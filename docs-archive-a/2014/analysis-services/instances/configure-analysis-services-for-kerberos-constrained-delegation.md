---
title: Konfigurieren von Analysis Services für die eingeschränkte Kerberos-Delegierung | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 6d751477-6bf1-48b4-8833-5a631bbe7650
author: minewiskan
ms.author: owend
ms.openlocfilehash: 03b852acb4868cd384ef34948c6aff70541638a0
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87699026"
---
# <a name="configure-analysis-services-for-kerberos-constrained-delegation"></a><span data-ttu-id="b53f1-102">Konfigurieren von Analysis Services für die eingeschränkte Kerberos-Delegierung</span><span class="sxs-lookup"><span data-stu-id="b53f1-102">Configure Analysis Services for Kerberos constrained delegation</span></span>
  <span data-ttu-id="b53f1-103">Wenn Sie Analysis Services für die Kerberos-Authentifizierung konfigurieren, verfolgen Sie damit wahrscheinlich eines oder beide der folgenden Ziele: Analysis Services soll bei der Abfrage von Daten eine Benutzeridentität annehmen, oder eine Benutzeridentität soll von Analysis Services an einen untergeordneten Dienst delegiert werden.</span><span class="sxs-lookup"><span data-stu-id="b53f1-103">When configuring Analysis Services for Kerberos authentication, you are most likely interested in achieving one or both of the following outcomes: having Analysis Services impersonate a user identity when querying data; or having Analysis Services delegate a user identity to a down-level service.</span></span> <span data-ttu-id="b53f1-104">Für die Szenarien gelten leicht abweichende Konfigurationsanforderungen.</span><span class="sxs-lookup"><span data-stu-id="b53f1-104">Each scenario calls for slightly different configuration requirements.</span></span> <span data-ttu-id="b53f1-105">Bei beiden Szenarien muss überprüft werden, ob die Konfiguration ordnungsgemäß ausgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="b53f1-105">Both scenarios require verification to ensure configuration was done properly.</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="b53f1-106">**[!INCLUDE[msCoName](../../includes/msconame-md.md)] Kerberos-Konfigurations-Manager für [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]** ist ein Diagnosetool zur Behebung Kerberos-bezogener Verbindungsprobleme bei [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b53f1-106">**[!INCLUDE[msCoName](../../includes/msconame-md.md)] Kerberos Configuration Manager for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]** is a diagnostic tool that helps troubleshoot Kerberos related connectivity issues with [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="b53f1-107">Weitere Informationen finden Sie unter [Microsoft Kerberos-Konfigurations-Manager für SQL Server](https://www.microsoft.com/download/details.aspx?id=39046).</span><span class="sxs-lookup"><span data-stu-id="b53f1-107">For more information, see [Microsoft Kerberos Configuration Manager for SQL Server](https://www.microsoft.com/download/details.aspx?id=39046).</span></span>  
  
 <span data-ttu-id="b53f1-108">Dieses Thema enthält folgende Abschnitte:</span><span class="sxs-lookup"><span data-stu-id="b53f1-108">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="b53f1-109">Zulassen, dass Analysis Services eine Benutzeridentität annimmt</span><span class="sxs-lookup"><span data-stu-id="b53f1-109">Allow Analysis Services to impersonate a user identity</span></span>](#bkmk_impersonate)  
  
-   [<span data-ttu-id="b53f1-110">Konfigurieren Analysis Services für die vertrauenswürdige Delegierung</span><span class="sxs-lookup"><span data-stu-id="b53f1-110">Configure Analysis Services for trusted delegation</span></span>](#bkmk_delegate)  
  
-   [<span data-ttu-id="b53f1-111">Prüfen, ob eine Identität angenommen oder delegiert wurde</span><span class="sxs-lookup"><span data-stu-id="b53f1-111">Test for impersonated or delegated identity</span></span>](#bkmk_test)  
  
> [!NOTE]  
>  <span data-ttu-id="b53f1-112">Die Delegierung ist nicht erforderlich, wenn die Verbindung mit Analysis Services eine Single-Hop-Verbindung ist oder wenn die Lösung gespeicherte Anmeldeinformationen verwendet, die von SharePoint "Einmaliges Anmelden" oder Reporting Services bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="b53f1-112">Delegation is not required if the connection to Analysis Services is a single hop, or your solution uses stored credentials provided by SharePoint Secure Store Service or Reporting Services.</span></span> <span data-ttu-id="b53f1-113">Wenn alle Verbindungen direkte Verbindungen von Excel mit einer Analysis Services-Datenbank sind oder auf gespeicherten Anmeldeinformationen basieren, können Sie Kerberos (oder NTLM) verwenden, ohne eine eingeschränkte Delegierung konfigurieren zu müssen.</span><span class="sxs-lookup"><span data-stu-id="b53f1-113">If all connections are direct connections from Excel to an Analysis Services database, or based on stored credentials, you can use Kerberos (or NTLM) without having to configure constrained delegation.</span></span>  
>   
>  <span data-ttu-id="b53f1-114">Die eingeschränkte Kerberos-Delegierung ist erforderlich, wenn die Benutzeridentität über mehrere Computer Verbindungen (als "Double-Hop" bezeichnet) übertragen werden muss.</span><span class="sxs-lookup"><span data-stu-id="b53f1-114">Kerberos constrained delegation is required if the user identity has to flow over multiple computer connections (known as "double-hop").</span></span> <span data-ttu-id="b53f1-115">Wenn der Analysis Services-Datenzugriff von der Benutzeridentität abhängig ist und die Verbindungsanforderung von einem delegierenden Dienst stammt, verwenden Sie die Checkliste im nächsten Abschnitt, um sicherzustellen, dass Analysis Services die Identität des ursprünglichen Aufrufers annehmen kann.</span><span class="sxs-lookup"><span data-stu-id="b53f1-115">When Analysis Services data access is contingent upon user identity, and the connection request is from a delegating service, use the checklist in the next section to ensure that Analysis Services is able to impersonate the original caller.</span></span> <span data-ttu-id="b53f1-116">Weitere Informationen zu Analysis Services-Authentifizierungsabläufen finden Sie unter [Microsoft BI-Authentifizierung und Identitätsdelegierung](https://go.microsoft.com/fwlink/?LinkID=286576).</span><span class="sxs-lookup"><span data-stu-id="b53f1-116">For more information about Analysis Services authentication flows, see [Microsoft BI Authentication and Identity Delegation](https://go.microsoft.com/fwlink/?LinkID=286576).</span></span>  
>   
>  <span data-ttu-id="b53f1-117">Als bewährte Sicherheitsmethode empfiehlt Microsoft immer eher die eingeschränkte als die uneingeschränkte Delegierung.</span><span class="sxs-lookup"><span data-stu-id="b53f1-117">As a security best practice, Microsoft always recommends constrained delegation over unconstrained delegation.</span></span> <span data-ttu-id="b53f1-118">Die uneingeschränkte Delegierung ist ein großes Sicherheitsrisiko, da sie der Dienstidentität ermöglicht, die Identität eines anderen Benutzers auf *beliebigen* Downstreamcomputern, -diensten oder -anwendungen zu übernehmen (im Gegensatz zu nur den Diensten, die über eine eingeschränkte Delegierung ausdrücklich definiert werden).</span><span class="sxs-lookup"><span data-stu-id="b53f1-118">Unconstrained delegation is a major security risk because it allows the service identity to impersonate another user on *any* downstream computer, service, or application (as opposed to just those services explicitly defined via constrained delegation).</span></span>  
  
##  <a name="allow-analysis-services-to-impersonate-a-user-identity"></a><a name="bkmk_impersonate"></a><span data-ttu-id="b53f1-119">Zulassen, dass Analysis Services die Identität einer Benutzeridentität annimmt</span><span class="sxs-lookup"><span data-stu-id="b53f1-119">Allow Analysis Services to impersonate a user identity</span></span>  
 <span data-ttu-id="b53f1-120">Um übergeordneten Diensten wie Reporting Services, IIS oder SharePoint zu ermöglichen, eine Benutzeridentität für Analysis Services anzunehmen, müssen Sie die eingeschränkte Kerberos-Delegierung für diese Dienste konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="b53f1-120">To allow up-level services such as Reporting Services, IIS, or SharePoint to impersonate a user identity on Analysis Services, you must configure Kerberos constrained delegation for those services.</span></span> <span data-ttu-id="b53f1-121">In diesem Szenario nimmt Analysis Services die Identität des aktuellen Benutzers an, indem die vom delegierenden Dienst bereitgestellte Identität angenommen wird. Die daraufhin zurückgegebenen Ergebnisse basieren auf der Rollenmitgliedschaft dieser Benutzeridentität.</span><span class="sxs-lookup"><span data-stu-id="b53f1-121">In this scenario, Analysis Services impersonates the current user using the identity provided by the delegating service, returning results based on role membership of that user identity.</span></span>  
  
|<span data-ttu-id="b53f1-122">Aufgabe</span><span class="sxs-lookup"><span data-stu-id="b53f1-122">Task</span></span>|<span data-ttu-id="b53f1-123">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="b53f1-123">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="b53f1-124">Schritt 1: Überprüfen, ob die Konten für die Delegierung geeignet sind</span><span class="sxs-lookup"><span data-stu-id="b53f1-124">Step 1: Verify that accounts are suitable for delegation</span></span>|<span data-ttu-id="b53f1-125">Stellen Sie sicher, dass die Konten, unter denen Sie die Dienste ausführen, über die entsprechenden Eigenschaften in Active Directory verfügen.</span><span class="sxs-lookup"><span data-stu-id="b53f1-125">Ensure that the accounts used to run the services have the correct properties in Active Directory.</span></span> <span data-ttu-id="b53f1-126">Dienstkonten in Active Directory dürfen nicht als vertrauliche Konten gekennzeichnet oder ausdrücklich aus Delegierungsszenarien ausgeschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="b53f1-126">Service accounts in Active Directory must not be marked as sensitive accounts, or specifically excluded from delegation scenarios.</span></span> <span data-ttu-id="b53f1-127">Weitere Informationen finden Sie unter [Grundlegendes zu Benutzerkonten](https://go.microsoft.com/fwlink/?LinkId=235818).</span><span class="sxs-lookup"><span data-stu-id="b53f1-127">For more information, see [Understanding User Accounts](https://go.microsoft.com/fwlink/?LinkId=235818).</span></span><br /><br /> <span data-ttu-id="b53f1-128">Wichtig: im Allgemeinen müssen alle Konten und Server derselben Active Directory Domäne oder vertrauenswürdigen Domänen in derselben Gesamtstruktur angehören. \*\* \* \* \* \* \*\*</span><span class="sxs-lookup"><span data-stu-id="b53f1-128">**\*\* Important \*\*** Generally, all accounts and servers must belong to the same Active Directory domain or to trusted domains in the same forest.</span></span> <span data-ttu-id="b53f1-129">Da Windows Server 2012 jedoch die Delegierung über Domänengrenzen hinweg unterstützt, können Sie eingeschränkte Kerberos-Delegierung über eine Domänengrenze hinweg konfigurieren, wenn die Domänenfunktionsebene Windows Server 2012 ist.</span><span class="sxs-lookup"><span data-stu-id="b53f1-129">However, because Windows Server 2012 supports delegation across domain boundaries, you can configure Kerberos constrained delegation across a domain boundary if the domain functional level is Windows Server 2012.</span></span> <span data-ttu-id="b53f1-130">Eine andere Möglichkeit besteht darin, Analysis Services für den HTTP-Zugriff zu konfigurieren und IIS-Authentifizierungsmethoden für die Clientverbindung zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="b53f1-130">Another alternative is to configure Analysis Services for HTTP access and use IIS authentication methods on the client connection.</span></span> <span data-ttu-id="b53f1-131">Weitere Informationen finden Sie unter [Konfigurieren von HTTP-Zugriff auf Analysis Services unter Internetinformationsdienste &#40;IIS&#41; 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).</span><span class="sxs-lookup"><span data-stu-id="b53f1-131">For more information, see [Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).</span></span>|  
|<span data-ttu-id="b53f1-132">Schritt 2: Registrieren des SPN</span><span class="sxs-lookup"><span data-stu-id="b53f1-132">Step 2: Register the SPN</span></span>|<span data-ttu-id="b53f1-133">Vor dem Einrichten der eingeschränkten Delegierung müssen Sie einen Dienstprinzipalnamen (SPN) für die Analysis Services-Instanz registrieren.</span><span class="sxs-lookup"><span data-stu-id="b53f1-133">Before setting up constrained delegation, you must register a Service Principle Name (SPN) for the Analysis Services instance.</span></span> <span data-ttu-id="b53f1-134">Sie benötigen den Analysis Services-SPN, wenn Sie die eingeschränkte Kerberos-Delegierung für Dienste der mittleren Ebene konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="b53f1-134">You will need the Analysis Services SPN when configuring Kerberos constrained delegation for middle tier services.</span></span> <span data-ttu-id="b53f1-135">Anweisungen dazu finden Sie unter [SPN registration for an Analysis Services instance](spn-registration-for-an-analysis-services-instance.md) .</span><span class="sxs-lookup"><span data-stu-id="b53f1-135">See [SPN registration for an Analysis Services instance](spn-registration-for-an-analysis-services-instance.md) for instructions.</span></span><br /><br /> <span data-ttu-id="b53f1-136">Ein Dienstprinzipalname (Service Principal Name, SPN) gibt die eindeutige Identität eines Diensts in einer Domäne an, die für die Kerberos-Authentifizierung konfiguriert wurde.</span><span class="sxs-lookup"><span data-stu-id="b53f1-136">A Service Principle Name (SPN) specifies the unique identity of a service in a domain configured for Kerberos authentication.</span></span> <span data-ttu-id="b53f1-137">Clientverbindungen mit integrierter Sicherheit erfordern im Rahmen der SSPI-Authentifizierung häufig einen SPN.</span><span class="sxs-lookup"><span data-stu-id="b53f1-137">Client connections using integrated security often request an SPN as part of SSPI authentication.</span></span> <span data-ttu-id="b53f1-138">Die Anforderung wird an einen Active Directory-Domänencontroller (DC) weitergeleitet. Dabei stellt KDC ein Ticket bereit, wenn für den vom Client angegebenen SPN in Active Directory eine entsprechende SPN-Registrierung vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="b53f1-138">The request is forwarded to an Active Directory Domain Controller (DC), with the KDC granting a ticket if the SPN presented by the client has a matching SPN registration in Active Directory.</span></span>|  
|<span data-ttu-id="b53f1-139">Schritt 3: Konfigurieren der eingeschränkten Delegierung</span><span class="sxs-lookup"><span data-stu-id="b53f1-139">Step 3: Configure constrained delegation</span></span>|<span data-ttu-id="b53f1-140">Nachdem Sie die zu verwendenden Konten überprüft und SPNs dafür registriert haben, konfigurieren Sie im nächsten Schritt übergeordnete Dienste wie IIS, Reporting Services oder SharePoint-Webdienste für die eingeschränkte Delegierung, und geben Sie dabei die Analysis Services-SPN als spezifischen Dienst an, für den die Delegierung erlaubt ist.</span><span class="sxs-lookup"><span data-stu-id="b53f1-140">After validating the accounts you want to use and registering SPNs for those accounts, your next step is to configure up-level services, such as IIS, Reporting Services, or SharePoint web services for constrained delegation, specifying the Analysis Services SPN as the specific service for which delegation is allowed.</span></span><br /><br /> <span data-ttu-id="b53f1-141">Unter SharePoint ausgeführte Dienste wie Excel Services oder Reporting Services im SharePoint-Modus hosten häufig Arbeitsmappen und Berichte, die mehrdimensionale oder tabellarische Analysis Services-Daten nutzen.</span><span class="sxs-lookup"><span data-stu-id="b53f1-141">Services that run in SharePoint, such as Excel Services or Reporting Services in SharePoint mode, often host workbooks and reports that consume Analysis Services multidimensional or tabular data.</span></span> <span data-ttu-id="b53f1-142">Die Konfiguration der eingeschränkten Delegierung für diese Dienste ist eine allgemeine Konfigurationsaufgabe, die ausgeführt werden muss, damit die Datenaktualisierung von Excel Services unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="b53f1-142">Configuring constrained delegation for these services is a common configuration task, and necessary for supporting data refresh from Excel Services.</span></span> <span data-ttu-id="b53f1-143">Über die folgenden Links erhalten Sie Anweisungen für SharePoint Services und andere Dienste, die Downstream-Verbindungsanforderungen für Analysis Services-Daten ausgeben können:</span><span class="sxs-lookup"><span data-stu-id="b53f1-143">The following links provide instructions for SharePoint services, as well as other services likely to present a downstream data connection request for Analysis Services data:</span></span><br /><br /> <span data-ttu-id="b53f1-144">[Identitätsdelegierung für Excel Services (SharePoint Server 2010)](https://go.microsoft.com/fwlink/?LinkId=299826) oder [Konfigurieren von Excel Services in SharePoint Server 2010 für Kerberos-Authentifizierung](https://support.microsoft.com/kb/2466519)</span><span class="sxs-lookup"><span data-stu-id="b53f1-144">[Identity delegation for Excel Services (SharePoint Server 2010)](https://go.microsoft.com/fwlink/?LinkId=299826) or [How to configure Excel Services in SharePoint Server 2010 for Kerberos authentication](https://support.microsoft.com/kb/2466519)</span></span><br /><br /> [<span data-ttu-id="b53f1-145">Identitätsdelegierung für PerformancePoint-Dienste (SharePoint Server 2010)</span><span class="sxs-lookup"><span data-stu-id="b53f1-145">Identity delegation for PerformancePoint Services (SharePoint Server 2010)</span></span>](https://go.microsoft.com/fwlink/?LinkId=299827)<br /><br /> [<span data-ttu-id="b53f1-146">Identitätsdelegierung für SQL Server Reporting Services (SharePoint Server 2010)</span><span class="sxs-lookup"><span data-stu-id="b53f1-146">Identity delegation for SQL Server Reporting Services (SharePoint Server 2010)</span></span>](https://go.microsoft.com/fwlink/?LinkId=299828)<br /><br /> <span data-ttu-id="b53f1-147">Informationen zu IIS 7.0 finden Sie unter [Konfigurieren der Windows-Authentifizierung (IIS 7.0)](https://technet.microsoft.com/library/cc754628\(v=ws.10\).aspx) oder [Konfigurieren von SQL Server 2008 Analysis Services und SQL Server 2005 Analysis Services, um Kerberos-Authentifizierung zu verwenden](https://support.microsoft.com/kb/917409).</span><span class="sxs-lookup"><span data-stu-id="b53f1-147">For IIS 7.0 see [Configure Windows Authentication (IIS 7.0)](https://technet.microsoft.com/library/cc754628\(v=ws.10\).aspx) or [How to configure SQL Server 2008 Analysis Services and SQL Server 2005 Analysis Services to use Kerberos authentication](https://support.microsoft.com/kb/917409).</span></span>|  
|<span data-ttu-id="b53f1-148">Schritt 4: Testen von Verbindungen</span><span class="sxs-lookup"><span data-stu-id="b53f1-148">Step 4: Test connections</span></span>|<span data-ttu-id="b53f1-149">Stellen Sie beim Testen Verbindungen von Remotecomputern unter verschiedenen Identitäten her, und fragen Sie Analysis Services mit den gleichen Anwendungen ab, die von Benutzern im geschäftlichen Bereich verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="b53f1-149">When testing, connect from remote computers, under different identities, and query Analysis Services using the same applications as business users.</span></span> <span data-ttu-id="b53f1-150">Mithilfe von SQL Server Profiler können Sie die Verbindung überwachen.</span><span class="sxs-lookup"><span data-stu-id="b53f1-150">You can use SQL Server Profiler to monitor the connection.</span></span> <span data-ttu-id="b53f1-151">Die Benutzeridentität für die Anforderung sollte angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="b53f1-151">You should see the user identity on the request.</span></span> <span data-ttu-id="b53f1-152">Weitere Informationen finden Sie unter [Prüfen, ob eine Identität angenommen oder delegiert wurde](#bkmk_test) in diesem Abschnitt.</span><span class="sxs-lookup"><span data-stu-id="b53f1-152">For more information, see [Test for impersonated or delegated identity](#bkmk_test) in this section.</span></span>|  
  
##  <a name="configure-analysis-services-for-trusted-delegation"></a><a name="bkmk_delegate"></a> <span data-ttu-id="b53f1-153">Konfigurieren von Analysis Services für die vertrauenswürdige Delegierung</span><span class="sxs-lookup"><span data-stu-id="b53f1-153">Configure Analysis Services for trusted delegation</span></span>  
 <span data-ttu-id="b53f1-154">Indem Sie Analysis Services für die eingeschränkte Kerberos-Delegierung konfigurieren, ermöglichen Sie dem Dienst, eine Clientidentität für einen untergeordneten Dienst, z.B. die relationale Datenbank-Engine, anzunehmen. Daraufhin können die Daten so abgefragt werden, als wäre der Client direkt verbunden.</span><span class="sxs-lookup"><span data-stu-id="b53f1-154">Configuring Analysis Services for Kerberos constrained delegation allows the service to impersonate a client identity on a down-level service, such as the relational database engine, so that data can be queried as if the client was connected directly.</span></span>  
  
 <span data-ttu-id="b53f1-155">Delegierungsszenarien für Analysis Services sind auf tabellarische Modelle beschränkt, die für den `DirectQuery`-Modus konfiguriert sind.</span><span class="sxs-lookup"><span data-stu-id="b53f1-155">Delegation scenarios for Analysis Services are limited to tabular models configured for `DirectQuery` mode.</span></span> <span data-ttu-id="b53f1-156">Dies ist das einzige Szenario, bei dem Analysis Services delegierte Anmeldeinformationen an einen anderen Dienst übergeben kann.</span><span class="sxs-lookup"><span data-stu-id="b53f1-156">This is the only scenario in which Analysis Services can pass delegated credentials to another service.</span></span> <span data-ttu-id="b53f1-157">In allen anderen Szenarien wie den im vorherigen Abschnitt erwähnten SharePoint-Szenarien ist Analysis Services am empfangenden Ende der Delegierungskette.</span><span class="sxs-lookup"><span data-stu-id="b53f1-157">In all other scenarios, such as SharePoint scenarios mentioned in the previous section, Analysis Services is on the receiving end of the delegation chain.</span></span> <span data-ttu-id="b53f1-158">Weitere Informationen zu DirectQuery finden Sie unter [DirectQuery-Modus &#40;SSAS – tabellarisch&#41;](../tabular-models/directquery-mode-ssas-tabular.md).</span><span class="sxs-lookup"><span data-stu-id="b53f1-158">For more information about DirectQuery, see [DirectQuery Mode &#40;SSAS Tabular&#41;](../tabular-models/directquery-mode-ssas-tabular.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="b53f1-159">Ein typisches Missverständnis ist, dass ROLAP-Speicher, -Verarbeitungsvorgänge oder -Zugriff auf Remotepartitionen auf irgendeine Weise eine eingeschränkte Delegierung erforderlich machen.</span><span class="sxs-lookup"><span data-stu-id="b53f1-159">A common misconception is that ROLAP storage, processing operations, or access to remote partitions somehow introduce requirements for constrained delegation.</span></span> <span data-ttu-id="b53f1-160">Das ist nicht der Fall.</span><span class="sxs-lookup"><span data-stu-id="b53f1-160">This is not the case.</span></span> <span data-ttu-id="b53f1-161">Alle diese Vorgänge werden direkt vom Dienstkonto (das auch als Verarbeitungskonto bezeichnet wird) im eigenen Namen ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="b53f1-161">All of these operations are executed directly by the service account (also referred to as the processing account), on its own behalf.</span></span> <span data-ttu-id="b53f1-162">Die Delegierung ist für diese Vorgänge in Analysis Services nicht erforderlich, da die Berechtigungen für solche Vorgänge direkt dem Dienstkonto gewährt werden (beispielsweise das Gewähren der db_datareader-Berechtigungen für die relationale Datenbank, damit der Dienst Daten verarbeiten kann).</span><span class="sxs-lookup"><span data-stu-id="b53f1-162">Delegation is not required for these operations in Analysis Services, given that permissions for such operations are granted directly to the service account (for example, granting db_datareader permissions on the relational database so that the service can process data).</span></span> <span data-ttu-id="b53f1-163">Weitere Informationen zu Servervorgängen und -berechtigungen finden Sie unter [Konfigurieren von Dienstkonten &#40;Analysis Services&#41;](configure-service-accounts-analysis-services.md).</span><span class="sxs-lookup"><span data-stu-id="b53f1-163">For more information about server operations and permissions, see [Configure Service Accounts &#40;Analysis Services&#41;](configure-service-accounts-analysis-services.md).</span></span>  
  
 <span data-ttu-id="b53f1-164">In diesem Abschnitt wird erläutert, wie Sie Analysis Services für die vertrauenswürdige Delegierung einrichten.</span><span class="sxs-lookup"><span data-stu-id="b53f1-164">This section explains how to set up Analysis Services for trusted delegation.</span></span> <span data-ttu-id="b53f1-165">Nachdem Sie diese Aufgabe abgeschlossen haben, kann Analysis Services delegierte Anmeldeinformationen zur Unterstützung des in tabellarischen Lösungen verwendeten DirectQuery-Modus an SQL Server übergeben.</span><span class="sxs-lookup"><span data-stu-id="b53f1-165">After you complete this task, Analysis Services will be able to pass delegated credentials to SQL Server, in support of DirectQuery mode used in Tabular solutions.</span></span>  
  
 <span data-ttu-id="b53f1-166">Vorbereitungen:</span><span class="sxs-lookup"><span data-stu-id="b53f1-166">Before you start:</span></span>  
  
-   <span data-ttu-id="b53f1-167">Überprüfen Sie, ob Analysis Services gestartet wurde.</span><span class="sxs-lookup"><span data-stu-id="b53f1-167">Verify that Analysis Services is started.</span></span>  
  
-   <span data-ttu-id="b53f1-168">Überprüfen Sie, ob der für Analysis Services registrierte SPN gültig ist.</span><span class="sxs-lookup"><span data-stu-id="b53f1-168">Verify the SPN registered for Analysis Services is valid.</span></span> <span data-ttu-id="b53f1-169">Anweisungen finden Sie unter [SPN registration for an Analysis Services instance](spn-registration-for-an-analysis-services-instance.md).</span><span class="sxs-lookup"><span data-stu-id="b53f1-169">For instructions, see [SPN registration for an Analysis Services instance](spn-registration-for-an-analysis-services-instance.md)</span></span>  
  
 <span data-ttu-id="b53f1-170">Wenn beide Voraussetzungen erfüllt sind, fahren Sie mit den folgenden Schritten fort.</span><span class="sxs-lookup"><span data-stu-id="b53f1-170">When both prerequisites are satisfied, continue with the following steps.</span></span> <span data-ttu-id="b53f1-171">Beachten Sie, dass Sie Domänenadministrator sein müssen, um die eingeschränkte Delegierung einzurichten.</span><span class="sxs-lookup"><span data-stu-id="b53f1-171">Note that you must be a domain administrator to set up constrained delegation.</span></span>  
  
1.  <span data-ttu-id="b53f1-172">Suchen Sie unter Active Directory-Benutzer und -Computer das Dienstkonto, unter dem Analysis Services ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="b53f1-172">In Active Directory Users and Computers, find the service account under which Analysis Services runs.</span></span> <span data-ttu-id="b53f1-173">Klicken Sie mit der rechten Maustaste auf das Dienstkonto, und wählen Sie **Eigenschaften**aus.</span><span class="sxs-lookup"><span data-stu-id="b53f1-173">Right-click the service account and choose **Properties**.</span></span>  
  
     <span data-ttu-id="b53f1-174">Zur Veranschaulichung werden in den folgenden Screenshots "OlapSvc" und "SQLSvc" verwendet, um Analysis Services und SQL Server darzustellen.</span><span class="sxs-lookup"><span data-stu-id="b53f1-174">For illustrative purposes, the following screenshots use OlapSvc and SQLSvc to represent Analysis Services and SQL Server, respectively.</span></span>  
  
     <span data-ttu-id="b53f1-175">"OlapSvc" ist das Konto, das für die eingeschränkte Delegierung an "SQLSvc" konfiguriert wird.</span><span class="sxs-lookup"><span data-stu-id="b53f1-175">OlapSvc is the account that will be configured for constrained delegation to SQLSvc.</span></span> <span data-ttu-id="b53f1-176">Nachdem Sie diese Aufgabe abgeschlossen haben, ist "OlapSvc" berechtigt, delegierte Anmeldeinformationen für ein Dienstticket an "SQLSvc" zu übergeben. Dadurch wird beim Anfordern von Daten die Identität des ursprünglichen Aufrufers angenommen.</span><span class="sxs-lookup"><span data-stu-id="b53f1-176">When you complete this task, OlapSvc will have permission to pass delegated credentials on a service ticket to SQLSvc, impersonating the original caller when requesting data.</span></span>  
  
2.  <span data-ttu-id="b53f1-177">Wählen Sie auf der Registerkarte Delegierung die Option **Benutzer bei Delegierungen angegebener Dienste vertrauen**und dann **Nur Kerberos verwenden**aus.</span><span class="sxs-lookup"><span data-stu-id="b53f1-177">On the Delegation tab, select **Trust this user for delegation to specified services only**, followed by **Use Kerberos only**.</span></span> <span data-ttu-id="b53f1-178">Klicken Sie auf **Hinzufügen** , um anzugeben, an welchen Dienst Anmeldeinformationen von Analysis Services delegiert werden dürfen.</span><span class="sxs-lookup"><span data-stu-id="b53f1-178">Click **Add** to specify which service Analysis Services is permitted to delegate credentials.</span></span>  
  
     <span data-ttu-id="b53f1-179">Die Registerkarte Delegierung wird nur angezeigt, wenn das Dienstkonto (OlapSvc) einem Dienst (Analysis Services) zugewiesen ist und für den Dienst ein SPN registriert wurde.</span><span class="sxs-lookup"><span data-stu-id="b53f1-179">Delegation tab appears only when the user account (OlapSvc) is assigned to a service (Analysis Services), and the service has an SPN registered for it.</span></span> <span data-ttu-id="b53f1-180">Die SPN-Registrierung setzt voraus, dass der Dienst ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="b53f1-180">SPN registration requires that the service is running.</span></span>  
  
     <span data-ttu-id="b53f1-181">![SSAS_Kerberos_1_AccountProperties](../media/ssas-kerberos-1-accountproperties.gif "SSAS_Kerberos_1_AccountProperties")</span><span class="sxs-lookup"><span data-stu-id="b53f1-181">![SSAS_Kerberos_1_AccountProperties](../media/ssas-kerberos-1-accountproperties.gif "SSAS_Kerberos_1_AccountProperties")</span></span>  
  
3.  <span data-ttu-id="b53f1-182">Klicken Sie auf der Seite Dienste hinzufügen auf **Benutzer oder Computer**.</span><span class="sxs-lookup"><span data-stu-id="b53f1-182">On the Add Services page, click **Users or Computers**.</span></span>  
  
     <span data-ttu-id="b53f1-183">![SSAS_Kerberos_2_](../media/ssas-kerberos-2.gif "SSAS_Kerberos_2_")</span><span class="sxs-lookup"><span data-stu-id="b53f1-183">![SSAS_Kerberos_2_](../media/ssas-kerberos-2.gif "SSAS_Kerberos_2_")</span></span>  
  
4.  <span data-ttu-id="b53f1-184">Geben Sie auf der Seite zum Auswählen von Benutzern oder Computern das Konto ein, das zur Ausführung der SQL Server-Instanz verwendet wird, die Daten für tabellarische Analysis Services-Modelldatenbanken bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="b53f1-184">On the Select Users or Computer page, enter the account used to run the SQL Server instance providing data to Analysis Services tabular model databases.</span></span> <span data-ttu-id="b53f1-185">Klicken Sie auf **OK** , um das Dienstkonto zu übernehmen.</span><span class="sxs-lookup"><span data-stu-id="b53f1-185">Click **OK** to accept the service account.</span></span>  
  
     <span data-ttu-id="b53f1-186">Wenn Sie das gewünschte Konto nicht auswählen können, überprüfen Sie, ob SQL Server ausgeführt wird und ob ein SPN für das Konto registriert wurde.</span><span class="sxs-lookup"><span data-stu-id="b53f1-186">If you cannot select the account you want, verify that SQL Server is running and has an SPN registered for that account.</span></span> <span data-ttu-id="b53f1-187">Weitere Informationen zu SPNs für die Datenbank-Engine finden Sie unter [Register a Service Principal Name for Kerberos Connections](../../database-engine/configure-windows/register-a-service-principal-name-for-kerberos-connections.md).</span><span class="sxs-lookup"><span data-stu-id="b53f1-187">For more information about SPNs for the database engine, see [Register a Service Principal Name for Kerberos Connections](../../database-engine/configure-windows/register-a-service-principal-name-for-kerberos-connections.md).</span></span>  
  
     <span data-ttu-id="b53f1-188">![SSAS_Kerberos_3_SelectUsers](../media/ssas-kerberos-3-selectusers.gif "SSAS_Kerberos_3_SelectUsers")</span><span class="sxs-lookup"><span data-stu-id="b53f1-188">![SSAS_Kerberos_3_SelectUsers](../media/ssas-kerberos-3-selectusers.gif "SSAS_Kerberos_3_SelectUsers")</span></span>  
  
5.  <span data-ttu-id="b53f1-189">Die SQL Server-Instanz sollte jetzt in Dienste hinzufügen angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="b53f1-189">The SQL Server instance should now appear in Add Services.</span></span> <span data-ttu-id="b53f1-190">Darüber hinaus wird jeder Dienst, der dieses Konto verwendet, in der Liste angezeigt.</span><span class="sxs-lookup"><span data-stu-id="b53f1-190">Any service also using that account will also appear in the list.</span></span> <span data-ttu-id="b53f1-191">Wählen Sie die SQL Server-Instanz aus, die Sie verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="b53f1-191">Choose the SQL Server instance you want to use.</span></span> <span data-ttu-id="b53f1-192">Klicken Sie auf **OK** , um die Instanz zu übernehmen.</span><span class="sxs-lookup"><span data-stu-id="b53f1-192">Click **OK** to accept the instance.</span></span>  
  
     <span data-ttu-id="b53f1-193">![SSAS_Kerberos_4_](../media/ssas-kerberos-4.gif "SSAS_Kerberos_4_")</span><span class="sxs-lookup"><span data-stu-id="b53f1-193">![SSAS_Kerberos_4_](../media/ssas-kerberos-4.gif "SSAS_Kerberos_4_")</span></span>  
  
6.  <span data-ttu-id="b53f1-194">Die Eigenschaftenseite des Analysis Services-Dienstkontos sollte jetzt dem folgenden Screenshot entsprechen.</span><span class="sxs-lookup"><span data-stu-id="b53f1-194">The properties page of the Analysis Services service account should now look similar to the following screenshot.</span></span> <span data-ttu-id="b53f1-195">Klicken Sie auf **OK** , um die Änderungen zu speichern.</span><span class="sxs-lookup"><span data-stu-id="b53f1-195">Click **OK** to save your changes.</span></span>  
  
     <span data-ttu-id="b53f1-196">![SSAS_Kerberos_5_Finished](../media/ssas-kerberos-5-finished.gif "SSAS_Kerberos_5_Finished")</span><span class="sxs-lookup"><span data-stu-id="b53f1-196">![SSAS_Kerberos_5_Finished](../media/ssas-kerberos-5-finished.gif "SSAS_Kerberos_5_Finished")</span></span>  
  
7.  <span data-ttu-id="b53f1-197">Überprüfen Sie, ob die Delegierung erfolgreich war, indem Sie vom Remoteclientcomputer unter einer anderen Identität eine Verbindung herstellen und eine Abfrage an das tabellarische Modell senden.</span><span class="sxs-lookup"><span data-stu-id="b53f1-197">Test for successful delegation by connecting from a remote client computer, under a different identity, and query the tabular model.</span></span> <span data-ttu-id="b53f1-198">Die Benutzeridentität für die Anforderung sollte im SQL Server Profiler angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="b53f1-198">You should see the user identity on the request in SQL Server Profiler.</span></span>  
  
##  <a name="test-for-impersonated-or-delegated-identity"></a><a name="bkmk_test"></a><span data-ttu-id="b53f1-199">Testen auf die Identität mit Identitätswechsel oder Delegierter Identität</span><span class="sxs-lookup"><span data-stu-id="b53f1-199">Test for impersonated or delegated identity</span></span>  
 <span data-ttu-id="b53f1-200">Überwachen Sie mit SQL Server Profiler die Identität des Benutzers, der die Daten abfragt.</span><span class="sxs-lookup"><span data-stu-id="b53f1-200">Use SQL Server Profiler to monitor the identity of the user who is querying data.</span></span>  
  
1.  <span data-ttu-id="b53f1-201">Starten Sie erst **SQL Server Profiler** für die Analysis Services-Instanz und dann eine neue Ablaufverfolgung.</span><span class="sxs-lookup"><span data-stu-id="b53f1-201">Start **SQL Server Profiler** on the Analysis Services instance and then start a new trace.</span></span>  
  
2.  <span data-ttu-id="b53f1-202">Überprüfen Sie in der Ereignisauswahl, ob `Audit Login` und `Audit Logout` im Abschnitt Sicherheitsüberwachung aktiviert sind.</span><span class="sxs-lookup"><span data-stu-id="b53f1-202">In Events Selection, verify that `Audit Login` and `Audit Logout` are checked in the Security Audit section.</span></span>  
  
3.  <span data-ttu-id="b53f1-203">Stellen Sie von einem Remoteclientcomputer über einen Anwendungsdienst (z. B. SharePoint oder Reporting Services) eine Verbindung mit Analysis Services her.</span><span class="sxs-lookup"><span data-stu-id="b53f1-203">Connect to Analysis Services via an application service (such as SharePoint or Reporting Services) from a remote client computer.</span></span> <span data-ttu-id="b53f1-204">Das Audit Login-Ereignis zeigt die Identität des Benutzers an, der eine Verbindung mit Analysis Services herstellt.</span><span class="sxs-lookup"><span data-stu-id="b53f1-204">The Audit Login event will show the identity of the user connecting to Analysis Services.</span></span>  
  
 <span data-ttu-id="b53f1-205">Gründliche Tests erfordern den Einsatz von Netzwerküberwachungstools, die Kerberos-Anforderungen und -Antworten im Netzwerk erfassen können.</span><span class="sxs-lookup"><span data-stu-id="b53f1-205">Thorough testing will require the use of network monitoring tools that can capture Kerberos requests and responses on the network.</span></span> <span data-ttu-id="b53f1-206">Für diese Aufgabe kann das Netzwerkmonitor-Hilfsprogramm (netmon.exe) mit Kerberos-Filter verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="b53f1-206">The Network Monitor utility (netmon.exe), filtered for Kerberos, can be used for this task.</span></span> <span data-ttu-id="b53f1-207">Weitere Informationen zur Verwendung von Netmon 3.4 und anderen Tools zum Testen der Kerberos-Authentifizierung finden Sie unter [Konfigurieren der Kerberos-Authentifizierung: Kernkonfiguration (SharePoint Server 2010)](https://technet.microsoft.com/library/gg502602\(v=office.14\).aspx).</span><span class="sxs-lookup"><span data-stu-id="b53f1-207">For more information about using Netmon 3.4 and other tools for testing Kerberos authentication, see [Configuring Kerberos authentication: Core configuration (SharePoint Server 2010)](https://technet.microsoft.com/library/gg502602\(v=office.14\).aspx).</span></span>  
  
 <span data-ttu-id="b53f1-208">Eine ausführliche Beschreibung der einzelnen Optionen auf der Registerkarte "Delegierung" des Active Directory-Dialogfelds mit den Objekteigenschaften finden Sie unter [Das komplizierteste Dialogfeld Active Directory](https://www.itprotoday.com/active-directory/most-confusing-dialog-box-active-directory) .</span><span class="sxs-lookup"><span data-stu-id="b53f1-208">Additionally, see [The Most Confusing Dialog Box in Active Directory](https://www.itprotoday.com/active-directory/most-confusing-dialog-box-active-directory) for a thorough description of each option in the Delegation tab of the Active Directory object's property dialog box.</span></span> <span data-ttu-id="b53f1-209">In diesem Artikel wird auch erläutert, wie Sie LDP zum Testen und Interpretieren der Testergebnisse verwenden.</span><span class="sxs-lookup"><span data-stu-id="b53f1-209">This article also explains how to use LDP to test and interpret test results.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b53f1-210">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="b53f1-210">See Also</span></span>  
 <span data-ttu-id="b53f1-211">[Microsoft BI-Authentifizierung und Identitäts Delegierung](https://go.microsoft.com/fwlink/?LinkID=286576) </span><span class="sxs-lookup"><span data-stu-id="b53f1-211">[Microsoft BI Authentication and Identity Delegation](https://go.microsoft.com/fwlink/?LinkID=286576) </span></span>  
 <span data-ttu-id="b53f1-212">[Gegenseitige Authentifizierung mithilfe von Kerberos](https://go.microsoft.com/fwlink/?LinkId=299283) </span><span class="sxs-lookup"><span data-stu-id="b53f1-212">[Mutual Authentication Using Kerberos](https://go.microsoft.com/fwlink/?LinkId=299283) </span></span>  
 <span data-ttu-id="b53f1-213">[Verbindung mit Analysis Services herstellen](connect-to-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="b53f1-213">[Connect to Analysis Services](connect-to-analysis-services.md) </span></span>  
 <span data-ttu-id="b53f1-214">[SPN-Registrierung für eine Analysis Services Instanz](spn-registration-for-an-analysis-services-instance.md) </span><span class="sxs-lookup"><span data-stu-id="b53f1-214">[SPN registration for an Analysis Services instance](spn-registration-for-an-analysis-services-instance.md) </span></span>  
 [<span data-ttu-id="b53f1-215">Verbindungszeichenfolgen-Eigenschaften &#40;Analysis Services&#41;</span><span class="sxs-lookup"><span data-stu-id="b53f1-215">Connection String Properties &#40;Analysis Services&#41;</span></span>](connection-string-properties-analysis-services.md)  
  
  

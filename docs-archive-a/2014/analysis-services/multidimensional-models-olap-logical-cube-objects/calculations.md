---
title: Berechnungen | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- calculations [Analysis Services]
- OLAP objects [Analysis Services], calculations
- MDX [Analysis Services], calculations
- calculations [Analysis Services], about calculations
- cubes [Analysis Services], calculations
ms.assetid: 6be84916-fd05-4efc-ab98-6adbbad80154
author: minewiskan
ms.author: owend
ms.openlocfilehash: 4457a5fa434be3865edf770f7ca69a676c051893
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87723214"
---
# <a name="calculations"></a><span data-ttu-id="158ae-102">Berechnungen</span><span class="sxs-lookup"><span data-stu-id="158ae-102">Calculations</span></span>
  <span data-ttu-id="158ae-103">Eine Berechnung ist ein MDX-Ausdruck (Multidimensional Expressions) oder ein Skript, das verwendet wird, um ein berechnetes Element, eine benannte Menge oder eine Bereichs bezogene Zuweisung in einem Cube in zu definieren [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="158ae-103">A calculation is a Multidimensional Expressions (MDX) expression or script that is used to define a calculated member, a named set, or a scoped assignment in a cube in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="158ae-104">Mithilfe von Berechnungen können Sie einem Cube Objekte hinzufügen, die nicht durch die Daten des Cubes definiert sind, sondern über Ausdrücke, die auf andere Teile des Cubes, andere Cubes oder auch auf Informationen außerhalb der [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]-Datenbank verweisen können.</span><span class="sxs-lookup"><span data-stu-id="158ae-104">Calculations let you add objects that are defined not by the data of the cube, but by expressions that can reference other parts of the cube, other cubes, or even information outside the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> <span data-ttu-id="158ae-105">Mithilfe von Berechnungen können Sie die Funktionen eines Cubes erweitern, wodurch Business Intelligence-Anwendungen flexibler und leistungsfähiger werden.</span><span class="sxs-lookup"><span data-stu-id="158ae-105">Calculations let you extend the capabilities of a cube, adding flexibility and power to business intelligence applications.</span></span> <span data-ttu-id="158ae-106">Weitere Informationen zu Skript Berechnungen finden Sie unter [Introduction to MDX Scripting in Microsoft SQL Server 2005](https://go.microsoft.com/fwlink/?LinkId=81892).</span><span class="sxs-lookup"><span data-stu-id="158ae-106">For more information about scripting calculations, see [Introduction to MDX Scripting in Microsoft SQL Server 2005](https://go.microsoft.com/fwlink/?LinkId=81892).</span></span> <span data-ttu-id="158ae-107">Weitere Informationen zu Leistungsproblemen im Zusammenhang mit MDX-Abfragen und-Berechnungen finden Sie im [SQL Server 2005 Analysis Services Performance Guide](https://docsbay.net/Microsoft-SQL-Server-2005-Analysis-Services-Performance-Guide).</span><span class="sxs-lookup"><span data-stu-id="158ae-107">For more information about performance issues related to MDX queries and calculations, see the [SQL Server 2005 Analysis Services Performance Guide](https://docsbay.net/Microsoft-SQL-Server-2005-Analysis-Services-Performance-Guide).</span></span>  
  
## <a name="calculated-members"></a><span data-ttu-id="158ae-108">Berechnete Elemente</span><span class="sxs-lookup"><span data-stu-id="158ae-108">Calculated Members</span></span>  
 <span data-ttu-id="158ae-109">Bei einem berechneten Element handelt es sich um ein Element, dessen Wert zur Laufzeit mithilfe eines MDX-Ausdrucks (Multidimensional Expressions) berechnet wird, den Sie beim Definieren des berechneten Elements angeben.</span><span class="sxs-lookup"><span data-stu-id="158ae-109">A calculated member is a member whose value is calculated at run time using a Multidimensional Expressions (MDX) expression that you specify when you define the calculated member.</span></span> <span data-ttu-id="158ae-110">Ein berechnetes Element ist für Business Intelligence-Anwendungen in gleicher Weise wie andere Elemente auch verfügbar.</span><span class="sxs-lookup"><span data-stu-id="158ae-110">A calculated member is available to business intelligence applications just like any other member.</span></span> <span data-ttu-id="158ae-111">Durch berechnete Elemente wird die Größe des Cubes nicht erhöht, da nur die Definitionen im Cube gespeichert werden. Die Werte werden im Arbeitsspeicher berechnet, wenn sie zur Beantwortung einer Abfrage benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="158ae-111">Calculated members do not increase the size of the cube because only the definitions are stored in the cube; values are calculated in memory as required to answer a query.</span></span>  
  
 <span data-ttu-id="158ae-112">Berechnete Elemente können für eine beliebige Dimension, einschließlich der Measuredimension, definiert werden.</span><span class="sxs-lookup"><span data-stu-id="158ae-112">Calculated members can be defined for any dimension, including the measures dimension.</span></span> <span data-ttu-id="158ae-113">Berechnete Elemente, die auf der Measuredimension erstellt wurden, werden als berechnete Measures bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="158ae-113">Calculated members created on the Measures dimension are called calculated measures.</span></span>  
  
 <span data-ttu-id="158ae-114">Obwohl berechnete Elemente normalerweise auf Daten basieren, die bereits im Cube vorhanden sind, können Sie komplexe Ausdrücke erstellen, indem Sie Daten mit arithmetischen Operatoren, Zahlen und Funktionen kombinieren.</span><span class="sxs-lookup"><span data-stu-id="158ae-114">Although calculated members are typically based on data that already exists in the cube, you can create complex expressions by combining data with arithmetic operators, numbers, and functions.</span></span> <span data-ttu-id="158ae-115">Mit MDX-Funktionen wie LookupCube können Sie auch auf Daten in anderen Cubes in der [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]-Datenbank zugreifen.</span><span class="sxs-lookup"><span data-stu-id="158ae-115">You can also use MDX functions, such as LookupCube, to access data in other cubes in the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="158ae-116">enthält standardisierte Visual Studio-Funktionsbibliotheken, und mit gespeicherten Prozeduren können Sie Daten aus anderen Quellen als der aktuellen [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]-Datenbank abrufen.</span><span class="sxs-lookup"><span data-stu-id="158ae-116">includes standardized Visual Studio function libraries, and you can use stored procedures to retrieve data from sources other than the current [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> <span data-ttu-id="158ae-117">Weitere Informationen zu gespeicherten Prozeduren finden Sie unter [Definieren von gespeicherten Prozeduren](../multidimensional-models-extending-olap-stored-procedures/defining-stored-procedures.md).</span><span class="sxs-lookup"><span data-stu-id="158ae-117">For more information about stored procedures, see [Defining Stored Procedures](../multidimensional-models-extending-olap-stored-procedures/defining-stored-procedures.md).</span></span>  
  
 <span data-ttu-id="158ae-118">Angenommen, die leitenden Mitarbeiter eines Transportunternehmens möchten ermitteln, welcher Frachttyp, ausgehend vom Gewinn pro Mengeneinheit, rentabler versendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="158ae-118">For example, suppose executives in a shipping company want to determine which types of cargo are more profitable to carry, based on profit per unit of volume.</span></span> <span data-ttu-id="158ae-119">Sie verwenden dazu einen Shipments-Cube, der die Dimensionen Cargo, Fleet und Time sowie die Measures Price_to_Ship, Cost_to_Ship und Volume_in_Cubic_Meters enthält; der Cube enthält jedoch kein Measure für die Rentabilität.</span><span class="sxs-lookup"><span data-stu-id="158ae-119">They use a Shipments cube that contains the dimensions Cargo, Fleet, and Time and the measures Price_to_Ship, Cost_to_Ship, and Volume_in_Cubic_Meters; however, the cube does not contain a measure for profitability.</span></span> <span data-ttu-id="158ae-120">Sie können in dem Cube ein berechnetes Element als Measure mit dem Namen Profit_per_Cubic_Meter erstellen, wobei Sie die vorhandenen Measures im folgenden Ausdruck verwenden:</span><span class="sxs-lookup"><span data-stu-id="158ae-120">You can create a calculated member as a measure named Profit_per_Cubic_Meter in the cube by combining the existing measures in the following expression:</span></span>  
  
```  
([Measures].[Price_to_Ship] - [Measures].[Cost_to_Ship]) /  
[Measures].[Volume_in_Cubic_Meters]  
```  
  
 <span data-ttu-id="158ae-121">Nachdem Sie das berechnete Element erstellt haben, wird Profit_per_Cubic_Meter zusammen mit den anderen Measures angezeigt, wenn Sie den Shipments-Cube das nächste Mal durchsuchen.</span><span class="sxs-lookup"><span data-stu-id="158ae-121">After you create the calculated member, the Profit_per_Cubic_Meter appears together with the other measures the next time that the Shipments cube is browsed.</span></span>  
  
 <span data-ttu-id="158ae-122">Um berechnete Elemente zu erstellen, verwenden Sie die Registerkarte **Berechnung**s im Cube-Designer.</span><span class="sxs-lookup"><span data-stu-id="158ae-122">To create calculated members, use the **Calculation**s tab in Cube Designer.</span></span> <span data-ttu-id="158ae-123">Weitere Informationen finden Sie unter [Erstellen berechneter](../multidimensional-models/create-calculated-members.md) Elemente.</span><span class="sxs-lookup"><span data-stu-id="158ae-123">For more information, see [Create Calculated Members](../multidimensional-models/create-calculated-members.md)</span></span>  
  
## <a name="named-sets"></a><span data-ttu-id="158ae-124">Benannte Mengen</span><span class="sxs-lookup"><span data-stu-id="158ae-124">Named Sets</span></span>  
 <span data-ttu-id="158ae-125">Eine benannte Menge ist ein CREATE SET MDX-Anweisungsausdruck, der eine Menge zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="158ae-125">A named set is a CREATE SET MDX statement expression that returns a set.</span></span> <span data-ttu-id="158ae-126">Der MDX-Ausdruck wird als Teil der Definition eines Cubes in gespeichert [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="158ae-126">The MDX expression is saved as part of the definition of a cube in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="158ae-127">Eine benannte Menge wird zum Wiederverwenden in MDX-Abfragen (Multidimensional Expressions) erstellt.</span><span class="sxs-lookup"><span data-stu-id="158ae-127">A named set is created for reuse in Multidimensional Expressions (MDX) queries.</span></span> <span data-ttu-id="158ae-128">Mithilfe einer benannten Menge können Anwender des Produkts im geschäftlichen Bereich Abfragen vereinfachen und für komplexe, häufig verwendete Mengenausdrücke einen Mengennamen anstelle eines Mengenausdrucks verwenden.</span><span class="sxs-lookup"><span data-stu-id="158ae-128">A named set enables business users to simplify queries, and use a set name instead of a set expression for complex, frequently used set expressions.</span></span> <span data-ttu-id="158ae-129">**Verwandte Themen:** [Erstellen von benannten Mengen](../multidimensional-models/create-named-sets.md)</span><span class="sxs-lookup"><span data-stu-id="158ae-129">**Related topic:** [Create Named Sets](../multidimensional-models/create-named-sets.md)</span></span>  
  
## <a name="script-commands"></a><span data-ttu-id="158ae-130">Skriptbefehle</span><span class="sxs-lookup"><span data-stu-id="158ae-130">Script Commands</span></span>  
 <span data-ttu-id="158ae-131">Ein Skriptbefehl ist ein MDX-Skript, das in der Cubedefinition enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="158ae-131">A script command is an MDX script, included as part of the definition of the cube.</span></span> <span data-ttu-id="158ae-132">Mithilfe von Skriptbefehlen können Sie nahezu jede Aktion ausführen, die von MDX auf einem Cube unterstützt wird, wie etwa eine Berechnung mit einem definierten Bereich, die nur auf einen Teil des Cubes angewendet wird.</span><span class="sxs-lookup"><span data-stu-id="158ae-132">Script commands let you perform almost any action that is supported by MDX on a cube, such as scoping a calculation to apply to only part of the cube.</span></span> <span data-ttu-id="158ae-133">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] können MDX-Skripts entweder auf den gesamten Cube oder auf bestimmte Abschnitte des Cubes angewendet werden, an bestimmten Punkten während der Ausführung des Skripts.</span><span class="sxs-lookup"><span data-stu-id="158ae-133">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], MDX scripts can apply either to the whole cube or to specific sections of the cube, at specific points throughout the execution of the script.</span></span> <span data-ttu-id="158ae-134">Der Standardskriptbefehl, die CALCULATE-Anweisung, füllt Zellen im Cube mit aggregierten Daten auf, die auf dem Standardbereich basieren.</span><span class="sxs-lookup"><span data-stu-id="158ae-134">The default script command, which is the CALCULATE statement, populates cells in the cube with aggregated data based on the default scope.</span></span>  
  
 <span data-ttu-id="158ae-135">Der Standardbereich ist der gesamte Cube, aber Sie können auch einen begrenzteren Bereich angeben, einen so genannten Teilcube, und ein MDX-Skript dann nur auf diesen bestimmten Cubebereich anwenden.</span><span class="sxs-lookup"><span data-stu-id="158ae-135">The default scope is the whole cube, but you can define a more limited scope, known as a subcube, and then apply an MDX script to only that particular cube space.</span></span> <span data-ttu-id="158ae-136">Die SCOPE-Anweisung definiert den Bereich aller nachfolgenden MDX-Ausdrücke und -Anweisungen im Berechnungsskript, bis der Bereich beendet oder erneut definiert wird.</span><span class="sxs-lookup"><span data-stu-id="158ae-136">The SCOPE statement defines the scope of all subsequent MDX expressions and statements in the calculation script until the scope is terminated or redefined.</span></span> <span data-ttu-id="158ae-137">Dann wird die THIS-Anweisung verwendet, um einen MDX-Ausdruck auf den aktuellen Bereich anzuwenden.</span><span class="sxs-lookup"><span data-stu-id="158ae-137">The THIS statement is then used to apply an MDX expression to the current scope.</span></span> <span data-ttu-id="158ae-138">Sie können die BACK_COLOR-Anweisung verwenden, um eine Hintergrundzellenfarbe für die Zellen im aktuellen Bereich festzulegen. Dies ist beim Debuggen sehr hilfreich.</span><span class="sxs-lookup"><span data-stu-id="158ae-138">You can use the BACK_COLOR statement to specify a background cell color for the cells in the current scope, to help you during debugging.</span></span>  
  
 <span data-ttu-id="158ae-139">Sie können einen Skriptbefehl z. B. verwenden, um Mitarbeitern für einen gewissen Zeitraum Sollvorgaben und ein Vertriebsgebiet auf der Grundlage der gewichteten Verkaufszahlen für einen früheren Zeitraum zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="158ae-139">For example, you can use a script command to allocate sales quotas to employees across time and sales territory based on the weighted values of sales for a prior time period.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="158ae-140">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="158ae-140">See Also</span></span>  
 [<span data-ttu-id="158ae-141">Berechnungen in mehrdimensionalen Modellen</span><span class="sxs-lookup"><span data-stu-id="158ae-141">Calculations in Multidimensional Models</span></span>](../multidimensional-models/calculations-in-multidimensional-models.md)  
  
  

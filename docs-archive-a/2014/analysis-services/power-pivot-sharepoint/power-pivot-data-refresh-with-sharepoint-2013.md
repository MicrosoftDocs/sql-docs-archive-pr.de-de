---
title: Power Pivot-Datenaktualisierung mit SharePoint 2013 | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 34f03407-2ec4-4554-b16b-bc9a6c161815
author: minewiskan
ms.author: owend
ms.openlocfilehash: c1d65a60c75d695e07edab763c6f879e502bf356
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87618331"
---
# <a name="powerpivot-data-refresh-with-sharepoint-2013"></a><span data-ttu-id="66341-102">PowerPivot-Datenaktualisierung mit SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="66341-102">PowerPivot Data Refresh with SharePoint 2013</span></span>
  <span data-ttu-id="66341-103">Der Entwurf für die Aktualisierung von [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] Datenmodellen in SharePoint 2013 nutzt Excel Services als primäre Komponente zum Laden und Aktualisieren von Datenmodellen auf einer Instanz von, die [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] im SharePoint-Modus ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="66341-103">The design for refresh of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data models in SharePoint 2013 utilizes Excel Services as the primary component to load and refresh data models on an instance of [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] running in SharePoint mode.</span></span> <span data-ttu-id="66341-104">Der [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] -Server wird außerhalb der SharePoint-Farm ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="66341-104">The [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server runs external to the SharePoint farm.</span></span>  
  
 <span data-ttu-id="66341-105">Bei der vorherigen Datenaktualisierungsarchitektur wurden Datenmodelle in einer im SharePoint-Modus ausgeführten [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] -Instanz ausschließlich mithilfe des PowerPivot-Systemdiensts geladen und aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="66341-105">The previous data refresh architecture relied exclusively on the PowerPivot System Service to load and refresh data models on a SharePoint mode [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance.</span></span> <span data-ttu-id="66341-106">Die [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] -Instanz wurde lokal auf dem PowerPivot-Anwendungsserver ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="66341-106">The [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance ran locally on the PowerPivot application server.</span></span> <span data-ttu-id="66341-107">In der neuen Architektur wird außerdem eine neue Methode eingeführt, um Zeitplaninformationen als Metadaten des Arbeitsmappenelements in der Dokumentbibliothek zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="66341-107">The new architecture also introduces a new method to maintain schedule information as meta data of the workbook item in the document library.</span></span> <span data-ttu-id="66341-108">Die Architektur in SharePoint 2013 Excel Services unterstützt sowohl die **interaktive Datenaktualisierung** als auch die **planmäßige Datenaktualisierung**.</span><span class="sxs-lookup"><span data-stu-id="66341-108">The architecture in SharePoint 2013 Excel Services supports both **interactive data refresh** and **scheduled data refresh**.</span></span>  
  
 <span data-ttu-id="66341-109">**[!INCLUDE[applies](../../includes/applies-md.md)]** SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="66341-109">**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2013</span></span>  
  
 <span data-ttu-id="66341-110">**In diesem Thema:**</span><span class="sxs-lookup"><span data-stu-id="66341-110">**In this topic:**</span></span>  
  
-   [<span data-ttu-id="66341-111">Interaktive Datenaktualisierung</span><span class="sxs-lookup"><span data-stu-id="66341-111">Interactive Data Refresh</span></span>](#bkmk_interactive_refresh)  
  
-   [<span data-ttu-id="66341-112">Windows-Authentifizierung mit arbeitsmappendatenverbindungen und interaktiver Datenaktualisierung</span><span class="sxs-lookup"><span data-stu-id="66341-112">Windows Authentication with Workbook Data Connections and Interactive Data Refresh</span></span>](#bkmk_windows_auth_interactive_data_refresh)  
  
-   [<span data-ttu-id="66341-113">Geplante Datenaktualisierung</span><span class="sxs-lookup"><span data-stu-id="66341-113">Scheduled Data Refresh</span></span>](#bkmk_scheduled_refresh)  
  
-   [<span data-ttu-id="66341-114">Architektur der geplante Datenaktualisierung in SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="66341-114">Scheduled Data Refresh Architecture in SharePoint 2013</span></span>](#bkmk_refresh_architecture)  
  
-   [<span data-ttu-id="66341-115">Zusätzliche Überlegungen zur Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="66341-115">Additional Authentication Considerations</span></span>](#datarefresh_additional_authentication)  
  
-   [<span data-ttu-id="66341-116">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="66341-116">More Information</span></span>](#bkmk_moreinformation)  
  
## <a name="background"></a><span data-ttu-id="66341-117">Hintergrund</span><span class="sxs-lookup"><span data-stu-id="66341-117">Background</span></span>  
 <span data-ttu-id="66341-118">SharePoint Server 2013 Excel Services verwaltet die Datenaktualisierung für Excel 2013-Arbeitsmappen und löst die Datenmodell Verarbeitung auf einem [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] Server aus, der im SharePoint-Modus ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="66341-118">SharePoint Server 2013 Excel Services manages data refresh for Excel 2013 workbooks and triggers the data model processing on a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server that is running in SharePoint mode.</span></span> <span data-ttu-id="66341-119">Für Excel 2010-Arbeitsmappen verwaltet Excel Services auch das Laden und Speichern von Arbeitsmappen und Datenmodellen.</span><span class="sxs-lookup"><span data-stu-id="66341-119">For Excel 2010 workbooks, Excel Services also manages the loading and saving of workbooks and data models.</span></span> <span data-ttu-id="66341-120">Allerdings verwendet Excel Services den PowerPivot-Systemdienst, um die Verarbeitungsbefehle an das Datenmodell zu senden.</span><span class="sxs-lookup"><span data-stu-id="66341-120">However, Excel Services relies on the PowerPivot System Service to send the processing commands to the data model.</span></span> <span data-ttu-id="66341-121">In der folgenden Tabelle werden die Komponenten zusammengefasst, die Verarbeitungsbefehle für die Datenaktualisierung senden, aufgeschlüsselt nach Version der Arbeitsmappe.</span><span class="sxs-lookup"><span data-stu-id="66341-121">The following table summarizes the components that send processing commands for data refresh depending on the version of the workbook.</span></span> <span data-ttu-id="66341-122">Als Umgebung wird eine SharePoint 2013-Farm angenommen, die für die Verwendung eines [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis-Servers im SharePoint-Modus konfiguriert ist.</span><span class="sxs-lookup"><span data-stu-id="66341-122">The assumed environment is a SharePoint 2013 farm configured to use a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server running in SharePoint mode.</span></span>  
  
||||  
|-|-|-|  
||<span data-ttu-id="66341-123">Excel 2013-Arbeitsmappen</span><span class="sxs-lookup"><span data-stu-id="66341-123">Excel 2013 Workbooks</span></span>|<span data-ttu-id="66341-124">Excel 2010-Arbeitsmappen</span><span class="sxs-lookup"><span data-stu-id="66341-124">Excel 2010 Workbooks</span></span>|  
|<span data-ttu-id="66341-125">Datenaktualisierung auslösen</span><span class="sxs-lookup"><span data-stu-id="66341-125">Trigger Data Refresh</span></span>|<span data-ttu-id="66341-126">**Interaktiv:** Authentifizierter Benutzer</span><span class="sxs-lookup"><span data-stu-id="66341-126">**Interactive:** Authenticated User</span></span><br /><br /> <span data-ttu-id="66341-127">**Geplant:** PowerPivot-Systemdienst</span><span class="sxs-lookup"><span data-stu-id="66341-127">**Scheduled:** PowerPivot System Service</span></span>|<span data-ttu-id="66341-128">PowerPivot-Systemdienst</span><span class="sxs-lookup"><span data-stu-id="66341-128">PowerPivot System Service</span></span>|  
|<span data-ttu-id="66341-129">Arbeitsmappe aus Inhaltsdatenbanken laden</span><span class="sxs-lookup"><span data-stu-id="66341-129">Load Workbook from Content Databases</span></span>|<span data-ttu-id="66341-130">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="66341-130">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="66341-131">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="66341-131">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="66341-132">Datenmodell in Analysis Services-Instanz laden</span><span class="sxs-lookup"><span data-stu-id="66341-132">Load Data model on Analysis Services instance</span></span>|<span data-ttu-id="66341-133">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="66341-133">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="66341-134">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="66341-134">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="66341-135">Verarbeitungsbefehle an Analysis Services-Instanz senden</span><span class="sxs-lookup"><span data-stu-id="66341-135">Send Processing Commands to Analysis Services instance</span></span>|<span data-ttu-id="66341-136">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="66341-136">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="66341-137">PowerPivot-Systemdienst</span><span class="sxs-lookup"><span data-stu-id="66341-137">PowerPivot System Service</span></span>|  
|<span data-ttu-id="66341-138">Arbeitsmappendaten aktualisieren</span><span class="sxs-lookup"><span data-stu-id="66341-138">Update Workbook Data</span></span>|<span data-ttu-id="66341-139">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="66341-139">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="66341-140">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="66341-140">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="66341-141">Arbeitsmappe und Datenmodell in Inhaltsdatenbank speichern</span><span class="sxs-lookup"><span data-stu-id="66341-141">Save Workbook and Data model to Content Database</span></span>|<span data-ttu-id="66341-142">**Interaktiv:** N/V</span><span class="sxs-lookup"><span data-stu-id="66341-142">**Interactive:** N/A</span></span><br /><br /> <span data-ttu-id="66341-143">**Geplant:** SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="66341-143">**Scheduled:** SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="66341-144">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="66341-144">SharePoint 2013 Excel Services</span></span>|  
  
 <span data-ttu-id="66341-145">In der folgenden Tabelle werden die unterstützten Aktualisierungsfunktionen in einer SharePoint 2013-Farm zusammengefasst, die für die Verwendung eines [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis-Servers im SharePoint-Modus konfiguriert ist:</span><span class="sxs-lookup"><span data-stu-id="66341-145">The following table summarizes the supported refresh features in a SharePoint 2013 farm configured to use a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server running in SharePoint mode:</span></span>  
  
|<span data-ttu-id="66341-146">Arbeitsmappe erstellt in</span><span class="sxs-lookup"><span data-stu-id="66341-146">Workbook created in</span></span>|<span data-ttu-id="66341-147">Geplante Datenaktualisierung</span><span class="sxs-lookup"><span data-stu-id="66341-147">Scheduled data refresh</span></span>|<span data-ttu-id="66341-148">Interaktive Datenaktualisierung</span><span class="sxs-lookup"><span data-stu-id="66341-148">Interactive refresh</span></span>|  
|-------------------------|----------------------------|-------------------------|  
|<span data-ttu-id="66341-149">2008 R2 PowerPivot für Excel</span><span class="sxs-lookup"><span data-stu-id="66341-149">2008 R2 PowerPivot for Excel</span></span>|<span data-ttu-id="66341-150">Wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="66341-150">Not supported.</span></span> <span data-ttu-id="66341-151">Aktualisieren der Arbeitsmappe **( \* )**</span><span class="sxs-lookup"><span data-stu-id="66341-151">Upgrade the workbook **(\*)**</span></span>|<span data-ttu-id="66341-152">Wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="66341-152">Not supported.</span></span> <span data-ttu-id="66341-153">Aktualisieren der Arbeitsmappe **( \* )**</span><span class="sxs-lookup"><span data-stu-id="66341-153">Upgrade the workbook **(\*)**</span></span>|  
|<span data-ttu-id="66341-154">2012 PowerPivot für Excel</span><span class="sxs-lookup"><span data-stu-id="66341-154">2012 PowerPivot for Excel</span></span>|<span data-ttu-id="66341-155">Unterstützt</span><span class="sxs-lookup"><span data-stu-id="66341-155">Supported</span></span>|<span data-ttu-id="66341-156">Wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="66341-156">Not supported.</span></span> <span data-ttu-id="66341-157">Aktualisieren der Arbeitsmappe **( \* )**</span><span class="sxs-lookup"><span data-stu-id="66341-157">Upgrade the workbook **(\*)**</span></span>|  
|<span data-ttu-id="66341-158">Excel 2013</span><span class="sxs-lookup"><span data-stu-id="66341-158">Excel 2013</span></span>|<span data-ttu-id="66341-159">Unterstützt</span><span class="sxs-lookup"><span data-stu-id="66341-159">Supported</span></span>|<span data-ttu-id="66341-160">Unterstützt</span><span class="sxs-lookup"><span data-stu-id="66341-160">Supported</span></span>|  
  
 <span data-ttu-id="66341-161">**( \* )** Weitere Informationen zu arbeitsmappenupgrades finden Sie unter Aktualisieren von Arbeitsmappen [und planmäßige Datenaktualisierung &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="66341-161">**(\*)** For more information on workbook upgrades, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
##  <a name="interactive-data-refresh"></a><a name="bkmk_interactive_refresh"></a> <span data-ttu-id="66341-162">Interactive Data Refresh</span><span class="sxs-lookup"><span data-stu-id="66341-162">Interactive Data Refresh</span></span>  
 <span data-ttu-id="66341-163">Bei der interaktiven oder manuellen Datenaktualisierung in SharePoint Server 2013 Excel Services können Datenmodelle mit Daten aus der ursprünglichen Datenquelle aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="66341-163">Interactive, or manual data refresh in SharePoint Server 2013 Excel Services can refresh data models with data from the original data source.</span></span> <span data-ttu-id="66341-164">Die interaktive Datenaktualisierung ist verfügbar, nachdem Sie eine Excel Services-Anwendung konfiguriert haben, indem Sie einen im SharePoint-Modus ausgeführten [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] -Server registrieren.</span><span class="sxs-lookup"><span data-stu-id="66341-164">Interactive data refresh is available after you configure an Excel Services application by registering an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server, running in SharePoint mode.</span></span> <span data-ttu-id="66341-165">Weitere Informationen finden Sie unter [Verwalten von Excel Services-Datenmodelleinstellungen (SharePoint Server 2013)](https://technet.microsoft.com/library/jj219780.aspx).</span><span class="sxs-lookup"><span data-stu-id="66341-165">For more information, see [Manage Excel Services data model settings (SharePoint Server 2013)](https://technet.microsoft.com/library/jj219780.aspx).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="66341-166">Die interaktive Datenaktualisierung ist nur für Arbeitsmappen verfügbar, die in Excel 2013 erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="66341-166">Interactive data refresh is only available for workbooks that created in Excel 2013.</span></span> <span data-ttu-id="66341-167">Wenn Sie versuchen, eine Excel 2010-Arbeitsmappe zu aktualisieren, zeigt Excel Services eine Fehlermeldung ähnlich der folgenden an: "Power Pivot-Vorgang fehlgeschlagen: die Arbeitsmappe wurde in einer älteren Version von Excel erstellt, und Power Pivot kann nicht aktualisiert werden, bis die Datei aktualisiert wurde".</span><span class="sxs-lookup"><span data-stu-id="66341-167">If you try to refresh an Excel 2010 workbook, Excel Services displays an error message similar to "PowerPivot Operation Failed: The Workbook was created in an older version of Excel and PowerPivot cannot be refreshed until the file is upgraded".</span></span> <span data-ttu-id="66341-168">Weitere Informationen zum Upgraden von Arbeitsmappen finden Sie unter [Upgraden von Arbeitsmappen und planmäßige Datenaktualisierungen &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="66341-168">For more information on upgrading workbooks, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
 <span data-ttu-id="66341-169">**Wichtige Punkte zur interaktiven Aktualisierung:**</span><span class="sxs-lookup"><span data-stu-id="66341-169">**Interactive refresh key point of interest:**</span></span>  
  
-   <span data-ttu-id="66341-170">Bei der interaktiven Datenaktualisierung werden nur die Daten in der aktuellen Benutzersitzung aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="66341-170">Interactive data refresh only refreshes the data in the current user session.</span></span> <span data-ttu-id="66341-171">Die Daten werden nicht automatisch wieder im Arbeitsmappenelement in der SharePoint-Inhaltsdatenbank gespeichert.</span><span class="sxs-lookup"><span data-stu-id="66341-171">The data is not automatically saved back to the workbook item in the SharePoint content database.</span></span>  
  
-   <span data-ttu-id="66341-172">**Anmeldeinformationen:** Die interaktive Datenaktualisierung kann die Identität des aktuell angemeldeten Benutzers als Anmeldeinformationen oder gespeicherte Anmeldeinformationen verwenden, um eine Verbindung mit der Datenquelle herzustellen.</span><span class="sxs-lookup"><span data-stu-id="66341-172">**Credentials:** Interactive data refresh can use the identity of the currently logged-on user as credentials or stored credentials to connect to the data source.</span></span> <span data-ttu-id="66341-173">Welche Anmeldeinformationen verwendet werden, hängt von den Excel Services-Authentifizierungseinstellungen ab, die für die Verbindung der Arbeitsmappe mit der externen Datenquelle definiert sind.</span><span class="sxs-lookup"><span data-stu-id="66341-173">The  credentials used depend on the Excel Services Authentication Settings defined for the workbook connection to the external data source.</span></span>  
  
-   <span data-ttu-id="66341-174">**Unterstützte Arbeitsmappen:**  In Excel 2013 erstellte Arbeitsmappen.</span><span class="sxs-lookup"><span data-stu-id="66341-174">**Supported Workbooks:**  Workbooks created in Excel 2013.</span></span>  
  
 <span data-ttu-id="66341-175">**So aktualisieren Sie Daten:**</span><span class="sxs-lookup"><span data-stu-id="66341-175">**To refresh data:**</span></span>  
  
-   <span data-ttu-id="66341-176">Beachten Sie die Abbildung nach den Schritten.</span><span class="sxs-lookup"><span data-stu-id="66341-176">See the illustration that follows the steps.</span></span>  
  
1.  <span data-ttu-id="66341-177">Öffnen Sie in einer SharePoint-Dokumentbibliothek eine PowerPivot-Arbeitsmappe im Browser.</span><span class="sxs-lookup"><span data-stu-id="66341-177">In a SharePoint document library, open a PowerPivot workbook in the browser.</span></span>  
  
2.  <span data-ttu-id="66341-178">Klicken Sie im Browserfenster auf das Menü **Daten** und dann auf **Ausgewählte Verbindung aktualisieren** oder **Alle Verbindungen aktualisieren**.</span><span class="sxs-lookup"><span data-stu-id="66341-178">In the browser window, click the **Data** menu and then click **Refresh Selected Connection** or **Refresh All Connections**.</span></span>  
  
3.  <span data-ttu-id="66341-179">Excel Services lädt die PowerPivot-Datenbank, verarbeitet sie und fragt sie anschließend ab, um den Excel-Arbeitsmappencache zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="66341-179">Excel Services loads the PowerPivot database, processes it and then queries it to refresh the Excel workbook cache.</span></span>  
  
4.  <span data-ttu-id="66341-180">**Hinweis:** Die aktualisierte Arbeitsmappe wird nicht automatisch wieder in der Dokumentbibliothek gespeichert.</span><span class="sxs-lookup"><span data-stu-id="66341-180">**Note:** The updated workbook is not automatically saved back to the document library.</span></span>  
  
 <span data-ttu-id="66341-181">![interaktive Datenaktualisierung](../media/as-interactive-datarefresh-sharepoint2013.gif "interaktive Datenaktualisierung")</span><span class="sxs-lookup"><span data-stu-id="66341-181">![interactive data refresh](../media/as-interactive-datarefresh-sharepoint2013.gif "interactive data refresh")</span></span>  
  
###  <a name="windows-authentication-with-workbook-data-connections-and-interactive-data-refresh"></a><a name="bkmk_windows_auth_interactive_data_refresh"></a> <span data-ttu-id="66341-182">Windows-Authentifizierung mit Arbeitsmappen-Datenverbindungen und interaktiver Datenaktualisierung</span><span class="sxs-lookup"><span data-stu-id="66341-182">Windows Authentication with Workbook Data Connections and Interactive Data Refresh</span></span>  
 <span data-ttu-id="66341-183">Excel Services sendet dem Analysis Services-Server einen Verarbeitungsbefehl, der den Server anweist, die Identität eines Benutzerkontos anzunehmen.</span><span class="sxs-lookup"><span data-stu-id="66341-183">Excel Services sends the Analysis Services server a process command that instructs the server to impersonate a user account.</span></span> <span data-ttu-id="66341-184">Um ausreichende Systemrechte zum Delegieren des Benutzeridentitätswechsels zu erhalten, benötigt das Analysis Services-Dienstkonto die Berechtigung **Einsetzen als Teil des Betriebssystems** auf dem lokalen Server.</span><span class="sxs-lookup"><span data-stu-id="66341-184">To obtain system rights sufficient to perform the user impersonation-delegation process, the Analysis Services service account, requires **Act as part of the operating system** privilege on the local server.</span></span> <span data-ttu-id="66341-185">Der Analysis Services-Server muss auch in der Lage sein, die Anmeldeinformationen des Benutzers für Datenquellen zu delegieren.</span><span class="sxs-lookup"><span data-stu-id="66341-185">The Analysis Services server also needs to be able to delegate the user's credentials to data sources.</span></span> <span data-ttu-id="66341-186">Das Abfrageergebnis wird an Excel Services gesendet.</span><span class="sxs-lookup"><span data-stu-id="66341-186">The query result is sent to Excel Services.</span></span>  
  
 <span data-ttu-id="66341-187">Typische Benutzerfreundlichkeit: Wenn ein Kunde "alle Verbindungen aktualisieren" in einer Excel 2013-Arbeitsmappe auswählt, die ein Power Pivot-Modell enthält, wird eine Fehlermeldung ähnlich der folgenden angezeigt:</span><span class="sxs-lookup"><span data-stu-id="66341-187">Typical user experience: When a customer selects "Refresh All Connections" in an Excel 2013 workbook that contains a PowerPivot model, they see an error message similar to the following:</span></span>  
  
-   <span data-ttu-id="66341-188">**Fehler bei der Aktualisierung der externen Daten:** Beim Arbeiten am Datenmodell in der Arbeitsmappe ist ein Fehler aufgetreten.</span><span class="sxs-lookup"><span data-stu-id="66341-188">**External Data Refresh Failed:** An error occurred while working on the Data Model in the workbook.</span></span> <span data-ttu-id="66341-189">Wiederholen Sie den Vorgang.</span><span class="sxs-lookup"><span data-stu-id="66341-189">Please try again.</span></span> <span data-ttu-id="66341-190">Eine oder mehrere Datenverbindungen in dieser Arbeitsmappe können nicht aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="66341-190">We are unable to refresh one or more data connections in this workbook.</span></span>  
  
 <span data-ttu-id="66341-191">Abhängig vom jeweiligen Datenanbieter werden im ULS-Protokoll Meldungen ähnlich den folgenden angezeigt.</span><span class="sxs-lookup"><span data-stu-id="66341-191">Depending on the data provider you are using, you see messages similar to the following in the ULS log.</span></span>  
  
 <span data-ttu-id="66341-192">**Bei SQL Native Client:**</span><span class="sxs-lookup"><span data-stu-id="66341-192">**With the SQL Native Client:**</span></span>  
  
-   <span data-ttu-id="66341-193">Fehler beim Erstellen einer externen Verbindung oder beim Ausführen einer Abfrage.</span><span class="sxs-lookup"><span data-stu-id="66341-193">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="66341-194">Anbietermeldung: Das Out-of-Line-Objekt 'DataSource', das auf die ID(s) '20102481-39c8-4d21-bf63-68f583ad22bb' verweist, wurde angegeben, jedoch nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="66341-194">Provider message: Out of line object 'DataSource', referring to ID(s) '20102481-39c8-4d21-bf63-68f583ad22bb', has been specified but has not been used.</span></span>  <span data-ttu-id="66341-195">OLE DB- oder ODBC-Fehler: Netzwerkbezogener oder instanzspezifischer Fehler beim Herstellen einer Verbindung mit SQL Server.</span><span class="sxs-lookup"><span data-stu-id="66341-195">OLE DB or ODBC error: A network-related or instance-specific error has occurred while establishing a connection to SQL Server.</span></span> <span data-ttu-id="66341-196">Der Server wurde nicht gefunden, oder auf ihn kann nicht zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="66341-196">Server is not found or not accessible.</span></span> <span data-ttu-id="66341-197">Überprüfen Sie, ob der Instanzname richtig ist und ob SQL Server Remoteverbindungen zulässt.</span><span class="sxs-lookup"><span data-stu-id="66341-197">Check if instance name is correct and if SQL Server is configured to allow remote connections.</span></span> <span data-ttu-id="66341-198">Weitere Informationen finden Sie in der SQL Server-Onlinedokumentation.; 08001; SSL-Anbieter: Das angeforderte Sicherheitspaket ist nicht vorhanden; 08001; Client kann keine Verbindung herstellen; 08001; Verschlüsselung wird auf dem Client nicht unterstützt.; 08001.</span><span class="sxs-lookup"><span data-stu-id="66341-198">For more information see SQL Server Books Online.; 08001; SSL Provider: The requested security package does not exist ; 08001; Client unable to establish connection; 08001; Encryption not supported on the client.; 08001.</span></span>  <span data-ttu-id="66341-199">, Verbindungsname: ThisWorkbookDataModel, Arbeitsmappe: Mappe1.xlsx.</span><span class="sxs-lookup"><span data-stu-id="66341-199">, ConnectionName: ThisWorkbookDataModel, Workbook: book1.xlsx.</span></span>  
  
 <span data-ttu-id="66341-200">**Bei Microsoft OLE DB-Anbieter für SQL Server:**</span><span class="sxs-lookup"><span data-stu-id="66341-200">**With the Microsoft OLE DB Provider for SQL Server:**</span></span>  
  
-   <span data-ttu-id="66341-201">Fehler beim Erstellen einer externen Verbindung oder beim Ausführen einer Abfrage.</span><span class="sxs-lookup"><span data-stu-id="66341-201">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="66341-202">Anbietermeldung: Das Out-of-Line-Objekt 'DataSource', das auf die ID(s) '6e711bfa-b62f-4879-a177-c5dd61d9c242' verweist, wurde angegeben, jedoch nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="66341-202">Provider message: Out of line object 'DataSource', referring to ID(s) '6e711bfa-b62f-4879-a177-c5dd61d9c242', has been specified but has not been used.</span></span> <span data-ttu-id="66341-203">OLE DB- oder ODBC-Fehler.</span><span class="sxs-lookup"><span data-stu-id="66341-203">OLE DB or ODBC error.</span></span> <span data-ttu-id="66341-204">, Verbindungsname: ThisWorkbookDataModel, Arbeitsmappe: OLEDB Provider.xlsx.</span><span class="sxs-lookup"><span data-stu-id="66341-204">, ConnectionName: ThisWorkbookDataModel, Workbook: OLEDB Provider.xlsx.</span></span>  
  
 <span data-ttu-id="66341-205">**Bei .NET Framework-Datenanbieter für SQL Server:**</span><span class="sxs-lookup"><span data-stu-id="66341-205">**With the .NET Framework Data Provider for SQL Server:**</span></span>  
  
-   <span data-ttu-id="66341-206">Fehler beim Erstellen einer externen Verbindung oder beim Ausführen einer Abfrage.</span><span class="sxs-lookup"><span data-stu-id="66341-206">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="66341-207">Anbietermeldung: Das Out-of-Line-Objekt 'DataSource', das auf die ID(s) 'f5fb916c-3eac-4d07-a542-531524c0d44a' verweist, wurde angegeben, jedoch nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="66341-207">Provider message: Out of line object 'DataSource', referring to ID(s) 'f5fb916c-3eac-4d07-a542-531524c0d44a', has been specified but has not been used.</span></span>  <span data-ttu-id="66341-208">Fehler in der relationalen Engine.</span><span class="sxs-lookup"><span data-stu-id="66341-208">Errors in the high-level relational engine.</span></span> <span data-ttu-id="66341-209">Ausnahme bei der Verwendung der verwalteten IDbConnection-Schnittstelle: Die Datei oder Assembly 'System.Transactions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' oder eine Abhängigkeit davon wurde nicht gefunden.</span><span class="sxs-lookup"><span data-stu-id="66341-209">The following exception occurred while the managed IDbConnection interface was being used: Could not load file or assembly 'System.Transactions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies.</span></span> <span data-ttu-id="66341-210">Entweder wurde eine geforderte Identitätswechselebene nicht geliefert, oder die gelieferte Identitätswechselebene ist unzulässig.</span><span class="sxs-lookup"><span data-stu-id="66341-210">Either a required impersonation level was not provided, or the provided impersonation level is invalid.</span></span> <span data-ttu-id="66341-211">(Ausnahme von HRESULT: 0x80070542).</span><span class="sxs-lookup"><span data-stu-id="66341-211">(Exception from HRESULT: 0x80070542).</span></span>  <span data-ttu-id="66341-212">, Verbindungsname: ThisWorkbookDataModel, Arbeitsmappe: NETProvider.xlsx.</span><span class="sxs-lookup"><span data-stu-id="66341-212">, ConnectionName: ThisWorkbookDataModel, Workbook: NETProvider.xlsx.</span></span>  
  
 <span data-ttu-id="66341-213">**Zusammenfassung der Konfigurationsschritte** zum Konfigurieren der Berechtigung **Einsetzen als Teil des Betriebssystems** auf dem lokalen Server:</span><span class="sxs-lookup"><span data-stu-id="66341-213">**Summary of Configuration Steps** To configure **Act as part of the operating system** privilege on the local server:</span></span>  
  
1.  <span data-ttu-id="66341-214">Fügen Sie auf dem Analysis Services Server, der im SharePoint-Modus ausgeführt wird, das Analysis Services Dienst Konto der Berechtigung "**als Teil des Betriebssystems agieren**" hinzu:</span><span class="sxs-lookup"><span data-stu-id="66341-214">On the Analysis Services Server running in SharePoint mode, Add the Analysis Services service account to the "**Act as part of the operating system**" privilege:</span></span>  
  
    1.  <span data-ttu-id="66341-215">Ausführen von " `secpol.msc` "</span><span class="sxs-lookup"><span data-stu-id="66341-215">Run "`secpol.msc`"</span></span>  
  
    2.  <span data-ttu-id="66341-216">Klicken Sie auf **Lokale Sicherheitsrichtlinie**, klicken Sie dann auf **Lokale Richtlinien**und anschließend auf **Zuweisen von Benutzerrechten**.</span><span class="sxs-lookup"><span data-stu-id="66341-216">Click **Local Security Policy**, then click **Local policies**, and then click **User rights assignment**.</span></span>  
  
    3.  <span data-ttu-id="66341-217">Fügen Sie das Dienstkonto hinzu.</span><span class="sxs-lookup"><span data-stu-id="66341-217">Add the service account.</span></span>  
  
2.  <span data-ttu-id="66341-218">Starten Sie Excel Services neu, und führen Sie einen Neustart des Analysis Services-Servers durch.</span><span class="sxs-lookup"><span data-stu-id="66341-218">Restart Excel Services and reboot the Analysis Services server.</span></span>  
  
3.  <span data-ttu-id="66341-219">Die Delegierung vom Excel Services-Dienstkonto oder vom Claims to Windows Token Service (C2WTS) zur Analyse Services-Instanz ist nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="66341-219">Delegation from the Excel Services service account or from Claims to Windows token service (C2WTS) to the Analysis services instance is not required.</span></span> <span data-ttu-id="66341-220">Daher ist keine Konfiguration für KCD von Excel Services oder C2WTS für PowerPivot AS-Dienst erforderlich.</span><span class="sxs-lookup"><span data-stu-id="66341-220">Therefore no configuration for KCD from Excel Services or C2WTS to PowerPivot AS service is necessary.</span></span> <span data-ttu-id="66341-221">Wenn sich die Backend-Datenquelle auf demselben Server wie die [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] -Instanz befindet, ist keine eingeschränkte Kerberos-Delegierung erforderlich.</span><span class="sxs-lookup"><span data-stu-id="66341-221">If the backend data source is on the same server as the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance, Kerberos Constrained Delegation is not required.</span></span> <span data-ttu-id="66341-222">Allerdings benötigt das [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] -Dienstkonto das Recht, als Teil des Betriebssystems zu agieren.</span><span class="sxs-lookup"><span data-stu-id="66341-222">However, the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] service account requires the right to Act As Part Of The Operating System.</span></span>  
  
 <span data-ttu-id="66341-223">![as_interactive_data_refresh2012SP1_windowsauth](../media/as-interactive-data-refresh2012sp1-windowsauth.gif "as_interactive_data_refresh2012SP1_windowsauth")</span><span class="sxs-lookup"><span data-stu-id="66341-223">![as_interactive_data_refresh2012SP1_windowsauth](../media/as-interactive-data-refresh2012sp1-windowsauth.gif "as_interactive_data_refresh2012SP1_windowsauth")</span></span>  
  
 <span data-ttu-id="66341-224">Weitere Informationen finden Sie unter [agieren als Teil des Betriebssystems](https://technet.microsoft.com/library/cc784323\(WS.10\).aspx).</span><span class="sxs-lookup"><span data-stu-id="66341-224">For more information, see [Act as part of the operating system](https://technet.microsoft.com/library/cc784323\(WS.10\).aspx).</span></span>  
  
##  <a name="scheduled-data-refresh"></a><a name="bkmk_scheduled_refresh"></a><span data-ttu-id="66341-225">Geplante Datenaktualisierung</span><span class="sxs-lookup"><span data-stu-id="66341-225">Scheduled Data Refresh</span></span>  
 <span data-ttu-id="66341-226">**Wichtige Punkte zur geplanten Datenaktualisierung:**</span><span class="sxs-lookup"><span data-stu-id="66341-226">**Scheduled data refresh key points of interest:**</span></span>  
  
-   <span data-ttu-id="66341-227">Erfordert die Bereitstellung des PowerPivot für SharePoint-Add-Ins.</span><span class="sxs-lookup"><span data-stu-id="66341-227">Requires the deployment of the PowerPivot for SharePoint add-in.</span></span> <span data-ttu-id="66341-228">Weitere Informationen finden Sie unter [installieren oder Deinstallieren des PowerPivot für SharePoint-Add-ins &#40;SharePoint 2013&#41;](../instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="66341-228">For more information, see [Install or Uninstall the PowerPivot for SharePoint Add-in &#40;SharePoint 2013&#41;](../instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013.md).</span></span>  
  
-   <span data-ttu-id="66341-229">Ein Benutzer konfiguriert einen Aktualisierungszeitplan für eine Arbeitsmappe.</span><span class="sxs-lookup"><span data-stu-id="66341-229">A user configures a refresh schedule for a workbook.</span></span> <span data-ttu-id="66341-230">Zum geplanten Zeitpunkt sendet der PowerPivot-Systemdienst eine Anforderung an Excel Services für folgende Aktionen:</span><span class="sxs-lookup"><span data-stu-id="66341-230">At the scheduled time, the PowerPivot System Service sends a request to Excel Services to:</span></span>  
  
    -   <span data-ttu-id="66341-231">Laden und Verarbeiten der PowerPivot-Datenbank</span><span class="sxs-lookup"><span data-stu-id="66341-231">Load and process the PowerPivot database.</span></span>  
  
    -   <span data-ttu-id="66341-232">Aktualisieren der Arbeitsmappe</span><span class="sxs-lookup"><span data-stu-id="66341-232">Refresh the workbook.</span></span>  
  
    -   <span data-ttu-id="66341-233">Erneutes Speichern der Arbeitsmappe in der Inhaltsdatenbank</span><span class="sxs-lookup"><span data-stu-id="66341-233">Save the workbook back to the content database.</span></span>  
  
-   <span data-ttu-id="66341-234">**Anmeldeinformationen:** Verwendet gespeicherte Anmeldeinformationen.</span><span class="sxs-lookup"><span data-stu-id="66341-234">**Credentials:** Uses stored credentials.</span></span> <span data-ttu-id="66341-235">Verwendet nicht die Identität des aktuellen Benutzers.</span><span class="sxs-lookup"><span data-stu-id="66341-235">Does not use the identity of the current user.</span></span>  
  
-   <span data-ttu-id="66341-236">**Unterstützte Arbeitsmappen:** Mit dem [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot-Add-In für Excel 2010 oder mit Excel 2013 erstellte Arbeitsmappen.</span><span class="sxs-lookup"><span data-stu-id="66341-236">**Supported Workbooks:** Workbooks created using the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot add-in for Excel 2010 or using Excel 2013.</span></span> <span data-ttu-id="66341-237">In Excel 2010 mit dem [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] PowerPivot-Add-In erstellte Arbeitsmappen werden nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="66341-237">Workbooks created in Excel 2010 with the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] PowerPivot add-in are not supported.</span></span> <span data-ttu-id="66341-238">Aktualisieren Sie die Arbeitsmappe mindestens auf das [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot-Format.</span><span class="sxs-lookup"><span data-stu-id="66341-238">Upgrade the workbook to at least the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot format.</span></span> <span data-ttu-id="66341-239">Weitere Informationen zum Upgraden von Arbeitsmappen finden Sie unter [Upgraden von Arbeitsmappen und planmäßige Datenaktualisierungen &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="66341-239">For more information on workbook upgrades, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
 <span data-ttu-id="66341-240">So zeigen Sie die Seite **Datenaktualisierung verwalten** an:</span><span class="sxs-lookup"><span data-stu-id="66341-240">To display the **Manage Data Refresh** page:</span></span>  
  
-   <span data-ttu-id="66341-241">Beachten Sie die Abbildung nach den Schritten.</span><span class="sxs-lookup"><span data-stu-id="66341-241">See the illustration that follows the steps.</span></span>  
  
1.  <span data-ttu-id="66341-242">Klicken Sie in einer SharePoint-Dokumentbibliothek auf das Menü **Öffnen** (**...**) für eine PowerPivot-Arbeitsmappe.</span><span class="sxs-lookup"><span data-stu-id="66341-242">In a SharePoint document library, click the **Open menu** (**...**) for a PowerPivot workbook.</span></span>  
  
2.  <span data-ttu-id="66341-243">Klicken Sie auf das zweite Menü **Öffnen** , und klicken Sie dann auf **PowerPivot-Datenaktualisierung verwalten**.</span><span class="sxs-lookup"><span data-stu-id="66341-243">Click the second **Open menu** and then click **Manage PowerPivot Data Refresh**.</span></span>  
  
3.  <span data-ttu-id="66341-244">Klicken Sie auf der Seite **Datenaktualisierung verwalten** auf **Aktivieren** , und konfigurieren Sie dann den Aktualisierungszeitplan.</span><span class="sxs-lookup"><span data-stu-id="66341-244">On the **Manage Data Refresh** page, click **Enable** and then configure the refresh schedule.</span></span>  
  
4.  <span data-ttu-id="66341-245">Zum angegebenen Zeitpunkt sendet der PowerPivot-Systemdienst eine Anforderung an Excel Services für folgende Aktionen:</span><span class="sxs-lookup"><span data-stu-id="66341-245">At the specified time, the PowerPivot System Service sends a request to Excel Services to:</span></span>  
  
    -   <span data-ttu-id="66341-246">Laden und Verarbeiten des PowerPivot-Datenmodells</span><span class="sxs-lookup"><span data-stu-id="66341-246">Load and process the PowerPivot data model.</span></span>  
  
    -   <span data-ttu-id="66341-247">Aktualisieren der Arbeitsmappe</span><span class="sxs-lookup"><span data-stu-id="66341-247">Refresh the workbook.</span></span>  
  
    -   <span data-ttu-id="66341-248">Erneutes Speichern der Arbeitsmappe in der Inhaltsdatenbank</span><span class="sxs-lookup"><span data-stu-id="66341-248">Save the workbook back to the content database.</span></span>  
  
 <span data-ttu-id="66341-249">![Datenaktualisierung verwalten (Kontextmenü)](../media/as-manage-datarefresh-sharepoint2013.gif "Datenaktualisierung verwalten (Kontextmenü)")</span><span class="sxs-lookup"><span data-stu-id="66341-249">![manage data refresh context menu](../media/as-manage-datarefresh-sharepoint2013.gif "manage data refresh context menu")</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="66341-250">Weitere Informationen zum Aktualisieren von Arbeitsmappen aus SharePoint Online finden Sie unter Aktualisieren [von Excel-Arbeitsmappen mit eingebetteten Power Pivot-Modellen aus SharePoint Online (Whitepaper)](https://technet.microsoft.com/library/jj992650.aspx) ( https://technet.microsoft.com/library/jj992650.aspx) .</span><span class="sxs-lookup"><span data-stu-id="66341-250">For information on refreshing workbooks from SharePoint online, see [Refreshing Excel workbooks with embedded PowerPivot models from SharePoint Online (white paper)](https://technet.microsoft.com/library/jj992650.aspx) (https://technet.microsoft.com/library/jj992650.aspx).</span></span>  
  
##  <a name="scheduled-data-refresh-architecture-in-sharepoint-2013"></a><a name="bkmk_refresh_architecture"></a><span data-ttu-id="66341-251">Geplante Daten Aktualisierungs Architektur in SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="66341-251">Scheduled Data Refresh Architecture in SharePoint 2013</span></span>  
 <span data-ttu-id="66341-252">In der folgenden Abbildung wird die Datenaktualisierungsarchitektur in SharePoint 2013 und SQL Server 2012 SP1 zusammengefasst dargestellt.</span><span class="sxs-lookup"><span data-stu-id="66341-252">The following illustration summarizes the data refresh architecture in SharePoint 2013 and SQL Server 2012 SP1.</span></span>  
  
 <span data-ttu-id="66341-253">![Architektur von SQL Server 2012 SP1 Datenaktualisierung](../media/as-scheduled-data-refresh2012sp1-architecture.gif "Architektur von SQL Server 2012 SP1 Datenaktualisierung")</span><span class="sxs-lookup"><span data-stu-id="66341-253">![architecture of SQL Server 2012 SP1 data refresh](../media/as-scheduled-data-refresh2012sp1-architecture.gif "architecture of SQL Server 2012 SP1 data refresh")</span></span>  
  
||<span data-ttu-id="66341-254">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="66341-254">Description</span></span>||  
|-|-----------------|-|  
|<span data-ttu-id="66341-255">**(1)**</span><span class="sxs-lookup"><span data-stu-id="66341-255">**(1)**</span></span>|<span data-ttu-id="66341-256">Analysis Services-Engine</span><span class="sxs-lookup"><span data-stu-id="66341-256">Analysis Services Engine</span></span>|<span data-ttu-id="66341-257">Ein [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] -Server, der im SharePoint-Modus ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="66341-257">An [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server that is running in SharePoint mode.</span></span> <span data-ttu-id="66341-258">Der Server wird außerhalb der SharePoint-Farm ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="66341-258">The server runs outside of the SharePoint farm.</span></span>|  
|<span data-ttu-id="66341-259">**2,2**</span><span class="sxs-lookup"><span data-stu-id="66341-259">**(2)**</span></span>|<span data-ttu-id="66341-260">Benutzeroberfläche</span><span class="sxs-lookup"><span data-stu-id="66341-260">User Interface</span></span>|<span data-ttu-id="66341-261">Die Benutzeroberfläche besteht aus zwei Seiten.</span><span class="sxs-lookup"><span data-stu-id="66341-261">The user interface is comprised of two pages.</span></span> <span data-ttu-id="66341-262">Auf einer Seite wird der Zeitplan definiert, auf der zweiten Seite wird der Aktualisierungsverlauf angezeigt.</span><span class="sxs-lookup"><span data-stu-id="66341-262">One to define the schedule and the second to view the refresh history.</span></span> <span data-ttu-id="66341-263">Die Seiten greifen nicht direkt auf die PowerPivot-Dienstanwendungsdatenbanken zu, sondern über den PowerPivot-Systemdienst.</span><span class="sxs-lookup"><span data-stu-id="66341-263">The pages do not directly access the PowerPivot Service application databases but use the PowerPivot system service to access the databases.</span></span>|  
|<span data-ttu-id="66341-264">**€**</span><span class="sxs-lookup"><span data-stu-id="66341-264">**(3)**</span></span>|<span data-ttu-id="66341-265">PowerPivot-Systemdienst</span><span class="sxs-lookup"><span data-stu-id="66341-265">PowerPivot System Service</span></span>|<span data-ttu-id="66341-266">Der Dienst wird installiert, wenn Sie das PowerPivot für SharePoint-Add-In bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="66341-266">The service is installed when you deploy the PowerPivot for SharePoint add-in.</span></span> <span data-ttu-id="66341-267">Der Dienst wird für Folgendes verwendet:</span><span class="sxs-lookup"><span data-stu-id="66341-267">The service is used for the following:</span></span><br /><br /> <span data-ttu-id="66341-268">Dieser Dienst hostet die Aktualisierungsplanungs-Engine, die Excel Services-APIs für die Datenaktualisierung von Excel 2013-Arbeitsmappen aufruft.</span><span class="sxs-lookup"><span data-stu-id="66341-268">This service hosts the refresh scheduling engine, which calls Excel Services APIs for data refresh of Excel 2013 workbooks.</span></span> <span data-ttu-id="66341-269">Für Excel 2010-Arbeitsmappen führt der Dienst die Datenmodellverarbeitung direkt aus, verwendet für das Laden des Datenmodells und das Aktualisieren der Arbeitsmappe jedoch weiterhin Excel Services.</span><span class="sxs-lookup"><span data-stu-id="66341-269">For Excel 2010 workbooks, the service directly performs the data model processing but continues to reply on Excel Services for loading the data model and updating the workbook.</span></span><br /><br /> <span data-ttu-id="66341-270">Dieser Dienst stellt Methoden für Komponenten bereit, wie z. B. die Benutzeroberflächenseiten, um mit dem Systemdienst zu kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="66341-270">This service provides methods for components such as the user interface pages, to communicate with the system service.</span></span><br /><br /> <span data-ttu-id="66341-271">Der Dienst verwaltet Anforderungen für den externen Zugriff auf Arbeitsmappen als Datenquelle, die vom PowerPivot-Webdienst empfangen werden.</span><span class="sxs-lookup"><span data-stu-id="66341-271">Manages requests for external access to workbooks as a data source, received through the PowerPivot Web Service.</span></span><br /><br /> <span data-ttu-id="66341-272">Verwaltung geplanter Datenaktualisierungsanforderungen für Zeitgeberaufträge und Konfigurationsseiten.</span><span class="sxs-lookup"><span data-stu-id="66341-272">Scheduled data refresh request management for timer jobs and configuration pages.</span></span> <span data-ttu-id="66341-273">Der Dienst verwaltet Anforderungen zum Lesen von Daten in die und aus der Datenbank und zum Auslösen der Datenaktualisierung mit Excel Services.</span><span class="sxs-lookup"><span data-stu-id="66341-273">The service manages requests to read data in and out of the service application database and trigger data refresh with Excel Services.</span></span><br /><br /> <span data-ttu-id="66341-274">Verwendungsanalyse und verwandter Zeitgeberauftrag.</span><span class="sxs-lookup"><span data-stu-id="66341-274">Usage processing and related timer job.</span></span>|  
|<span data-ttu-id="66341-275">**0:**</span><span class="sxs-lookup"><span data-stu-id="66341-275">**(4)**</span></span>|<span data-ttu-id="66341-276">Dienste für Excel-Berechnungen</span><span class="sxs-lookup"><span data-stu-id="66341-276">Excel Calculation Services</span></span>|<span data-ttu-id="66341-277">Zuständig für das Laden der Datenmodelle.</span><span class="sxs-lookup"><span data-stu-id="66341-277">Responsible for loading the data models.</span></span>|  
|<span data-ttu-id="66341-278">**5**</span><span class="sxs-lookup"><span data-stu-id="66341-278">**(5)**</span></span>|<span data-ttu-id="66341-279">Secure Store Service</span><span class="sxs-lookup"><span data-stu-id="66341-279">Secure Store Service</span></span>|<span data-ttu-id="66341-280">Wenn die Authentifizierungs Einstellungen in der Arbeitsmappe für **die Verwendung des Kontos des authentifizierten Benutzers** oder " **keine**" konfiguriert sind, werden die in der Secure Store-Zielanwendungs-ID gespeicherten Anmelde Informationen für die Datenaktualisierung verwendet.</span><span class="sxs-lookup"><span data-stu-id="66341-280">If the authentication settings in the workbook are configured to **Use the authenticated user's account** or **None**, the credentials stored in the Secure Store target application ID are used for data refresh.</span></span> <span data-ttu-id="66341-281">Weitere Informationen finden Sie im Abschnitt [Zusätzliche Überlegungen zur Authentifizierung](#datarefresh_additional_authentication) in diesem Thema.</span><span class="sxs-lookup"><span data-stu-id="66341-281">For more information, see the [Additional Authentication Considerations](#datarefresh_additional_authentication) section in this topic.</span></span>|  
|<span data-ttu-id="66341-282">**6**</span><span class="sxs-lookup"><span data-stu-id="66341-282">**(6)**</span></span>|<span data-ttu-id="66341-283">Zeitgeberauftrag für PowerPivot-Datenaktualisierung</span><span class="sxs-lookup"><span data-stu-id="66341-283">PowerPivot data refresh timer Job</span></span>|<span data-ttu-id="66341-284">Weist den PowerPivot-Systemdienst an, eine Verbindung mit Excel Services herzustellen, um Datenmodelle zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="66341-284">Instructs the PowerPivot system service to connect with Excel Services for refreshing data models.</span></span>|  
  
 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="66341-285">benötigt entsprechende Datenanbieter und Clientbibliotheken, damit der [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] -Server im SharePoint-Modus auf Datenquellen zugreifen kann.</span><span class="sxs-lookup"><span data-stu-id="66341-285">requires appropriate data providers and client libraries so that the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server in SharePoint mode can access data sources.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="66341-286">Da der PowerPivot-Systemdienst keine PowerPivot-Modelle mehr lädt oder speichert, gelten die meisten Einstellungen zum Zwischenspeichern von Modellen auf einem Anwendungsserver nicht für eine SharePoint 2013-Farm.</span><span class="sxs-lookup"><span data-stu-id="66341-286">Because the PowerPivot system service no longer loads or saves PowerPivot models, most of the settings for caching models on an application server do not apply to a SharePoint 2013 farm.</span></span>  
  
## <a name="data-refresh-log-data"></a><span data-ttu-id="66341-287">Protokolldaten der Datenaktualisierung</span><span class="sxs-lookup"><span data-stu-id="66341-287">Data refresh log data</span></span>  
 <span data-ttu-id="66341-288">**Verwendungsdaten:** Sie können Verwendungsdaten zur Datenaktualisierung im PowerPivot-Management-Dashboard anzeigen.</span><span class="sxs-lookup"><span data-stu-id="66341-288">**Usage Data:** You can view data refresh usage data in the PowerPivot Management Dashboard.</span></span> <span data-ttu-id="66341-289">So zeigen Sie die Verwendungsdaten an:</span><span class="sxs-lookup"><span data-stu-id="66341-289">To see the usage data:</span></span>  
  
1.  <span data-ttu-id="66341-290">Klicken Sie in der SharePoint-Zentraladministration in der Gruppe **Allgemeine Anwendungseinstellungen** auf **PowerPivot-Management-Dashboard** .</span><span class="sxs-lookup"><span data-stu-id="66341-290">In SharePoint Central Administration, click **PowerPivot Management Dashboard** in the **General application settings** group.</span></span>  
  
2.  <span data-ttu-id="66341-291">Sehen Sie sich am unteren Rand des Dashboards die **Datenaktualisierung-Letzte Aktivität** und **Datenaktualisierung-letzte Fehler**an.</span><span class="sxs-lookup"><span data-stu-id="66341-291">At the bottom of the dashboard, see the **Data Refresh - Recent Activity** and **Data Refresh - Recent Failures**.</span></span>  
  
3.  <span data-ttu-id="66341-292">Weitere Informationen zu Verwendungsdaten und wie Sie diese aktivieren finden Sie unter [PowerPivot Management Dashboard and Usage Data](power-pivot-management-dashboard-and-usage-data.md).</span><span class="sxs-lookup"><span data-stu-id="66341-292">For more information on usage data and how to enable it, see [PowerPivot Management Dashboard and Usage Data](power-pivot-management-dashboard-and-usage-data.md).</span></span>  
  
 <span data-ttu-id="66341-293">**Diagnoseprotokolldaten:** Sie können SharePoint-Diagnoseprotokolldaten zur Datenaktualisierung anzeigen.</span><span class="sxs-lookup"><span data-stu-id="66341-293">**Diagnostic log data:** You can view SharePoint diagnostic log data related to data refresh.</span></span> <span data-ttu-id="66341-294">Überprüfen Sie die Konfiguration der Diagnoseprotokollierung für den **PowerPivot-Dienst** auf der Seite **Überwachung** der SharePoint-Zentraladministration.</span><span class="sxs-lookup"><span data-stu-id="66341-294">First, verify the configuration of diagnostic logging for the **PowerPivot Service** in SharePoint Central Administration **Monitoring** page.</span></span> <span data-ttu-id="66341-295">Möglicherweise müssen Sie die Protokollierungs Stufe für das "unwichtigste Ereignis" erhöhen, das protokolliert werden soll.</span><span class="sxs-lookup"><span data-stu-id="66341-295">You may need to increase the level of logging for the "least critical event" to log.</span></span> <span data-ttu-id="66341-296">Legen Sie beispielsweise vorübergehend den Wert auf **Ausführlich** fest, und führen Sie dann die Datenaktualisierungsvorgänge erneut aus.</span><span class="sxs-lookup"><span data-stu-id="66341-296">For example, temporarily set the value to **Verbose** and then rerun data refresh operations.</span></span>  
  
 <span data-ttu-id="66341-297">Die Protokolleinträge enthalten Folgendes:</span><span class="sxs-lookup"><span data-stu-id="66341-297">The log entries contain:</span></span>  
  
-   <span data-ttu-id="66341-298">Den **Bereich** des **PowerPivot-Diensts**.</span><span class="sxs-lookup"><span data-stu-id="66341-298">The **Area** of **PowerPivot Service**.</span></span>  
  
-   <span data-ttu-id="66341-299">Die Kategorie der **Datenaktualisierung**.</span><span class="sxs-lookup"><span data-stu-id="66341-299">The category of **Data Refresh**.</span></span>  
  
 <span data-ttu-id="66341-300">Überprüfen Sie die **Konfiguration der Diagnoseprotokollierung**.</span><span class="sxs-lookup"><span data-stu-id="66341-300">Review the **configure diagnostic logging**.</span></span> <span data-ttu-id="66341-301">Weitere Informationen finden Sie unter [Konfigurieren und Anzeigen von SharePoint-Protokolldateien und Diagnoseprotokollierung &#40;PowerPivot für SharePoint&#41;](configure-and-view-sharepoint-and-diagnostic-logging.md).</span><span class="sxs-lookup"><span data-stu-id="66341-301">For more information, see [Configure and View SharePoint Log Files  and Diagnostic Logging &#40;PowerPivot for SharePoint&#41;](configure-and-view-sharepoint-and-diagnostic-logging.md).</span></span>  
  
##  <a name="additional-authentication-considerations"></a><a name="datarefresh_additional_authentication"></a><span data-ttu-id="66341-302">Weitere Überlegungen zur Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="66341-302">Additional Authentication Considerations</span></span>  
 <span data-ttu-id="66341-303">Die Einstellungen im Dialogfeld **Excel Services-Authentifizierungseinstellungen** in Excel 2013 bestimmen die Windows-Identität, die Excel Services und [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] für die Datenaktualisierung verwenden.</span><span class="sxs-lookup"><span data-stu-id="66341-303">The settings in the **Excel Services Authentication Settings** dialog in Excel 2013, determine the Windows identity that Excel Services and [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] use for data refresh.</span></span>  
  
-   <span data-ttu-id="66341-304">**Das Konto des authentifizierten Benutzers verwenden**: Excel Services führt die Datenaktualisierung unter der Identität des aktuell angemeldeten Benutzers aus.</span><span class="sxs-lookup"><span data-stu-id="66341-304">**Use the authenticated user's account**: Excel Services performs data refresh under the identity of the currently logged-in user.</span></span>  
  
-   <span data-ttu-id="66341-305">**Ein gespeichertes Konto verwenden**: Geht von einer SharePoint Secure Store Service-Anwendungs-ID aus, die Excel Services verwendet, um den Benutzernamen und das Kennwort abzurufen, um die Datenaktualisierung zu authentifizieren.</span><span class="sxs-lookup"><span data-stu-id="66341-305">**Use a stored account**: Assumes a SharePoint Secure Store Service application ID, which Excel Services uses to retrieve the user name and password to authenticate data refresh authentication.</span></span>  
  
-   <span data-ttu-id="66341-306">**Keine**: Das **unbeaufsichtigte Dienstkonto** von Excel Services wird verwendet.</span><span class="sxs-lookup"><span data-stu-id="66341-306">**None**: The Excel Services **Unattended Service Account** is used.</span></span> <span data-ttu-id="66341-307">Das Dienstkonto ist einem Secure Store Service-Proxy zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="66341-307">The service account is associated with a Secure Store Proxy.</span></span> <span data-ttu-id="66341-308">Konfigurieren Sie die Einstellungen auf der Seite **Excel Services-Anwendungseinstellungen** im Abschnitt **Externe Daten** .</span><span class="sxs-lookup"><span data-stu-id="66341-308">Configure the settings on the **Excel Services Application Settings** page, in the **External Data** section.</span></span>  
  
 <span data-ttu-id="66341-309">So öffnen Sie das Dialogfeld mit Authentifizierungseinstellungen:</span><span class="sxs-lookup"><span data-stu-id="66341-309">To open the authentication settings dialog:</span></span>  
  
1.  <span data-ttu-id="66341-310">Klicken Sie in Excel 2013 auf die Registerkarte **Daten** .</span><span class="sxs-lookup"><span data-stu-id="66341-310">Click the **Data** tab in Excel 2013.</span></span>  
  
2.  <span data-ttu-id="66341-311">Klicken Sie im Menüband auf **Verbindungen** .</span><span class="sxs-lookup"><span data-stu-id="66341-311">Click **Connections** in the ribbon.</span></span>  
  
3.  <span data-ttu-id="66341-312">Wählen Sie im Dialogfeld **Arbeitsmappenverbindungen**die Verbindung aus, und klicken Sie auf **Eigenschaften**.</span><span class="sxs-lookup"><span data-stu-id="66341-312">In the **Workbook connections dialog**, select the connection and click **Properties**.</span></span>  
  
4.  <span data-ttu-id="66341-313">Klicken Sie im Dialogfeld **Verbindungs Eigenschaften** auf **Definition**, und klicken Sie dann auf die Schaltfläche **Authentifizierungs Einstellungen...** .</span><span class="sxs-lookup"><span data-stu-id="66341-313">In the **Connection properties** dialog, click **Definition**, and then click the **Authentication Settings...** button.</span></span>  
  
 <span data-ttu-id="66341-314">![Excel Services-Authentifizierungseinstellungen](../media/as-authentication-settings-4-ecs-in-excel2013.gif "Excel Services-Authentifizierungseinstellungen")</span><span class="sxs-lookup"><span data-stu-id="66341-314">![excel services authentication settings](../media/as-authentication-settings-4-ecs-in-excel2013.gif "excel services authentication settings")</span></span>  
  
 <span data-ttu-id="66341-315">Weitere Informationen zur Authentifizierung der Datenaktualisierung und zur Verwendung von Anmeldeinformationen finden Sie im Blogbeitrag [Refreshing PowerPivot Data in SharePoint 2013](https://blogs.msdn.com/b/analysisservices/archive/2012/12/21/refreshing-powerpivot-data-in-sharepoint-2013.aspx).</span><span class="sxs-lookup"><span data-stu-id="66341-315">For more information on data refresh authentication and usage of credentials, see the blog post [Refreshing PowerPivot Data in SharePoint 2013](https://blogs.msdn.com/b/analysisservices/archive/2012/12/21/refreshing-powerpivot-data-in-sharepoint-2013.aspx).</span></span>  
  
##  <a name="more-information"></a><a name="bkmk_moreinformation"></a> <span data-ttu-id="66341-316">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="66341-316">More Information</span></span>  
 <span data-ttu-id="66341-317">[Problembehandlung von PowerPivot-Daten](https://social.technet.microsoft.com/wiki/contents/articles/3870.troubleshooting-powerpivot-data-refresh.aspx).</span><span class="sxs-lookup"><span data-stu-id="66341-317">[Troubleshooting PowerPivot Data Refresh](https://social.technet.microsoft.com/wiki/contents/articles/3870.troubleshooting-powerpivot-data-refresh.aspx).</span></span>  
  
 <span data-ttu-id="66341-318">[Excel Services in SharePoint 2013](https://www.enjoysharepoint.com/configure-excel-service-application-in-sharepoint-2013/).</span><span class="sxs-lookup"><span data-stu-id="66341-318">[Excel Services in SharePoint 2013](https://www.enjoysharepoint.com/configure-excel-service-application-in-sharepoint-2013/).</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="66341-319">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="66341-319">See Also</span></span>  
 <span data-ttu-id="66341-320">[Aktualisieren von Arbeitsmappen und planmäßige Datenaktualisierung &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md) </span><span class="sxs-lookup"><span data-stu-id="66341-320">[Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md) </span></span>  
 [<span data-ttu-id="66341-321">PowerPivot für SharePoint 2013 Installation</span><span class="sxs-lookup"><span data-stu-id="66341-321">PowerPivot for SharePoint 2013 Installation</span></span>](../instances/install-windows/install-analysis-services-in-power-pivot-mode.md)  
  
  

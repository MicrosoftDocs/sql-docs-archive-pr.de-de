---
title: Referenz zu Integritäts Regeln (PowerPivot für SharePoint) | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 47ae04ce-7b9d-49c2-8dbc-bafcb73d4603
author: minewiskan
ms.author: owend
ms.openlocfilehash: 5e4c895cf55742b8db89bd86f7fe4c5277ef7a6c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87696237"
---
# <a name="health-rules-reference-powerpivot-for-sharepoint"></a>Referenz zu Integritätsregeln (PowerPivot für SharePoint)
  In diesem Referenzthema werden die SharePoint-Integritätsregeln beschrieben, die durch eine PowerPivot für SharePoint-Installation hinzugefügt werden. Diese Regeln werden verwendet, um Probleme mit dem Serverzustand, der Verfügbarkeit oder der Konfiguration einer [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] -Dienstanwendung bzw. einer zugeordneten [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] -Instanz zu melden.  
  
 In der folgenden Tabelle werden die Regeln in der Reihenfolge aufgeführt, in der sie in der SharePoint-Zentraladministration auf der Seite Regeldefinitionen der Integritätsanalyse angezeigt werden. Bei konfigurierbaren Regeln können Sie die Schwellenwerte ändern, bei denen die Regel ausgelöst wird. Weitere Informationen finden Sie unter [Power Pivot-Integritäts Regeln-konfigurieren](configure-power-pivot-health-rules.md). Unter "Automatische Reparatur" wird angegeben, ob es eine integrierte Abhilfemaßnahme gibt. Falls ja, können Sie auf der Seite der Problemberichte auf diese klicken, um das Problem zu beheben.  
  
||  
|-|  
|**[!INCLUDE[applies](../../includes/applies-md.md)]** SharePoint 2013 &#124; SharePoint 2010|  
  
 **Hinweis:** [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] werden verschiedene Sätze von Integritätsregeln für unterschiedliche SharePoint-Versionen installiert. Weitere Informationen finden Sie in der Spalte "Version" in der Tabelle unten, oder Sie können den folgenden Windows PowerShell-Befehl ausführen, um die installierten Regeln anzuzeigen.  
  
```powershell
Get-SPHealthAnalysisRule | Select name, enabled, summary | Where {$_.summary -like "*power*"}  | Format-Table -Property * -AutoSize | Out-Default  
```  
  
|Regel|Konfigurierbar|Automatische Reparatur|Version|BESCHREIBUNG|  
|----------|------------------|-----------------|-------------|-----------------|  
|PowerPivot: Der Analysis Services OLE DB-Anbieter ist nicht auf diesem Computer installiert.|Nein|Nein|SharePoint 2010|Der OLE DB-Anbieter für Analysis Services ist entweder auf dem Server nicht installiert oder weist die falsche Version auf. Diese Regel wird angezeigt, wenn die SharePoint-Farm Instanzen von Excel Services auf Anwendungsservern enthält, für die PowerPivot für SharePoint nicht verfügbar ist. Die Regel warnt Sie, dass der OLE DB-Anbieter für Analysis Services nicht installiert ist, der von Excel Services zum Herstellen einer Verbindung mit PowerPivot-Daten verwendet wird. Um dieses Problem zu beheben, installieren Sie den OLE DB-Anbieter auf jedem Excel Services-Server, auf dem der OLE DB-Anbieter für Analysis Services nicht vorhanden ist. Sie können den OLE DB-Anbieter für Analysis Services im Microsoft Download Center herunterladen und installieren. Weitere Informationen finden Sie unter [Installieren des OLE DB-Anbieters für Analysis Services auf SharePoint-Servern](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).|  
|PowerPivot: Registrierungseinstellungen für "Microsoft.AnalysisServices.ChannelTransport.dll" sind nicht gültig, nachdem Sie die SQL Server 2008 R2-Version des MSOLAP-Anbieters auf diesem Computer installiert haben.|Nein|Ja|SharePoint 2010|Dies ist ein Serverkonfigurationsproblem. Höchstwahrscheinlich wurde die Datei "ChannelTransport.dll" nicht in der globalen Assembly registriert. Führen Sie die automatische Reparatur für diese Regel aus, um die .dll-Datei auf jedem Server zu registrieren, auf dem PowerPivot für SharePoint installiert ist. Alternativ können Sie "regasm.exe" ausführen, um die Datei manuell zu registrieren. Wenn Sie den SharePoint-Timerdienst nicht als lokaler Administrator ausführen, ist ggf. eine manuelle Registrierung erforderlich. Wenn Sie die Registrierungseinstellungen nicht aktualisieren, hat dies eine langsamere Serverkommunikation zwischen Excel Services und dem PowerPivot-Systemdienst zur Folge, was in bestimmten Sicherheitskonfigurationen Verbindungsfehler auslösen kann.|  
|PowerPivot: Die PowerPivot-Dienstanwendung verfügt nicht über die Berechtigung, um den Vorgang abzuschließen.|Nein|Nein|SharePoint 2010|Diese Regel überprüft, ob die PowerPivot-Dienstanwendungsidentität Datenbankbesitzer der PowerPivot-Serveranwendungsdatenbank ist und über Administratorberechtigungen für die lokale SQL Server Analysis Services-Instanz verfügt. Diese Berechtigungen werden während der Installation und Bereitstellung automatisch gewährt. Wenn dieser Schritt jedoch nicht abgeschlossen wurde, tritt diese Integritätsregel ein.|  
|PowerPivot: Die PowerPivot-Dienstanwendungsidentität sollte nicht der lokalen Administratorgruppe angehören.|Nein|Nein|SharePoint 2010|Dies ist eine Best Practice, die die Gesamtsicherheit der Bereitstellung verbessert. Wenn Sie die PowerPivot-Dienstanwendung so konfiguriert haben, dass sie unter einem Konto der lokalen Administratorgruppe ausgeführt werden soll, sollten Sie das Dienstkonto in ein Konto ändern, der nicht zu dieser Gruppe gehört. Es wird empfohlen, ein spezielles Konto mit möglichst wenigen Berechtigungen für jeden Dienst zu verwenden. Sie erzielen so eine Dienstisolation und vereinfachen die Überwachung von Anmeldungen. Weitere Informationen zum Ändern des Dienst Kontos finden Sie unter [Konfigurieren von Power Pivot-Dienst Konten](configure-power-pivot-service-accounts.md).|  
|PowerPivot: Die Analysis Services-Instanz wird im tabellarischen Modus ausgeführt, aber die Konfigurationseinstellung, die diesen Modus angibt, ist deaktiviert.|Nein|Nein|SharePoint 2010|Diese Regel überprüft, ob in der SQL Server Analysis Services-Instanz in einer PowerPivot für SharePoint-Installation die `DeploymentMode`-Servereigenschaft auf 1 festgelegt ist. Wenn die Eigenschaft auf einen anderen Wert festgelegt ist oder wenn der SharePoint-Timerdienst, der die Regelprüfung ausführt, nicht über die Berechtigung zum Öffnen der Datei verfügt, schlägt diese Regel fehl. Weitere Informationen zur Bereitstellungsmoduseigenschaft finden Sie unter [Bestimmen des Servermodus einer Analysis Services-Instanz](../instances/determine-the-server-mode-of-an-analysis-services-instance.md).|  
|PowerPivot: Der Zeitgeberauftrag für die PowerPivot-Datenaktualisierung wurde deaktiviert.|Nein|Nein|SharePoint 2013<br /><br /> SharePoint 2010|Überprüfen Sie die Einstellungen für den Zeitgeberauftrag, um sicherzustellen, dass dieser aktiviert wurde. Wenn Sie die PowerPivot-Datenaktualisierungsfunktion nicht verwenden, können Sie diese Regel ignorieren. Weitere Informationen finden Sie unter [Power Pivot-Datenaktualisierung mit SharePoint 2010](../powerpivot-data-refresh-with-sharepoint-2010.md).|  
|PowerPivot: Die SQL Server Analysis Services (PowerPivot)-Dienstkontoinformationen, die vom SQL Server-Konfigurations-Manager verwaltet werden, unterscheiden sich von den Kontoinformationen, die von der Zentraladministration verwaltet werden.|Nein|Nein|SharePoint 2010|Diese Regel überprüft, ob die Dienstkontoinformationen im SQL Server-Konfigurations-Manager mit den Informationen des verwalteten Kontos in der Zentraladministration für die gleiche Analysis Services-Instanz übereinstimmen. Wenn sich die Konten unterscheiden, wird dem Problem- und Lösungsbericht ein Eintrag hinzugefügt, damit Sie die Dienstkontoinformationen im SQL Server-Konfigurations-Manager auf das in der Zentraladministration angegebene Konto zurücksetzen können. Der SQL Server-Konfigurations-Manager ist kein unterstütztes Tool zum Ändern des Benutzernamens und Kennworts von Dienstkonten in einer PowerPivot für SharePoint-Installation. Bei Verwendung der Zentraladministration kann die Funktion für verwaltete Konten von SharePoint genutzt werden. Wenn die Farm mehrere PowerPivot für SharePoint-Server beinhaltet, können inkonsistente Dienstkontoeinstellungen die Verarbeitungs- und Abfrageoperationen auf dem Server mit den falschen Dienstinformationen beeinträchtigen.<br /><br /> Wenn diese Regel ausgelöst wurde, können auf einem einzelnen Server PowerPivot-Arbeitsmappen vorübergehend genutzt werden. Es wird jedoch empfohlen, das Problem so schnell wie möglich zu beheben. Datenbank- und Dateisystemberechtigungen werden anhand der Kontoinformationen in der Zentraladministration aktualisiert.|  
|PowerPivot: Die bereitgestellte Farmlösung ist nicht auf dem neuesten Stand.|Nein|Ja|SharePoint 2010|Eine PowerPivot für SharePoint-Installation verwendet eine Lösung auf Farmebene und eine Lösung auf Webanwendungsebene, um die Funktionen zu installieren. Diese Regel gibt an, dass die Farmlösung relativ zur Version, dem Server oder möglicherweise der Weblösung nicht aktuell ist. Höchstwahrscheinlich handelt es sich hierbei um ein Serverbereitstellungsproblem. Zur Behebung dieses Problems können Sie das SQL Server-Setup ausführen, um eine der PowerPivot für SharePoint-Installationen in der Farm zu reparieren. Weitere Informationen zu Lösungen in einer PowerPivot für SharePoint-Installation finden Sie unter Bereitstellen von [Power Pivot-Lösungen in SharePoint](deploy-power-pivot-solutions-to-sharepoint.md).|  
|PowerPivot: Die CPU-Gesamtauslastung ist zu hoch.|Ja|Nein|SharePoint 2010|Diese Regel meldet den CPU-Verbrauch auf Systemebene. Die CPU-Gesamtauslastung wird überwacht, da der PowerPivot-Systemdienst diese als Measure des Serverstatus für den zustandsbasierten Lastenausgleich auf mehreren PowerPivot für SharePoint-Servern in einer Farm verwendet. Erwägen Sie, der Farm einen weiteren Anwendungsserver hinzuzufügen und CPU-intensive Anwendungen auf diesen Server zu verschieben.|  
|PowerPivot: Analysis Services verfügt nicht über genügend CPU-Ressourcen, um die angeforderten Vorgänge auszuführen.|Ja|Nein|SharePoint 2010|Die Menge der verfügbaren CPU-Ressourcen für den Analysis Services-Prozess (msmdsrv.exe) reicht für den Grad der Aktivität auf diesem Server nicht aus. Erwägen Sie, der Farm einen weiteren PowerPivot für SharePoint-Server hinzuzufügen. Weitere Informationen finden Sie unter [Bereitstellungs Prüfliste: horizontales Skalieren durch Hinzufügen von Power Pivot-Servern zu einer SharePoint 2010-Farm](../../sql-server/install/deployment-checklist-scale-out-adding-powerpivot-servers-sharepoint-2010-farm.md).|  
|PowerPivot: Analysis Services verfügt nicht über genügend Arbeitsspeicher, um die angeforderten Vorgänge auszuführen.|Nein|Nein|SharePoint 2010|Diese Regel wird ausgelöst, wenn nur noch 5 % des Speichers für Analysis Services verfügbar ist. Auf einem SharePoint-Anwendungsserver sollte eine SQL Server Analysis Services-Instanz immer über einen kleinen Arbeitsspeicher als Reserve verfügen, der nie verwendet wird. Da der Server für die meisten Vorgänge arbeitsspeichergebunden ist, läuft er am besten, wenn er nicht ganz bis zur oberen Grenze ausgeführt wird.<br /><br /> Standardmäßig werden Warnungen aufgrund von unzureichendem Arbeitsspeicher ausgegeben, wenn der verfügbare Speicher auf 5 % gefallen ist. Sie können diesen Wert in einen höheren oder niedrigeren Wert ändern, indem Sie die Einstellungen für die Analysis Services-Instanz anpassen. Weitere Informationen finden Sie unter [Power Pivot-Integritäts Regeln-konfigurieren](configure-power-pivot-health-rules.md).<br /><br /> Die 5 % nicht verwendeter Arbeitsspeicher werden als Prozentsatz des Arbeitsspeichers berechnet, der den Analysis Services zugeordnet wird. Wenn der gesamte Speicher z. B. 200 GB beträgt und Analysis Services davon 80 % (oder 160 GB) belegt, dann entsprechen die 5 % nicht verwendeter Speicher 5 % von 160 GB (oder 8 GB).|  
|PowerPivot: Die hohe Verbindungsanzahl weist darauf hin, dass weitere Server zur Bewältigung der aktuellen Arbeitslast bereitgestellt werden sollten.|Ja|Nein|SharePoint 2010|Standardmäßig wird diese Integritätsregel ausgelöst, wenn die Anzahl einzelner Benutzerverbindungen 100 überschreitet. Dieser Standardwert ist ein beliebiger Wert (basiert nicht auf den Hardwarespezifikationen des Servers oder auf der Benutzeraktivität), damit Sie den Wert abhängig von der Serverkapazität und Benutzeraktivität in der Umgebung herauf- oder herabsetzen können. Weitere Informationen finden Sie unter [Power Pivot-Integritäts Regeln-konfigurieren](configure-power-pivot-health-rules.md).|  
|PowerPivot: Das Verhältnis zwischen Ladeereignissen und Verbindungen ist zu hoch.|Ja|Nein|SharePoint 2013<br /><br /> SharePoint 2010|Standardmäßig wird diese Integritätsregel ausgelöst, wenn der Prozentsatz der Ladeereignissen im Verhältnis zu Verbindungsereignissen im Verlauf des ganzen Datensammlungszeitraums (standardmäßig 4 Stunden) 50 % überschreitet. Ein Verhältnis in dieser Höhe deutet auf eine sehr hohe Anzahl von Verbindungen zu eindeutigen Arbeitsmappen oder auf zu drastische Cachereduzierungseinstellungen hin (Arbeitsmappen werden schnell entladen und aus dem System entfernt, während Anforderungen für diese Daten noch aktiv sind). Um falsche Positivmeldungen zu vermeiden, müssen in einem Zeitraum von 4 Stunden mindestens 20 Verbindungen vorhanden sein, damit das Verhältnis berechnet werden kann. Sie können als Grundlage dieser Integritätsregel auch ein anderes Verhältnis festlegen. Weitere Informationen finden Sie unter [Power Pivot-Integritäts Regeln-konfigurieren](configure-power-pivot-health-rules.md). Weitere Informationen zum Konfigurieren des Caches finden Sie unter [Konfigurieren der Speicherplatz Verwendung &#40;PowerPivot für SharePoint&#41;](configure-disk-space-usage-power-pivot-for-sharepoint.md).|  
|PowerPivot: Mindestens eine MiniDump-Datei wurde im Protokollverzeichnis gefunden, was auf einen Programmabsturz hinweist.|Nein|Nein|SharePoint 2013<br /><br /> SharePoint 2010|Während eines Programmabsturzes werden Minidump-Dateien generiert, um Informationen über den Status der PowerPivot-Dienstanwendung kurz vor dem Absturz zu erfassen. Diese Informationen können an Microsoft gesendet und für die Problembehandlung verwendet werden. Diese Regel wird ausgelöst, wenn .dmp-Dateien auf dem Server erkannt werden. Die Regel stellt einen Link zu der Datei bereit, die sich im Ordner "\OLAP\Log" der PowerPivot für SharePoint-Instanz befindet. Beachten Sie, dass Sie den Inhalt der Datei nicht mithilfe eines Texteditors anzeigen können. Um eine Minidump-Datei anzuzeigen, müssen Sie ein separates Debugtool herunterladen und installieren. Weitere Informationen finden Sie unter [Debugtools für Windows](/windows-hardware/drivers/debugger/).|  
|PowerPivot: Das Laufwerk, auf dem PowerPivot-Daten zwischengespeichert werden, verfügt über unzureichenden Speicherplatz.|Ja|Nein|SharePoint 2010|Standardmäßig wird diese Integritätsregel ausgelöst, wenn der Speicherplatz auf dem Laufwerk mit dem Sicherungsordner geringer als 5 % ist. Weitere Informationen zum Festlegen dieses Prozentsatzes finden Sie unter [Power Pivot-Integritäts Regeln-konfigurieren](configure-power-pivot-health-rules.md). Weitere Informationen zur Datenträger Verwendung finden Sie unter [Konfigurieren der Speicherplatz Verwendung &#40;PowerPivot für SharePoint&#41;](configure-disk-space-usage-power-pivot-for-sharepoint.md).|  
|PowerPivot: Verwendungsdaten werden nicht mit der erwarteten Häufigkeit aktualisiert.|Ja|Nein|SharePoint 2013<br /><br /> SharePoint 2010|PowerPivot für SharePoint erfasst Metriken zur Datenaktualisierung, zu Verbindungen und Abfrageantwortzeiten mithilfe des integrierten Systems für die Sammlung von Verwendungsdaten. Diese Verwendungsdaten werden in der PowerPivot-Dienstanwendungsdatenbank gespeichert, die dann wiederum zum Aktualisieren einer PowerPivot-Arbeitsmappe (PowerPivot Management Data.xlsx) dient, die Daten für Berichte im PowerPivot-Management-Dashboard bereitstellt. Diese Regel gibt an, dass Verwendungsdaten nicht mit ausreichender Häufigkeit in die Datei "PowerPivot Management Data.xlsx" verschoben werden. Die Regel verwendet den Zeitstempel in der XLSX-Datei als Nachweis, dass die Datei aktualisiert wurde. Weitere Probleme im Verwendungsdatensammlungssystem, die die Genauigkeit der Daten beeinträchtigen, werden durch diese Regel nicht erkannt. Überprüfen Sie zum Beheben dieses Fehlers, ob die Zeitgeberaufträge ausgeführt werden. Weitere Informationen zur Sammlung von Verwendungs Daten finden Sie unter [Konfigurieren der Sammlung von Verwendungs Daten für &#40;PowerPivot für SharePoint](configure-usage-data-collection-for-power-pivot-for-sharepoint.md).|  
|Power Pivot: das Mittel Tier-Prozess Konto sollte die Berechtigung "alles lesen" für alle zugeordneten spwebapplications besitzen.|Nein|Ja|SharePoint 2013<br /><br /> SharePoint 2010|Die Power Pivot-Dienst Anwendungs Identität muss über **vollständige Lese** Berechtigungen verfügen, um im Namen von Benutzern, die über die Berechtigung "nur anzeigen" für ein Dokument verfügen, auf die SharePoint-Inhalts Datenbanken zuzugreifen. Öffnen Sie die Seite **Dienst Konten konfigurieren** in der zentral Administration, um zu bestimmen, welches Konto als Power Pivot-Dienst Anwendungs Identität verwendet wird. Höchstwahrscheinlich wird die Dienstanwendung entweder im Dienstanwendungspool des **SharePoint-Webdienstsystems** oder einem dedizierten Anwendungspool ausgeführt. Obwohl diese Regel eine automatische Reparaturoption bereitstellt, erzielen Sie bessere Ergebnisse, wenn Sie die Berechtigungen manuell erteilen, indem Sie die folgenden Schritte ausführen:<br /><br /> 1) Klicken Sie in der Zentraladministration auf **Webanwendungen verwalten**.<br /><br /> 2) Wählen Sie eine Website aus, und klicken Sie anschließend auf **Benutzerrichtlinie**.<br /><br /> 3) Klicken Sie auf **Benutzer hinzufügen**.<br /><br /> 4) Wählen Sie (Alle-Zonen) aus, und klicken Sie auf **Weiter**.<br /><br /> 5) geben Sie unter Benutzer die Power Pivot-Dienst Anwendungs Identität ein, und klicken Sie dann auf das Kontrollkästchen **vollständiger Lese** Vorgang. Klicken Sie auf **Fertig stellen**.<br /><br /> 6) Überprüfen Sie die Reparatur. Klicken Sie in Monitoring auf **Regeldefinitionen überprüfen**. Suchen und öffnen Sie dann die PowerPivot-Regel. Klicken Sie auf **jetzt ausführen**. Gehen Sie zurück zu **Probleme und Lösungen überprüfen** , um sicherzustellen, dass die Regel nicht mehr angezeigt wird.|  
|PowerPivot: Der sekundäre Anmeldedienst (Seclogon) ist deaktiviert.|Nein|Nein|SharePoint 2013<br /><br /> SharePoint 2010|Der sekundäre Anmeldedienst wird verwendet, um Miniaturbilder der PowerPivot-Arbeitsmappen im PowerPivot-Katalog zu generieren. Standardmäßig ist der sekundäre Anmeldedienst auf manuellen Start festgelegt. Wenn der Dienst deaktiviert ist, tritt beim Generieren von Miniaturansichten ein Fehler auf. Darüber hinaus enthalten die ULS-Protokolle den folgenden Fehler: "der Fehler 1058 kann als Hauptursache auftreten, weil der Windows-Dienst" sekundäre Anmeldung "deaktiviert ist.<br /><br /> Um die Dienstkonfiguration zu überprüfen, verwenden Sie die Konsolenanwendungsdienste, um Sekundäre Anmeldung zu suchen und deren **Starttyp** in **Manuell**zu ändern. Wenn Sie den Dienst nicht aktivieren können, verfügt Ihre Organisation möglicherweise über eine Gruppenrichtlinie zum Deaktivieren. Fragen Sie einen Administrator, ob dies der Fall ist.<br /><br /> Wenn Sie den Dienst aktiviert haben, werden die Miniaturansichts- oder Momentaufnahmebilder nach und nach aktualisiert. Sie können auch eine Aktualisierung erzwingen, indem Sie den Dienst erneut starten und dann die Eigenschaftenseiten eines bestimmten Berichts öffnen und erneut speichern. Weitere Informationen finden Sie unter [Verwenden des Power Pivot](https://go.microsoft.com/fwlink/?LinkId=246462)-Katalogs.|  
|PowerPivot: ADOMD.NET ist nicht auf einem eigenständigen WFE installiert, das für die Zentraladministration konfiguriert ist.|Nein|Nein|SharePoint 2013<br /><br /> SharePoint 2010|ADOMD.NET ist eine Analysis Services-Clientbibliothek, die Verbindungen mit einer Analysis Services-Datenbank unterstützt. In einer Bereitstellung von PowerPivot für SharePoint ermöglicht ADOMD.NET den Zugriff auf die integrierten Berichte im PowerPivot-Management-Dashboard der Zentraladministration. Integrierte Berichte sind eigentlich PowerPivot-Arbeitsmappen, die eingebettete Analysis Services-Daten enthalten. Das Management-Dashboard sendet mithilfe von ADOMD.NET eine Verbindungsanforderung an den Server, der in der Arbeitsmappe enthaltene Daten lädt.<br /><br /> In Topologien mit Zentraladministration, die auf einem eigenständigen Web-Front-End-Server ausgeführt wird, müssen Sie ADOMD.NET manuell installieren, wenn Sie diese Berichte im Management-Dashboard anzeigen möchten. Weitere Informationen finden Sie unter [Installieren von ADOMD.NET auf Web-Front-End-Servern, auf denen die Zentraladministration ausgeführt wird](../../sql-server/install/install-adomd-net-on-web-front-end-servers-running-central-administration.md).|  

---
title: 'Lektion 3: Zugreifen auf den Webdienst | Microsoft-Dokumentation'
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: c3e4c198-ab35-4548-9471-1b4e6b6e5dfd
author: markingmyname
ms.author: maghan
manager: kfile
ms.openlocfilehash: c69e0dbe9eef987a764686bdf84e68bd8c530628
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87717095"
---
# <a name="lesson-3-accessing-the-web-service"></a><span data-ttu-id="e8d40-102">Lektion 3: Zugriff auf den Webdienst</span><span class="sxs-lookup"><span data-stu-id="e8d40-102">Lesson 3: Accessing the Web Service</span></span>
  <span data-ttu-id="e8d40-103">Nachdem Sie dem Projekt einen Verweis auf den Berichtsserver-Webdienst hinzugefügt haben, besteht der nächste Schritt darin, eine Instanz der Proxyklasse des Webdiensts zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="e8d40-103">After you add a reference for the Report Server Web service to your project, the next step is to create an instance of the Web service's proxy class.</span></span> <span data-ttu-id="e8d40-104">Auf die Methoden des Webdiensts kann durch Aufrufen der Methoden in der Proxyklasse zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="e8d40-104">You can then access the methods of the Web service by calling the methods in the proxy class.</span></span> <span data-ttu-id="e8d40-105">Wenn diese Methoden von Ihrer Anwendung aufgerufen werden, behandelt der von [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] generierte Proxyklassencode die Kommunikation zwischen Ihrer Anwendung und dem Webdienst.</span><span class="sxs-lookup"><span data-stu-id="e8d40-105">When your application calls these methods, the proxy class code generated by [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] handles the communications between your application and the Web service.</span></span>  
  
 <span data-ttu-id="e8d40-106">Zuerst erstellen Sie <xref:ReportService2010.ReportingService2010> - eine Instanz der Proxyklasse des Webdiensts.</span><span class="sxs-lookup"><span data-stu-id="e8d40-106">First, you will create an instance of the Web service's proxy class, <xref:ReportService2010.ReportingService2010>.</span></span> <span data-ttu-id="e8d40-107">Dann rufen Sie die <xref:ReportService2010.ReportingService2010.GetProperties%2A>-Methode des Webdiensts mithilfe der Proxyklasse auf.</span><span class="sxs-lookup"><span data-stu-id="e8d40-107">Next, you will make a call to the Web service's <xref:ReportService2010.ReportingService2010.GetProperties%2A> method using the proxy class.</span></span> <span data-ttu-id="e8d40-108">Sie verwenden diesen Aufruf zum Abrufen des Namens und der Beschreibung eines der Beispielsberichte, Company Sales.</span><span class="sxs-lookup"><span data-stu-id="e8d40-108">You will use the call to retrieve the name and description of one of the sample reports, Company Sales.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e8d40-109">Beim Zugreifen auf einen Webdienst, der unter [!INCLUDE[ssExpress](../includes/ssexpress-md.md)] mit Advanced Services ausgeführt wird, müssen Sie "$SQLExpress" an den "ReportServer"-Pfad anfügen.</span><span class="sxs-lookup"><span data-stu-id="e8d40-109">When accessing a Web service running on [!INCLUDE[ssExpress](../includes/ssexpress-md.md)] with Advanced Services, you must append "$SQLExpress" to the "ReportServer" path.</span></span> <span data-ttu-id="e8d40-110">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="e8d40-110">For example:</span></span>  
>   
>  `http://<Server Name>/reportserver$sqlexpress/reportservice2010.asmx"`  
  
### <a name="to-access-the-web-service"></a><span data-ttu-id="e8d40-111">So greifen Sie auf den Webdienst zu</span><span class="sxs-lookup"><span data-stu-id="e8d40-111">To access the Web service</span></span>  
  
1.  <span data-ttu-id="e8d40-112">Zunächst müssen Sie der Datei Program.cs (Module1.vb in [!INCLUDE[vbprvb](../includes/vbprvb-md.md)]) den Namespace hinzufügen, indem Sie der Codedatei eine `using`-Direktive (`Imports` in [!INCLUDE[vbprvb](../includes/vbprvb-md.md)]) hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="e8d40-112">You must first add the namespace to the Program.cs file (Module1.vb in [!INCLUDE[vbprvb](../includes/vbprvb-md.md)]) by adding a `using` (`Imports` in [!INCLUDE[vbprvb](../includes/vbprvb-md.md)]) directive to the code file.</span></span> <span data-ttu-id="e8d40-113">Wenn Sie diese Direktive verwenden, müssen die Typen im Namespace nicht vollqualifiziert sein.</span><span class="sxs-lookup"><span data-stu-id="e8d40-113">If you use this directive, you do not need to fully qualify the types in the namespace.</span></span>  
  
2.  <span data-ttu-id="e8d40-114">Fügen Sie dazu den folgenden Code am Anfang der Codedatei ein:</span><span class="sxs-lookup"><span data-stu-id="e8d40-114">To do this, add the following code to the beginning of your code file:</span></span>  
  
    ```vb  
    Imports System  
    Imports GetPropertiesSample.ReportService2010  
    ```  
  
    ```csharp  
    using System;  
    using GetPropertiesSample.ReportService2010;  
    ```  
  
3.  <span data-ttu-id="e8d40-115">Nachdem Sie die Namespacedirektive in die Codedatei eingegeben haben, geben Sie den folgenden Code in die Main-Methode Ihrer Konsolenanwendung ein.</span><span class="sxs-lookup"><span data-stu-id="e8d40-115">Once you have entered the namespace directive to your code file, enter the following code in the Main method of your console application.</span></span> <span data-ttu-id="e8d40-116">Stellen Sie sicher, dass Sie beim Festlegen der **Url** -Eigenschaft der Webdienstinstanz den Namen Ihres Servers ändern:</span><span class="sxs-lookup"><span data-stu-id="e8d40-116">Make sure to change the name of your server when setting the **Url** property of the web service instance:</span></span>  
  
    ```vb  
    Sub Main()  
       Dim rs As New ReportingService2010  
       rs.Credentials = System.Net.CredentialCache.DefaultCredentials  
       rs.Url = "http://<Server Name>/reportserver/reportservice2010.asmx"  
  
       Dim name As New [Property]  
       name.Name = "Name"  
  
       Dim description As New [Property]  
       description.Name = "Description"  
  
       Dim properties(1) As [Property]  
       properties(0) = name  
       properties(1) = description  
  
       Try  
          Dim returnProperties As [Property]() = rs.GetProperties( _  
             "/AdventureWorks 2012 Sample Reports/Company Sales 2012", properties)  
  
          Dim p As [Property]  
          For Each p In returnProperties  
              Console.WriteLine((p.Name + ": " + p.Value))  
          Next p  
  
       Catch e As Exception  
          Console.WriteLine(e.Message)  
       End Try  
    End Sub  
    ```  
  
    ```csharp  
    static void Main(string[] args)  
    {  
       ReportingService2010 rs = new ReportingService2010();  
       rs.Credentials = System.Net.CredentialCache.DefaultCredentials;  
       rs.Url = "http://<Server Name>/reportserver/reportservice2010.asmx";  
  
       Property name = new Property();  
       name.Name = "Name";  
  
       Property description = new Property();  
       description.Name = "Description";  
  
       Property[] properties = new Property[2];  
       properties[0] = name;  
       properties[1] = description;  
  
       try  
       {  
          Property[] returnProperties = rs.GetProperties(  
          "/AdventureWorks 2012 Sample Reports/Company Sales 2012",properties);  
  
          foreach (Property p in returnProperties)  
          {  
             Console.WriteLine(p.Name + ": " + p.Value);  
          }  
       }  
  
       catch (Exception e)  
       {  
          Console.WriteLine(e.Message);  
       }  
    }  
    ```  
  
4.  <span data-ttu-id="e8d40-117">Speichern Sie die Projektmappe.</span><span class="sxs-lookup"><span data-stu-id="e8d40-117">Save the solution.</span></span>  
  
 <span data-ttu-id="e8d40-118">Der Beispielcode in dieser exemplarischen Vorgehensweise verwendet die <xref:ReportService2010.ReportingService2010.GetProperties%2A>-Methode des Webdiensts, um Eigenschaften des Beispielberichts Company Sales 2012 abzurufen.</span><span class="sxs-lookup"><span data-stu-id="e8d40-118">The walkthrough sample code uses the <xref:ReportService2010.ReportingService2010.GetProperties%2A> method of the Web service to retrieve properties of the sample report, Company Sales 2012.</span></span> <span data-ttu-id="e8d40-119">Die- <xref:ReportService2010.ReportingService2010.GetProperties%2A> Methode benötigt zwei Argumente: den Namen des Berichts, für den Sie Eigenschafts Informationen abrufen möchten, und ein Array von **Property []** -Objekten, das die Namen der Eigenschaften enthält, deren Werte Sie abrufen möchten.</span><span class="sxs-lookup"><span data-stu-id="e8d40-119">The <xref:ReportService2010.ReportingService2010.GetProperties%2A> method takes two arguments: the name of the report for which you want to retrieve property information and an array of **Property[]** objects that contains the names of properties whose values you want to retrieve.</span></span> <span data-ttu-id="e8d40-120">Die Methode gibt auch ein Array von **Property[]** -Objekten zurück, die die Namen und Werte der Eigenschaften enthalten, die im Eigenschaftenargument angegeben sind.</span><span class="sxs-lookup"><span data-stu-id="e8d40-120">The method also returns an array of **Property[]** objects that contains the names and values of the properties specified in the properties argument.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e8d40-121">Wenn Sie ein leeres **Property[]** -Array für das Eigenschaftenargument angeben, werden alle verfügbaren Eigenschaften zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="e8d40-121">If you supply an empty **Property[]** array for the properties argument, all available properties are returned.</span></span>  
  
 <span data-ttu-id="e8d40-122">Im vorherigen Beispiel verwendet der Code die <xref:ReportService2010.ReportingService2010.GetProperties%2A>-Methode, um den Namen und die Beschreibung des Beispielberichts Company Sales 2012 zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="e8d40-122">In the previous sample, the code uses the <xref:ReportService2010.ReportingService2010.GetProperties%2A> method to return the name and description of the sample report, Company Sales 2012.</span></span> <span data-ttu-id="e8d40-123">Im Code wird dann eine `foreach`-Schleife verwendet, um die Eigenschaften und Werte auf die Konsole zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="e8d40-123">The code then uses a `foreach` loop to write the properties and values to the console.</span></span>  
  
 <span data-ttu-id="e8d40-124">Weitere Informationen zum Erstellen und Verwenden einer Proxyklasse für den Berichtsserver-Webdienst finden Sie unter [Creating the Web Service Proxy](../reporting-services/report-server-web-service/net-framework/creating-the-web-service-proxy.md).</span><span class="sxs-lookup"><span data-stu-id="e8d40-124">For more information about creating and using a proxy class for the Report Server Web service, see [Creating the Web Service Proxy](../reporting-services/report-server-web-service/net-framework/creating-the-web-service-proxy.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e8d40-125">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="e8d40-125">See Also</span></span>  
 <span data-ttu-id="e8d40-126">[Lektion 4: Ausführen der Anwendung &#40;VB-VC&#35;&#41;](../../2014/tutorials/lesson-4-running-the-application-vb-vcsharp.md) </span><span class="sxs-lookup"><span data-stu-id="e8d40-126">[Lesson 4: Running the Application &#40;VB-VC&#35;&#41;](../../2014/tutorials/lesson-4-running-the-application-vb-vcsharp.md) </span></span>  
 [<span data-ttu-id="e8d40-127">Zugreifen auf den Report Server-Webdienst mithilfe von Visual Basic oder Visual C&#35; &#40;SSRS-Tutorial&#41;</span><span class="sxs-lookup"><span data-stu-id="e8d40-127">Accessing the Report Server Web Service Using Visual Basic or Visual C&#35; &#40;SSRS Tutorial&#41;</span></span>](../../2014/tutorials/access-report-server-web-service-vb-vcsharp-ssrs-tutorial.md)  
  
  

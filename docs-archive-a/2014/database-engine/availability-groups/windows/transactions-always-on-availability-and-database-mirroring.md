---
title: Datenbankübergreifende Transaktionen werden für die Daten Bank Spiegelung oder AlwaysOn-Verfügbarkeitsgruppen nicht unterstützt (SQL Server) | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- database mirroring [SQL Server], interoperability
- cross-database transactions [SQL Server]
- transactions [database mirroring]
- Availability Groups [SQL Server], interoperability
- troubleshooting [SQL Server], cross-database transactions
ms.assetid: 9f7ed895-ad65-43e3-ba08-00d7bff1456d
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: a0e23e073375c8f00317003635df8ec0b69883cd
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87724962"
---
# <a name="cross-database-transactions-not-supported-for-database-mirroring-or-alwayson-availability-groups-sql-server"></a><span data-ttu-id="2d5ed-102">Datenbankübergreifende Transaktionen nicht unterstützt für Datenbankspiegelungs- oder AlwaysOn-Verfügbarkeitsgruppen (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="2d5ed-102">Cross-Database Transactions Not Supported For Database Mirroring or AlwaysOn Availability Groups (SQL Server)</span></span>
  <span data-ttu-id="2d5ed-103">Datenbankübergreifende Transaktionen und verteilte Transaktionen werden von [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] oder der Datenbankspiegelung nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="2d5ed-103">Cross-database transactions and distributed transactions are not supported by [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] or by database mirroring.</span></span> <span data-ttu-id="2d5ed-104">Dies ist darauf zurückzuführen, dass die Unteilbarkeit/Vollständigkeit von Transaktionen aus folgenden Gründen nicht gewährleistet werden kann:</span><span class="sxs-lookup"><span data-stu-id="2d5ed-104">This is because transaction atomicity/integrity cannot be guaranteed for the following reasons:</span></span>  
  
-   <span data-ttu-id="2d5ed-105">Für datenbankübergreifende Transaktionen: Jede Datenbank führt einen unabhängigen Commit aus.</span><span class="sxs-lookup"><span data-stu-id="2d5ed-105">For cross-database transactions: Each database commits independently.</span></span> <span data-ttu-id="2d5ed-106">Aus diesem Grund kann sogar für Datenbanken in einer einzelnen Verfügbarkeitsgruppe ein Failover auftreten, nachdem eine Datenbank für eine Transaktion einen Commit ausgeführt hat, jedoch bevor die andere Datenbank diesen Schritt ausgeführt hat.</span><span class="sxs-lookup"><span data-stu-id="2d5ed-106">Therefore, even for databases in a single availability group, a failover could occur after one database commits a transaction but before the other database does.</span></span> <span data-ttu-id="2d5ed-107">Bei der Datenbankspiegelung wird dieses Problem verstärkt, da die gespiegelte Datenbank sich nach einem Failover in der Regel auf einer anderen Serverinstanz der anderen Datenbank befindet. Auch wenn beide Datenbanken zwischen denselben beiden Partnern gespiegelt werden, ist nicht garantiert, dass das Failover für beide Datenbanken gleichzeitig ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="2d5ed-107">For database mirroring this issue is compounded because after a failover, the mirrored database is typically on a different server instance from the other database, and  even if both databases are mirrored between the same two partners, there is no guarantee that both databases will fail over at the same time.</span></span>  
  
-   <span data-ttu-id="2d5ed-108">Für verteilte Transaktionen: Nach einem Failover kann vom neuen Prinzipalserver bzw. vom primären Replikat keine Verbindung mit dem verteilten Transaktionskoordinator auf dem vorherigen Prinzipalserver bzw. primären Replikat hergestellt werden.</span><span class="sxs-lookup"><span data-stu-id="2d5ed-108">For distributed transactions: After a failover, the new principal server/primary replica is unable to connect to the distributed transaction coordinator on the previous principal server/primary replica.</span></span> <span data-ttu-id="2d5ed-109">Aus diesem Grund kann der neue Prinzipalserver bzw. das neue primäre Replikat den Transaktionsstatus nicht erlangen.</span><span class="sxs-lookup"><span data-stu-id="2d5ed-109">Therefore, the new principal server/primary replica cannot obtain the transaction status.</span></span>  
  
 <span data-ttu-id="2d5ed-110">Im folgenden Beispiel zur Datenbankspiegelung wird verdeutlicht, wie eine logische Inkonsistenz auftreten kann.</span><span class="sxs-lookup"><span data-stu-id="2d5ed-110">The following database mirroring example illustrates how a logical inconsistency could occur.</span></span> <span data-ttu-id="2d5ed-111">In diesem Beispiel fügt eine Anwendung über eine datenbankübergreifende Transaktion zwei Datenzeilen ein: Eine Zeile wird in eine Tabelle in einer gespiegelten Datenbank (A) eingefügt, und die andere Zeile wird in eine Tabelle in einer anderen Datenbank (B) eingefügt. Datenbank A wird im Modus für hohe Sicherheit mit automatischem Failover gespiegelt.</span><span class="sxs-lookup"><span data-stu-id="2d5ed-111">In this example, an application uses a cross-database transaction to insert two rows of data: one row is inserted into a table in a mirrored database, A, and the other row is inserted into a table in another database, B. Database A is being mirrored in high-safety mode with automatic failover.</span></span> <span data-ttu-id="2d5ed-112">Während des Commits der Transaktion fällt Datenbank A aus. Die Spiegelungssitzung führt automatisch ein Failover zum Spiegel von Datenbank A aus.</span><span class="sxs-lookup"><span data-stu-id="2d5ed-112">While the transaction is being committed, database A becomes unavailable, and the mirroring session automatically fails over to the mirror of database A.</span></span>  
  
 <span data-ttu-id="2d5ed-113">Nach dem Failover kann ein Commit der datenbankübergreifenden Transaktion möglicherweise erfolgreich für Datenbank B ausgeführt werden, jedoch nicht für die Datenbank, für die der Failover ausgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="2d5ed-113">After the failover, the cross-database transaction might be successfully committed on database B but not on the failed-over database.</span></span> <span data-ttu-id="2d5ed-114">Dies wäre möglich, wenn der ursprüngliche Prinzipalserver für Datenbank A nicht das Protokoll für die datenbankübergreifende Transaktion vor dem Ausfall an den Spiegelserver gesendet hätte.</span><span class="sxs-lookup"><span data-stu-id="2d5ed-114">This would occur if the original principal server for database A had not sent the log for the cross-database transaction to the mirror server before the failure.</span></span> <span data-ttu-id="2d5ed-115">Nach dem Failover wäre diese Transaktion auf dem neuen Prinzipalserver nicht vorhanden.</span><span class="sxs-lookup"><span data-stu-id="2d5ed-115">After the failover, that transaction would not exist on the new principal server.</span></span> <span data-ttu-id="2d5ed-116">Datenbanken A und B würden inkonsistent werden, da die in Datenbank B eingefügten Daten erhalten bleiben, während die in Datenbank A eingefügten Daten verloren gingen.</span><span class="sxs-lookup"><span data-stu-id="2d5ed-116">Databases A and B would become inconsistent, because the data inserted in database B remains intact, but the data inserted in database A has been lost.</span></span>  
  
 <span data-ttu-id="2d5ed-117">Ein vergleichbares Szenario kann bei einer MS DTC-Transaktion auftreten.</span><span class="sxs-lookup"><span data-stu-id="2d5ed-117">A similar scenario can occur while using a MS DTC transaction.</span></span> <span data-ttu-id="2d5ed-118">Angenommen, der neue Prinzipal setzt sich nach dem Failover mit MS DTC in Verbindung.</span><span class="sxs-lookup"><span data-stu-id="2d5ed-118">For example, after failover, the new principal contacts MS DTC.</span></span> <span data-ttu-id="2d5ed-119">Der neue Prinzipalserver ist MS DTC jedoch nicht bekannt, deshalb beendet er alle Transaktionen, für die "ein Commit vorbereitet wird", für die in anderen Datenbanken jedoch bereits anscheinend ein Commit ausgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="2d5ed-119">But MS DTC has no knowledge of the new principal server, and it terminates any transactions that are "preparing to commit," which are considered committed in other databases.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="2d5ed-120">Eine SQL Server-Installation wird auch unterstützt, wenn Datenbankspiegelungsfunktionen oder Verfügbarkeitsgruppen zusammen mit DTC verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="2d5ed-120">Using Database Mirroring or Availability Groups together with DTC does not result in an unsupported SQL Server installation.</span></span> <span data-ttu-id="2d5ed-121">Wenn eine Datenbank jedoch Teil einer Datenbank-Spiegelungssitzung ist oder eine Verfügbarkeitsgruppe und DTC ebenfalls in der Datenbank verwendet werden, geht Microsoft Supportproblemen nur dann nach, wenn sie nicht in Zusammenhang mit der kombinierten Verwendung der Datenbankspiegelungsfunktionen oder Verfügbarkeitsgruppen mit DTC stehen.</span><span class="sxs-lookup"><span data-stu-id="2d5ed-121">If, however, a database is part of a Database Mirroring session or an Availability Group and DTC is also used in the database, support issues will be investigated by Microsoft only if unrelated to the combined use of Database Mirroring or Availability Groups with DTC.</span></span>  
  
  

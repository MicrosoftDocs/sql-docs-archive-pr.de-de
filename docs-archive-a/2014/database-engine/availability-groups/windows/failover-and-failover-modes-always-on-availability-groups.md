---
title: Failover-und Failovermodi (AlwaysOn-Verfügbarkeitsgruppen) | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- Availability Groups [SQL Server], availability replicas
- Availability Groups [SQL Server], failover
- Availability Groups [SQL Server], failover modes
- failover [SQL Server], AlwaysOn Availability Groups
ms.assetid: 378d2d63-50b9-420b-bafb-d375543fda17
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: eb904cd0f0649c43553b5d6c8b031c5f284901f4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87617285"
---
# <a name="failover-and-failover-modes-alwayson-availability-groups"></a><span data-ttu-id="64886-102">Failover und Failovermodi (AlwaysOn-Verfügbarkeitsgruppen)</span><span class="sxs-lookup"><span data-stu-id="64886-102">Failover and Failover Modes (AlwaysOn Availability Groups)</span></span>
  <span data-ttu-id="64886-103">Im Kontext einer Verfügbarkeitsgruppe können die primäre und die sekundäre Rolle von Verfügbarkeitsreplikaten normalerweise im Rahmen des so genannten *Failovers*ausgetauscht werden.</span><span class="sxs-lookup"><span data-stu-id="64886-103">Within the context of an availability group, the primary role and secondary role of availability replicas are typically interchangeable in a process known as *failover*.</span></span> <span data-ttu-id="64886-104">Failover können in drei Formen auftreten: automatisches Failover (ohne Datenverlust), geplantes manuelles Failover (ohne Datenverlust) und erzwungenes manuelles Failover (mit möglichem Datenverlust), welches in der Regel *erzwungenes Failover*genannt wird.</span><span class="sxs-lookup"><span data-stu-id="64886-104">Three forms of failover exist: automatic failover (without data loss), planned manual failover (without data loss), and forced manual failover (with possible data loss), typically called *forced failover*.</span></span> <span data-ttu-id="64886-105">Beim automatischen und geplanten manuellen Failover bleiben alle Daten erhalten.</span><span class="sxs-lookup"><span data-stu-id="64886-105">Automatic and planned manual failover preserve all your data.</span></span> <span data-ttu-id="64886-106">Eine Verfügbarkeitsgruppe führt ein Failover auf der Ebene des Verfügbarkeitsreplikats aus.</span><span class="sxs-lookup"><span data-stu-id="64886-106">An availability group fails over at the availability-replica level.</span></span> <span data-ttu-id="64886-107">Das heißt, eine Verfügbarkeitsgruppe führt ein Failover auf eines ihrer sekundären Replikate (das aktuelle *Failoverziel*) aus.</span><span class="sxs-lookup"><span data-stu-id="64886-107">That is, an availability group fails over to one of its secondary replicas (the current *failover target*).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="64886-108">Probleme auf Datenbankebene, z. B. wenn eine Datenbank aufgrund des Verlusts einer Datendatei fehlerverdächtig wird, eine Datenbank gelöscht oder ein Transaktionsprotokoll beschädigt wird, führen nicht zum Failover einer Verfügbarkeitsgruppe.</span><span class="sxs-lookup"><span data-stu-id="64886-108">Issues at the database level, such as a database becoming suspect due to the loss of a data file, deletion of a database, or corruption of a transaction log, do not cause an availability group to failover.</span></span>  
  
 <span data-ttu-id="64886-109">Während des Failovers übernimmt das Failoverziel die primäre Rolle, stellt die zugehörigen Datenbanken wieder her und schaltet sie als neue primäre Datenbanken online.</span><span class="sxs-lookup"><span data-stu-id="64886-109">During the failover, the failover target takes over the primary role, recovers its databases, and brings them online as the new primary databases.</span></span> <span data-ttu-id="64886-110">Das frühere primäre Replikat (falls verfügbar) wechselt zur sekundären Rolle, und seine Datenbanken werden zu sekundären Datenbanken.</span><span class="sxs-lookup"><span data-stu-id="64886-110">The former primary replica, when available, switches to the secondary role, and its databases become secondary databases.</span></span> <span data-ttu-id="64886-111">Diese Rollen können in Reaktion auf wiederholte Fehler oder zu Verwaltungszwecken hin und her (bzw. zu einem anderen Failoverziel) gewechselt werden.</span><span class="sxs-lookup"><span data-stu-id="64886-111">Potentially, these roles can switch back and forth (or to a different failover target) in response to multiple failures or for administrative purposes.</span></span>  
  
 <span data-ttu-id="64886-112">Die von den einzelnen Verfügbarkeitsreplikaten unterstützten Failoverformen werden von der Eigenschaft *Failovermodus* angegeben.</span><span class="sxs-lookup"><span data-stu-id="64886-112">The form(s) of failover that a given availability replica supports is specified by the *failover mode* property.</span></span> <span data-ttu-id="64886-113">Die für die einzelnen Verfügbarkeitsreplikate möglichen Failovermodi hängen wie folgt vom [Verfügbarkeitsmodus](availability-modes-always-on-availability-groups.md) des Replikats ab:</span><span class="sxs-lookup"><span data-stu-id="64886-113">For a given availability replica, the possible failover modes depends on the [availability mode](availability-modes-always-on-availability-groups.md) of the replica, as follows:</span></span>  
  
-   <span data-ttu-id="64886-114">**Replikate mit synchronem Commit** unterstützen zwei Einstellungen: automatisch oder manuell.</span><span class="sxs-lookup"><span data-stu-id="64886-114">**Synchronous-commit replicas** support two settings-automatic or manual.</span></span> <span data-ttu-id="64886-115">Die "automatische" Einstellung unterstützt sowohl automatisches Failover als auch manuelles Failover.</span><span class="sxs-lookup"><span data-stu-id="64886-115">The "automatic" setting supports both automatic failover and manual failover.</span></span> <span data-ttu-id="64886-116">Um Datenverluste zu vermeiden, muss das Failoverziel beim automatischen und geplanten Failover ein sekundäres Replikat mit synchronem Commit und fehlerfreiem Synchronisierungsstatus sein (was darauf hinweist, dass jede sekundäre Datenbank auf dem Failoverziel mit der entsprechenden primären Datenbank synchronisiert ist).</span><span class="sxs-lookup"><span data-stu-id="64886-116">To prevent data loss, automatic failover and planned failover require that the failover target be a synchronous-commit secondary replica with a healthy synchronization state (this indicates that every secondary database on the failover target is synchronized with its corresponding primary database).</span></span> <span data-ttu-id="64886-117">Wenn ein sekundäres Replikat keine dieser Bedingungen erfüllt, unterstützt es stets nur ein erzwungenes Failover.</span><span class="sxs-lookup"><span data-stu-id="64886-117">Whenever a secondary replica does not meet both of these conditions, it supports only forced failover.</span></span> <span data-ttu-id="64886-118">Beachten Sie, dass erzwungene Failover auch von Replikaten unterstützt werden, deren Rolle sich im RESOLVING-Status befindet.</span><span class="sxs-lookup"><span data-stu-id="64886-118">Note that forced failover is also supported a replicas whose role is in the RESOLVING state.</span></span>  
  
-   <span data-ttu-id="64886-119">**Replikate mit asynchronem Commit** unterstützen nur den manuellen Failovermodus.</span><span class="sxs-lookup"><span data-stu-id="64886-119">**Asynchronous-commit replicas** support only the manual failover mode.</span></span> <span data-ttu-id="64886-120">Da sie nie synchronisiert werden, unterstützen sie nur erzwungene Failover.</span><span class="sxs-lookup"><span data-stu-id="64886-120">Moreover, because they are never synchronized, they support only forced failover.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="64886-121">Nach einem Failover müssen Clientanwendungen, die auf die primären Datenbanken zugreifen müssen, eine Verbindung mit dem neuen primären Replikat herstellen.</span><span class="sxs-lookup"><span data-stu-id="64886-121">After a failover, client applications that need to access the primary databases must connect to the new primary replica.</span></span> <span data-ttu-id="64886-122">Außerdem können schreibgeschützte Clientanwendungen, wenn das neue sekundäre Replikat für den schreibgeschützten Zugriff konfiguriert ist, eine Verbindung mit dem Replikat herstellen.</span><span class="sxs-lookup"><span data-stu-id="64886-122">Also, if the new secondary replica is configured to allow read-only access, read-only client applications can connect to it.</span></span> <span data-ttu-id="64886-123">Weitere Informationen dazu, wie Clients eine Verbindung zu Verfügbarkeitsgruppen herstellen, finden Sie unter [Verfügbarkeitsgruppenlistener, Clientkonnektivität und Anwendungsfailover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span><span class="sxs-lookup"><span data-stu-id="64886-123">For information about how clients connect to an availability group, see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span></span>  
  
  
##  <a name="terms-and-definitions"></a><a name="TermsAndDefinitions"></a> <span data-ttu-id="64886-124">Begriffe und Definitionen</span><span class="sxs-lookup"><span data-stu-id="64886-124">Terms and Definitions</span></span>  
 <span data-ttu-id="64886-125">Automatisches Failover</span><span class="sxs-lookup"><span data-stu-id="64886-125">Automatic failover</span></span>  
 <span data-ttu-id="64886-126">Beim Verlust des primären Replikats tritt automatisch ein Failover statt.</span><span class="sxs-lookup"><span data-stu-id="64886-126">A failover that occurs automatically on the loss of the primary replica.</span></span> <span data-ttu-id="64886-127">Automatisches Failover wird nur unterstützt, wenn das aktuelle primäre Replikat und ein sekundäres Replikat so konfiguriert sind, dass der Failovermodus auf AUTOMATIC festgelegt ist und das sekundäre Replikat derzeit synchronisiert wird.</span><span class="sxs-lookup"><span data-stu-id="64886-127">Automatic failover is supported only when the current primary and one secondary replica are both configured with failover mode set to AUTOMATIC and the secondary replica currently synchronized.</span></span>  <span data-ttu-id="64886-128">Wenn der Failovermodus entweder des primären oder des sekundären Replikats MANUAL ist, kann kein automatisches Failover auftreten.</span><span class="sxs-lookup"><span data-stu-id="64886-128">If the failover mode of either the primary or secondary replica is MANUAL, automatic failover cannot occur.</span></span>  
  
 <span data-ttu-id="64886-129">Geplantes manuelles Failover (ohne Datenverlust)</span><span class="sxs-lookup"><span data-stu-id="64886-129">Planned manual failover (without data loss)</span></span>  
 <span data-ttu-id="64886-130">Ein geplantes manuelles Failover oder *manuelles Failover*ist ein Failover, das in der Regel von einem Datenbankadministrator zu administrativen Zwecken initiiert wird.</span><span class="sxs-lookup"><span data-stu-id="64886-130">Planned manual failover, or *manual failover*, is a failover that is initiated by a database administrator, typically, for administrative purposes.</span></span> <span data-ttu-id="64886-131">Ein geplantes manuelles Failover wird nur unterstützt, wenn sowohl das primäre Replikat als auch das sekundäre Replikat für den Modus mit synchronem Commit konfiguriert sind und das sekundäre Replikat derzeit synchronisiert wird (im Status SYNCHRONIZED).</span><span class="sxs-lookup"><span data-stu-id="64886-131">A planned manual failover is supported only if both the primary replica and secondary replica are configured for synchronous-commit mode and the secondary replica is currently synchronized (in the SYNCHRONIZED state).</span></span> <span data-ttu-id="64886-132">Wenn das sekundäre Zielreplikat synchronisiert ist, ist ein manuelles Failover (ohne Datenverlust) selbst bei einem Absturz des primären Replikats möglich, da die sekundären Datenbanken für ein Failover bereit sind.</span><span class="sxs-lookup"><span data-stu-id="64886-132">When the target secondary replica is synchronized, manual failover (without data loss) is possible even if the primary replica has crashed because the secondary databases are ready for failover.</span></span> <span data-ttu-id="64886-133">Ein Datenbankadministrator initiiert manuell ein manuelles Failover.</span><span class="sxs-lookup"><span data-stu-id="64886-133">A database administrator manually initiates a manual failover.</span></span>  
  
 <span data-ttu-id="64886-134">Erzwungenes Failover (mit möglichem Datenverlust)</span><span class="sxs-lookup"><span data-stu-id="64886-134">Forced failover (with possible data loss)</span></span>  
 <span data-ttu-id="64886-135">Ein Failover, das von einem Datenbankadministrator initiiert werden kann, wenn kein sekundäres Replikat mit dem primären Replikat SYNCHRONISIERT ist oder das primäre Replikat nicht ausgeführt wird und kein sekundäres Replikat für ein Failover bereit ist.</span><span class="sxs-lookup"><span data-stu-id="64886-135">A failover that can be initiated by a database administrator when no secondary replica is SYNCHRONIZED with the primary replica or the primary replica is not running and no secondary replica is failover ready.</span></span> <span data-ttu-id="64886-136">Ein erzwungenes Failover birgt das Risiko möglicher Datenverluste und sollte nur für die Notfallwiederherstellung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="64886-136">Forced failover risks possible data loss and is recommended strictly for disaster recovery.</span></span> <span data-ttu-id="64886-137">Erzwungenes Failover ist auch als erzwungenes manuelles Failover bekannt, da es nur manuell initiiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="64886-137">Forced failover is also known as forced manual failover because it can only be initiated manually.</span></span> <span data-ttu-id="64886-138">Dies ist der einzige Failovertyp, der im Verfügbarkeitsmodus für asynchrone Commits unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="64886-138">This is the only form of failover supported by in asynchronous-commit availability mode.</span></span>  
  
 [!INCLUDE[ssFosAutoC](../../../includes/ssfosautoc-md.md)]  
 <span data-ttu-id="64886-139">Ein Paar von Verfügbarkeitsreplikaten (einschließlich des aktuellen primären Replikats) in einer Verfügbarkeitsgruppe, die für den synchronem Commitmodus mit automatischem Failover konfiguriert sind (sofern zutreffend).</span><span class="sxs-lookup"><span data-stu-id="64886-139">Within a given availability group, a pair of availability replicas (including the current primary replica) that are configured for synchronous-commit mode with automatic failover, if any.</span></span> <span data-ttu-id="64886-140">Ein[!INCLUDE[ssFosAuto](../../../includes/ssfosauto-md.md)]ist nur wirksam, wenn das sekundäre Replikat derzeit mit dem primären Replikat SYNCHRONISIERT wird.</span><span class="sxs-lookup"><span data-stu-id="64886-140">An[!INCLUDE[ssFosAuto](../../../includes/ssfosauto-md.md)]takes effect only if the secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
 [!INCLUDE[ssFosSyncC](../../../includes/ssfossyncc-md.md)]  
 <span data-ttu-id="64886-141">Ein Satz von zwei oder drei Verfügbarkeitsreplikaten (einschließlich des aktuellen primären Replikats) in einer Verfügbarkeitsgruppe, die für den synchronen Commitmodus (falls zutreffend) konfiguriert sind.</span><span class="sxs-lookup"><span data-stu-id="64886-141">Within a given availability group, a set of two or three availability replicas (including the current primary replica) that are configured for synchronous-commit mode, if any.</span></span> <span data-ttu-id="64886-142">Ein [!INCLUDE[ssFosSync](../../../includes/ssfossync-md.md)]wird nur wirksam, wenn die sekundären Replikate für den manuellen Failovermodus konfiguriert sind und mindestens ein sekundäres Replikat derzeit mit dem primären Replikat SYNCHRONISIERT ist.</span><span class="sxs-lookup"><span data-stu-id="64886-142">A [!INCLUDE[ssFosSync](../../../includes/ssfossync-md.md)]takes effect only if the secondary replicas are configured for manual failover mode and at least one secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
 [!INCLUDE[ssFosEntireC](../../../includes/ssfosentirec-md.md)]  
 <span data-ttu-id="64886-143">Innerhalb einer angegebenen Verfügbarkeitsgruppe der Satz aller Verfügbarkeitsreplikate, deren Betriebszustand gerade ONLINE ist, unabhängig vom Verfügbarkeitsmodus und Failovermodus.</span><span class="sxs-lookup"><span data-stu-id="64886-143">Within a given availability group, the set of all availability replicas whose operational state is currently ONLINE, regardless of availability mode and of failover mode.</span></span> <span data-ttu-id="64886-144">Der [!INCLUDE[ssFosEntire](../../../includes/ssfosentire-md.md)]wird relevant, wenn gerade kein sekundäres Replikat mit dem primären Replikat SYNCHRONISIERT wird.</span><span class="sxs-lookup"><span data-stu-id="64886-144">The [!INCLUDE[ssFosEntire](../../../includes/ssfosentire-md.md)]becomes relevant when no secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
##  <a name="overview-of-failover"></a><a name="Overview"></a> <span data-ttu-id="64886-145">Übersicht über Failover</span><span class="sxs-lookup"><span data-stu-id="64886-145">Overview of Failover</span></span>  
 <span data-ttu-id="64886-146">In der folgenden Tabelle ist zusammengefasst, welche Failovertypen unter unterschiedlichen Verfügbarkeits- und Failovermodi unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="64886-146">The following table summarizes which forms of failover are supported under different availability and failover modes.</span></span> <span data-ttu-id="64886-147">Für jede Paarung ergibt sich der effektive Verfügbarkeitsmodus und Failovermodus aus der Schnittmenge der Modi des primären Replikats sowie der Modi eines oder mehrerer sekundärer Replikate.</span><span class="sxs-lookup"><span data-stu-id="64886-147">For each pairing, the effective availability mode and failover mode is determined by the intersection of the modes of the primary replica plus the modes of one or more secondary replicas.</span></span>  
  
||<span data-ttu-id="64886-148">Asynchroner Commit-Modus</span><span class="sxs-lookup"><span data-stu-id="64886-148">Asynchronous-commit mode</span></span>|<span data-ttu-id="64886-149">Synchroner Commit-Modus mit manuellem Failovermodus</span><span class="sxs-lookup"><span data-stu-id="64886-149">Synchronous-commit mode with manual-failover mode</span></span>|<span data-ttu-id="64886-150">Synchroner Commit-Modus mit automatischem Failovermodus</span><span class="sxs-lookup"><span data-stu-id="64886-150">Synchronous-commit mode with automatic-failover mode</span></span>|  
|-|-------------------------------|---------------------------------------------------------|------------------------------------------------------------|  
|<span data-ttu-id="64886-151">Automatisches Failover</span><span class="sxs-lookup"><span data-stu-id="64886-151">Automatic failover</span></span>|<span data-ttu-id="64886-152">Nein</span><span class="sxs-lookup"><span data-stu-id="64886-152">No</span></span>|<span data-ttu-id="64886-153">Nein</span><span class="sxs-lookup"><span data-stu-id="64886-153">No</span></span>|<span data-ttu-id="64886-154">Ja</span><span class="sxs-lookup"><span data-stu-id="64886-154">Yes</span></span>|  
|<span data-ttu-id="64886-155">Geplantes manuelles Failover</span><span class="sxs-lookup"><span data-stu-id="64886-155">Planned manual failover</span></span>|<span data-ttu-id="64886-156">Nein</span><span class="sxs-lookup"><span data-stu-id="64886-156">No</span></span>|<span data-ttu-id="64886-157">Ja</span><span class="sxs-lookup"><span data-stu-id="64886-157">Yes</span></span>|<span data-ttu-id="64886-158">Ja</span><span class="sxs-lookup"><span data-stu-id="64886-158">Yes</span></span>|  
|<span data-ttu-id="64886-159">erzwungenes Failover</span><span class="sxs-lookup"><span data-stu-id="64886-159">Forced failover</span></span>|<span data-ttu-id="64886-160">Ja</span><span class="sxs-lookup"><span data-stu-id="64886-160">Yes</span></span>|<span data-ttu-id="64886-161">Ja</span><span class="sxs-lookup"><span data-stu-id="64886-161">Yes</span></span>|<span data-ttu-id="64886-162">Zwar**<sup>\*</sup>**</span><span class="sxs-lookup"><span data-stu-id="64886-162">Yes**<sup>\*</sup>**</span></span>|  
  
 <span data-ttu-id="64886-163">**<sup>\*</sup>** Wenn Sie einen Befehl für einen erzwungenen Failover für ein synchronisiertes sekundäres Replikat ausgeben, verhält sich das sekundäre Replikat genauso wie bei einem manuellen Failover.</span><span class="sxs-lookup"><span data-stu-id="64886-163">**<sup>\*</sup>**  If you issue a forced failover command on a synchronized secondary replica, the secondary replica behaves the same as for a manual failover.</span></span>  
  
 <span data-ttu-id="64886-164">Die Zeitdauer, für die Datenbank während eines Failovers nicht verfügbar ist, hängt vom Failovertyp und seiner Ursache ab.</span><span class="sxs-lookup"><span data-stu-id="64886-164">The amount of time that the database is unavailable during a failover depends on the type of failover and its cause.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="64886-165">Um Clientverbindungen außer für eigenständige Datenbanken nach dem Failover zu unterstützen, müssen auf einer früheren primären Datenbank definierte Anmeldungen und Aufträge für die neue primäre Datenbank manuell neu erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="64886-165">To support client connections after failover, except for contained databases, logins and jobs defined on any of the former primary databases must be manually recreated on the new primary database.</span></span> <span data-ttu-id="64886-166">Weitere Informationen finden Sie unter [Verwaltung von Anmeldungen und Aufträgen für die Datenbanken einer Verfügbarkeitsgruppe &#40;SQL Server&#41;](../../logins-and-jobs-for-availability-group-databases.md)ausgetauscht werden.</span><span class="sxs-lookup"><span data-stu-id="64886-166">For more information, see [Management of Logins and Jobs for the Databases of an Availability Group &#40;SQL Server&#41;](../../logins-and-jobs-for-availability-group-databases.md).</span></span>  
  
### <a name="failover-sets"></a><span data-ttu-id="64886-167">Failoversätze</span><span class="sxs-lookup"><span data-stu-id="64886-167">Failover Sets</span></span>  
 <span data-ttu-id="64886-168">Welche Failoverarten für eine bestimmte Verfügbarkeitsgruppe möglich sind, richtet sich nach dem jeweiligen Failoversatz.</span><span class="sxs-lookup"><span data-stu-id="64886-168">The forms of failover that are possible for a given availability group can be understood in terms of failover sets.</span></span> <span data-ttu-id="64886-169">Ein Failoversatz besteht aus dem primären Replikat und den sekundären Replikaten, die eine bestimmte, im Folgenden beschriebene Failoverart unterstützen:</span><span class="sxs-lookup"><span data-stu-id="64886-169">A failover set consists of the primary replica and secondary replicas that support a given form of failover, as follows:</span></span>  
  
-   <span data-ttu-id="64886-170">**[!INCLUDE[ssFosAutoC](../../../includes/ssfosautoc-md.md)] (optional):**  Ein Paar von Verfügbarkeitsreplikaten (einschließlich des aktuellen primären Replikats) in einer Verfügbarkeitsgruppe, die für den synchronem Commitmodus mit automatischem Failover konfiguriert sind (sofern zutreffend).</span><span class="sxs-lookup"><span data-stu-id="64886-170">**[!INCLUDE[ssFosAutoC](../../../includes/ssfosautoc-md.md)] (optional):**  Within a given availability group, a pair of availability replicas (including the current primary replica) that are configured for synchronous-commit mode with automatic failover, if any.</span></span> <span data-ttu-id="64886-171">Ein automatisches Failover ist nur wirksam, wenn das sekundäre Replikat derzeit mit dem primären Replikat synchronisiert wird.</span><span class="sxs-lookup"><span data-stu-id="64886-171">An automatic failover set takes effect only if the secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
-   <span data-ttu-id="64886-172">**[!INCLUDE[ssFosSyncC](../../../includes/ssfossyncc-md.md)] (optional):**  Ein Satz von zwei oder drei Verfügbarkeitsreplikaten (einschließlich des aktuellen primären Replikats) in einer Verfügbarkeitsgruppe, die für den synchronen Commitmodus (falls zutreffend) konfiguriert sind.</span><span class="sxs-lookup"><span data-stu-id="64886-172">**[!INCLUDE[ssFosSyncC](../../../includes/ssfossyncc-md.md)] (optional):**  Within a given availability group, a set of two or three availability replicas (including the current primary replica) that are configured for synchronous-commit mode, if any.</span></span> <span data-ttu-id="64886-173">Ein Failover mit synchronem Commit ist nur wirksam, wenn die sekundären Replikate für den manuellen Failovermodus konfiguriert sind und mindestens ein sekundäres Replikat derzeit mit dem primären Replikat synchronisiert wird.</span><span class="sxs-lookup"><span data-stu-id="64886-173">A synchronous-commit failover set takes effect only if the secondary replicas are configured for manual failover mode and at least one secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
-   <span data-ttu-id="64886-174">**[!INCLUDE[ssFosEntireC](../../../includes/ssfosentirec-md.md)]:**  Innerhalb einer angegebenen Verfügbarkeitsgruppe der Satz aller Verfügbarkeitsreplikate, deren Betriebszustand gerade ONLINE ist, unabhängig vom Verfügbarkeitsmodus und Failovermodus.</span><span class="sxs-lookup"><span data-stu-id="64886-174">**[!INCLUDE[ssFosEntireC](../../../includes/ssfosentirec-md.md)] :**  Within a given availability group, the set of all availability replicas whose operational state is currently ONLINE, regardless of availability mode and of failover mode.</span></span> <span data-ttu-id="64886-175">Der Satz für gesamtes Failover wird relevant, wenn derzeit kein sekundäres Replikat mit dem primären Replikat synchronisiert wird.</span><span class="sxs-lookup"><span data-stu-id="64886-175">The entire failover set becomes relevant when no secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
 <span data-ttu-id="64886-176">Wenn Sie ein Verfügbarkeitsreplikat für synchrone Commits mit automatischem Failover konfigurieren, wird das Verfügbarkeitsreplikat Teil von [!INCLUDE[ssFosAuto](../../../includes/ssfosauto-md.md)].</span><span class="sxs-lookup"><span data-stu-id="64886-176">When you configure an availability replica as synchronous commit with automatic failover, the availability replica becomes part of the [!INCLUDE[ssFosAuto](../../../includes/ssfosauto-md.md)].</span></span> <span data-ttu-id="64886-177">Ob jedoch der Satz wirksam wird, hängt vom aktuellen primären Element ab.</span><span class="sxs-lookup"><span data-stu-id="64886-177">However whether the set takes effect depends the current primary.</span></span> <span data-ttu-id="64886-178">Die Failovertypen, die tatsächlich zu einem bestimmten Zeitpunkt möglich sind, hängen davon ab, welche Failoversätze aktuell wirksam sind.</span><span class="sxs-lookup"><span data-stu-id="64886-178">The forms of failover that are actually possible at a given time depends on what failover sets are currently in effect.</span></span>  
  
 <span data-ttu-id="64886-179">Betrachten Sie z. B. eine Verfügbarkeitsgruppe mit vier Verfügbarkeitsreplikaten:</span><span class="sxs-lookup"><span data-stu-id="64886-179">For example, consider an availability group that has four availability replicas, as follows:</span></span>  
  
|<span data-ttu-id="64886-180">Replikat</span><span class="sxs-lookup"><span data-stu-id="64886-180">Replica</span></span>|<span data-ttu-id="64886-181">Verfügbarkeitsmodus- und Failovermodus-Einstellungen</span><span class="sxs-lookup"><span data-stu-id="64886-181">Availability Mode and Failover Mode Settings</span></span>|  
|-------------|--------------------------------------------------|  
|<span data-ttu-id="64886-182">Ein</span><span class="sxs-lookup"><span data-stu-id="64886-182">A</span></span>|<span data-ttu-id="64886-183">Synchroner Commit mit automatischem Failover</span><span class="sxs-lookup"><span data-stu-id="64886-183">Synchronous commit with automatic failover</span></span>|  
|<span data-ttu-id="64886-184">B</span><span class="sxs-lookup"><span data-stu-id="64886-184">B</span></span>|<span data-ttu-id="64886-185">Synchroner Commit mit automatischem Failover</span><span class="sxs-lookup"><span data-stu-id="64886-185">Synchronous commit with automatic failover</span></span>|  
|<span data-ttu-id="64886-186">C</span><span class="sxs-lookup"><span data-stu-id="64886-186">C</span></span>|<span data-ttu-id="64886-187">Synchroner Commit nur mit geplantem manuellem Failover</span><span class="sxs-lookup"><span data-stu-id="64886-187">Synchronous commit with planned manual failover only</span></span>|  
|<span data-ttu-id="64886-188">D</span><span class="sxs-lookup"><span data-stu-id="64886-188">D</span></span>|<span data-ttu-id="64886-189">Asynchroner Commit (nur mit erzwungenem Failover)</span><span class="sxs-lookup"><span data-stu-id="64886-189">Asynchronous commit (with only forced failover)</span></span>|  
  
 <span data-ttu-id="64886-190">Das Failoververhalten für jedes sekundäre Replikat hängt davon ab, welches Verfügbarkeitsreplikat gerade das primäre Replikat ist.</span><span class="sxs-lookup"><span data-stu-id="64886-190">The failover behavior for each secondary replica depends on which availability replica is currently the primary replica.</span></span> <span data-ttu-id="64886-191">Grundsätzlich ist für ein bestimmtes sekundäres Replikat das Failoververhalten der schlimmste Fall angesichts des aktuellen primären Replikats.</span><span class="sxs-lookup"><span data-stu-id="64886-191">Basically, for a given secondary replica, the failover behavior is the worst case given the current primary replica.</span></span> <span data-ttu-id="64886-192">In der folgenden Abbildung wird veranschaulicht, wie das Failoververhalten des sekundären Replikats in Abhängigkeit des aktuellen primären Replikats variiert und ob es für den asynchronen (nur mit erzwungenem Failover) oder den synchronen Commit-Modus (mit oder ohne manuellem Failover) konfiguriert ist.</span><span class="sxs-lookup"><span data-stu-id="64886-192">The following figure illustrates how the failover behavior of secondary replicas varies depending on the current primary replica, and whether it is configured for asynchronous-commit mode (with only forced failover) or synchronous-commit mode (with or without automatic failover).</span></span>  
  
 <span data-ttu-id="64886-193">![Wie sich die Konfiguration des primären Replikats auf das Failover auswirkt](../../media/aoag-failoversetexample.gif "Wie sich die Konfiguration des primären Replikats auf das Failover auswirkt")</span><span class="sxs-lookup"><span data-stu-id="64886-193">![How primary replica configuration affects failover](../../media/aoag-failoversetexample.gif "How primary replica configuration affects failover")</span></span>  
  
##  <a name="automatic-failover"></a><a name="AutomaticFailover"></a> <span data-ttu-id="64886-194">Automatic Failover</span><span class="sxs-lookup"><span data-stu-id="64886-194">Automatic Failover</span></span>  
 <span data-ttu-id="64886-195">Ein automatisches Failover verursacht den automatischen Übergang eines qualifizierten sekundären Replikats zur primären Rolle, nachdem das primäre Replikat nicht mehr zur Verfügung steht.</span><span class="sxs-lookup"><span data-stu-id="64886-195">An automatic failover causes a qualified secondary replica to automatically transition to the primary role after the primary replica becomes unavailable.</span></span> <span data-ttu-id="64886-196">Ein automatisches Failover ist am besten geeignet, wenn der WSFC-Knoten, der das primäre Replikat hostet, lokal zum Knoten ist, der das sekundäre Replikat hostet.</span><span class="sxs-lookup"><span data-stu-id="64886-196">Automatic failover is best suited when the WSFC node that hosts the primary replica is local to the node that hosts the secondary replica.</span></span> <span data-ttu-id="64886-197">Das liegt daran, dass die Datensynchronisierung am besten bei niedrigen Nachrichtenlatenzzeiten zwischen Computern funktioniert und weil Clientverbindungen lokal hergestellt werden können.</span><span class="sxs-lookup"><span data-stu-id="64886-197">This is because data synchronization works best with low message latency between computers and because client connections can remain local.</span></span>  
  
  
###  <a name="conditions-required-for-an-automatic-failover"></a><a name="RequiredConditions"></a> <span data-ttu-id="64886-198">Für ein automatisches Failover erforderliche Bedingungen</span><span class="sxs-lookup"><span data-stu-id="64886-198">Conditions Required for an Automatic Failover</span></span>  
 <span data-ttu-id="64886-199">Ein automatisches Failover tritt nur unter den folgenden Bedingungen auf:</span><span class="sxs-lookup"><span data-stu-id="64886-199">Automatic failover occurs only under the following conditions:</span></span>  
  
-   <span data-ttu-id="64886-200">Ein Satz für automatische Failover ist vorhanden.</span><span class="sxs-lookup"><span data-stu-id="64886-200">An automatic failover set exists.</span></span> <span data-ttu-id="64886-201">Dieser Satz besteht aus einem primären und einem sekundären Replikat (dem *Ziel des automatischen Failovers*), die beide für den synchronen Commitmodus konfiguriert sind und auf ein automatisches Failover (AUTOMATIC) festgelegt sind.</span><span class="sxs-lookup"><span data-stu-id="64886-201">This set consists of a primary replica and a secondary replica (the *automatic failover target*) that are both configured for synchronous-commit mode and set to AUTOMATIC failover.</span></span> <span data-ttu-id="64886-202">HYPERLINK „file:///C:\\\Users\\\marshow\\\AppData\\\Local\\\Temp\\\DxEditor\\\DduePreview\\Default\\\6fe88e12-4df1-4025-ba24-7579635ccecf\\\HTM\\\html\\\29e0ac5d-eb58-4801-82b9-e278f08db920“ Wenn das primäre Replikat auf MANUELLES Failover festgelegt ist, kann automatisches Failover nicht auftreten, auch wenn ein sekundäres Replikat auf AUTOMATISCHES Failover festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="64886-202">HYPERLINK "file:///C:\\\Users\\\marshow\\\AppData\\\Local\\\Temp\\\DxEditor\\\DduePreview\\\Default\\\6fe88e12-4df1-4025-ba24-7579635ccecf\\\HTM\\\html\\\29e0ac5d-eb58-4801-82b9-e278f08db920"  If the primary replica is set MANUAL failover, automatic failover cannot occur, even if a secondary replica is set to AUTOMATIC failover.</span></span>  
  
     <span data-ttu-id="64886-203">Weitere Informationen finden Sie unter [Verfügbarkeitsmodi &#40;AlwaysOn-Verfügbarkeitsgruppen&#41;](availability-modes-always-on-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="64886-203">For more information, see [Availability Modes &#40;AlwaysOn Availability Groups&#41;](availability-modes-always-on-availability-groups.md).</span></span>  
  
-   <span data-ttu-id="64886-204">Das Ziel des automatischen Failovers weist einen fehlerfreien Synchronisierungsstatus auf (das heißt, dass jede sekundäre Datenbank im Failoverziel mit ihrer entsprechenden primären Datenbank synchronisiert wird).</span><span class="sxs-lookup"><span data-stu-id="64886-204">The automatic failover target has a healthy synchronization state (this indicates that every secondary database on the failover target is synchronized with its corresponding primary database).</span></span>  
  
    > [!TIP]  
    >  <span data-ttu-id="64886-205">Durch AlwaysOn-Verfügbarkeitsgruppen wird der Zustand beider Replikate in einem Satz für automatische Failover überwacht.</span><span class="sxs-lookup"><span data-stu-id="64886-205">AlwaysOn Availability Groups monitors the health of both replicas in an automatic failover set.</span></span> <span data-ttu-id="64886-206">Wenn eines der Replikate fehlerhaft ist, wird der Zustand der Verfügbarkeitsgruppe auf CRITICAL festgelegt.</span><span class="sxs-lookup"><span data-stu-id="64886-206">If either replica fails, the availability group's health state is set to CRITICAL.</span></span> <span data-ttu-id="64886-207">Wenn das sekundäre Replikat fehlerhaft ist, kann kein automatisches Failover ausgeführt werden, da das Ziel für das automatische Failover nicht verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="64886-207">If the secondary replica fails, automatic failover is not possible because the automatic failover target is unavailable.</span></span> <span data-ttu-id="64886-208">Wenn das primäre Replikat fehlerhaft ist, wird für die Verfügbarkeitsgruppe ein Failover auf das sekundäre Replikat ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="64886-208">If the primary replica fails, the availability group will fail over to the secondary replica.</span></span> <span data-ttu-id="64886-209">Für das automatische Failover ist erst wieder ein Ziel verfügbar, nachdem das vorherige primäre Replikat online geschaltet wurde.</span><span class="sxs-lookup"><span data-stu-id="64886-209">Until the former primary replica comes online, no automatic failover target exists.</span></span> <span data-ttu-id="64886-210">Um für den unwahrscheinlichen Fall, dass ein Folgefehler auftritt, in beiden Situationen Verfügbarkeit zu gewährleisten, wird empfohlen, ein anderes sekundäres Replikat als Ziel für das automatische Failover zu konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="64886-210">In either case, to ensure availability in the unlikely case of a sequential failure, we recommend that you configure a different secondary replica as the automatic failover target.</span></span>  
    >   
    >  <span data-ttu-id="64886-211">Weitere Informationen finden Sie unter [Verwenden von AlwaysOn-Richtlinien zum Anzeigen des Zustands einer Verfügbarkeitsgruppe &#40;SQL Server&#41;](use-always-on-policies-to-view-the-health-of-an-availability-group-sql-server.md) und [Ändern des Failovermodus eines Verfügbarkeitsreplikats &#40;SQL Server&#41;](change-the-failover-mode-of-an-availability-replica-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="64886-211">For more information, see [Use AlwaysOn Policies to View the Health of an Availability Group &#40;SQL Server&#41;](use-always-on-policies-to-view-the-health-of-an-availability-group-sql-server.md) and [Change the Failover Mode of an Availability Replica &#40;SQL Server&#41;](change-the-failover-mode-of-an-availability-replica-sql-server.md).</span></span>  
  
-   <span data-ttu-id="64886-212">Der WSFC-Cluster (Windows Server Failover Clustering) verfügt über ein Quorum.</span><span class="sxs-lookup"><span data-stu-id="64886-212">The Windows Server Failover Clustering (WSFC) cluster has quorum.</span></span> <span data-ttu-id="64886-213">Weitere Informationen finden Sie unter [WSFC-Quorummodi und Abstimmungskonfiguration &#40;SQL Server&#41;](../../../sql-server/failover-clusters/windows/wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="64886-213">For more information, see [WSFC Quorum Modes and Voting Configuration &#40;SQL Server&#41;](../../../sql-server/failover-clusters/windows/wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span></span>  
  
-   <span data-ttu-id="64886-214">Das primäre Replikat steht nicht mehr zur Verfügung, und die durch die flexible Failoverrichtlinie definierten Failover-Bedingungsebenen wurden erfüllt.</span><span class="sxs-lookup"><span data-stu-id="64886-214">The primary replica has become unavailable, and the failover-condition levels defined by your the flexible failover policy have been met.</span></span> <span data-ttu-id="64886-215">Informationen zu Failover-Bedingungsebenen finden Sie unter [Flexible Failoverrichtlinie für automatisches Failover einer Verfügbarkeitsgruppe &#40;SQL Server&#41;](flexible-automatic-failover-policy-availability-group.md)ausgetauscht werden.</span><span class="sxs-lookup"><span data-stu-id="64886-215">For information about failover-condition levels, see [Flexible Failover Policy for Automatic Failover of an Availability Group &#40;SQL Server&#41;](flexible-automatic-failover-policy-availability-group.md).</span></span>  
  
###  <a name="how-automatic-failover-works"></a><a name="HowAutoFoWorks"></a> <span data-ttu-id="64886-216">So funktioniert ein automatisches Failover</span><span class="sxs-lookup"><span data-stu-id="64886-216">How Automatic Failover Works</span></span>  
 <span data-ttu-id="64886-217">Durch ein automatisches Failover wird die folgende Aktionskette ausgelöst:</span><span class="sxs-lookup"><span data-stu-id="64886-217">An automatic failover initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="64886-218">Wenn die Serverinstanz, die das aktuelle primäre Replikat hostet, immer noch ausgeführt wird, ändert sie den Status der primären Datenbanken in DISCONNECTED und trennt alle Clientverbindungen.</span><span class="sxs-lookup"><span data-stu-id="64886-218">If the server instance that is hosting the current primary replica is still running, it changes the state of the primary databases to DISCONNECTED and disconnects all clients.</span></span>  
  
2.  <span data-ttu-id="64886-219">Wenn Protokolldatensätze in Wiederherstellungswarteschlangen auf dem sekundären Zielreplikat warten, wendet das sekundäre Replikat die verbleibenden Protokolldatensätze an, um das Rollforward der sekundären Datenbanken fertig zu stellen.</span><span class="sxs-lookup"><span data-stu-id="64886-219">If any log records are waiting in recovery queues on the target secondary replica, the secondary replica applies the remaining log records to finish rolling forward the secondary databases.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="64886-220">Die zum Anwenden des Protokolls auf eine bestimmte Datenbank erforderliche Zeit hängt von der Systemgeschwindigkeit, der aktuellen Arbeitsauslastung und der Menge an Protokollen in der Wiederherstellungswarteschlange ab.</span><span class="sxs-lookup"><span data-stu-id="64886-220">The amount of time required to apply the log to a given database depends on the speed of the system, the recent work load, and the amount of log in the recovery queue.</span></span>  
  
3.  <span data-ttu-id="64886-221">Das frühere sekundäre Replikat geht in die primäre Rolle über.</span><span class="sxs-lookup"><span data-stu-id="64886-221">The former secondary replica transitions to the primary role.</span></span> <span data-ttu-id="64886-222">Seine Datenbanken werden die primären Datenbanken.</span><span class="sxs-lookup"><span data-stu-id="64886-222">Its databases become the primary databases.</span></span> <span data-ttu-id="64886-223">Das neue primäre Replikat führt so schnell wie möglich ein Rollback für alle Transaktionen aus, für die kein Commit ausgeführt wurde (die Rollbackphase der Wiederherstellung).</span><span class="sxs-lookup"><span data-stu-id="64886-223">The new primary replica rolls back any uncommitted transactions (the undo phase of recovery) as quickly as possible.</span></span> <span data-ttu-id="64886-224">Diese Transaktionen, für die kein Commit ausgeführt wurde, werden durch Sperren isoliert und ermöglichen ein Rollback im Hintergrund, während Clients die Datenbank verwenden.</span><span class="sxs-lookup"><span data-stu-id="64886-224">Locks isolate these uncommitted transactions, allowing roll back to occur in the background while clients use the database.</span></span> <span data-ttu-id="64886-225">Für Transaktionen, für die ein Commit ausgeführt wurde, wird dabei kein Rollback durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="64886-225">This process does not roll back any committed transactions.</span></span>  
  
     <span data-ttu-id="64886-226">Bis eine angegebene sekundäre Datenbank verbunden wird, ist sie kurzfristig als NOT_SYNCHRONIZED markiert.</span><span class="sxs-lookup"><span data-stu-id="64886-226">Until a given secondary database is connected, it is briefly marked as NOT_SYNCHRONIZED.</span></span> <span data-ttu-id="64886-227">Bevor die Rollbackwiederherstellung gestartet wird, können sekundäre Datenbanken eine Verbindung mit den neuen primären Datenbanken herstellen und schnell in den Status SYNCHRONIZED übergehen.</span><span class="sxs-lookup"><span data-stu-id="64886-227">Before the rollback recovery starts, secondary databases can connect to the new primary databases and quickly transition to the SYNCHRONIZED state.</span></span> <span data-ttu-id="64886-228">Der Idealfall für ein drittes Replikat mit synchronem Commit besteht normalerweise darin, dass das Replikat nach dem Failover in der sekundären Rolle verbleibt.</span><span class="sxs-lookup"><span data-stu-id="64886-228">The best case is usually for a third synchronous-commit replica that remains in the secondary role after the failover.</span></span>  
  
4.  <span data-ttu-id="64886-229">Später, wenn die Serverinstanz, die das frühere primäre Replikat hostet, neu gestartet wird, erkennt sie, dass jetzt ein anderes Verfügbarkeitsreplikat die primäre Rolle besitzt.</span><span class="sxs-lookup"><span data-stu-id="64886-229">Later, when the server instance that is hosting the former primary replica restarts, it recognizes that another availability replica now owns the primary role.</span></span> <span data-ttu-id="64886-230">Das frühere primäre Replikat geht in die sekundäre Rolle über, und seine Datenbanken werden sekundäre Datenbanken.</span><span class="sxs-lookup"><span data-stu-id="64886-230">The former primary replica transitions to the secondary role, and its databases become secondary databases.</span></span> <span data-ttu-id="64886-231">Das neue sekundäre Replikat stellt eine Verbindung mit dem aktuellen primären Replikat her und fängt seine Datenbank so schnell wie möglich bis zu den aktuellen primären Datenbanken ab.</span><span class="sxs-lookup"><span data-stu-id="64886-231">The new secondary replica connects to the current primary replica and catches its database up to the current primary databases as quickly as possible.</span></span> <span data-ttu-id="64886-232">Sobald das neue sekundäre Replikat seine Datenbanken erneut synchronisiert hat, ist ein neues Failover in umgekehrter Richtung möglich.</span><span class="sxs-lookup"><span data-stu-id="64886-232">As soon as the new secondary replica has resynchronized its databases, failover is again possible, in the reverse direction.</span></span>  
  
###  <a name="to-configure-automatic-failover"></a><a name="EnableAutoFo"></a> <span data-ttu-id="64886-233">So konfigurieren Sie ein automatisches Failover</span><span class="sxs-lookup"><span data-stu-id="64886-233">To Configure Automatic Failover</span></span>  
 <span data-ttu-id="64886-234">Ein Verfügbarkeitsreplikat kann konfiguriert werden, um ein automatisches Failover jederzeit zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="64886-234">An availability replica can be configured to support automatic failover at any point.</span></span>  
  
 <span data-ttu-id="64886-235">**To configure automatic failover**</span><span class="sxs-lookup"><span data-stu-id="64886-235">**To configure automatic failover**</span></span>  
  
1.  <span data-ttu-id="64886-236">Stellen Sie sicher, dass das sekundäre Replikat konfiguriert ist, um den Verfügbarkeitsmodus mit synchronem Commit zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="64886-236">Ensure that the secondary replica is configured to use the synchronous-commit availability mode.</span></span> <span data-ttu-id="64886-237">Weitere Informationen finden Sie unter [Ändern des Verfügbarkeitsmodus eines Verfügbarkeitsreplikats &#40;SQL Server&#41;](change-the-availability-mode-of-an-availability-replica-sql-server.md)ausgetauscht werden.</span><span class="sxs-lookup"><span data-stu-id="64886-237">For more information, see [Change the Availability Mode of an Availability Replica &#40;SQL Server&#41;](change-the-availability-mode-of-an-availability-replica-sql-server.md).</span></span>  
  
2.  <span data-ttu-id="64886-238">Legen Sie den Failovermodus auf automatisch fest.</span><span class="sxs-lookup"><span data-stu-id="64886-238">Set the failover mode to automatic.</span></span> <span data-ttu-id="64886-239">Weitere Informationen finden Sie unter [Ändern des Failovermodus eines Verfügbarkeitsreplikats &#40;SQL Server&#41;](change-the-failover-mode-of-an-availability-replica-sql-server.md)ausgetauscht werden.</span><span class="sxs-lookup"><span data-stu-id="64886-239">For more information, see [Change the Failover Mode of an Availability Replica &#40;SQL Server&#41;](change-the-failover-mode-of-an-availability-replica-sql-server.md).</span></span>  
  
3.  <span data-ttu-id="64886-240">Ändern Sie optional die flexible Failoverrichtlinie der Verfügbarkeitsgruppe, und geben Sie die Fehlerarten an, durch die ein automatisches Failover verursacht werden kann.</span><span class="sxs-lookup"><span data-stu-id="64886-240">Optionally, change the flexible failover policy of the availability group to specify the sorts of failures that can cause an automatic failover to occur.</span></span> <span data-ttu-id="64886-241">Weitere Informationen finden Sie unter [Konfigurieren der flexiblen Failoverrichtlinie zum Steuern der Bedingungen für ein automatisches Failover &#40;AlwaysOn-Verfügbarkeitsgruppen&#41;](configure-flexible-automatic-failover-policy.md) HYPERLINK "file:///C:\\\Users\\\marshow\\\AppData\\\Local\\\Temp\\\DxEditor\\\DduePreview\\\Default\\\6a8d98a9-6e6a-40d1-9809-efa9013d7452\\\HTM\\\html\\\1ed564b4-9835-4245-ae35-9ba67419a4ce"  and [Failoverrichtlinie für Failoverclusterinstanzen](../../../sql-server/failover-clusters/windows/failover-policy-for-failover-cluster-instances.md).</span><span class="sxs-lookup"><span data-stu-id="64886-241">For more information, see [Configure the Flexible Failover Policy to Control Conditions for Automatic Failover &#40;AlwaysOn Availability Groups&#41;](configure-flexible-automatic-failover-policy.md) HYPERLINK "file:///C:\\\Users\\\marshow\\\AppData\\\Local\\\Temp\\\DxEditor\\\DduePreview\\\Default\\\6a8d98a9-6e6a-40d1-9809-efa9013d7452\\\HTM\\\html\\\1ed564b4-9835-4245-ae35-9ba67419a4ce"  and [Failover Policy for Failover Cluster Instances](../../../sql-server/failover-clusters/windows/failover-policy-for-failover-cluster-instances.md).</span></span>  
  
##  <a name="planned-manual-failover-without-data-loss"></a><a name="ManualFailover"></a> <span data-ttu-id="64886-242">Geplantes manuelles Failover (ohne Datenverlust)</span><span class="sxs-lookup"><span data-stu-id="64886-242">Planned Manual Failover (Without Data Loss)</span></span>  
 <span data-ttu-id="64886-243">Bei einem manuellen Failover geht ein synchronisiertes sekundäres Replikat zur primären Rolle über, nachdem ein Datenbankadministrator einen Befehl für ein manuelles Failover auf der Serverinstanz ausgibt, die das sekundäre Zielreplikat hostet.</span><span class="sxs-lookup"><span data-stu-id="64886-243">A manual failover causes a synchronized secondary replica to transition to the primary role after a database administrator issues a manual-failover command on the server instance that hosts the target secondary replica.</span></span> <span data-ttu-id="64886-244">Zur Unterstützung eines manuellen Failovers müssen das sekundäre Replikat und das aktuelle primäre Replikat für den synchronen Commitmodus (falls zutreffend) konfiguriert sein.</span><span class="sxs-lookup"><span data-stu-id="64886-244">To support manual failover, the secondary replica and the current primary replica must both be configured for synchronous-commit mode, if any.</span></span> <span data-ttu-id="64886-245">Jede sekundäre Datenbank auf dem Verfügbarkeitsreplikat muss mit der Verfügbarkeitsgruppe verknüpft und mit der entsprechenden primären Datenbank synchronisiert werden (d. h., das sekundäre Replikat muss synchronisiert werden).</span><span class="sxs-lookup"><span data-stu-id="64886-245">Every secondary database on the availability replica must be joined to the availability group and synchronized with its corresponding primary database (that is, the secondary replica must be synchronized).</span></span> <span data-ttu-id="64886-246">Damit wird sichergestellt, dass ein Commit für jede Transaktion, für die ein Commit auf einer früheren primären Datenbank ausgeführt wurde, auch auf der neuen primären Datenbank ausgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="64886-246">This guarantees that every transaction that was committed on a former primary database has also been committed on the new primary database.</span></span> <span data-ttu-id="64886-247">Daher sind die neuen primären Datenbanken mit den alten primären Datenbanken identisch.</span><span class="sxs-lookup"><span data-stu-id="64886-247">Therefore, the new primary databases are identical to the old primary databases.</span></span>  
  
 <span data-ttu-id="64886-248">In der folgenden Abbildung werden die Phasen eines geplanten Failovers veranschaulicht:</span><span class="sxs-lookup"><span data-stu-id="64886-248">The following figure illustrates the stages of a planned failover:</span></span>  
  
1.  <span data-ttu-id="64886-249">Vor dem Failover wird das primäre Replikat von der Serverinstanz auf `Node01`gehostet.</span><span class="sxs-lookup"><span data-stu-id="64886-249">Before the failover, the primary replica is hosted by the server instance on `Node01`.</span></span>  
  
2.  <span data-ttu-id="64886-250">Ein Datenbankadministrator initiiert ein geplantes Failover.</span><span class="sxs-lookup"><span data-stu-id="64886-250">A database administrator initiates a planned failover.</span></span> <span data-ttu-id="64886-251">Das Failoverziel ist das von der Serverinstanz auf `Node02`gehostete Verfügbarkeitsreplikat.</span><span class="sxs-lookup"><span data-stu-id="64886-251">The failover target is the availability replica hosted by the server instance on `Node02`.</span></span>  
  
3.  <span data-ttu-id="64886-252">Das Failoverziel (auf `Node02`) wird zum neuen primären Replikat.</span><span class="sxs-lookup"><span data-stu-id="64886-252">The failover target (on `Node02`) becomes the new primary replica.</span></span> <span data-ttu-id="64886-253">Da dies ein geplantes Failover ist, wechselt das frühere primäre Replikat während des Failovers zur sekundären Rolle und schaltet die zugehörigen Datenbanken unmittelbar als sekundäre Datenbanken online.</span><span class="sxs-lookup"><span data-stu-id="64886-253">Because this is a planned failover, the former primary replica switches to the secondary role during the failover and brings its databases online as secondary databases immediately.</span></span>  
  
 <span data-ttu-id="64886-254">![Abbildung eines geplanten manuellen Failovers](../../media/aoag-plannedmanualfailover.gif "Abbildung eines geplanten manuellen Failovers")</span><span class="sxs-lookup"><span data-stu-id="64886-254">![Illustation of a planned manual failover](../../media/aoag-plannedmanualfailover.gif "Illustation of a planned manual failover")</span></span>  
  
  
###  <a name="conditions-required-for-a-manual-failover"></a><a name="ManualFailoverConditions"></a> <span data-ttu-id="64886-255">Für ein manuelles Failover erforderliche Bedingungen</span><span class="sxs-lookup"><span data-stu-id="64886-255">Conditions Required for a Manual Failover</span></span>  
 <span data-ttu-id="64886-256">Um ein manuelles Failover zu unterstützen, muss das aktuelle primäre Replikat auf den Modus mit synchronem Commit festgelegt werden, und ein sekundäres Replikat muss folgende Bedingungen erfüllen:</span><span class="sxs-lookup"><span data-stu-id="64886-256">To support a manual failover, the current primary replica must be set to synchronous-commit mode and a secondary replica must be:</span></span>  
  
-   <span data-ttu-id="64886-257">Konfiguriert für den Modus mit synchronem Commit.</span><span class="sxs-lookup"><span data-stu-id="64886-257">Configured for synchronous-commit mode.</span></span>  
  
-   <span data-ttu-id="64886-258">Derzeit mit dem primären Replikat synchronisiert.</span><span class="sxs-lookup"><span data-stu-id="64886-258">Currently synchronized with the primary replica.</span></span>  
  
 <span data-ttu-id="64886-259">Um ein Failover einer Verfügbarkeitsgruppe manuell auszuführen, müssen Sie mit dem sekundären Replikat verbunden sein, das das neue primäre Replikat wird.</span><span class="sxs-lookup"><span data-stu-id="64886-259">To manually fail over an availability group, you must be connected to the secondary replica that is to become the new primary replica.</span></span>  
  
###  <a name="how-a-planned-manual-failover-works"></a><a name="ManualFailoverHowWorks"></a> <span data-ttu-id="64886-260">Funktionsweise eines geplanten manuellen Failovers</span><span class="sxs-lookup"><span data-stu-id="64886-260">How a Planned Manual Failover Works</span></span>  
 <span data-ttu-id="64886-261">Ein geplantes manuelles Failover, das auf dem sekundären Zielreplikat initiiert werden muss, initiiert die folgende Aktionskette:</span><span class="sxs-lookup"><span data-stu-id="64886-261">A planned manual failover, which must be initiated on the target secondary replica, initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="64886-262">Um sicherzustellen, dass keine neuen Benutzertransaktionen auf den ursprünglichen primären Datenbanken auftreten, sendet der WSFC-Cluster eine Anforderung an das primäre Replikat, in den Offlinemodus zu wechseln.</span><span class="sxs-lookup"><span data-stu-id="64886-262">To ensure that no new user transactions occur on the original primary databases, the WSFC cluster sends a request to the primary replica to go offline.</span></span>  
  
2.  <span data-ttu-id="64886-263">Wenn ein Protokoll in die Wiederherstellungswarteschlange einer sekundären Datenbank wartet, stellt das sekundäre Replikat das Rollforward dieser sekundären Datenbank fertig.</span><span class="sxs-lookup"><span data-stu-id="64886-263">If any log is waiting in the recovery queue of any secondary database, the secondary replica finishes rolling forward that secondary database.</span></span> <span data-ttu-id="64886-264">Die erforderliche Zeit hängt von der Systemgeschwindigkeit, der aktuellen Arbeitsauslastung und der Menge der Protokolle in der Wiederherstellungswarteschlange ab.</span><span class="sxs-lookup"><span data-stu-id="64886-264">The amount of time required depends on the speed of the system, the recent workload, and the amount of log in the recovery queue.</span></span> <span data-ttu-id="64886-265">Um die aktuelle Größe der Wiederherstellungswarteschlange festzustellen, verwenden Sie den Leistungsindikator **Recovery Queue** .</span><span class="sxs-lookup"><span data-stu-id="64886-265">To learn the current size of the recovery queue, use the **Recovery Queue** performance counter.</span></span> <span data-ttu-id="64886-266">Weitere Informationen finden Sie unter [SQL Server, Datenbankreplikat](../../../relational-databases/performance-monitor/sql-server-database-replica.md).</span><span class="sxs-lookup"><span data-stu-id="64886-266">For more information, see [SQL Server, Database Replica](../../../relational-databases/performance-monitor/sql-server-database-replica.md).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="64886-267">Die Failoverzeit kann durch die Begrenzung der Größe der Wiederherstellungswarteschlange reguliert werden.</span><span class="sxs-lookup"><span data-stu-id="64886-267">The failover time can be regulated by limiting the size of the recovery queue.</span></span> <span data-ttu-id="64886-268">Das führt allerdings möglicherweise zu einem langsameren primären Replikat, damit vom sekundären Replikat die Geschwindigkeit gehalten werden kann.</span><span class="sxs-lookup"><span data-stu-id="64886-268">However, this can cause the primary replica to slow down to allow the secondary replica to keep up.</span></span>  
  
3.  <span data-ttu-id="64886-269">Das sekundäre Replikat wird das neue primäre Replikat, und das frühere primäre Replikat wird das neue sekundäre Replikat.</span><span class="sxs-lookup"><span data-stu-id="64886-269">The secondary replica becomes the new primary replica, and the former primary replica becomes the new secondary replica.</span></span>  
  
4.  <span data-ttu-id="64886-270">Das neue primäre Replikat führt für alle Transaktionen, für die noch kein Commit ausgeführt wurde, ein Rollback aus und schaltet seine Datenbanken als primären Datenbanken online. Alle sekundäre Datenbanken werden kurz als NICHT SYNCHRONISIERT markiert, bis sie eine Verbindung mit den neuen primären Datenbanken herstellen und damit synchronisiert werden können.</span><span class="sxs-lookup"><span data-stu-id="64886-270">The new primary replica rolls back any uncommitted transactions and brings its databases online as the primary databases.All secondary databases are briefly marked as NOT SYNCHRONIZED until they connect and resynchronize to the new primary databases.</span></span> <span data-ttu-id="64886-271">Für Transaktionen, für die ein Commit ausgeführt wurde, wird dabei kein Rollback durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="64886-271">This process does not roll back any committed transactions.</span></span>  
  
5.  <span data-ttu-id="64886-272">Wenn das frühere primäre Replikat wieder online geschaltet wird, nimmt es die sekundäre Rolle an, und die frühere primäre Datenbank wird zur sekundären Datenbank.</span><span class="sxs-lookup"><span data-stu-id="64886-272">When the former primary replica comes back online, it takes on the secondary role, and the former primary database becomes the secondary database.</span></span> <span data-ttu-id="64886-273">Das neue sekundäre Replikat synchronisiert schnell die neuen sekundären Datenbanken erneut mit den entsprechenden primären Datenbanken.</span><span class="sxs-lookup"><span data-stu-id="64886-273">The new secondary replica quickly resynchronizes the new secondary databases with the corresponding primary databases.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="64886-274">Sobald das neue sekundäre Replikat die Datenbanken erneut synchronisiert hat, ist ein neues Failover möglich, allerdings in umgekehrter Richtung.</span><span class="sxs-lookup"><span data-stu-id="64886-274">As soon as the new secondary replica has resynchronized the databases, failover is again possible, but in the reverse direction.</span></span>  
  
 <span data-ttu-id="64886-275">Nach dem Failover müssen von Clients erneut Verbindungen mit der aktuellen primären Datenbank hergestellt werden.</span><span class="sxs-lookup"><span data-stu-id="64886-275">After failover, clients must reconnect to the current primary database.</span></span> <span data-ttu-id="64886-276">Weitere Informationen finden Sie unter [Verfügbarkeitsgruppenlistener, Clientkonnektivität und Anwendungsfailover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md)wichtig sind.</span><span class="sxs-lookup"><span data-stu-id="64886-276">For more information, see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span></span>  
  
###  <a name="maintaining-availability-during-upgrades"></a><a name="ManualFailoverDuringUpgrades"></a> <span data-ttu-id="64886-277">Aufrechterhalten der Verfügbarkeit während Upgrades</span><span class="sxs-lookup"><span data-stu-id="64886-277">Maintaining Availability During Upgrades</span></span>  
 <span data-ttu-id="64886-278">Der Datenbankadministrator für die Verfügbarkeitsgruppen kann die Datenbankverfügbarkeit mithilfe von manuellen Failovers aufrechterhalten, wenn Sie Hardware oder Software aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="64886-278">The database administrator for your availability groups can use manual failovers to maintain database availability when you upgrade hardware or software.</span></span> <span data-ttu-id="64886-279">Um eine Verfügbarkeitsgruppe für Softwareupgrades zu verwenden, muss die Serverinstanz und/oder der Computerknoten, der das sekundäre Zielreplikat hostet, die Upgrades bereits empfangen haben.</span><span class="sxs-lookup"><span data-stu-id="64886-279">To use an availability group for software upgrades, the server instance and/or computer node that hosts the target secondary replica must have already received the upgrades.</span></span> <span data-ttu-id="64886-280">Weitere Informationen finden Sie unter [Upgrade and Update of Availability Group Servers with Minimal Downtime and Data Loss](upgrading-always-on-availability-group-replica-instances.md).</span><span class="sxs-lookup"><span data-stu-id="64886-280">For more information, see [Upgrade and Update of Availability Group Servers with Minimal Downtime and Data Loss](upgrading-always-on-availability-group-replica-instances.md).</span></span>  
  
##  <a name="forced-failover-with-possible-data-loss"></a><a name="ForcedFailover"></a> <span data-ttu-id="64886-281">Erzwungenes Failover (mit möglichem Datenverlust)</span><span class="sxs-lookup"><span data-stu-id="64886-281">Forced Failover (with Possible Data Loss)</span></span>  
 <span data-ttu-id="64886-282">Das Erzwingen eines Failovers einer Verfügbarkeitsgruppe (mit möglichem Datenverlust) ist eine Notfallwiederherstellungsmethode, mit der Sie ein sekundäres Replikat als betriebsbereiten Standbyserver verwenden können. Da das Erzwingen eines Failovers zu möglichem Datenverlust führen kann, sollte diese Methode unter Vorbehalt und selten verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="64886-282">Forcing failover of an availability group (with possible data loss) is a disaster recovery method that allows you to use a secondary replica as a warm standby server.Because forcing failover risks possible data loss, it should be used cautiously and sparingly.</span></span> <span data-ttu-id="64886-283">Es wird empfohlen, das Failover nur dann zu erzwingen, wenn Sie den Dienst für die Verfügbarkeitsdatenbanken sofort wiederherstellen müssen und bereit sind, das Risiko des Datenverlustes in Kauf zu nehmen.</span><span class="sxs-lookup"><span data-stu-id="64886-283">We recommend forcing failover only if you must restore service to your availability databases immediately and are willing to risk losing data.</span></span> <span data-ttu-id="64886-284">Weitere Informationen zu den Voraussetzungen und Empfehlungen zum Erzwingen eines Failovers sowie ein Beispielszenario, in dem zur Wiederherstellung nach einem schwerwiegenden Fehler ein erzwungenes Failover verwendet wird, finden Sie unter [Ausführen eines erzwungenen manuellen Failovers einer Verfügbarkeitsgruppe &#40;SQL Server&#41;](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md)ausgetauscht werden.</span><span class="sxs-lookup"><span data-stu-id="64886-284">For more information about the prerequisites and recommendations for forcing failover and for an example scenario that uses a forced failover to recover from a catastrophic failure, see [Perform a Forced Manual Failover of an Availability Group &#40;SQL Server&#41;](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md).</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="64886-285">Für das Erzwingen eines Failovers muss der WSFC-Cluster über Quorum verfügen.</span><span class="sxs-lookup"><span data-stu-id="64886-285">Forcing failover requires that the WSFC cluster have quorum.</span></span> <span data-ttu-id="64886-286">Informationen zum Konfigurieren und das Erzwingen des Quorums finden Sie unter [Windows Server-Failoverclustering &#40;WSFC&#41; mit SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md)ausgetauscht werden.</span><span class="sxs-lookup"><span data-stu-id="64886-286">For information about configuring quorum and forcing quorum, see [Windows Server Failover Clustering &#40;WSFC&#41; with SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md).</span></span>  
  
  
###  <a name="how-forced-failover-works"></a><a name="ForcedFailoverHowWorks"></a> <span data-ttu-id="64886-287">So funktioniert ein erzwungenes Failover</span><span class="sxs-lookup"><span data-stu-id="64886-287">How Forced Failover Works</span></span>  
 <span data-ttu-id="64886-288">Durch ein erzwungenes Failover wird der Wechsel der primären Rolle zu einem Zielreplikat initiiert, dessen Rolle sich im SECONDARY- oder RESOLVING-Status befindet.</span><span class="sxs-lookup"><span data-stu-id="64886-288">Forcing failover initiates a transition of the primary role to a target replica whose role is in the SECONDARY or RESOLVING state.</span></span> <span data-ttu-id="64886-289">Das Failoverziel wird zum neuen primären Replikat und stellt seine Datenbankkopien sofort den Clients zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="64886-289">The failover target becomes the new primary replica and immediately serves its copies of the databases to clients.</span></span> <span data-ttu-id="64886-290">Wenn das frühere primäre Replikat verfügbar wird, geht es in die sekundäre Rolle über, und seine Datenbanken werden sekundäre Datenbanken.</span><span class="sxs-lookup"><span data-stu-id="64886-290">When the former primary replica becomes available, it will transition to the secondary role and its databases will become secondary databases.</span></span>  
  
 <span data-ttu-id="64886-291">Alle sekundären Datenbanken (einschließlich der früheren primären Datenbanken, wenn sie verfügbar werden) haben den Status SUSPENDED.</span><span class="sxs-lookup"><span data-stu-id="64886-291">All secondary databases (including the former primary databases, when they become available) are SUSPENDED.</span></span> <span data-ttu-id="64886-292">In Abhängigkeit früherer Datensynchronisierungsstatus einer angehaltenen sekundären Datenbank empfiehlt es sich möglicherweise, fehlende übergebene Daten für die primäre Datenbank zu retten.</span><span class="sxs-lookup"><span data-stu-id="64886-292">Depending on the previous data synchronization state of a suspended secondary database, it might be suitable for salvaging missing committed data for that primary database.</span></span> <span data-ttu-id="64886-293">Auf einem sekundären Replikat, das für schreibgeschützten Zugriff konfiguriert ist, können Sie die sekundären Datenbanken abfragen, um fehlende Daten manuell zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="64886-293">On a secondary replica that is configured for read-only access, you can query the secondary databases to manually discover missing data.</span></span> <span data-ttu-id="64886-294">Danach können Sie [!INCLUDE[tsql](../../../includes/tsql-md.md)] -Anweisungen ausgeben, um alle notwendigen Änderungen für die neuen primären Datenbanken vorzunehmen.</span><span class="sxs-lookup"><span data-stu-id="64886-294">Then you can issue [!INCLUDE[tsql](../../../includes/tsql-md.md)] statements on the new primary databases to make any necessary changes.</span></span>  
  
###  <a name="risks-of-forcing-failover"></a><a name="ForcedFailoverRisks"></a> <span data-ttu-id="64886-295">Risiken beim Erzwingen des Failovers</span><span class="sxs-lookup"><span data-stu-id="64886-295">Risks of Forcing Failover</span></span>  
 <span data-ttu-id="64886-296">Sie sollten unbedingt bedenken, dass durch das Erzwingen des Failovers Daten verloren gehen können.</span><span class="sxs-lookup"><span data-stu-id="64886-296">It is essential to understand that forcing failover can cause data loss.</span></span> <span data-ttu-id="64886-297">Zu einem Datenverlust kann es kommen, weil das Zielreplikat nicht mit dem primären Replikat kommunizieren und somit nicht sicherstellen kann, dass die Datenbanken synchronisiert sind.</span><span class="sxs-lookup"><span data-stu-id="64886-297">Data loss is possible because the target replica cannot communicate with the primary replica and, therefore, cannot guarantee that the databases are synchronized.</span></span> <span data-ttu-id="64886-298">Durch das Erzwingen des Failovers wird eine neue Wiederherstellungsverzweigung gestartet.</span><span class="sxs-lookup"><span data-stu-id="64886-298">Forcing failover starts a new recovery fork.</span></span> <span data-ttu-id="64886-299">Da sich die ursprünglichen primären Datenbanken und sekundären Datenbanken auf verschiedenen Wiederherstellungsverzweigungen befinden, enthält jede Datenbank nun Daten, die in der jeweils anderen Datenbank nicht vorhanden sind: Jede ursprüngliche primäre Datenbank enthält die Änderungen, die noch nicht aus der Sendewarteschlange an die frühere sekundäre Datenbank gesendet wurden (die nicht gesendeten Protokolle). Die früheren sekundären Datenbanken enthalten die Änderungen, die nach dem Erzwingen des Failovers vorgenommen wurden.</span><span class="sxs-lookup"><span data-stu-id="64886-299">Because the original primary databases and secondary databases are on different recovery forks, each of them now contains data that the other database does not contain: each original primary database contains whatever changes were not yet sent from its send queue to the former secondary database (the unsent log); the former secondary databases contain whatever changes occur after failover was forced.</span></span>  
  
 <span data-ttu-id="64886-300">Wird das Failover aufgrund eines Fehlers des primären Replikats erzwungen, hängt der potenzielle Datenverlust davon ab, ob Transaktionsprotokolle vorhanden sind, die vor dem Fehler nicht an das sekundäre Replikat gesendet wurden.</span><span class="sxs-lookup"><span data-stu-id="64886-300">If failover is forced because the primary replica has failed, potential data loss is depends on whether any transaction logs had not been sent to the secondary replica before the failure.</span></span> <span data-ttu-id="64886-301">Im asynchronen Commit-Modus besteht immer die Möglichkeit, dass sich nicht gesendete Protokolle ansammeln.</span><span class="sxs-lookup"><span data-stu-id="64886-301">Under the asynchronous-commit mode, accumulated unsent log is always a possibility.</span></span> <span data-ttu-id="64886-302">Im synchronen Commit-Modus ist dies nur bis zum Synchronisieren der sekundären Datenbanken möglich.</span><span class="sxs-lookup"><span data-stu-id="64886-302">Under synchronous-commit mode, this is possible only until the secondary databases becomes synchronized.</span></span>  
  
 <span data-ttu-id="64886-303">In der folgenden Tabelle werden die Möglichkeiten eines Datenverlusts für eine bestimmte Datenbank auf dem Replikat, wofür Sie ein Failover ausführen, zusammengefasst.</span><span class="sxs-lookup"><span data-stu-id="64886-303">The following table summarizes the possibility of data loss for a particular database on the replica to which you force failover.</span></span>  
  
|<span data-ttu-id="64886-304">Verfügbarkeitsmodus des sekundären Replikats</span><span class="sxs-lookup"><span data-stu-id="64886-304">Availability mode of Secondary Replica</span></span>|<span data-ttu-id="64886-305">Ist die Datenbank synchronisiert?</span><span class="sxs-lookup"><span data-stu-id="64886-305">Is database synchronized?</span></span>|<span data-ttu-id="64886-306">Besteht die Möglichkeit eines Datenverlusts?</span><span class="sxs-lookup"><span data-stu-id="64886-306">Is data loss possible?</span></span>|  
|--------------------------------------------|-------------------------------|----------------------------|  
|<span data-ttu-id="64886-307">Synchroner Commit</span><span class="sxs-lookup"><span data-stu-id="64886-307">Synchronous-commit</span></span>|<span data-ttu-id="64886-308">Ja</span><span class="sxs-lookup"><span data-stu-id="64886-308">Yes</span></span>|<span data-ttu-id="64886-309">Nein</span><span class="sxs-lookup"><span data-stu-id="64886-309">No</span></span>|  
|<span data-ttu-id="64886-310">Synchroner Commit</span><span class="sxs-lookup"><span data-stu-id="64886-310">Synchronous-commit</span></span>|<span data-ttu-id="64886-311">Nein</span><span class="sxs-lookup"><span data-stu-id="64886-311">No</span></span>|<span data-ttu-id="64886-312">Ja</span><span class="sxs-lookup"><span data-stu-id="64886-312">Yes</span></span>|  
|<span data-ttu-id="64886-313">Asynchroner Commit</span><span class="sxs-lookup"><span data-stu-id="64886-313">Asynchronous-commit</span></span>|<span data-ttu-id="64886-314">Nein</span><span class="sxs-lookup"><span data-stu-id="64886-314">No</span></span>|<span data-ttu-id="64886-315">Ja</span><span class="sxs-lookup"><span data-stu-id="64886-315">Yes</span></span>|  
||||  
  
 <span data-ttu-id="64886-316">Sekundäre Datenbanken verfolgen nur zwei Wiederherstellungsverzweigungen nach. Wenn Sie also mehrere erzwungene Failover ausführen, kann eine sekundäre Datenbank, für die die Datensynchronisierung mit dem vorherigen erzwungenen Failover gestartet wurde, u. U. nicht fortgesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="64886-316">Secondary databases track only two recovery forks, so if you perform multiple forced failovers, any secondary database that did start data synchronization with the previous force failover might not be able to resume.</span></span> <span data-ttu-id="64886-317">In diesem Fall müssen alle sekundären Datenbanken, die nicht fortgesetzt werden können, aus der Verfügbarkeitsgruppe entfernt und der Verfügbarkeitsgruppe wieder hinzugefügt werden, nachdem sie bis zum richtigen Zeitpunkt wiederhergestellt wurden.</span><span class="sxs-lookup"><span data-stu-id="64886-317">If this occurs, any secondary databases that cannot be resumed will need to be removed from the availability group, restored to the correct point in time, and rejoined to the availability group.</span></span> <span data-ttu-id="64886-318">Da eine Wiederherstellung nicht über mehrere Wiederherstellungsverzweigungen ausgeführt werden kann, sollten Sie unbedingt eine Protokollsicherung erstellen, nachdem Sie mehr als ein erzwungenes Failover ausgeführt haben.</span><span class="sxs-lookup"><span data-stu-id="64886-318">A restore will not work across multiple recovery forks, therefore, be sure to perform a log backup after performing more than one forced failover.</span></span>  
  
###  <a name="why-forced-failover-is-required-after-forcing-quorum"></a><a name="WhyFFoPostForcedQuorum"></a> <span data-ttu-id="64886-319">Warum nach Erzwingen des Quorums ein erzwungenes Failover erforderlich ist</span><span class="sxs-lookup"><span data-stu-id="64886-319">Why Forced Failover is Required After Forcing Quorum</span></span>  
 <span data-ttu-id="64886-320">Nachdem Sie das Quorum (*erzwungenes Quorum*) im WSFC-Cluster erzwungen haben, müssen Sie für jede Verfügbarkeitsgruppe ein Failover erzwingen (mit möglichem Datenverlust).</span><span class="sxs-lookup"><span data-stu-id="64886-320">After quorum is forced on the WSFC cluster (*forced quorum*) you need to perform a forced failover (with possible data loss) on each availability group.</span></span> <span data-ttu-id="64886-321">Das Erzwingen eines Failovers ist erforderlich, da der wirkliche Status der WSFC-Clusterwerte verloren gegangen sein könnte.</span><span class="sxs-lookup"><span data-stu-id="64886-321">The forced failover is required because the real state of the WSFC cluster values might have been lost.</span></span> <span data-ttu-id="64886-322">Normale Failover müssen nach einem erzwungenen Quorum verhindert werden, da ein nicht synchronisiertes sekundäres Replikat andernfalls im neu konfigurierten WSFC-Cluster als synchronisiert angezeigt werden könnte.</span><span class="sxs-lookup"><span data-stu-id="64886-322">Preventing normal failovers after a forced quorum is required because of the possibility than an unsynchronized secondary replica would appear to be synchronized on the reconfigured WSFC cluster.</span></span>  
  
 <span data-ttu-id="64886-323">Betrachten Sie beispielsweise einen WSFC-Cluster, der eine Verfügbarkeitsgruppe auf drei Knoten hostet:  Knoten A hostet das primäre Replikat, und Knoten B und Knoten C hosten jeweils ein sekundäres Replikat.</span><span class="sxs-lookup"><span data-stu-id="64886-323">For example, consider a WSFC cluster that hosts an availability group on three nodes:  Node A hosts the primary replica and Node B and Node C each hosts a secondary replica.</span></span> <span data-ttu-id="64886-324">Knoten C wird vom WSFC-Cluster getrennt, während das lokale sekundäre Replikat SYNCHRONISIERT wird.</span><span class="sxs-lookup"><span data-stu-id="64886-324">Node C gets disconnected from the WSFC cluster while the local secondary replica is SYNCHRONIZED.</span></span>  <span data-ttu-id="64886-325">Die Knoten A und B weisen weiterhin ein fehlerfreies Quorum auf. Die Verfügbarkeitsgruppe bleibt online.</span><span class="sxs-lookup"><span data-stu-id="64886-325">But Node A and Node B retain a healthy quorum and the availability group remains online.</span></span> <span data-ttu-id="64886-326">Auf Knoten A akzeptiert das primäre Replikat weiterhin Updates. Auf Knoten B wird das sekundäre Replikat weiterhin mit dem primären Replikat synchronisiert.</span><span class="sxs-lookup"><span data-stu-id="64886-326">On Node A, the primary replica continues to accept updates, and on Node B, the secondary replica continues to synchronize with the primary replica.</span></span> <span data-ttu-id="64886-327">Das sekundäre Replikat auf Knoten C wird nicht mehr synchronisiert und fällt zunehmend hinter das primäre Replikat zurück.</span><span class="sxs-lookup"><span data-stu-id="64886-327">The secondary replica on Node C becomes unsynchronized and falls increasingly behind the primary replica.</span></span> <span data-ttu-id="64886-328">Da Knoten C getrennt wurde, bleibt das Replikat jedoch fälschlicherweise im Status SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="64886-328">However, because Node C is disconnected, the replica remains, incorrectly, in the SYNCHRONIZED state.</span></span>  
  
 <span data-ttu-id="64886-329">Wenn das Quorum verloren geht und dann auf Knoten A erzwungen wird, sollte der Synchronisierungsstatus der Verfügbarkeitsgruppe im WSFC-Cluster richtig sein. Das sekundäre Replikat auf Knoten C sollte den Status UNSYNCHRONIZED aufweisen.</span><span class="sxs-lookup"><span data-stu-id="64886-329">If quorum is lost and is then forced on Node A, the synchronization state of the availability group on the WSFC cluster should be correct-with the secondary replica on Node C shown as UNSYNCHRONIZED.</span></span> <span data-ttu-id="64886-330">Wenn jedoch ein Quorum auf Knoten C erzwungen wird, ist die Synchronisierung der Verfügbarkeitsgruppe falsch.</span><span class="sxs-lookup"><span data-stu-id="64886-330">However, if quorum is forced on Node C, the synchronization of the availability group will be incorrect.</span></span> <span data-ttu-id="64886-331">Der Synchronisierungsstatus im Cluster entspricht dem Status, als Knoten C getrennt wurde. Das sekundäre Replikat auf Knoten C weist *fälschlicherweise* den Status SYNCHRONIZED auf.</span><span class="sxs-lookup"><span data-stu-id="64886-331">The synchronization state on the cluster will have reverted back to when Node C was disconnected-with the secondary replica on Node C *incorrectly* shown as SYNCHRONIZED.</span></span> <span data-ttu-id="64886-332">Da geplante manuelle Failover die Sicherheit der Daten gewährleisten, darf eine Verfügbarkeitsgruppe nach dem Erzwingen eines Quorums nicht wieder online geschaltet werden.</span><span class="sxs-lookup"><span data-stu-id="64886-332">Since planned manual failovers guarantee the safety of the data, they are disallowed for bring an availability group back online after quorum is forced.</span></span>  
  
###  <a name="tracking-potential-data-loss"></a><a name="TrackPotentialDataLoss"></a> <span data-ttu-id="64886-333">Möglichen Datenverlust nachverfolgen</span><span class="sxs-lookup"><span data-stu-id="64886-333">Tracking Potential Data Loss</span></span>  
 <span data-ttu-id="64886-334">Wenn der WSFC-Cluster ein fehlerfreies Quorum aufweist, können Sie das aktuelle Datenverlustrisiko fürDatenbanken einschätzen.</span><span class="sxs-lookup"><span data-stu-id="64886-334">When the WSFC cluster has a healthy quorum, you can estimate the current potential for data loss on databases.</span></span> <span data-ttu-id="64886-335">Für ein gegebenes sekundäres Replikat hängt das aktuelle Datenverlustrisiko davon ab, wie groß die Verzögerung der lokalen sekundären Datenbanken gegenüber den entsprechenden primären Datenbanken ist.</span><span class="sxs-lookup"><span data-stu-id="64886-335">For a given secondary replica, the current potential for data loss depends on how far the local secondary databases are lagging behind the corresponding primary databases.</span></span> <span data-ttu-id="64886-336">Da die Verzögerung im Verlauf der Zeit variiert, wird empfohlen, den potenziellen Datenverlust für Ihre nicht synchronisierten sekundären Datenbanken regelmäßig nachzuverfolgen.</span><span class="sxs-lookup"><span data-stu-id="64886-336">Because the amount of lag varies over time, we recommend that you periodically track potential data loss for your unsynchronized secondary databases.</span></span> <span data-ttu-id="64886-337">Eine Nachverfolgung der Verzögerung umfasst den Vergleich der LSN des letzten Commits mit der Zeit des letzten Commits für jede primäre Datenbank und ihre sekundären Datenbanken wie folgt:</span><span class="sxs-lookup"><span data-stu-id="64886-337">Tracking lag involves comparing the Last Commit LSN and Last Commit Time for each primary database and its secondary databases, as follows:</span></span>  
  
1.  <span data-ttu-id="64886-338">Stellen Sie eine Verbindung mit dem primären Replikat her.</span><span class="sxs-lookup"><span data-stu-id="64886-338">Connect to the primary replica.</span></span>  
  
2.  <span data-ttu-id="64886-339">Fragen Sie die `last_commit_lsn` (LSN der letzten Transaktion, für die ein Commit ausgeführt wurde) und die `last_commit_time` Spalten (Zeitpunkt der letzten Commits) der dynamischen Verwaltungs Sicht [sys. dm_hadr_database_replica_states](/sql/relational-databases/system-dynamic-management-views/sys-dm-hadr-database-replica-states-transact-sql) ab.</span><span class="sxs-lookup"><span data-stu-id="64886-339">Query the `last_commit_lsn` (LSN of the last committed transaction) and `last_commit_time` (time of the last commit) columns of the [sys.dm_hadr_database_replica_states](/sql/relational-databases/system-dynamic-management-views/sys-dm-hadr-database-replica-states-transact-sql) dynamic management view.</span></span>  
  
3.  <span data-ttu-id="64886-340">Vergleichen Sie die Werte, die für jede primäre Datenbank und ihre sekundären Datenbanken zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="64886-340">Compare the values returned for each primary database and each of its secondary databases.</span></span> <span data-ttu-id="64886-341">Der Unterschied zwischen den LSNs des letzten Commits gibt die Verzögerung an.</span><span class="sxs-lookup"><span data-stu-id="64886-341">The difference between their Last Commit LSNs indicate the amount of lag.</span></span>  
  
4.  <span data-ttu-id="64886-342">Sie können eine Warnung ausgeben, wenn die Verzögerung für eine Datenbank oder einen Satz Datenbanken die gewünschte maximale Verzögerung für einen bestimmten Zeitraum überschreitet.</span><span class="sxs-lookup"><span data-stu-id="64886-342">You can trigger an alert when the amount of lag on a database or set of databases exceeds your desired maximum lag for a given period of time.</span></span> <span data-ttu-id="64886-343">Beispielsweise kann die Abfrage durch einen Auftrag ausgeführt werden, der einmal pro Minute für jede primäre Datenbank ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="64886-343">For example, the query can be run by a job that executes every minute on each primary database.</span></span> <span data-ttu-id="64886-344">Wenn der Unterschied zwischen `last_commit_time` einer primären Datenbank und einer ihrer sekundären Datenbanken das Recovery Point Objective (RPO) (beispielsweise 5 Minuten) seit der letzten Ausführung des Jobs überschreitet, kann der Job eine Warnung ausgeben.</span><span class="sxs-lookup"><span data-stu-id="64886-344">If the difference between the `last_commit_time` of a primary database and any of its secondary databases has exceeded the recovery point objective (RPO) (for example, 5 minutes) since the last time the job executed, the job can raise an alert.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="64886-345">Wenn der WSFC-Cluster kein Quorum aufweist oder das Quorum erzwungen wurden, sind `last_commit_lsn` und `last_commit_time` NULL.</span><span class="sxs-lookup"><span data-stu-id="64886-345">When the WSFC cluster lacks quorum or quorum has been forced, `last_commit_lsn` and `last_commit_time` are NULL.</span></span> <span data-ttu-id="64886-346">Weitere Informationen dazu, wie Sie nach der Erzwingung des Quorums Datenverluste vermeiden können, finden Sie unter „Möglichkeiten zum Vermeiden von Datenverlust nach dem Erzwingen eines Quorums“ in [Ausführen eines erzwungenen manuellen Failovers einer Verfügbarkeitsgruppe &#40;SQL Server&#41;](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md)ausgetauscht werden.</span><span class="sxs-lookup"><span data-stu-id="64886-346">For information about how you might be able to avoid data loss after you forced quorum, see "Potential Ways to Avoid Data Loss After Quorum is Forced" in [Perform a Forced Manual Failover of an Availability Group &#40;SQL Server&#41;](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md).</span></span>  
  
###  <a name="managing-the-potential-data-loss"></a><a name="ForcedFailoverManagingDataLoss"></a> <span data-ttu-id="64886-347">Umgang mit potenziellem Datenverlust</span><span class="sxs-lookup"><span data-stu-id="64886-347">Managing the Potential Data Loss</span></span>  
 <span data-ttu-id="64886-348">Nach einem erzwungenen Failover werden alle sekundären Datenbanken angehalten.</span><span class="sxs-lookup"><span data-stu-id="64886-348">After failover is forced, all secondary databases are suspended.</span></span> <span data-ttu-id="64886-349">Dies schließt die früheren primären Datenbanken ein, nachdem das frühere primäre Replikat wieder online geschaltet wurde und ermittelt, dass es jetzt ein sekundäres Replikat ist.</span><span class="sxs-lookup"><span data-stu-id="64886-349">This includes the former primary databases, after the former primary replica comes back online and discovers that it is now a secondary replica.</span></span> <span data-ttu-id="64886-350">Sie müssen jede angehaltene Datenbank einzeln auf jedem sekundären Replikat manuell fortsetzen.</span><span class="sxs-lookup"><span data-stu-id="64886-350">You must manually resume each suspended database individually on each secondary replica.</span></span>  
  
 <span data-ttu-id="64886-351">Sobald das frühere primäre Replikat verfügbar ist, können Sie versuchen, den potenziellen Datenverlust zu verwalten, falls die Datenbanken unbeschädigt sind.</span><span class="sxs-lookup"><span data-stu-id="64886-351">Once the former primary replica is available, assuming that its databases are undamaged, you can attempt to manage the potential data loss.</span></span> <span data-ttu-id="64886-352">Der jeweilige Ansatz für die Verwaltung des potenziellen Datenverlusts hängt davon ab, ob das ursprüngliche primäre Replikat eine Verbindung mit dem neuen primären Replikat hergestellt hat.</span><span class="sxs-lookup"><span data-stu-id="64886-352">The available approach for managing potential data loss depends on whether the original primary replica has connected to the new primary replica.</span></span> <span data-ttu-id="64886-353">Vorausgesetzt, dass das ursprüngliche primäre Replikat auf die neue primäre Instanz zugreifen kann, wird die Verbindung automatisch und transparent wiederhergestellt.</span><span class="sxs-lookup"><span data-stu-id="64886-353">Assuming that the original primary replica can access the new primary instance, reconnecting occurs automatically and transparently.</span></span>  
  
#### <a name="the-original-primary-replica-has-reconnected"></a><span data-ttu-id="64886-354">Das ursprüngliche primäre Replikat hat eine Verbindung wiederhergestellt</span><span class="sxs-lookup"><span data-stu-id="64886-354">The Original Primary Replica Has Reconnected</span></span>  
 <span data-ttu-id="64886-355">Normalerweise stellt das ursprüngliche primäre Replikat nach einem Fehler beim Neustarten rasch die Verbindung zu seinem Partner wieder her.</span><span class="sxs-lookup"><span data-stu-id="64886-355">Typically, after a failure, when the original primary replica restarts it quickly reconnects to its partner.</span></span> <span data-ttu-id="64886-356">Beim Wiederherstellen der Verbindung wird das ursprüngliche primäre Replikat zum sekundären Replikat.</span><span class="sxs-lookup"><span data-stu-id="64886-356">On reconnecting, the original primary replica becomes the secondary replica.</span></span> <span data-ttu-id="64886-357">Seine Datenbanken werden die sekundären Datenbanken und erhalten den Status SUSPENDED.</span><span class="sxs-lookup"><span data-stu-id="64886-357">Its databases becomes the secondary databases and enter the SUSPENDED state.</span></span> <span data-ttu-id="64886-358">Es wird nur dann ein Rollback der neuen sekundären Datenbanken ausgeführt, wenn Sie sie fortsetzen.</span><span class="sxs-lookup"><span data-stu-id="64886-358">The new secondary databases will not be not rolled back unless you resume them.</span></span>  
  
 <span data-ttu-id="64886-359">Der Zugriff auf die angehaltenen Datenbanken ist jedoch nicht möglich; deshalb können Sie sie nicht überprüfen, um festzustellen, welche Daten beim Fortsetzen einer bestimmten Datenbank verloren gehen würden.</span><span class="sxs-lookup"><span data-stu-id="64886-359">However, the suspended databases are inaccessible, so you cannot inspect them to evaluate what data would be lost if you were to resume a given database.</span></span> <span data-ttu-id="64886-360">Die Entscheidung, ob eine sekundäre Datenbank fortgesetzt oder entfernt werden soll, hängt somit wie folgt davon ab, ob Sie bereit sind, Datenverluste in Kauf zu nehmen:</span><span class="sxs-lookup"><span data-stu-id="64886-360">Therefore, the decision on whether to resume or remove a secondary database depends on whether you are willing to accept any data loss, as follows:</span></span>  
  
-   <span data-ttu-id="64886-361">Wenn der Verlust von Daten inakzeptabel ist, sollten Sie die Datenbanken aus der Verfügbarkeitsgruppe entfernen, um die Daten zu retten.</span><span class="sxs-lookup"><span data-stu-id="64886-361">If losing any data would be unacceptable, you should remove the databases from the availability group to salvage them.</span></span>  
  
     <span data-ttu-id="64886-362">Der Datenbankadministrator kann jetzt die früheren primären Datenbanken wiederherstellen und versuchen, die Daten wiederherzustellen, die verloren gegangen wären.</span><span class="sxs-lookup"><span data-stu-id="64886-362">The database administrator can now recover the former primary databases and attempt to recover the data that would have been lost.</span></span> <span data-ttu-id="64886-363">Wenn eine frühere primäre Datenbank jedoch online geschaltet wird, weicht sie von der aktuellen primären Datenbank ab. Daher muss der Datenbankadministrator entweder die entfernte Datenbank oder die aktuelle primäre Datenbank für Clients sperren, um weitere Abweichungen der Datenbanken sowie Clientfailoverprobleme zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="64886-363">However, when a former primary database comes online, it is divergent from the current primary database, so the database administrator needs to make either the removed database or the current primary database inaccessible to clients to avoid further divergence of the databases and to prevent client-failover issues.</span></span>  
  
-   <span data-ttu-id="64886-364">Wenn der Verlust von Daten für Ihre Geschäftsziele akzeptabel ist, können Sie die sekundären Datenbanken fortsetzen.</span><span class="sxs-lookup"><span data-stu-id="64886-364">If losing data would be acceptable to your business goals, you can resume the secondary databases.</span></span>  
  
     <span data-ttu-id="64886-365">Beim Fortsetzen einer neuen sekundären Datenbank wird ein Rollback der Datenbank als erster Schritt zum Synchronisieren ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="64886-365">Resuming a new secondary database causes it to be rolled back as the first step in synchronizing the database.</span></span> <span data-ttu-id="64886-366">Waren zum Zeitpunkt des Fehlers Protokolldatensätze in der Sendewarteschlange enthalten, gehen die entsprechenden Transaktionen verloren, selbst wenn ein Commit für sie ausgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="64886-366">If any log records were waiting in the send queue at the time of failure, the corresponding transactions are lost, even if they were committed.</span></span>  
  
#### <a name="the-original-primary-replica-has-not-reconnected"></a><span data-ttu-id="64886-367">Das ursprüngliche primäre Replikat hat keine Verbindung wiederhergestellt</span><span class="sxs-lookup"><span data-stu-id="64886-367">The Original Primary Replica Has Not Reconnected</span></span>  
 <span data-ttu-id="64886-368">Wenn Sie zeitweise verhindern können, dass das ursprüngliche primäre Replikat wieder eine Verbindung über das Netzwerk mit dem primären Replikat herstellt, können Sie die ursprünglichen primären Datenbanken überprüfen und so feststellen, welche Daten im Falle einer Fortsetzung verloren gehen würden.</span><span class="sxs-lookup"><span data-stu-id="64886-368">If you can temporarily prevent the original primary replica from reconnecting over the network to the new primary replica, you can inspect the original primary databases to evaluate what data would be lost if they were resumed.</span></span>  
  
-   <span data-ttu-id="64886-369">Der potenzielle Datenverlust ist akzeptabel</span><span class="sxs-lookup"><span data-stu-id="64886-369">If the potential data loss is acceptable</span></span>  
  
     <span data-ttu-id="64886-370">Lassen Sie zu, dass das ursprüngliche primäre Replikat erneut eine Verbindung mit dem neuen primären Replikat herstellt.</span><span class="sxs-lookup"><span data-stu-id="64886-370">Allow the original primary replica to reconnect to the new primary replica.</span></span> <span data-ttu-id="64886-371">Durch das erneute Verbinden werden die neuen sekundären Datenbanken angehalten.</span><span class="sxs-lookup"><span data-stu-id="64886-371">Reconnecting causes the new secondary databases to be suspended.</span></span> <span data-ttu-id="64886-372">Zum Starten der Datensynchronisierung in einer Datenbank setzen Sie deren Ausführung einfach fort.</span><span class="sxs-lookup"><span data-stu-id="64886-372">To start data synchronization on a database, simply resume it.</span></span> <span data-ttu-id="64886-373">Das neue sekundäre Replikat löscht die ursprüngliche Wiederherstellungsverzweigung für diese Datenbank, wobei alle Transaktionen verloren gehen, die nie an das frühere sekundäre Replikat gesendet wurden bzw. von ihm empfangen wurden.</span><span class="sxs-lookup"><span data-stu-id="64886-373">The new secondary replica drops the original recovery fork for that database, losing any transactions that were never sent to or received by the former secondary replica.</span></span>  
  
-   <span data-ttu-id="64886-374">Ist der Datenverlust nicht akzeptabel, gehen Sie folgendermaßen vor:</span><span class="sxs-lookup"><span data-stu-id="64886-374">If the data loss is unacceptable</span></span>  
  
     <span data-ttu-id="64886-375">Wenn die ursprüngliche primäre Datenbank wichtige Daten enthält, die verloren gehen würden, wenn Sie die angehaltene Datenbank fortsetzen, können Sie Daten auf der ursprünglichen primären Datenbank durch Entfernen der Datenbank aus der Verfügbarkeitsgruppe beibehalten.</span><span class="sxs-lookup"><span data-stu-id="64886-375">If the original primary database contains critical data that would be lost if you resumed the suspended database, you can preserve the data on the original primary database by removing it from the availability group.</span></span> <span data-ttu-id="64886-376">Dies bewirkt, dass die Datenbank den Status RESTORING erhält.</span><span class="sxs-lookup"><span data-stu-id="64886-376">This causes the database to enter the RESTORING state.</span></span> <span data-ttu-id="64886-377">Sie sollten in diesem Fall versuchen, das Protokollfragment der entfernten Datenbank zu sichern.</span><span class="sxs-lookup"><span data-stu-id="64886-377">At this point, we recommend that you attempt to back up the tail of the removed database's log.</span></span> <span data-ttu-id="64886-378">Sie können dann die aktuelle primäre (die frühere sekundäre Datenbank) durch Exportieren der in der ursprünglichen primären Datenbank zu erhaltenden Daten und Importieren der Daten in die aktuelle primäre Datenbank aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="64886-378">Then, you can update the current primary (the former secondary database) by exporting the data you want to salvage from the original primary database and importing it into the current primary database.</span></span> <span data-ttu-id="64886-379">Es wird empfohlen, so schnell wie möglich eine vollständige Datenbanksicherung der aktualisierten primären Datenbank zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="64886-379">We recommend taking a full database backup of the updated primary database as quickly as possible.</span></span>  
  
     <span data-ttu-id="64886-380">Sie können dann auf der Serverinstanz, die das neue sekundäre Replikat hostet, die angehaltene sekundäre Datenbank löschen und eine neue sekundäre Datenbank durch das Wiederherstellen dieser Sicherung (und mindestens einer nachfolgenden Protokollsicherung) mit RESTORE WITH NORECOVERY erstellen.</span><span class="sxs-lookup"><span data-stu-id="64886-380">Then, on the server instance that hosts the new secondary replica, you can delete the suspended secondary database and create a new secondary database by restoring this backup (and least one subsequent log backup) using RESTORE WITH NORECOVERY.</span></span> <span data-ttu-id="64886-381">Es wird empfohlen, zusätzliche Protokollsicherungen der aktuellen primären Datenbanken bis zum Fortsetzen der entsprechenden sekundären Datenbanken hinauszuzögern.</span><span class="sxs-lookup"><span data-stu-id="64886-381">We recommend delaying additional log backups of the current primary databases until the corresponding secondary databases are resumed.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="64886-382">Die Transaktionsprotokollkürzung wird auf einer primären Datenbank verzögert, solange eine ihrer sekundären Datenbanken angehalten ist.</span><span class="sxs-lookup"><span data-stu-id="64886-382">Transaction log truncation is delayed on a primary database while any of its secondary databases is suspended.</span></span> <span data-ttu-id="64886-383">Der Synchronisierungszustand eines sekundären Replikats mit synchronem Commit kann auch keinen Übergang zu HEALTHY durchführen, solange alle lokalen Datenbanküberreste angehalten sind.</span><span class="sxs-lookup"><span data-stu-id="64886-383">Also the synchronization health of a synchronous-commit secondary replica cannot transition to HEALTHY as long as any local database remains suspended.</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="64886-384">Verwandte Aufgaben</span><span class="sxs-lookup"><span data-stu-id="64886-384">Related Tasks</span></span>  
 <span data-ttu-id="64886-385">**So konfigurieren Sie das Failoververhalten**</span><span class="sxs-lookup"><span data-stu-id="64886-385">**To configure failover behavior**</span></span>  
  
-   [<span data-ttu-id="64886-386">Ändern des Verfügbarkeitsmodus eines Verfügbarkeitsreplikats &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="64886-386">Change the Availability Mode of an Availability Replica &#40;SQL Server&#41;</span></span>](change-the-availability-mode-of-an-availability-replica-sql-server.md)  
  
-   [<span data-ttu-id="64886-387">Ändern des Failovermodus eines Verfügbarkeitsreplikats &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="64886-387">Change the Failover Mode of an Availability Replica &#40;SQL Server&#41;</span></span>](change-the-failover-mode-of-an-availability-replica-sql-server.md)  
  
-   [<span data-ttu-id="64886-388">Konfigurieren Sie die flexible Failoverrichtlinie zum Steuern der Bedingungen für automatisches Failover &#40;AlwaysOn-Verfügbarkeitsgruppen&#41;</span><span class="sxs-lookup"><span data-stu-id="64886-388">Configure the Flexible Failover Policy to Control Conditions for Automatic Failover &#40;AlwaysOn Availability Groups&#41;</span></span>](configure-flexible-automatic-failover-policy.md)  
  
 <span data-ttu-id="64886-389">**So führen Sie ein manuelles Failover aus**</span><span class="sxs-lookup"><span data-stu-id="64886-389">**To perform a manual fail over**</span></span>  
  
-   [<span data-ttu-id="64886-390">Ausführen eines geplanten manuellen Failovers einer Verfügbarkeitsgruppe &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="64886-390">Perform a Planned Manual Failover of an Availability Group &#40;SQL Server&#41;</span></span>](perform-a-planned-manual-failover-of-an-availability-group-sql-server.md)  
  
-   [<span data-ttu-id="64886-391">Ausführen eines erzwungenen manuellen Failovers einer Verfügbarkeitsgruppe &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="64886-391">Perform a Forced Manual Failover of an Availability Group &#40;SQL Server&#41;</span></span>](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md)  
  
-   [<span data-ttu-id="64886-392">Verwenden des Assistenten für Failover-Verfügbarkeitsgruppen &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="64886-392">Use the Fail Over Availability Group Wizard &#40;SQL Server Management Studio&#41;</span></span>](use-the-fail-over-availability-group-wizard-sql-server-management-studio.md)  
  
-   [<span data-ttu-id="64886-393">Verwaltung von Anmeldungen und Aufträgen für die Datenbanken einer Verfügbarkeitsgruppe &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="64886-393">Management of Logins and Jobs for the Databases of an Availability Group &#40;SQL Server&#41;</span></span>](../../logins-and-jobs-for-availability-group-databases.md)  
  
 <span data-ttu-id="64886-394">**So konfigurieren Sie die WSFC-Quorumkonfiguration**</span><span class="sxs-lookup"><span data-stu-id="64886-394">**To configure WSFC Quorum Configuration**</span></span>  
  
-   [<span data-ttu-id="64886-395">Konfigurieren von Cluster-Quorum-NodeWeight-Einstellungen</span><span class="sxs-lookup"><span data-stu-id="64886-395">Configure Cluster Quorum NodeWeight Settings</span></span>](../../../sql-server/failover-clusters/windows/configure-cluster-quorum-nodeweight-settings.md)  
  
-   [<span data-ttu-id="64886-396">Anzeigen von Cluster-Quorum-NodeWeight-Einstellungen</span><span class="sxs-lookup"><span data-stu-id="64886-396">View Cluster Quorum NodeWeight Settings</span></span>](../../../sql-server/failover-clusters/windows/view-cluster-quorum-nodeweight-settings.md)  
  
-   [<span data-ttu-id="64886-397">Erzwingen des Starts eines Clusters ohne Quorum</span><span class="sxs-lookup"><span data-stu-id="64886-397">Force a WSFC Cluster to Start Without a Quorum</span></span>](../../../sql-server/failover-clusters/windows/force-a-wsfc-cluster-to-start-without-a-quorum.md)  
  
##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="64886-398">Verwandte Inhalte</span><span class="sxs-lookup"><span data-stu-id="64886-398">Related Content</span></span>  
  
-   [<span data-ttu-id="64886-399">Microsoft SQL Server AlwaysOn-Lösungshandbuch zu hoher Verfügbarkeit und Notfallwiederherstellung</span><span class="sxs-lookup"><span data-stu-id="64886-399">Microsoft SQL Server AlwaysOn Solutions Guide for High Availability and Disaster Recovery</span></span>](https://go.microsoft.com/fwlink/?LinkId=227600)  
  
-   [<span data-ttu-id="64886-400">SQL Server AlwaysOn-Teamblog: Der offizielle SQL Server AlwaysOn-Teamblog</span><span class="sxs-lookup"><span data-stu-id="64886-400">SQL Server AlwaysOn Team Blog: The official SQL Server AlwaysOn Team Blog</span></span>](https://blogs.msdn.com/b/sqlalwayson/)  
  
## <a name="see-also"></a><span data-ttu-id="64886-401">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="64886-401">See Also</span></span>  
 <span data-ttu-id="64886-402">[Übersicht über AlwaysOn-Verfügbarkeitsgruppen &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="64886-402">[Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) </span></span>  
 <span data-ttu-id="64886-403">[Verfügbarkeits Modi &#40;AlwaysOn-Verfügbarkeitsgruppen&#41;](availability-modes-always-on-availability-groups.md) </span><span class="sxs-lookup"><span data-stu-id="64886-403">[Availability Modes &#40;AlwaysOn Availability Groups&#41;](availability-modes-always-on-availability-groups.md) </span></span>  
 <span data-ttu-id="64886-404">[Windows Server-Failoverclustering &#40;WSFC&#41; mit SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="64886-404">[Windows Server Failover Clustering &#40;WSFC&#41; with SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md) </span></span>  
 <span data-ttu-id="64886-405">[Datenbankübergreifende Transaktionen werden für die Daten Bank Spiegelung oder AlwaysOn-Verfügbarkeitsgruppen &#40;SQL Server nicht unterstützt&#41;](transactions-always-on-availability-and-database-mirroring.md) </span><span class="sxs-lookup"><span data-stu-id="64886-405">[Cross-Database Transactions Not Supported For Database Mirroring or AlwaysOn Availability Groups &#40;SQL Server&#41;](transactions-always-on-availability-and-database-mirroring.md) </span></span>  
 <span data-ttu-id="64886-406">[Failover Policy for Failover Cluster Instances](../../../sql-server/failover-clusters/windows/failover-policy-for-failover-cluster-instances.md) </span><span class="sxs-lookup"><span data-stu-id="64886-406">[Failover Policy for Failover Cluster Instances](../../../sql-server/failover-clusters/windows/failover-policy-for-failover-cluster-instances.md) </span></span>  
 [<span data-ttu-id="64886-407">Flexible Failoverrichtlinie für automatisches Failover einer Verfügbarkeitsgruppe (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="64886-407">Flexible Failover Policy for Automatic Failover of an Availability Group &#40;SQL Server&#41;</span></span>](flexible-automatic-failover-policy-availability-group.md)  
  
  

---
title: Upgrade und Update von Verfügbarkeits Gruppen Servern mit minimalen Ausfallzeiten und Datenverlusten | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
ms.assetid: f670af56-dbcc-4309-9119-f919dcad8a65
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 6bac882b93016a430fbcace2d590e6cc087123d2
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87724953"
---
# <a name="upgrade-and-update-of-availability-group-servers-with-minimal-downtime-and-data-loss"></a><span data-ttu-id="f36dd-102">Upgrade und Update von Verfügbarkeitsgruppenservern bei minimaler Downtime und minimalem Datenverlust</span><span class="sxs-lookup"><span data-stu-id="f36dd-102">Upgrade and Update of Availability Group Servers with Minimal Downtime and Data Loss</span></span>
  <span data-ttu-id="f36dd-103">Wenn Sie für SQL Server 2012-Serverinstanzen ein Update oder Upgrade auf ein Service Pack oder eine neuere Version ausführen, können Sie die Downtime einer Verfügbarkeitsgruppe auf nur einen manuellen Failover begrenzen, indem Sie ein sequenzielles Update oder Upgrade ausführen.</span><span class="sxs-lookup"><span data-stu-id="f36dd-103">When updating or upgrading server instances from SQL Server 2012 to a service pack or a newer version, you can reduce downtime for an availability group to only a single manual failover by performing a sequential update or upgrade.</span></span> <span data-ttu-id="f36dd-104">Beim Upgrade von SQL Server-Versionen wird dieser Vorgang als paralleles Upgrade und beim Update aktueller SQL Server-Versionen anhand von Hotfixes oder Service Packs als paralleles Update bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="f36dd-104">For upgrading SQL Server versions, it is known as rolling upgrade; for updating the current SQL Server version with hotfixes or service packs, it is known as rolling update.</span></span>  
  
 <span data-ttu-id="f36dd-105">Dieses Thema beschränkt sich auf Upgrades/Updates von SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f36dd-105">This topic limits the discussion to SQL Server upgrades/updates only.</span></span> <span data-ttu-id="f36dd-106">Informationen zu Betriebssystem bezogenen Upgrades/Aktualisierungen, unter denen die SQL Server Instanzen mit hoher Verfügbarkeit ausgeführt werden, finden Sie unter [Cluster übergreifende Migration von AlwaysOn-Verfügbarkeitsgruppen für Betriebssystem Upgrades](https://msdn.microsoft.com/library/jj873730.aspx) .</span><span class="sxs-lookup"><span data-stu-id="f36dd-106">For operating system-related upgrades/updates that the highly-available SQL Server instances are running on, see [Cross-cluster Migration of AlwaysOn Availability Groups for Operating System Upgrades](https://msdn.microsoft.com/library/jj873730.aspx)</span></span>  
  
## <a name="rolling-upgradeupdate-best-practices-for-alwayson-availability-groups"></a><span data-ttu-id="f36dd-107">Bewährte Verfahren für parallele Upgrades/Updates von AlwaysOn-Verfügbarkeitsgruppen</span><span class="sxs-lookup"><span data-stu-id="f36dd-107">Rolling Upgrade/Update Best Practices for AlwaysOn Availability Groups</span></span>  
 <span data-ttu-id="f36dd-108">Beachten Sie beim Ausführen von Serverupgrades/-updates die folgenden bewährten Verfahren, um die Downtime und Datenverluste für Verfügbarkeitsgruppen zu minimieren:</span><span class="sxs-lookup"><span data-stu-id="f36dd-108">The following best practices should be observed when performing server upgrades/updates in order to minimize downtime and data loss for your availability groups:</span></span>  
  
-   <span data-ttu-id="f36dd-109">Vor dem Start des parallelen Upgrades/Updates:</span><span class="sxs-lookup"><span data-stu-id="f36dd-109">Before starting the rolling upgrade/update,</span></span>  
  
    -   <span data-ttu-id="f36dd-110">Führen Sie zu Übungszwecken ein manuelles Failover für mindestens eines der Replikate mit synchronem Commit aus.</span><span class="sxs-lookup"><span data-stu-id="f36dd-110">Perform a practice manual failover on at least one of your synchronous-commit replicas</span></span>  
  
    -   <span data-ttu-id="f36dd-111">Schützen Sie Ihre Daten, indem Sie eine vollständige Datenbanksicherung für jede Verfügbarkeitsdatenbank ausführen.</span><span class="sxs-lookup"><span data-stu-id="f36dd-111">Protect your data by performing a full database backup on every availability database</span></span>  
  
    -   <span data-ttu-id="f36dd-112">Führen Sie DBCC CHECKDB für jede Verfügbarkeitsdatenbank aus.</span><span class="sxs-lookup"><span data-stu-id="f36dd-112">Run DBCC CHECKDB on every availability database</span></span>  
  
-   <span data-ttu-id="f36dd-113">Führen Sie das Upgrade/Update zuerst immer für die sekundären Remotereplikatknoten und dann für die lokalen sekundären Replikatknoten und zuletzt für den primären Replikatknoten aus.</span><span class="sxs-lookup"><span data-stu-id="f36dd-113">Always upgrade/update the remote secondary replica nodes first, then local secondary replica nodes next, and the primary replica node last.</span></span>  
  
-   <span data-ttu-id="f36dd-114">Von einer Datenbank, für die gerade ein Upgrade ausgeführt wird, kann keine Sicherung erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="f36dd-114">Backups cannot occur on a database that is in the process of being upgraded.</span></span>  <span data-ttu-id="f36dd-115">Vor dem Aktualisieren der sekundären Replikate konfigurieren Sie die Voreinstellung für die automatisierte Sicherung, um Sicherungen nur auf dem primären Replikat auszuführen.</span><span class="sxs-lookup"><span data-stu-id="f36dd-115">Prior to upgrading the secondary replicas, configure the automated backup preference to run backups only on the primary replica.</span></span>  <span data-ttu-id="f36dd-116">Vor dem Upgrade des primären Replikats sollten Sie diese Einstellung so ändern, dass nur Sicherungen auf den sekundären Replikaten ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="f36dd-116">Prior to upgrading the primary replica, modify this setting to run backups only on the secondary replicas.</span></span>  
  
-   <span data-ttu-id="f36dd-117">Damit für die Verfügbarkeitsgruppe während des Upgrades/Updates kein unbeabsichtigter Failover ausgeführt wird, entfernen Sie den Verfügbarkeitsfailover zunächst von allen Replikaten mit synchronem Commit.</span><span class="sxs-lookup"><span data-stu-id="f36dd-117">To prevent the availability group from unintended failovers during the upgrade/update process, remove availability failover from all synchronous-commit replicas before you begin.</span></span>  
  
-   <span data-ttu-id="f36dd-118">Führen Sie für den primären Replikatknoten kein Upgrade aus, bevor Sie für die Verfügbarkeitsgruppe kein Failover auf einen aktualisierten Knoten mit sekundärem Replikat ausgeführt haben.</span><span class="sxs-lookup"><span data-stu-id="f36dd-118">Do not upgrade the primary replica node before failing over the availability group to an upgraded node with a secondary replica first.</span></span> <span data-ttu-id="f36dd-119">Andernfalls kann sich die Downtime von Clientanwendungen während des Upgrades/Updates auf dem primären Replikat verlängern.</span><span class="sxs-lookup"><span data-stu-id="f36dd-119">Otherwise, client applications may suffer extended downtime during the upgrade/update on the primary replica.</span></span>  
  
-   <span data-ttu-id="f36dd-120">Führen Sie für die Verfügbarkeitsgruppe immer ein Failover auf den sekundären Replikatknoten mit synchronem Commit aus.</span><span class="sxs-lookup"><span data-stu-id="f36dd-120">Always fail over the availability group to a synchronous-commit secondary replica node.</span></span> <span data-ttu-id="f36dd-121">Wenn Sie ein Failover auf ein sekundäres Replikat mit asynchronem Commit ausführen, treten in den Datenbanken Datenverluste auf und die Datenverschiebung wird automatisch so lange angehalten, bis der Vorgang manuell fortgesetzt wird.</span><span class="sxs-lookup"><span data-stu-id="f36dd-121">If you fail over to an asynchronous-commit secondary replica, the databases will suffer data loss, and data movement is automatically suspended until you manually resume data movement.</span></span>  
  
-   <span data-ttu-id="f36dd-122">Führen Sie für den primären Replikatknoten kein Upgrade/Upgrade aus, bevor Sie das Upgrade/Update der übrigen sekundären Replikatknoten nicht abgeschlossen haben.</span><span class="sxs-lookup"><span data-stu-id="f36dd-122">Do not upgrade/update the primary replica node before upgrading/updating any other secondary replica nodes.</span></span> <span data-ttu-id="f36dd-123">Ein primäres Replikat, für das ein Upgrade ausgeführt wurde, kann keine Protokolle mehr an sekundäre Replikate senden, für die noch kein Upgrade auf dieselbe Version ausgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="f36dd-123">An upgraded primary replica can no longer ship logs to any secondary replica that has not yet been upgraded to the same version.</span></span> <span data-ttu-id="f36dd-124">Wenn eine Datenverschiebung zu einem sekundären Replikat angehalten wurde, kann für dieses Replikat kein automatisches Failover ausgeführt werden, und die Verfügbarkeitsdatenbanken sind anfällig für Datenverluste.</span><span class="sxs-lookup"><span data-stu-id="f36dd-124">When data movement to a secondary replica is suspended, no automatic failover can occur for that replica, and your availability databases are vulnerable to data loss.</span></span>  
  
-   <span data-ttu-id="f36dd-125">Bevor Sie ein Failover für eine Verfügbarkeitsgruppe ausführen, sollten Sie überprüfen, ob der Synchronisierungsstatus des Failoverziels SYNCHRONIZED lautet.</span><span class="sxs-lookup"><span data-stu-id="f36dd-125">Before failing over an availability group, verify that the synchronization state of the failover target is SYNCHRONIZED.</span></span>  
  
## <a name="rolling-upgradeupdate-process"></a><span data-ttu-id="f36dd-126">Schritte zur Ausführung des parallelen Upgrades/Updates</span><span class="sxs-lookup"><span data-stu-id="f36dd-126">Rolling Upgrade/Update Process</span></span>  
 <span data-ttu-id="f36dd-127">Die genauen Schritte hängen von Faktoren wie der Bereitstellungstopologie der Verfügbarkeitsgruppen und dem Commitmodus der einzelnen Replikate ab.</span><span class="sxs-lookup"><span data-stu-id="f36dd-127">In practice, the exact process will depend on factors such as the deployment topology of your availability groups and the commit mode of each replica.</span></span> <span data-ttu-id="f36dd-128">Im einfachsten Szenario ist ein paralleles Upgrade/Update jedoch ein mehrstufiger Prozess, der aus den folgenden Phasen besteht:</span><span class="sxs-lookup"><span data-stu-id="f36dd-128">But in the simplest scenario, a rolling upgrade/update is a multi-stage process that in its simplest form involves the following steps:</span></span>  
  
 <span data-ttu-id="f36dd-129">![Szenario 'Upgrade von Verfügbarkeitsgruppen in HADR'](../../media/alwaysonupgrade-ag-hadr.gif "Szenario 'Upgrade von Verfügbarkeitsgruppen in HADR'")</span><span class="sxs-lookup"><span data-stu-id="f36dd-129">![Availability Group Upgrade in HADR Scenario](../../media/alwaysonupgrade-ag-hadr.gif "Availability Group Upgrade in HADR Scenario")</span></span>  
  
1.  <span data-ttu-id="f36dd-130">Deaktivieren des automatischen Failovers für alle Replikate mit synchronem Commit</span><span class="sxs-lookup"><span data-stu-id="f36dd-130">Remove automatic failover on all synchronous-commit replicas</span></span>  
  
2.  <span data-ttu-id="f36dd-131">Ausführen eines Upgrades/Updates für alle Remoteserverinstanzen, auf denen sekundäre Replikate mit asynchronem Commit ausgeführt werden</span><span class="sxs-lookup"><span data-stu-id="f36dd-131">Upgrade/update all remote server instances running asynchronous-commit secondary replicas</span></span>  
  
3.  <span data-ttu-id="f36dd-132">Ausführen eines Upgrades/Updates für alle lokalen Serverinstanzen, auf denen das primäre Replikat derzeit nicht ausgeführt wird</span><span class="sxs-lookup"><span data-stu-id="f36dd-132">Upgrade/update the all local server instances that are not currently running the primary replica</span></span>  
  
4.  <span data-ttu-id="f36dd-133">Ausführen eines manuellen Failovers der Verfügbarkeitsgruppe auf ein sekundäres Replikat mit synchronem Commit</span><span class="sxs-lookup"><span data-stu-id="f36dd-133">Manually fail over the availability group to a synchronous-commit secondary replica</span></span>  
  
5.  <span data-ttu-id="f36dd-134">Ausführen eines Upgrades/Updates der Serverinstanz, von der das primäre Replikat zuvor gehostet wurde</span><span class="sxs-lookup"><span data-stu-id="f36dd-134">Upgrade/update the server instance that formerly hosted the primary replica</span></span>  
  
6.  <span data-ttu-id="f36dd-135">Konfigurieren automatischer Failoverpartner nach Bedarf</span><span class="sxs-lookup"><span data-stu-id="f36dd-135">Configure automatic failover partners as desired</span></span>  
  
 <span data-ttu-id="f36dd-136">Falls erforderlich, können Sie einen zusätzlichen manuellen Failover ausführen, um die ursprüngliche Konfiguration der Verfügbarkeitsgruppe wiederherzustellen.</span><span class="sxs-lookup"><span data-stu-id="f36dd-136">If necessary, you can perform an extra manual failover to return the availability group to its original configuration.</span></span>  
  
## <a name="availability-group-with-one-remote-secondary-replica"></a><span data-ttu-id="f36dd-137">Verfügbarkeitsgruppe mit einem sekundären Remotereplikat</span><span class="sxs-lookup"><span data-stu-id="f36dd-137">Availability Group with One Remote Secondary Replica</span></span>  
 <span data-ttu-id="f36dd-138">Wenn Sie eine Verfügbarkeitsgruppe ausschließlich zur Notfallwiederherstellung bereitgestellt haben, müssen Sie für die Verfügbarkeitsgruppe u. U. ein Failover auf ein sekundäres Replikat mit asynchronem Commit ausführen.</span><span class="sxs-lookup"><span data-stu-id="f36dd-138">If you have deployed an availability group only for disaster recovery, you may need to fail over the availability group to an asynchronous-commit secondary replica.</span></span> <span data-ttu-id="f36dd-139">Diese Konfiguration wird in der folgenden Abbildung dargestellt:</span><span class="sxs-lookup"><span data-stu-id="f36dd-139">Such configuration is illustrated by the following figure:</span></span>  
  
 <span data-ttu-id="f36dd-140">![Szenario 'Upgrade von Verfügbarkeitsgruppen in DR'](../../media/agupgrade-ag-dr.gif "Szenario 'Upgrade von Verfügbarkeitsgruppen in DR'")</span><span class="sxs-lookup"><span data-stu-id="f36dd-140">![Availability Group Upgrade in DR Scenario](../../media/agupgrade-ag-dr.gif "Availability Group Upgrade in DR Scenario")</span></span>  
  
 <span data-ttu-id="f36dd-141">In diesem Fall müssen Sie für die Verfügbarkeitsgruppe während des parallelen Upgrades/Updates ein Failover auf das sekundäre Replikat mit asynchronem Commit ausführen.</span><span class="sxs-lookup"><span data-stu-id="f36dd-141">In this situation, you must fail over the availability group to the asynchronous-commit secondary replica during the rolling upgrade/update.</span></span> <span data-ttu-id="f36dd-142">Zur Vermeidung von Datenverlusten ändern Sie den Commitmodus in den synchronen Commitmodus und warten mit dem Failover der Verfügbarkeitsgruppe, bis das sekundäre Replikat synchronisiert ist.</span><span class="sxs-lookup"><span data-stu-id="f36dd-142">To prevent data loss, change the commit mode to synchronous commit and wait for the secondary replica to be synchronized before you fail over the availability group.</span></span> <span data-ttu-id="f36dd-143">Das parallele Upgrade/Update kann somit folgende Schritte umfassen:</span><span class="sxs-lookup"><span data-stu-id="f36dd-143">Therefore, the rolling upgrade/update process may look as follows:</span></span>  
  
1.  <span data-ttu-id="f36dd-144">Upgrade/Update des Remoteservers</span><span class="sxs-lookup"><span data-stu-id="f36dd-144">Upgrade/update the remote server</span></span>  
  
2.  <span data-ttu-id="f36dd-145">Ändern des Commitmodus in den synchronen Commitmodus</span><span class="sxs-lookup"><span data-stu-id="f36dd-145">Change the commit mode to synchronous commit</span></span>  
  
3.  <span data-ttu-id="f36dd-146">Warten, bis der Synchronisierungsstatus SYNCHRONIZED lautet</span><span class="sxs-lookup"><span data-stu-id="f36dd-146">Wait until synchronization state is SYNCHRONIZED</span></span>  
  
4.  <span data-ttu-id="f36dd-147">Ausführen eines Failovers der Verfügbarkeitsgruppe auf den Remotestandort</span><span class="sxs-lookup"><span data-stu-id="f36dd-147">Fail over the availability group to the remote site</span></span>  
  
5.  <span data-ttu-id="f36dd-148">Upgrade/Update des lokalen Servers (am primären Standort)</span><span class="sxs-lookup"><span data-stu-id="f36dd-148">Upgrade/update the local (primary site) server</span></span>  
  
6.  <span data-ttu-id="f36dd-149">Ausführen eines Failovers der Verfügbarkeitsgruppe auf den primären Standort</span><span class="sxs-lookup"><span data-stu-id="f36dd-149">Fail over the availability group to the primary site</span></span>  
  
7.  <span data-ttu-id="f36dd-150">Ändern des Commitmodus in den asynchronen Commitmodus</span><span class="sxs-lookup"><span data-stu-id="f36dd-150">Change the commit mode to asynchronous commit</span></span>  
  
 <span data-ttu-id="f36dd-151">Der synchrone Commitmodus ist für die Datensynchronisierung mit einem Remotestandort nicht zu empfehlen. Nachdem die Einstellung geändert wurde, verzeichnen die Clientanwendungen möglicherweise einen sofortigen Anstieg der Datenbanklatenz.</span><span class="sxs-lookup"><span data-stu-id="f36dd-151">Since the synchronous-commit mode is not a recommended setting for data synchronization to a remote site, client applications may notice an immediate increase in database latency after the setting change.</span></span> <span data-ttu-id="f36dd-152">Darüber hinaus führt ein Failover dazu, dass alle unbestätigten Protokollmeldungen verworfen werden.</span><span class="sxs-lookup"><span data-stu-id="f36dd-152">Moreover, performing a failover will cause all unacknowledged log messages to be discarded.</span></span> <span data-ttu-id="f36dd-153">Die Anzahl der verworfenen Protokollmeldungen kann aufgrund hoher Netzwerklatenz zwischen den beiden Standorten deutlich erhöht sein, was auf den Clients zu einer hohen Rate von Transaktionsfehlern führt.</span><span class="sxs-lookup"><span data-stu-id="f36dd-153">The amount of discarded log messages can be quite large due to the high network latency between the two sites, causing clients to experience a high volume of transactional failure.</span></span> <span data-ttu-id="f36dd-154">Sie können die Auswirkungen auf die Clientanwendungen anhand der folgenden Maßnahmen minimieren:</span><span class="sxs-lookup"><span data-stu-id="f36dd-154">You can minimize impact to client applications by doing the following:</span></span>  
  
-   <span data-ttu-id="f36dd-155">Festlegen des Wartungsfensters auf Zeiten mit geringem Clientdatenverkehr</span><span class="sxs-lookup"><span data-stu-id="f36dd-155">Carefully select a maintenance window during low client traffic</span></span>  
  
-   <span data-ttu-id="f36dd-156">Ändern Sie den Verfügbarkeitsmodus beim Upgrade/Update von SQL Server am primären Standort zurück in den asynchronen Commitmodus, und kehren Sie zu synchronen Commits zurück, wenn Sie wieder bereit für ein Failover auf den primären Standort sind.</span><span class="sxs-lookup"><span data-stu-id="f36dd-156">While upgrading/updating SQL Server on the primary site, change the availability mode back to asynchronous commit, then revert to synchronous commit when you are ready to fail over to the primary site again</span></span>  
  
## <a name="availability-group-with-failover-cluster-instance-nodes"></a><span data-ttu-id="f36dd-157">Verfügbarkeitsgruppe mit Failoverclusterinstanz-Knoten</span><span class="sxs-lookup"><span data-stu-id="f36dd-157">Availability Group with Failover Cluster Instance Nodes</span></span>  
 <span data-ttu-id="f36dd-158">Wenn eine Verfügbarkeitsgruppe Failoverclusterinstanz-Knoten (Failover Cluster Instance, FCI) enthält, sollten Sie ein Upgrade/Update zunächst für die inaktiven und dann erst für die aktiven Knoten ausführen.</span><span class="sxs-lookup"><span data-stu-id="f36dd-158">If an availability group contains failover cluster instance (FCI) nodes, you should upgrade/update the inactive nodes before you upgrade/update the active nodes.</span></span> <span data-ttu-id="f36dd-159">In der folgenden Abbildung ist ein gängiges Verfügbarkeitsgruppenszenario mit FCIs dargestellt. Es basiert auf FCIs, die auf lokale Hochverfügbarkeit und asynchrone Commits zur Remote-Notfallwiederherstellung ausgelegt sind, und veranschaulicht die Schritte zum Ausführen des Upgrades.</span><span class="sxs-lookup"><span data-stu-id="f36dd-159">The figure below illustrates a common availability group scenario with FCIs for local high availability and asynchronous commit between the FCIs for remote disaster recovery, and the upgrade sequence.</span></span>  
  
 <span data-ttu-id="f36dd-160">![Upgrade von Verfügbarkeitsgruppen mit FCIs](../../media/agupgrade-ag-fci-dr.gif "Upgrade von Verfügbarkeitsgruppen mit FCIs")</span><span class="sxs-lookup"><span data-stu-id="f36dd-160">![Availability Group Upgrade with FCIs](../../media/agupgrade-ag-fci-dr.gif "Availability Group Upgrade with FCIs")</span></span>  
  
1.  <span data-ttu-id="f36dd-161">Upgrade/Update von REMOTE2</span><span class="sxs-lookup"><span data-stu-id="f36dd-161">Upgrade/update REMOTE2</span></span>  
  
2.  <span data-ttu-id="f36dd-162">Failover von FCI2 auf REMOTE2</span><span class="sxs-lookup"><span data-stu-id="f36dd-162">Fail over FCI2 to REMOTE2</span></span>  
  
3.  <span data-ttu-id="f36dd-163">Upgrade/Update von REMOTE1</span><span class="sxs-lookup"><span data-stu-id="f36dd-163">Upgrade/update REMOTE1</span></span>  
  
4.  <span data-ttu-id="f36dd-164">Upgrade/Update von PRIMARY2</span><span class="sxs-lookup"><span data-stu-id="f36dd-164">Upgrade/update PRIMARY2</span></span>  
  
5.  <span data-ttu-id="f36dd-165">Failover von FCI1 auf PRIMARY2</span><span class="sxs-lookup"><span data-stu-id="f36dd-165">Fail over FCI1 to PRIMARY2</span></span>  
  
6.  <span data-ttu-id="f36dd-166">Upgrade/Update von PRIMARY1</span><span class="sxs-lookup"><span data-stu-id="f36dd-166">Upgrade/update PRIMARY1</span></span>  
  
## <a name="upgradeupdate-sql-server-instances-with-multiple-availability-groups"></a><span data-ttu-id="f36dd-167">Upgrade/Update von SQL Server-Instanzen mit mehreren Verfügbarkeitsgruppen</span><span class="sxs-lookup"><span data-stu-id="f36dd-167">Upgrade/Update SQL Server Instances with Multiple Availability Groups</span></span>  
 <span data-ttu-id="f36dd-168">Wenn Sie mehrere Verfügbarkeitsgruppen mit primären Replikaten auf separaten Serverknoten ausführen (Aktiv-/Aktiv-Konfiguration), umfasst das Upgrade/Update mehr Failoverschritte, um Hochverfügbarkeit im Prozess sicherzustellen.</span><span class="sxs-lookup"><span data-stu-id="f36dd-168">If you are running multiple availability groups with primary replicas on separate server nodes (an Active/Active configuration), the upgrade/update path involves more failover steps to preserve high availability in the process.</span></span> <span data-ttu-id="f36dd-169">Angenommen, Sie führen drei Verfügbarkeitsgruppen auf drei Serverknoten aus (vgl. die folgende Tabelle) und alle sekundären Replikate werden im synchronen Commitmodus ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="f36dd-169">Suppose you are running three availability groups on three server nodes as shown in the following table, and all secondary replicas are running in synchronous-commit mode.</span></span>  
  
|<span data-ttu-id="f36dd-170">Verfügbarkeitsgruppe</span><span class="sxs-lookup"><span data-stu-id="f36dd-170">Availability Group</span></span>|<span data-ttu-id="f36dd-171">Knoten1</span><span class="sxs-lookup"><span data-stu-id="f36dd-171">Node1</span></span>|<span data-ttu-id="f36dd-172">Knoten2</span><span class="sxs-lookup"><span data-stu-id="f36dd-172">Node2</span></span>|<span data-ttu-id="f36dd-173">Knoten3</span><span class="sxs-lookup"><span data-stu-id="f36dd-173">Node3</span></span>|  
|------------------------|-----------|-----------|-----------|  
|<span data-ttu-id="f36dd-174">VG1</span><span class="sxs-lookup"><span data-stu-id="f36dd-174">AG1</span></span>|<span data-ttu-id="f36dd-175">Primär</span><span class="sxs-lookup"><span data-stu-id="f36dd-175">Primary</span></span>|||  
|<span data-ttu-id="f36dd-176">VG2</span><span class="sxs-lookup"><span data-stu-id="f36dd-176">AG2</span></span>||<span data-ttu-id="f36dd-177">Primär</span><span class="sxs-lookup"><span data-stu-id="f36dd-177">Primary</span></span>||  
|<span data-ttu-id="f36dd-178">VG3</span><span class="sxs-lookup"><span data-stu-id="f36dd-178">AG3</span></span>|||<span data-ttu-id="f36dd-179">Primär</span><span class="sxs-lookup"><span data-stu-id="f36dd-179">Primary</span></span>|  
  
 <span data-ttu-id="f36dd-180">In diesem Fall kann es von Vorteil sein, ein lastverteiltes paralleles Upgrade/Update in der folgenden Reihenfolge ausführen:</span><span class="sxs-lookup"><span data-stu-id="f36dd-180">It may be appropriate in your situation to perform a load-balanced rolling upgrade/update in the following sequence:</span></span>  
  
1.  <span data-ttu-id="f36dd-181">Failover von VG2 auf Knoten3 (um Knoten2 freizugeben)</span><span class="sxs-lookup"><span data-stu-id="f36dd-181">Fail over AG2 to Node3 (to free up Node2)</span></span>  
  
2.  <span data-ttu-id="f36dd-182">Upgrade/Update von Knoten2</span><span class="sxs-lookup"><span data-stu-id="f36dd-182">Upgrade/update Node2</span></span>  
  
3.  <span data-ttu-id="f36dd-183">Failover von VG1 auf Knoten2 (um Knoten1 freizugeben)</span><span class="sxs-lookup"><span data-stu-id="f36dd-183">Fail over AG1 to Node2 (to free up Node1)</span></span>  
  
4.  <span data-ttu-id="f36dd-184">Upgrade/Update von Knoten1</span><span class="sxs-lookup"><span data-stu-id="f36dd-184">Upgrade/update Node1</span></span>  
  
5.  <span data-ttu-id="f36dd-185">Failover sowohl von VG2 als auch von VG3 auf Knoten1 (um Knoten3 freizugeben)</span><span class="sxs-lookup"><span data-stu-id="f36dd-185">Fail over both AG2 and AG3 to Node1 (to free up Node3)</span></span>  
  
6.  <span data-ttu-id="f36dd-186">Upgrade/Update von Knoten3</span><span class="sxs-lookup"><span data-stu-id="f36dd-186">Upgrade/update Node3</span></span>  
  
7.  <span data-ttu-id="f36dd-187">Failover von VG3 auf Knoten3</span><span class="sxs-lookup"><span data-stu-id="f36dd-187">Fail over AG3 to Node3</span></span>  
  
 <span data-ttu-id="f36dd-188">Bei dieser Art von Upgrade/Update beträgt die durchschnittliche Downtime weniger als zwei Failover pro Verfügbarkeitsgruppe.</span><span class="sxs-lookup"><span data-stu-id="f36dd-188">This upgrade/update sequence has an average downtime of less than two failovers per availability group.</span></span> <span data-ttu-id="f36dd-189">Die resultierende Konfiguration ist in der folgenden Tabelle dargestellt.</span><span class="sxs-lookup"><span data-stu-id="f36dd-189">The resulting configuration is shown in the table below.</span></span>  
  
|<span data-ttu-id="f36dd-190">Verfügbarkeitsgruppe</span><span class="sxs-lookup"><span data-stu-id="f36dd-190">Availability Group</span></span>|<span data-ttu-id="f36dd-191">Knoten1</span><span class="sxs-lookup"><span data-stu-id="f36dd-191">Node1</span></span>|<span data-ttu-id="f36dd-192">Knoten2</span><span class="sxs-lookup"><span data-stu-id="f36dd-192">Node2</span></span>|<span data-ttu-id="f36dd-193">Knoten3</span><span class="sxs-lookup"><span data-stu-id="f36dd-193">Node3</span></span>|  
|------------------------|-----------|-----------|-----------|  
|<span data-ttu-id="f36dd-194">VG1</span><span class="sxs-lookup"><span data-stu-id="f36dd-194">AG1</span></span>||<span data-ttu-id="f36dd-195">Primär</span><span class="sxs-lookup"><span data-stu-id="f36dd-195">Primary</span></span>||  
|<span data-ttu-id="f36dd-196">VG2</span><span class="sxs-lookup"><span data-stu-id="f36dd-196">AG2</span></span>|<span data-ttu-id="f36dd-197">Primär</span><span class="sxs-lookup"><span data-stu-id="f36dd-197">Primary</span></span>|||  
|<span data-ttu-id="f36dd-198">VG3</span><span class="sxs-lookup"><span data-stu-id="f36dd-198">AG3</span></span>|||<span data-ttu-id="f36dd-199">Primär</span><span class="sxs-lookup"><span data-stu-id="f36dd-199">Primary</span></span>|  
  
 <span data-ttu-id="f36dd-200">Je nach der vorliegenden Implementierung kann der Upgrade-/Updatepfad abweichen. Das Gleiche gilt für die Downtime der Clientanwendungen.</span><span class="sxs-lookup"><span data-stu-id="f36dd-200">Based on your specific implementation, your upgrade/update path may vary, and the downtime that client applications experience may vary as well.</span></span>  
  
  

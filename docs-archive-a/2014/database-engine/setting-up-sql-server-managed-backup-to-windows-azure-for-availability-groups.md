---
title: Einrichten SQL Server verwalteten Sicherung in Azure für Verfügbarkeits Gruppen | Microsoft-Dokumentation
description: In diesem Tutorial wird gezeigt, wie Sie SQL Server verwaltete Sicherung für die Microsoft Azure für Datenbanken konfigurieren, die an Always on Verfügbarkeits Gruppen teilnehmen.
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
ms.assetid: 0c4553cd-d8e4-4691-963a-4e414cc0f1ba
author: mashamsft
ms.author: mathoma
ms.openlocfilehash: ebae9f75ac25698582b7f3e4c78c2fb773bd803e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87607968"
---
# <a name="setting-up-sql-server-managed-backup-to-azure-for-availability-groups"></a><span data-ttu-id="82a50-103">Einrichten der verwalteten SQL Server-Sicherung in Azure für Verfügbarkeitsgruppen</span><span class="sxs-lookup"><span data-stu-id="82a50-103">Setting up SQL Server Managed Backup to Azure for Availability Groups</span></span>
  <span data-ttu-id="82a50-104">Dieses Thema ist ein Lernprogramm zum Konfigurieren von [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] für Datenbanken, die an AlwaysOn-Verfügbarkeitsgruppen teilnehmen.</span><span class="sxs-lookup"><span data-stu-id="82a50-104">This topic is a tutorial on configuring [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for databases participating in AlwaysOn Availability Groups.</span></span>  
  
## <a name="availability-group-configurations"></a><span data-ttu-id="82a50-105">Verfügbarkeitsgruppenkonfigurationen</span><span class="sxs-lookup"><span data-stu-id="82a50-105">Availability Group Configurations</span></span>  
 [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)]<span data-ttu-id="82a50-106">wird für Datenbanken der Verfügbarkeits Gruppe unterstützt, unabhängig davon, ob die Replikate lokal oder vollständig in Azure konfiguriert sind oder eine Hybrid Implementierung zwischen lokalen Systemen und einem oder mehreren virtuellen Azure-Computern.</span><span class="sxs-lookup"><span data-stu-id="82a50-106">is supported for Availability Group databases, whether the replicas are all configured on-premises, or entirely on Azure, or a Hybrid implementation between on-premises and on one or more Azure virtual machines.</span></span> <span data-ttu-id="82a50-107">Allerdings müssen bei einigen Implementierungen u. U. folgende Aspekte berücksichtigt werden:</span><span class="sxs-lookup"><span data-stu-id="82a50-107">However you might need to consider the following for one or more implementations:</span></span>  
  
-   <span data-ttu-id="82a50-108">Häufigkeit von Protokollsicherungen: Je häufiger Protokolle gesichert werden, umso höher wird der Zeitaufwand und Speicherplatzbedarf.</span><span class="sxs-lookup"><span data-stu-id="82a50-108">Log Backup Frequency: The frequency of log backup is both time and log growth.</span></span> <span data-ttu-id="82a50-109">Beispielsweise wird alle zwei Stunden eine Protokollsicherung ausgeführt, es sei denn, der innerhalb des zweistündigen Zeitraums belegte Protokollspeicherplatz wächst auf fünf oder mehr MB an.</span><span class="sxs-lookup"><span data-stu-id="82a50-109">For example, the log backup is taken once every 2 hours unless the log space used within the two hour period is 5 MB or more.</span></span> <span data-ttu-id="82a50-110">Dies gilt ausnahmslos für lokale, cloudbasierte und Hybridimplementierungen.</span><span class="sxs-lookup"><span data-stu-id="82a50-110">This applies to all implementations, on-premises, cloud, or a Hybrid.</span></span>  
  
-   <span data-ttu-id="82a50-111">Netzwerkbandbreite: Dies gilt für Implementierungen, bei denen sich die Replikate an unterschiedlichen physischen Standorten befinden, wie z. b. in einem Hybrid Cloud oder über verschiedene Azure-Regionen in einer reinen cloudkonfiguration.</span><span class="sxs-lookup"><span data-stu-id="82a50-111">Network Bandwidth: This applies to implementations where the replicas are located in different physical locations, like in a hybrid cloud, or across different Azure regions in a cloud only configuration.</span></span> <span data-ttu-id="82a50-112">Die Netzwerkbandbreite kann die Latenz der sekundären Replikate beeinflussen, und wenn für die sekundären Replikate die synchrone Replikation festgelegt ist, kann das Protokoll auf dem primären Replikat anwachsen.</span><span class="sxs-lookup"><span data-stu-id="82a50-112">The network bandwidth can affect the latency of the secondaries and if the secondaries are set to synchronous replication, then this can cause log growth on the primary.</span></span> <span data-ttu-id="82a50-113">Wenn für die sekundären Replikate die synchrone Replikation festgelegt wurde, können sie aufgrund der Netzwerklatenz u. U. nicht mehr Schritt halten, was bei einem Failover auf das sekundäre Replikat zu Datenverlusten führen kann.</span><span class="sxs-lookup"><span data-stu-id="82a50-113">If the secondaries are set to synchronous replication, the secondaries may not be able to keep up due to network latency, which can result in data loss in the event of a failover to the secondary replica.</span></span>  
  
### <a name="configuring-ss_smartbackup-for-availability-databases"></a><span data-ttu-id="82a50-114">Konfigurieren von [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] für Verfügbarkeitsdatenbanken.</span><span class="sxs-lookup"><span data-stu-id="82a50-114">Configuring [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for Availability Databases.</span></span>  
 <span data-ttu-id="82a50-115">**Berechtigungen:**</span><span class="sxs-lookup"><span data-stu-id="82a50-115">**Permissions:**</span></span>  
  
-   <span data-ttu-id="82a50-116">Erfordert die Mitgliedschaft in **db_backupoperator** Daten Bank Rolle mit **ALTER ANY CREDENTIAL** -Berechtigungen und `EXECUTE` Berechtigungen für **sp_delete_backuphistory**gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="82a50-116">Requires membership in **db_backupoperator** database role, with **ALTER ANY CREDENTIAL** permissions, and `EXECUTE` permissions on **sp_delete_backuphistory**stored procedure.</span></span>  
  
-   <span data-ttu-id="82a50-117">Erfordert **Select** -Berechtigungen für die **smart_admin. fn_get_current_xevent_settings**-Funktion.</span><span class="sxs-lookup"><span data-stu-id="82a50-117">Requires **SELECT** permissions on the **smart_admin.fn_get_current_xevent_settings**function.</span></span>  
  
-   <span data-ttu-id="82a50-118">Erfordert `EXECUTE` Berechtigungen für die gespeicherte Prozedur **smart_admin. sp_get_backup_diagnostics** .</span><span class="sxs-lookup"><span data-stu-id="82a50-118">Requires `EXECUTE` permissions on the **smart_admin.sp_get_backup_diagnostics** stored procedure.</span></span> <span data-ttu-id="82a50-119">Außerdem sind `VIEW SERVER STATE`-Berechtigungen erforderlich, da andere Systemobjekte, die diese Berechtigung erfordern, intern aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="82a50-119">In addition, it requires `VIEW SERVER STATE` permissions as it internally calls other system objects that require this permission.</span></span>  
  
-   <span data-ttu-id="82a50-120">Erfordert `EXECUTE` Berechtigungen für die `smart_admin.sp_set_instance_backup` `smart_admin.sp_backup_master_switch` gespeicherten Prozeduren und.</span><span class="sxs-lookup"><span data-stu-id="82a50-120">Requires `EXECUTE` permissions on the `smart_admin.sp_set_instance_backup` and `smart_admin.sp_backup_master_switch` stored procedures.</span></span>  
  
 <span data-ttu-id="82a50-121">Die folgenden allgemeinen Schritte sind zum Einrichten einer AlwaysOn-Verfügbarkeitsgruppe mit [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] erforderlich.</span><span class="sxs-lookup"><span data-stu-id="82a50-121">The following are the basic steps to setting up an AlwaysOn Availability Group with [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span></span> <span data-ttu-id="82a50-122">Ein ausführliches schrittweises Lernprogramm wird weiter unten in diesem Thema beschrieben.</span><span class="sxs-lookup"><span data-stu-id="82a50-122">A detailed step-by step tutorial is described later in this topic.</span></span>  
  
1.  <span data-ttu-id="82a50-123">Konfigurieren Sie nach dem Erstellen der Verfügbarkeitsgruppe das bevorzugte Sicherungsreplikat.</span><span class="sxs-lookup"><span data-stu-id="82a50-123">Once you have created Availability Group, configure the preferred backup replica.</span></span> <span data-ttu-id="82a50-124">Diese Einstellung der Verfügbarkeitsgruppe wird auch von [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] verwendet, um festzustellen, welches Replikat für die Sicherung verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="82a50-124">This setting for the Availability Group is also used by [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] to determine which replica to use for backup.</span></span> <span data-ttu-id="82a50-125">Schritt-für-Schritt-Anleitungen zum Einrichten der Sicherungs Einstellungen finden Sie unter [Konfigurieren der Sicherung auf Verfügbarkeits Replikaten &#40;SQL Server&#41;](availability-groups/windows/configure-backup-on-availability-replicas-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="82a50-125">For step by step instructions about how to set up the backup preference, see [Configure Backup on Availability Replicas &#40;SQL Server&#41;](availability-groups/windows/configure-backup-on-availability-replicas-sql-server.md).</span></span>  <span data-ttu-id="82a50-126">Wenn Sie eine neue AlwaysOn-Verfügbarkeits Gruppe erstellen, finden Sie weitere Informationen unter [Getting Started with AlwaysOn-Verfügbarkeitsgruppen &#40;SQL Server&#41;](availability-groups/windows/getting-started-with-always-on-availability-groups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="82a50-126">If you are creating a new AlwaysOn Availability Group, see [Getting Started with AlwaysOn Availability Groups &#40;SQL Server&#41;](availability-groups/windows/getting-started-with-always-on-availability-groups-sql-server.md).</span></span>  
  
2.  <span data-ttu-id="82a50-127">Konfigurieren Sie den schreibgeschützten Verbindungszugriff auf sekundäre Replikate.</span><span class="sxs-lookup"><span data-stu-id="82a50-127">Configure read only connection access to the secondary replicas.</span></span> <span data-ttu-id="82a50-128">Schritt-für-Schritt-Anleitungen zum Konfigurieren des schreibgeschützten Zugriffs finden Sie unter Konfigurieren des schreibgeschützten [Zugriffs auf ein Verfügbarkeits Replikat &#40;SQL Server&#41;](availability-groups/windows/configure-read-only-access-on-an-availability-replica-sql-server.md)</span><span class="sxs-lookup"><span data-stu-id="82a50-128">For step by step instructions about how to configure read only access, see [Configure Read-Only Access on an Availability Replica &#40;SQL Server&#41;](availability-groups/windows/configure-read-only-access-on-an-availability-replica-sql-server.md)</span></span>  
  
3.  <span data-ttu-id="82a50-129">Geben Sie das Sicherungsreplikat an.</span><span class="sxs-lookup"><span data-stu-id="82a50-129">Specify Backup replica.</span></span> <span data-ttu-id="82a50-130">Die Einstellung für das bevorzugte Sicherungsreplikat wird von [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] verwendet, um festzustellen, welche Datenbank für die Planung von Sicherungen verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="82a50-130">The preferred backup replica setting is used by [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] to determine which database to use for scheduling backups from..</span></span>  <span data-ttu-id="82a50-131">Um zu ermitteln, ob das aktuelle Replikat das bevorzugte Sicherungs Replikat ist, verwenden Sie die [&#41;Funktion sys. fn_hadr_backup_is_preferred_replica &#40;Transact-SQL](/sql/relational-databases/system-functions/sys-fn-hadr-backup-is-preferred-replica-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="82a50-131">To determine whether the current replica is the preferred backup replica, use the [sys.fn_hadr_backup_is_preferred_replica  &#40;Transact-SQL&#41;](/sql/relational-databases/system-functions/sys-fn-hadr-backup-is-preferred-replica-transact-sql) function.</span></span>  
  
4.  <span data-ttu-id="82a50-132">Führen Sie auf jedem Replikat die [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] Konfiguration für die Datenbank mithilfe der gespeicherten Prozedur **Smart-admin. sp_set_db_backup** aus.</span><span class="sxs-lookup"><span data-stu-id="82a50-132">On each replica run [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] configuration for the database using the **smart-admin.sp_set_db_backup** stored procedure.</span></span>  
  
     <span data-ttu-id="82a50-133">\*\* [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] Verhalten nach einem Failover:\*\* [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] funktioniert nach einem failoverereignis weiterhin und behält Sicherungskopien und die Wiederherstellbarkeit bei.</span><span class="sxs-lookup"><span data-stu-id="82a50-133">**[!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] behavior after a failover:** [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] will continue to work and maintain backup copies and recoverability after a failover event.</span></span> <span data-ttu-id="82a50-134">Nach einem Failover sind keine speziellen Aktionen erforderlich.</span><span class="sxs-lookup"><span data-stu-id="82a50-134">No specific action is required after a failover.</span></span>  
  
#### <a name="considerations-and-requirements"></a><span data-ttu-id="82a50-135">Überlegungen und Anforderungen:</span><span class="sxs-lookup"><span data-stu-id="82a50-135">Considerations and Requirements:</span></span>  
 <span data-ttu-id="82a50-136">Bei der Konfiguration von [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] für Datenbanken, die Teil einer AlwaysOn-Verfügbarkeitsgruppe sind, müssen bestimmte Überlegungen und Anforderungen berücksichtigt werden.</span><span class="sxs-lookup"><span data-stu-id="82a50-136">Configuring [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for databases participating in AlwaysOn Availability Group requires specific considerations and requirements.</span></span> <span data-ttu-id="82a50-137">In der folgenden Liste werden Überlegungen und Anforderungen aufgeführt:</span><span class="sxs-lookup"><span data-stu-id="82a50-137">Following is a list of considerations and requirements:</span></span>  
  
-   <span data-ttu-id="82a50-138">Die Konfigurationseinstellungen für [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] müssen für alle Datenbanken auf allen [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]-Knoten einer Verfügbarkeitsgruppe gleich sein.</span><span class="sxs-lookup"><span data-stu-id="82a50-138">The [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] configuration settings should be the same for all the databases on all the nodes of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] participating in the same Availability Group.</span></span> <span data-ttu-id="82a50-139">Dies erreichen Sie, indem Sie entweder für die primäre Datenbank und für alle Replikate auf der Datenbankebene dieselbe Konfiguration für [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] festlegen, oder indem Sie dieselben Standardeinstellungen für [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] auf allen Knoten festlegen, die Teil der Verfügbarkeitsgruppen sind.</span><span class="sxs-lookup"><span data-stu-id="82a50-139">You can achieve this either by setting  the same [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] configurations for the primary and all the replicas at the database level, or by setting the same default [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] settings on all the nodes participating in the Availability Groups.</span></span> <span data-ttu-id="82a50-140">Es wird empfohlen, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] für die Datenbank festzulegen, da durch die Konfiguration von [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] auf Datenbankebene die Einstellungen auf die Datenbanken begrenzt bleiben und Änderungen an den Standardeinstellungen alle anderen Datenbanken auf den Instanzen betreffen.</span><span class="sxs-lookup"><span data-stu-id="82a50-140">We recommend setting [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] at the database because configuring [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] at the database level lets you isolate the settings to the databases and changes to default settings affect all other databases on the instance.</span></span>  
  
-   <span data-ttu-id="82a50-141">Geben Sie das Sicherungsreplikat an.</span><span class="sxs-lookup"><span data-stu-id="82a50-141">Specify Backup replica.</span></span> <span data-ttu-id="82a50-142">Die bevorzugte Sicherungsreplikateinstellung wird von [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] verwendet, um die Sicherungen zu planen.</span><span class="sxs-lookup"><span data-stu-id="82a50-142">The preferred backup replica setting is used by [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] to schedule the backups.</span></span> <span data-ttu-id="82a50-143">Um zu ermitteln, ob das aktuelle Replikat das bevorzugte Sicherungs Replikat ist, verwenden Sie die [&#41;Funktion sys. fn_hadr_backup_is_preferred_replica &#40;Transact-SQL](/sql/relational-databases/system-functions/sys-fn-hadr-backup-is-preferred-replica-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="82a50-143">To determine whether the current replica is the preferred backup replica, use the [sys.fn_hadr_backup_is_preferred_replica  &#40;Transact-SQL&#41;](/sql/relational-databases/system-functions/sys-fn-hadr-backup-is-preferred-replica-transact-sql) function.</span></span>  
  
-   <span data-ttu-id="82a50-144">Wenn das sekundäre Replikat als bevorzugtes Replikat konfiguriert ist, muss für dieses Replikat mindestens ein schreibgeschützter Verbindungszugriff konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="82a50-144">If the secondary replica is configured as the preferred replica, it should be configured to have at least read only connection access.</span></span> <span data-ttu-id="82a50-145">Verfügbarkeitsgruppen, die keinen Verbindungszugriff auf sekundäre Datenbanken haben, werden nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="82a50-145">Availability groups that have no connection access to secondary databases are not supported.</span></span>  <span data-ttu-id="82a50-146">Weitere Informationen finden Sie unter [Konfigurieren des schreibgeschützten Zugriffs auf ein Verfügbarkeitsreplikat &#40;SQL Server&#41;](availability-groups/windows/configure-read-only-access-on-an-availability-replica-sql-server.md)besitzen.</span><span class="sxs-lookup"><span data-stu-id="82a50-146">For more information, see [Configure Read-Only Access on an Availability Replica &#40;SQL Server&#41;](availability-groups/windows/configure-read-only-access-on-an-availability-replica-sql-server.md).</span></span>  
  
-   <span data-ttu-id="82a50-147">Wenn Sie [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] konfigurieren, nachdem Sie die Verfügbarkeitsgruppe konfiguriert haben, versucht [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], alle vorhandenen Sicherungen in den Speichercontainer zu kopieren.</span><span class="sxs-lookup"><span data-stu-id="82a50-147">If you are configuring [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] after you configure the Availability Group, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] will attempt to copy any existing backups based and copy them over to the storage container.</span></span>  <span data-ttu-id="82a50-148">Wenn [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] keine vorhandenen Sicherungen findet bzw. nicht auf diese zugreifen kann, wird eine vollständige Datenbanksicherung geplant.</span><span class="sxs-lookup"><span data-stu-id="82a50-148">If [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] is unable to find or access existing backups, it will schedule a full database backup.</span></span> <span data-ttu-id="82a50-149">Dieser Schritt dient speziell der Optimierung von Sicherungsvorgängen für Datenbanken in einer Verfügbarkeitsgruppe.</span><span class="sxs-lookup"><span data-stu-id="82a50-149">This is done specifically to optimize the backup operations for Availability Group databases.</span></span>  
  
-   <span data-ttu-id="82a50-150">Möglicherweise möchten Sie die Einstellungen auf Instanzebene deaktivieren, wenn Sie eine neue Verfügbarkeits Datenbank erstellen, und Sie beabsichtigen nicht, die Einstellungen auf Instanzebene auf die Datenbank anzuwenden.</span><span class="sxs-lookup"><span data-stu-id="82a50-150">You may want to consider disabling the instance level settings if you are creating a new availability database, and you don't intend to apply the instance level settings to the database</span></span>  
  
-   <span data-ttu-id="82a50-151">Bei Verwendung der Verschlüsselung verwenden Sie dasselbe Zertifikat auf allen Replikaten.</span><span class="sxs-lookup"><span data-stu-id="82a50-151">When using encryption, use the same certificate on all the replicas.</span></span> <span data-ttu-id="82a50-152">Auf diese Weise ist gewährleistet, dass Sicherungsvorgänge im Falle eines Failovers oder einer Wiederherstellung auf einem anderen Replikat kontinuierlich und unterbrechungsfrei verlaufen.</span><span class="sxs-lookup"><span data-stu-id="82a50-152">This facilitates continued and uninterrupted backup operations in the event of a failover or restores to a different replica.</span></span>  
  
#### <a name="enable-and-configure-ss_smartbackup-for-an-availability-database"></a><span data-ttu-id="82a50-153">Aktivieren und Konfigurieren von [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] für eine Verfügbarkeitsdatenbank</span><span class="sxs-lookup"><span data-stu-id="82a50-153">Enable and Configure [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for an Availability Database</span></span>  
 <span data-ttu-id="82a50-154">In diesem Lernprogramm werden die Schritte zum Aktivieren und Konfigurieren von [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] für eine Datenbank (AGTestDB) auf den Computern Node1 und Node2 beschrieben, gefolgt von den Schritten, mit denen die Überwachung des Integritätsstatus von [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] aktiviert wird.</span><span class="sxs-lookup"><span data-stu-id="82a50-154">This tutorial describes the steps to enable and configure [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for a database (AGTestDB) on computers Node1 and Node2, followed by steps to enable monitoring the [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] health status.</span></span>  
  
1.  <span data-ttu-id="82a50-155">**Erstellen Sie ein Azure-Speicherkonto:** Die Sicherungen werden im Azure-BLOB-Speicherdienst gespeichert.</span><span class="sxs-lookup"><span data-stu-id="82a50-155">**Create an Azure storage account:** The backups are stored in the Azure Blob storage service.</span></span> <span data-ttu-id="82a50-156">Sie müssen zunächst ein Azure-Speicherkonto erstellen, falls Sie noch nicht über ein Konto verfügen.</span><span class="sxs-lookup"><span data-stu-id="82a50-156">You must first create an Azure storage account, if you do not already have one.</span></span> <span data-ttu-id="82a50-157">Weitere Informationen finden Sie unter [Erstellen eines Azure Storage Kontos](https://www.windowsazure.com/manage/services/storage/how-to-create-a-storage-account/).</span><span class="sxs-lookup"><span data-stu-id="82a50-157">For more information, see [Creating an Azure Storage Account](https://www.windowsazure.com/manage/services/storage/how-to-create-a-storage-account/).</span></span> <span data-ttu-id="82a50-158">Notieren Sie sich den Namen und die URL des Speicherkontos sowie die Zugriffsschlüssel.</span><span class="sxs-lookup"><span data-stu-id="82a50-158">Make a note of the storage account name, access keys, and URL of the storage account.</span></span> <span data-ttu-id="82a50-159">Aus dem Speicherkontonamen und den Zugriffsschlüsseln werden SQL-Anmeldeinformationen erstellt.</span><span class="sxs-lookup"><span data-stu-id="82a50-159">The storage account name and access key information is used to create a SQL Credential.</span></span> <span data-ttu-id="82a50-160">[!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] verwendet die SQL-Anmeldeinformationen während Sicherungsvorgängen, um sich beim Speicherkonto zu authentifizieren.</span><span class="sxs-lookup"><span data-stu-id="82a50-160">The SQL Credential is used by [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] during backup operations to authenticate to the storage account.</span></span>  
  
2.  <span data-ttu-id="82a50-161">**Erstellen Sie SQL** -Anmelde Informationen: Erstellen Sie SQL-Anmelde Informationen, indem Sie den Namen des Speicher Kontos als Identität und den Speicherzugriffs Schlüssel als Kennwort verwenden.</span><span class="sxs-lookup"><span data-stu-id="82a50-161">**Create a SQL Credential:** Create a SQL Credential using the name of the storage account as the Identity and the storage access key as the password.</span></span>  
  
3.  <span data-ttu-id="82a50-162">**Sicherstellen, dass der SQL Server-Agent-Dienst ausgeführt wird:** Starten Sie den SQL Server-Agent, wenn er nicht ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="82a50-162">**Ensure SQL Server Agent service is Started and Running:** Start SQL Server Agent if it is not currently running.</span></span> [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] <span data-ttu-id="82a50-163">benötigt einen laufenden SQL Server-Agent auf der Instanz, um Sicherungsvorgänge durchführen zu können.</span><span class="sxs-lookup"><span data-stu-id="82a50-163">requires SQL Server Agent to be running on the instance to perform backup operations.</span></span>  <span data-ttu-id="82a50-164">Sie können den SQL-Agent automatisch ausführen lassen, um zu gewährleisten, dass regelmäßig Sicherungen ausgeführt werden können.</span><span class="sxs-lookup"><span data-stu-id="82a50-164">You may want to set SQL Agent to run automatically to make sure that backup operations can occur regularly.</span></span>  
  
4.  <span data-ttu-id="82a50-165">**Festlegen der Beibehaltungs Dauer:** Bestimmen Sie die Beibehaltungs Dauer für die Sicherungsdateien.</span><span class="sxs-lookup"><span data-stu-id="82a50-165">**Determine the retention period:** Determine the retention period that you want for the backup files.</span></span> <span data-ttu-id="82a50-166">Die Beibehaltungsdauer wird in Tagen angegeben und kann zwischen 1 und 30 Tagen liegen.</span><span class="sxs-lookup"><span data-stu-id="82a50-166">The retention period is specified in days and can range from 1 to 30.</span></span> <span data-ttu-id="82a50-167">Die Beibehaltungsdauer bestimmt den Zeitraum für die Wiederherstellbarkeit der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="82a50-167">The retention period determines the recoverability time frame for the database.</span></span>  
  
5.  <span data-ttu-id="82a50-168">**Erstellen Sie ein Zertifikat oder einen asymmetrischen Schlüssel für die Verschlüsselung während der Wiederherstellung:** Erstellen Sie das Zertifikat auf dem ersten Knoten Node1, und exportieren Sie es dann mithilfe des [Sicherungs Zertifikats &#40;Transact-SQL-&#41;](/sql/t-sql/statements/backup-certificate-transact-sql)in eine Datei.</span><span class="sxs-lookup"><span data-stu-id="82a50-168">**Create a Certificate or Asymmetric key to use for encryption during back up:** Create the certificate on the first node Node1, and then export it to a file using [BACKUP CERTIFICATE &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-certificate-transact-sql)..</span></span> <span data-ttu-id="82a50-169">Erstellen Sie auf Node2 mithilfe der von Node1 exportierten Datei ein Zertifikat.</span><span class="sxs-lookup"><span data-stu-id="82a50-169">On Node 2, create a certificate using the file exported from Node 1 .</span></span> <span data-ttu-id="82a50-170">Weitere Informationen zum Erstellen eines Zertifikats aus einer Datei finden Sie im Beispiel unter Erstellen eines Zertifikats [&#40;Transact-SQL-&#41;](/sql/t-sql/statements/create-certificate-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="82a50-170">For more information on creating a certificate from a file, see the example in [CREATE CERTIFICATE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-certificate-transact-sql).</span></span>  
  
6.  <span data-ttu-id="82a50-171">**Aktivieren und konfigurieren [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] für agtestdb auf Node1:** starten Sie SQL Server Management Studio, und stellen Sie eine Verbindung mit der Instanz auf Node1 her, auf der die Verfügbarkeits Datenbank installiert ist.</span><span class="sxs-lookup"><span data-stu-id="82a50-171">**Enable and configure [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for AGTestDB on Node1:** Start SQL Server Management Studio  and connect to the instance on Node1 where the availability database  is installed.</span></span> <span data-ttu-id="82a50-172">Führen Sie im Abfragefenster folgende Anweisung aus, nachdem Sie die Werte für Datenbankname, Speicher-URL, SQL-Anmeldeinformationen und Beibehaltungsdauer Ihren Anforderungen entsprechend angepasst haben:</span><span class="sxs-lookup"><span data-stu-id="82a50-172">From the query window run the following statement after you modify the values for the database name, storage URL, SQL Credential and retention period per your requirements:</span></span>  
  
    ```sql  
    Use msdb;  
    GO  
    EXEC smart_admin.sp_set_db_backup   
                    @database_name='AGTestDB'   
                    ,@retention_days=30   
                    ,@credential_name='MyCredential'  
                    ,@encryption_algorithm ='AES_128'  
                    ,@encryptor_type= 'Certificate'  
                    ,@encryptor_name='MyBackupCert'  
                    ,@enable_backup=1;  
    GO  
    ```  
  
     <span data-ttu-id="82a50-173">Weitere Informationen zum Erstellen eines Zertifikats für die Verschlüsselung finden Sie im Schritt **Erstellen eines Sicherungs Zertifikats** unter [Erstellen einer verschlüsselten Sicherung](../relational-databases/backup-restore/create-an-encrypted-backup.md).</span><span class="sxs-lookup"><span data-stu-id="82a50-173">For more information on creating a certificate for encryption, see the **Create a Backup Certificate** step in [Create an Encrypted Backup](../relational-databases/backup-restore/create-an-encrypted-backup.md).</span></span>  
  
7.  <span data-ttu-id="82a50-174">**Aktivieren und konfigurieren [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] für agtestdb auf Node2:** starten Sie SQL Server Management Studio, und stellen Sie eine Verbindung mit der Instanz auf Node2 her, auf der die Verfügbarkeits Datenbank installiert ist.</span><span class="sxs-lookup"><span data-stu-id="82a50-174">**Enable and configure [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for AGTestDB on Node2:** Start SQL Server Management Studio and connect to the instance on Node2 where the availability database  is installed.</span></span> <span data-ttu-id="82a50-175">Führen Sie im Abfragefenster folgende Anweisung aus, nachdem Sie die Werte für Datenbankname, Speicher-URL, SQL-Anmeldeinformationen und Beibehaltungsdauer Ihren Anforderungen entsprechend angepasst haben:</span><span class="sxs-lookup"><span data-stu-id="82a50-175">From the query window run the following statement after you modify the values for the database name, storage URL, SQL Credential and retention period per your requirements:</span></span>  
  
    ```sql  
    Use msdb;  
    GO  
    EXEC smart_admin.sp_set_db_backup   
                    @database_name='AGTestDB'   
                    ,@retention_days=30   
                    ,@credential_name='MyCredential'  
                    ,@encryption_algorithm ='AES_128'  
                    ,@encryptor_type= 'Certificate'  
                    ,@encryptor_name='MyBackupCert'  
                    ,@enable_backup=1;  
    GO  
    ```  
  
     [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] <span data-ttu-id="82a50-176">ist damit für die angegebene Datenbank aktiviert.</span><span class="sxs-lookup"><span data-stu-id="82a50-176">is now enabled on the database you specified.</span></span> <span data-ttu-id="82a50-177">Es kann bis zu 15 Minuten dauern, bis die Sicherungsvorgänge für die Datenbank gestartet werden.</span><span class="sxs-lookup"><span data-stu-id="82a50-177">It may take up to 15 minutes for the backup operations on the database to start to run.</span></span> <span data-ttu-id="82a50-178">Die Sicherung wird auf dem bevorzugten Sicherungsreplikat durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="82a50-178">The backup will occur on the preferred backup replica.</span></span>  
  
8.  <span data-ttu-id="82a50-179">**Überprüfen Sie die Standardkonfiguration für erweiterte Ereignisse:**  Überprüfen Sie die Konfiguration für erweiterte Ereignisse, indem Sie die folgende Transact-SQL-Anweisung auf dem Replikat ausführen, das [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] von zum Planen der Sicherungen verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="82a50-179">**Review Extended Event Default Configuration:**  Review the Extended Event configuration by running the following transact-SQL statement on the replica that [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] is using to schedule the backups from.</span></span> <span data-ttu-id="82a50-180">Dies ist i. d. R. die Einstellung für das bevorzugte Sicherungsreplikat der Verfügbarkeitsgruppe, zu der die Datenbank gehört.</span><span class="sxs-lookup"><span data-stu-id="82a50-180">This is usually the preferred backup replica setting for the Availability Group that the database belongs to.</span></span>  
  
    ```sql  
    SELECT * FROM smart_admin.fn_get_current_xevent_settings(); 
    ```  
  
     <span data-ttu-id="82a50-181">Stellen Sie sicher, dass Ereignisse der Kanäle Admin, Operational und Analytical standardmäßig aktiviert sind und nicht deaktiviert werden können.</span><span class="sxs-lookup"><span data-stu-id="82a50-181">You should see that Admin, Operational  and Analytical channel events are enabled by default and cannot be disabled.</span></span> <span data-ttu-id="82a50-182">Dies sollte ausreichen, um alle Ereignisse zu überwachen, die ein manuelles Eingreifen erfordern.</span><span class="sxs-lookup"><span data-stu-id="82a50-182">This should be sufficient to monitor the events that require manual intervention.</span></span>  <span data-ttu-id="82a50-183">Sie können die Debugereignisse aktivieren. Diese Kanäle enthalten jedoch Informations- und Debugereignisse, die [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] zur Erkennung und Behebung von Fehlern verwendet.</span><span class="sxs-lookup"><span data-stu-id="82a50-183">You can enable the debug events, but these channels include informational and debug events that [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] uses to detect issues and solve them.</span></span> <span data-ttu-id="82a50-184">Weitere Informationen finden Sie unter [überwachen SQL Server verwalteten Sicherung in Azure](../relational-databases/backup-restore/sql-server-managed-backup-to-microsoft-azure.md).</span><span class="sxs-lookup"><span data-stu-id="82a50-184">For more information, see [Monitor SQL Server Managed Backup to Azure](../relational-databases/backup-restore/sql-server-managed-backup-to-microsoft-azure.md).</span></span>  
  
9. <span data-ttu-id="82a50-185">**Aktivieren und Konfigurieren der Benachrichtigung für den Integritätsstatus:** [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] verfügt über eine gespeicherte Prozedur, die einen Agent-Auftrag erstellt, um E-Mail-Benachrichtigungen mit Fehlern oder Warnungen zu senden, die möglicherweise ein Eingreifen erfordern.</span><span class="sxs-lookup"><span data-stu-id="82a50-185">**Enable and Configure Notification for Health Status:** [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] has a stored procedure that creates an agent job to send out e-mail notifications of errors or warnings that may require attention.</span></span>  <span data-ttu-id="82a50-186">Wenn Sie diese E-Mail-Benachrichtigungen erhalten möchten, müssen Sie das Ausführen der gespeicherten Prozedur aktivieren, durch die ein SQL Server-Agentauftrag erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="82a50-186">To receive such notifications, you must enable run the stored procedure which creates a SQL Server Agent Job.</span></span> <span data-ttu-id="82a50-187">In den folgenden Schritten wird der Prozess zum Aktivieren und Konfigurieren der E-Mail-Benachrichtigungen beschrieben:</span><span class="sxs-lookup"><span data-stu-id="82a50-187">The following steps describe the process to enable and configure e-mail notifications:</span></span>  
  
    1.  <span data-ttu-id="82a50-188">Richten Sie Datenbank-E-Mail ein, falls diese Funktion auf der Instanz noch nicht aktiviert wurde.</span><span class="sxs-lookup"><span data-stu-id="82a50-188">Setup Database Mail if it is not already enabled on the instance.</span></span> <span data-ttu-id="82a50-189">Weitere Informationen finden Sie unter [Configure Database Mail](../relational-databases/database-mail/configure-database-mail.md).</span><span class="sxs-lookup"><span data-stu-id="82a50-189">For more information, see [Configure Database Mail](../relational-databases/database-mail/configure-database-mail.md).</span></span>  
  
    2.  <span data-ttu-id="82a50-190">Konfigurieren Sie SQL Server-Agent-Benachrichtigungen für die Verwendung von Datenbank-E-Mail.</span><span class="sxs-lookup"><span data-stu-id="82a50-190">Configure SQL Server Agent Notification to use Database Mail.</span></span> <span data-ttu-id="82a50-191">Weitere Informationen finden Sie unter [Konfigurieren von SQL Server-Agent-Mail zum Verwenden von Datenbank-E-Mails](../relational-databases/database-mail/configure-sql-server-agent-mail-to-use-database-mail.md).</span><span class="sxs-lookup"><span data-stu-id="82a50-191">For more information, see [Configure SQL Server Agent Mail to Use Database Mail](../relational-databases/database-mail/configure-sql-server-agent-mail-to-use-database-mail.md).</span></span>  
  
    3.  <span data-ttu-id="82a50-192">**Aktivieren der E-mail-Benachrichtigungen für den Empfang von Sicherungsfehlern und Warnungen:** Führen Sie im Abfragefenster die folgenden Transact-SQL-Anweisungen aus:</span><span class="sxs-lookup"><span data-stu-id="82a50-192">**Enable e-mail notifications to receive backup errors and warnings:** From the query window, run the following Transact-SQL statements:</span></span>  
  
        ```sql  
        EXEC msdb.smart_admin.sp_set_parameter  
        @parameter_name = 'SSMBackup2WANotificationEmailIds',  
        @parameter_value = '<email>'  
        ```  
  
         <span data-ttu-id="82a50-193">Weitere Informationen und ein vollständiges Beispielskript finden [Sie unter Überwachen SQL Server verwalteten Sicherung in Azure](../relational-databases/backup-restore/sql-server-managed-backup-to-microsoft-azure.md).</span><span class="sxs-lookup"><span data-stu-id="82a50-193">For more information and a full sample script see [Monitor SQL Server Managed Backup to Azure](../relational-databases/backup-restore/sql-server-managed-backup-to-microsoft-azure.md).</span></span>  
  
10. <span data-ttu-id="82a50-194">**Anzeigen von Sicherungsdateien im Azure Storage Konto:** Stellen Sie über SQL Server Management Studio oder den Azure-Verwaltungsportal eine Verbindung mit dem Speicherkonto her.</span><span class="sxs-lookup"><span data-stu-id="82a50-194">**View backup files in the Azure Storage Account:** Connect to the storage account from SQL Server Management Studio or the Azure Management Portal.</span></span> <span data-ttu-id="82a50-195">Es wird ein Container für die Instanz von SQL Server angezeigt, die die Datenbank hostet, die Sie für die Verwendung von [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] konfiguriert haben.</span><span class="sxs-lookup"><span data-stu-id="82a50-195">You will see a container for the instance of SQL Server that hosts the database you configured to use [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span></span> <span data-ttu-id="82a50-196">Innerhalb der ersten 15 Minuten nach dem Aktivieren von [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] für die Datenbank können außerdem eine Datenbank- und eine Protokollsicherung angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="82a50-196">You may also see a database and a log backup within 15 minutes of enabling [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for the database.</span></span>  
  
11. <span data-ttu-id="82a50-197">**Überwachen des Integritätsstatus:**  Sie können die zuvor konfigurierten E-Mail-Benachrichtigungen verwenden oder die protokollierten Ereignisse manuell überwachen.</span><span class="sxs-lookup"><span data-stu-id="82a50-197">**Monitor the Health Status:**  You can monitor through e-mail notifications you configured previously, or actively monitor the events logged.</span></span> <span data-ttu-id="82a50-198">Die folgenden Beispiele zeigen einige Transact-SQL-Anweisungen, mit denen die Ereignisse angezeigt werden können:</span><span class="sxs-lookup"><span data-stu-id="82a50-198">The following are some example Transact-SQL Statements used to view the events:</span></span>  
  
    ```sql  
    --  view all admin events  
    Use msdb;  
    Go  
    DECLARE @startofweek datetime  
    DECLARE @endofweek datetime  
    SET @startofweek = DATEADD(Day, 1-DATEPART(WEEKDAY, CURRENT_TIMESTAMP), CURRENT_TIMESTAMP)   
    SET @endofweek = DATEADD(Day, 7-DATEPART(WEEKDAY, CURRENT_TIMESTAMP), CURRENT_TIMESTAMP)  
  
    DECLARE @eventresult TABLE  
    (event_type nvarchar(512),  
    event varchar (512),  
    timestamp datetime  
    )  
  
    INSERT INTO @eventresult  
  
    EXEC smart_admin.sp_get_backup_diagnostics @begin_time = @startofweek, @end_time = @endofweek  
  
    SELECT * from @eventresult  
    WHERE event_type LIKE '%admin%'  
    ```  
  
    ```sql  
    -- to enable debug events  
    Use msdb;  
    Go  
    EXEC smart_admin.sp_set_parameter 'FileRetentionDebugXevent', 'True'  
    ```  
  
    ```sql  
    --  View all events in the current week  
    Use msdb;  
    Go  
    DECLARE @startofweek datetime  
    DECLARE @endofweek datetime  
    SET @startofweek = DATEADD(Day, 1-DATEPART(WEEKDAY, CURRENT_TIMESTAMP), CURRENT_TIMESTAMP)   
    SET @endofweek = DATEADD(Day, 7-DATEPART(WEEKDAY, CURRENT_TIMESTAMP), CURRENT_TIMESTAMP)  
  
    EXEC smart_admin.sp_get_backup_diagnostics @begin_time = @startofweek, @end_time = @endofweek;  
    ```  
  
 <span data-ttu-id="82a50-199">Die in diesem Abschnitt beschriebenen Schritte sind speziell für die erste Konfiguration von [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] für die Datenbank vorgesehen.</span><span class="sxs-lookup"><span data-stu-id="82a50-199">The steps described in this section are specifically for configuring [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for the first time on the database.</span></span> <span data-ttu-id="82a50-200">Sie können die vorhandenen Konfigurationen mithilfe derselben gespeicherten System Prozedur smart_admin ändern **. sp_set_db_backup** und die neuen Werte bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="82a50-200">You can modify the existing configurations using the same system stored procedure **smart_admin.sp_set_db_backup** and provide the new values.</span></span> <span data-ttu-id="82a50-201">Weitere Informationen finden Sie unter [SQL Server verwaltete Sicherung in Azure-Beibehaltungs-und Speichereinstellungen](../../2014/database-engine/sql-server-managed-backup-to-windows-azure-retention-and-storage-settings.md).</span><span class="sxs-lookup"><span data-stu-id="82a50-201">For more information, see [SQL Server Managed Backup to Azure - Retention and Storage Settings](../../2014/database-engine/sql-server-managed-backup-to-windows-azure-retention-and-storage-settings.md).</span></span>  
  
### <a name="considerations-when-removing-a-database-from-alwayson-availability-group-configuration"></a><span data-ttu-id="82a50-202">Überlegungen zum Entfernen einer Datenbank aus der Konfiguration für eine AlwaysOn-Verfügbarkeitsgruppe</span><span class="sxs-lookup"><span data-stu-id="82a50-202">Considerations when Removing a Database from AlwaysOn Availability Group Configuration</span></span>  
 <span data-ttu-id="82a50-203">Wenn eine Datenbank aus der Konfiguration der AlwaysOn-Verfügbarkeits Gruppe entfernt wird und jetzt eine eigenständige Datenbank ist, empfiehlt es sich, eine Sicherung mithilfe [smart_admin. sp_backup_on_demand &#40;Transact-SQL-&#41;](/sql/relational-databases/system-stored-procedures/managed-backup-sp-backup-on-demand-transact-sql)durchgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="82a50-203">If a database is removed from the AlwaysOn Availability Group configuration and is now a stand-alone database, we recommend doing backup using [smart_admin.sp_backup_on_demand &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/managed-backup-sp-backup-on-demand-transact-sql).</span></span> <span data-ttu-id="82a50-204">Wenn Sie auf diese Weise eine Datenbanksicherung erstellen, entsteht eine neue Sicherungskette, und die Datei wird im instanzspezifischen Container anstatt im Verfügbarkeitscontainer abgelegt, in dem die Sicherungen gespeichert wurden, als die Datenbank Teil der Verfügbarkeitsgruppe war.</span><span class="sxs-lookup"><span data-stu-id="82a50-204">When you create a database backup  this way, it establishes  a new backup chain and the file will be placed in the instance specific container as opposed to Availability container where the backups were stored when the database was part of Availability Group.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="82a50-205">Die Wiederherstellbarkeit der Datenbank in diesem Szenario aus Sicherungen, die vor der Änderung des Verfügbarkeitsgruppenstatus durchgeführt wurden, ist nicht gewährleistet.</span><span class="sxs-lookup"><span data-stu-id="82a50-205">The recoverability of the database in this scenario from backups previous to the change in the Availability Group status is not guaranteed.</span></span>  
  

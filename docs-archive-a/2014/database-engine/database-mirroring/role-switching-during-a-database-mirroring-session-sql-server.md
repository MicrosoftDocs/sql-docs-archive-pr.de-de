---
title: Rollenwechsel während einer Datenbank-Spiegelungssitzung (SQL Server) | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- role switching [SQL Server]
- mirroring partners [SQL Server]
- failover [SQL Server]
- failover partners [SQL Server]
- database mirroring [SQL Server], partners
- partners in database mirroring sessions [SQL Server]
- failover [SQL Server], database mirroring
- database mirroring [SQL Server], failover
ms.assetid: a782d60d-0373-4386-bd77-9ec192553700
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 5e16adbad2106d623279edf9d443eae3755c7be5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87701792"
---
# <a name="role-switching-during-a-database-mirroring-session-sql-server"></a><span data-ttu-id="ca0ea-102">Rollenwechsel während einer Datenbank-Spiegelungssitzung (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="ca0ea-102">Role Switching During a Database Mirroring Session (SQL Server)</span></span>
  <span data-ttu-id="ca0ea-103">Im Kontext einer Datenbank-Spiegelungssitzung können die Prinzipal- und Spiegelrollen normalerweise im Rahmen des so genannten *Rollenwechsels*ausgetauscht werden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-103">Within the context of a database mirroring session, the principal and mirror roles are typically interchangeable in a process known as *role switching*.</span></span> <span data-ttu-id="ca0ea-104">Beim Rollenwechsel dient der Spiegelserver als *Failoverpartner* für den Prinzipalserver. Er übernimmt die Prinzipalrolle, stellt dessen Kopie der Datenbank wieder her und schaltet sie als neue Prinzipaldatenbank online.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-104">In role switching, the mirror server acts as the *failover partner* for the principal server, taking over the principal role, recovering its copy of the database and bringing it online as the new principal database.</span></span> <span data-ttu-id="ca0ea-105">Der ehemalige Prinzipalserver übernimmt, soweit verfügbar, die Spiegelrolle, und die zugehörige Datenbank wird zur neuen Spiegeldatenbank.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-105">The former principal server, when available, assumes the mirror role, and its database becomes the new mirror database.</span></span> <span data-ttu-id="ca0ea-106">Potenziell können die Rollen hin- und hergewechselt werden, entweder als Antwort auf auftretende Fehler oder zu Verwaltungszwecken.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-106">Potentially, the roles can switch back and forth either in response to multiple failures or for administrative purposes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ca0ea-107">Dieses Thema setzt voraus, dass Sie mit den Betriebsmodi der Datenbankspiegelung vertraut sind.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-107">This topic assumes that you are familiar with the database mirroring operating modes.</span></span> <span data-ttu-id="ca0ea-108">Weitere Informationen finden Sie unter [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-108">For more information, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
 <span data-ttu-id="ca0ea-109">Die folgende Abbildung zeigt die Spiegelungspartner **Partner_A** und **Partner_B**, die die Prinzipal- und Spiegelrollen bei einer Reihe automatischer oder manueller Failover wechseln.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-109">The following illustration shows mirroring partners, **Partner_A** and **Partner_B**, switching the principal and mirror roles over a series of automatic or manual failovers.</span></span>  
  
 <span data-ttu-id="ca0ea-110">![Zweifacher Rollenwechsel von Partnern](../media/dbm-roleswitching.gif "Zweifacher Rollenwechsel von Partnern")</span><span class="sxs-lookup"><span data-stu-id="ca0ea-110">![Partners switching twice between roles](../media/dbm-roleswitching.gif "Partners switching twice between roles")</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="ca0ea-111">Nach einem Rollenwechsel müssen Aufträge, die für die ehemalige Prinzipaldatenbank ausgeführt wurden, auf dem neuen Prinzipalserver erneut erstellt werden, damit sie dort ausgeführt werden können.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-111">After a role switch, jobs that ran on the former principal database must be recreated on the new principal server to run there.</span></span> <span data-ttu-id="ca0ea-112">Weitere Informationen finden Sie unter [Verwaltung von Anmeldenamen und Aufträgen nach einem Rollenwechsel &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-112">For more information, see [Management of Logins and Jobs After Role Switching &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span></span>  
  
 <span data-ttu-id="ca0ea-113">Es werden drei Typen des Rollenwechsels unterschieden: automatisches Failover, manuelles Failover und erzwungener Dienst (mit möglichem Datenverlust).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-113">Three types of role switching exist: automatic failover, manual failover, and forced service (with possible data loss).</span></span> <span data-ttu-id="ca0ea-114">Die Unterstützung der einzelnen Arten hängt vom Betriebsmodus der Sitzung ab.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-114">Support for each form depends on the operating mode of the session.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ca0ea-115">Falls Sie mit den Betriebsmodi nicht vertraut sind, finden Sie weitere Informationen unter [Betriebsmodi der Datenbankspiegelung](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-115">If you are unfamiliar with these operating modes, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
-   <span data-ttu-id="ca0ea-116">**Manuelles Failover**</span><span class="sxs-lookup"><span data-stu-id="ca0ea-116">**Manual failover**</span></span>  
  
     <span data-ttu-id="ca0ea-117">Der Modus für hohe Sicherheit unterstützt automatisches Failover.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-117">High-safety mode supports manual failover.</span></span> <span data-ttu-id="ca0ea-118">Wenn die Datenbank synchronisiert wird, kann der Datenbankbesitzer ein manuelles Failover starten.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-118">Whenever the database is synchronized, the database owner can initiate a manual failover.</span></span>  
  
     <span data-ttu-id="ca0ea-119">Das manuelle Failover dient zu Verwaltungszwecken.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-119">Manual failover is provided for administrative purposes.</span></span> <span data-ttu-id="ca0ea-120">Weitere Informationen hierzu finden Sie weiter unten in diesem Thema unter [Manuelles Failover](#ManualFailover).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-120">For more information, see [Manual Failover](#ManualFailover), later in this topic.</span></span>  
  
-   <span data-ttu-id="ca0ea-121">**Automatisches Failover**</span><span class="sxs-lookup"><span data-stu-id="ca0ea-121">**Automatic failover**</span></span>  
  
     <span data-ttu-id="ca0ea-122">Wenn ein Zeuge vorhanden ist, wird im Modus für hohe Sicherheit automatisches Failover unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-122">In the presence of a witness, high-safety mode supports automatic failover.</span></span> <span data-ttu-id="ca0ea-123">Das automatische Failover erfolgt nur beim Ausfall des Prinzipalservers, falls der Zeuge und der Spiegelserver noch miteinander verbunden sind und die Datenbank bereits synchronisiert ist.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-123">Automatic failover occurs only on the loss of the principal server when the witness and mirror server are still connected to each other and the database is already synchronized.</span></span> <span data-ttu-id="ca0ea-124">Weitere Informationen hierzu finden Sie weiter unten in diesem Thema unter [Automatisches Failover](#AutomaticFailover).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-124">For more information, see [Automatic Failover](#AutomaticFailover), later in this topic.</span></span>  
  
-   <span data-ttu-id="ca0ea-125">**Erzwungener Dienst (mit möglichem Datenverlust)**</span><span class="sxs-lookup"><span data-stu-id="ca0ea-125">**Forced service (with possible data loss)**</span></span>  
  
     <span data-ttu-id="ca0ea-126">Das Erzwingen des Dienstes wird im Modus für hohe Leistung und im Modus für hohe Sicherheit, sofern kein Zeuge festgelegt wurde, unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-126">Forcing service is supported in high-safety mode when no witness is set and in high-performance mode.</span></span> <span data-ttu-id="ca0ea-127">Bei einem Ausfall des Prinzipalservers kann der Datenbankbesitzer die Datenbank verfügbar machen, indem der Dienst des Spiegelservers erzwungen wird (mit möglichem Datenverlust).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-127">On the loss of the principal server, the database owner can make the database available by forcing service to the mirror server (with possible data loss).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="ca0ea-128">Es wird empfohlen, die WITNESS-Eigenschaft im Modus für hohe Leistung auf OFF festzulegen.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-128">We recommend that the WITNESS property be set to OFF in high-performance mode.</span></span> <span data-ttu-id="ca0ea-129">Andernfalls muss der Spiegelserver mit dem Zeugen verbunden sein, um die Datenbank online zu bringen.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-129">Otherwise, to bring the database online, the mirror server must connected to the witness.</span></span>  
  
     <span data-ttu-id="ca0ea-130">Weitere Informationen hierzu finden Sie weiter unten in diesem Thema unter [Erzwungener Dienst (mit möglichem Datenverlust)](#ForcedService).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-130">For more information, see [Forced Service (with Possible Data Loss)](#ForcedService), later in this topic.</span></span>  
  
 <span data-ttu-id="ca0ea-131">In der folgenden Tabelle ist zusammengefasst, welche Arten des Failovers von den verschiedenen Betriebsmodi unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-131">The following table summarizes which forms of failover are supported under each of the operating modes.</span></span>  
  
||<span data-ttu-id="ca0ea-132">Hohe Leistung</span><span class="sxs-lookup"><span data-stu-id="ca0ea-132">High performance</span></span>|<span data-ttu-id="ca0ea-133">Modus für hohe Sicherheit ohne einen Zeugen</span><span class="sxs-lookup"><span data-stu-id="ca0ea-133">High-safety mode without a witness</span></span>|<span data-ttu-id="ca0ea-134">Modus für hohe Sicherheit mit einem Zeugen</span><span class="sxs-lookup"><span data-stu-id="ca0ea-134">High-safety mode with a witness</span></span>|  
|-|----------------------|-----------------------------------------|--------------------------------------|  
|<span data-ttu-id="ca0ea-135">Automatisches Failover</span><span class="sxs-lookup"><span data-stu-id="ca0ea-135">Automatic failover</span></span>|<span data-ttu-id="ca0ea-136">Nein</span><span class="sxs-lookup"><span data-stu-id="ca0ea-136">No</span></span>|<span data-ttu-id="ca0ea-137">Nein</span><span class="sxs-lookup"><span data-stu-id="ca0ea-137">No</span></span>|<span data-ttu-id="ca0ea-138">Ja</span><span class="sxs-lookup"><span data-stu-id="ca0ea-138">Yes</span></span>|  
|<span data-ttu-id="ca0ea-139">Manuelles Failover</span><span class="sxs-lookup"><span data-stu-id="ca0ea-139">Manual failover</span></span>|<span data-ttu-id="ca0ea-140">Nein</span><span class="sxs-lookup"><span data-stu-id="ca0ea-140">No</span></span>|<span data-ttu-id="ca0ea-141">Ja</span><span class="sxs-lookup"><span data-stu-id="ca0ea-141">Yes</span></span>|<span data-ttu-id="ca0ea-142">Ja</span><span class="sxs-lookup"><span data-stu-id="ca0ea-142">Yes</span></span>|  
|<span data-ttu-id="ca0ea-143">Erzwungener Dienst</span><span class="sxs-lookup"><span data-stu-id="ca0ea-143">Forced service</span></span>|<span data-ttu-id="ca0ea-144">Ja</span><span class="sxs-lookup"><span data-stu-id="ca0ea-144">Yes</span></span>|<span data-ttu-id="ca0ea-145">Ja</span><span class="sxs-lookup"><span data-stu-id="ca0ea-145">Yes</span></span>|<span data-ttu-id="ca0ea-146">Nein</span><span class="sxs-lookup"><span data-stu-id="ca0ea-146">No</span></span>|  
  
 <span data-ttu-id="ca0ea-147">Nach einem Rollenwechsel müssen bestimmte Metadaten auf beiden Partnern vorhanden sein, um sicherzustellen, dass alle Datenbankbenutzer auf die neue Prinzipaldatenbank zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-147">After a role switch, certain metadata must exist on both partners to ensure that all of the database users can access the new principal database.</span></span> <span data-ttu-id="ca0ea-148">Darüber hinaus müssen Sicherungsaufträge auf dem neuen Prinzipalserver erstellt werden, damit die Datenbank weiterhin in regelmäßigen Abständen gesichert wird.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-148">In addition, backup jobs must be created on the new principal server, to ensure that the database continues to be backed up on its regular schedule.</span></span> <span data-ttu-id="ca0ea-149">Weitere Informationen finden Sie unter [Verwaltung von Anmeldenamen und Aufträgen nach einem Rollenwechsel &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-149">For more information, see [Management of Logins and Jobs After Role Switching &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span></span>  
  
 <span data-ttu-id="ca0ea-150">Wie lange die Datenbankspiegelung während eines Rollenwechsels nicht durchgeführt werden kann, hängt vom Typ des Rollenwechsels und von der Ursache ab.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-150">During a role switch, the amount of time that database mirroring will be out of service depends on the type of role switching and on the cause.</span></span> <span data-ttu-id="ca0ea-151">Weitere Informationen finden Sie unter [Einschätzen der Unterbrechung des Diensts während des Rollenwechsels &#40;Datenbankspiegelung&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md)ausgetauscht werden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-151">For more information, see [Estimate the Interruption of Service During Role Switching &#40;Database Mirroring&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md).</span></span>  
  
##  <a name="manual-failover"></a><a name="ManualFailover"></a> <span data-ttu-id="ca0ea-152">Manual Failover</span><span class="sxs-lookup"><span data-stu-id="ca0ea-152">Manual Failover</span></span>  
 <span data-ttu-id="ca0ea-153">Durch das manuelle Failover werden die Clients von der Datenbank getrennt und die Rollen der Partner umgekehrt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-153">Manual failover disconnects the clients from the database and reverses the roles of the partners.</span></span> <span data-ttu-id="ca0ea-154">Nur der Modus mit hoher Sicherheit unterstützt ein manuelles Failover.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-154">Only high-safety mode supports manual failover.</span></span>  
  
  
###  <a name="maintaining-availability-during-upgrades"></a><a name="AvailabilityDuringUpgrades"></a> <span data-ttu-id="ca0ea-155">Aufrechterhalten der Verfügbarkeit während Upgrades</span><span class="sxs-lookup"><span data-stu-id="ca0ea-155">Maintaining Availability During Upgrades</span></span>  
 <span data-ttu-id="ca0ea-156">Vom Datenbankadministrator kann das manuelle Failover zum Aktualisieren der Hardware oder Software ohne Einbußen bei der Verfügbarkeit verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-156">The database administrator can use manual failover for upgrading hardware or software without sacrificing availability.</span></span> <span data-ttu-id="ca0ea-157">Um die Datenbankspiegelung für Softwareupgrades zu verwenden, müssen die Upgrades bereits auf dem Spiegelserver und/oder dem System vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-157">To use database mirroring for software upgrades, the mirror server and/or system must have already received the upgrades.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ca0ea-158">Die Datenbankspiegelung sollte in der Lage sein, ein paralleles Upgrade auszuführen. Dies wird jedoch nicht garantiert, da zukünftige Änderungen unbekannt sind.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-158">Database mirroring should be able to do a rolling upgrade, but this is not guaranteed, because future changes are unknown.</span></span> <span data-ttu-id="ca0ea-159">Weitere Informationen finden Sie unter [Minimize Downtime for Mirrored Databases When Upgrading Server Instances](upgrading-mirrored-instances.md).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-159">For more information, see [Minimize Downtime for Mirrored Databases When Upgrading Server Instances](upgrading-mirrored-instances.md).</span></span>  
  
 <span data-ttu-id="ca0ea-160">Die folgende Abbildung veranschaulicht ein manuelles Failover, bei dem während des Upgrades einer Datenbankserverinstanz die Datenbank verfügbar bleibt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-160">The following figure illustrates an instance of using manual failover to maintain database availability while you upgrade a database server instance.</span></span> <span data-ttu-id="ca0ea-161">Nach dem Abschluss des Upgrades kann vom Administrator optional ein Failover zurück zur Originalserverinstanz durchgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-161">When the upgrade is completed, an administrator may optionally fail over back to the original server instance.</span></span> <span data-ttu-id="ca0ea-162">Dies ist nützlich, wenn der Administrator die Spiegelungssitzung beenden und den Spiegelserver anderweitig verwenden möchte.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-162">This is useful when the administrator wants to stop the mirroring session and use the mirror server elsewhere.</span></span> <span data-ttu-id="ca0ea-163">Auf diese Weise kann eine einzelne Serverinstanz wiederholt beim Aktualisieren einer Reihe von Datenbankserverinstanzen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-163">In this way, a single server instance can be used repeatedly when updating a series of database server instances.</span></span>  
  
 <span data-ttu-id="ca0ea-164">![Geplantes manuelles Failover:](../media/dbm-failovmanuplanned.gif "Geplantes manuelles Failover")</span><span class="sxs-lookup"><span data-stu-id="ca0ea-164">![Planned manual failover](../media/dbm-failovmanuplanned.gif "Planned manual failover")</span></span>  
  
###  <a name="conditions-required-for-a-manual-failover"></a><a name="ConditionsForManualFo"></a> <span data-ttu-id="ca0ea-165">Für ein manuelles Failover erforderliche Bedingungen</span><span class="sxs-lookup"><span data-stu-id="ca0ea-165">Conditions Required for a Manual Failover</span></span>  
 <span data-ttu-id="ca0ea-166">Für das manuelle Failover ist die Transaktionssicherheitseinstellung FULL erforderlich (d. h., der Modus für hohe Sicherheit).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-166">Manual failover requires transaction safety to be set to FULL (that is, high-safety mode).</span></span> <span data-ttu-id="ca0ea-167">Wenn die Partner verbunden sind und die Datenbank bereits synchronisiert ist, wird das manuelle Failover unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-167">When the partners are connected and the database is already synchronized, manual failover is supported.</span></span>  
  
###  <a name="how-manual-failover-works"></a><a name="HowManualFoWorks"></a> <span data-ttu-id="ca0ea-168">So funktioniert ein manuelles Failover</span><span class="sxs-lookup"><span data-stu-id="ca0ea-168">How Manual Failover Works</span></span>  
 <span data-ttu-id="ca0ea-169">Durch ein manuelles Failover wird die folgende Aktionskette ausgelöst:</span><span class="sxs-lookup"><span data-stu-id="ca0ea-169">Manual failover initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="ca0ea-170">Vom Prinzipalserver werden Clients von der Prinzipaldatenbank getrennt. Das Ende des Protokolls wird an den Spiegelserver gesendet, und in Vorbereitung auf den Wechsel der Spiegelrolle wird der Status der Prinzipaldatenbank auf SYNCHRONIZING festgelegt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-170">The principal server disconnects clients from the principal database, sends the tail of the log to the mirror server, and, in preparation for switching to the mirror role, sets the mirroring state to SYNCHRONIZING.</span></span>  
  
2.  <span data-ttu-id="ca0ea-171">Vom Spiegelserver wird die Protokollsequenznummer (LSN, Log Sequence Number) des letzten vom Prinzipal empfangenen Protokolldatensatzes als Failover-LSN aufgezeichnet.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-171">The mirror server records the log sequence number (LSN) of the last log record received from the principal as the failover LSN.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="ca0ea-172">Um die LSN anzuzeigen, wählen Sie die **mirroring_failover_lsn**-Spalte von [sys.database_mirroring &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-mirroring-transact-sql) aus.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-172">To view this LSN, select the **mirroring_failover_lsn** column from [sys.database_mirroring &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-mirroring-transact-sql).</span></span>  
  
3.  <span data-ttu-id="ca0ea-173">Wartet ein Protokoll in der Wiederholungswarteschlange, schließt der Spiegelserver den Rollforward der Spiegeldatenbank ab.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-173">If any log is waiting in the redo queue, the mirror server finishes rolling forward the mirror database.</span></span> <span data-ttu-id="ca0ea-174">Die erforderliche Zeit hängt von der Systemgeschwindigkeit, der aktuellen Arbeitsauslastung und der Menge der Protokolle in der Wiederholungswarteschlange ab.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-174">The amount of time required depends on the speed of the system, the recent workload, and the amount of log in the redo queue.</span></span> <span data-ttu-id="ca0ea-175">Für den synchronen Betriebsmodus kann die Failoverzeit durch die Begrenzung der Wiederholungswarteschlangengröße reguliert werden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-175">For a synchronous operating mode, the failover time can be regulated by limiting the size of the redo queue.</span></span> <span data-ttu-id="ca0ea-176">Das führt allerdings möglicherweise zu einem langsameren Prinzipalserver, damit vom Spiegelserver die Geschwindigkeit gehalten werden kann.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-176">However, this can cause the principal server to slow down to allow the mirror server to keep up.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="ca0ea-177">Zur Feststellung der aktuellen Größe der Wiederholungswarteschlange verwenden Sie den Leistungsindikator **Wiederholungswarteschlange** im Datenbankspiegelungs-Leistungsobjekt. Weitere Informationen finden Sie unter [Überwachen der Datenbankspiegelung &#40;SQL Server&#41;](database-mirroring-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-177">To learn the current size of the redo queue, use the **Redo Queue** performance counter in the database mirroring performance object (for more information, see [Monitoring Database Mirroring &#40;SQL Server&#41;](database-mirroring-sql-server.md)).</span></span>  
  
4.  <span data-ttu-id="ca0ea-178">Der Spiegelserver wird zum neuen Prinzipalserver, und der vorherige Prinzipalserver wird zum neuen Spiegelserver.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-178">The mirror server becomes the new principal server, and the former principal server becomes the new mirror server.</span></span>  
  
5.  <span data-ttu-id="ca0ea-179">Vom neuen Prinzipalserver wird für alle Transaktionen, für die kein Commit ausgeführt worden ist, ein Rollback ausgeführt und die Kopie der Datenbank als Prinzipaldatenbank online gestellt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-179">The new principal server rolls back any uncommitted transactions and brings its copy of the database online as the principal database.</span></span>  
  
6.  <span data-ttu-id="ca0ea-180">Der vorherige Prinzipal übernimmt die Spiegelrolle, und die vorherige Prinzipaldatenbank wird zur Spiegeldatenbank.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-180">The former principal takes on the mirror role, and the former principal database becomes the mirror database.</span></span> <span data-ttu-id="ca0ea-181">Vom neuen Spiegelserver wird die neue Spiegeldatenbank schnell mit der neuen Prinzipaldatenbank erneut synchronisiert.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-181">The new mirror server quickly resynchronizes the new mirror database with the new principal database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="ca0ea-182">Sobald der neue Spiegelserver die Datenbanken synchronisiert hat, ist ein Failover wieder möglich, jedoch in umgekehrter Richtung.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-182">As soon as the new mirror server has resynchronized the databases, failover is again possible, but in the reverse direction.</span></span>  
  
 <span data-ttu-id="ca0ea-183">Nach dem Failover müssen die Clients erneut eine Verbindung zur aktuellen Prinzipaldatenbank herstellen.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-183">After failover, clients must reconnect to the current principal database.</span></span> <span data-ttu-id="ca0ea-184">Weitere Informationen finden Sie unter [Verbinden von Clients mit einer Datenbank-Spiegelungssitzung &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md)ausgetauscht werden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-184">For more information, see [Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md).</span></span>  
  
 <span data-ttu-id="ca0ea-185">**So initiieren Sie ein manuelles Failover**</span><span class="sxs-lookup"><span data-stu-id="ca0ea-185">**To initiate manual failover**</span></span>  
  
-   [<span data-ttu-id="ca0ea-186">Manueller Failover für eine Datenbank-Spiegelungssitzung &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="ca0ea-186">Manually Fail Over a Database Mirroring Session &#40;SQL Server Management Studio&#41;</span></span>](manually-fail-over-a-database-mirroring-session-sql-server-management-studio.md)  
  
-   <span data-ttu-id="ca0ea-187">[Manuelles Failover für eine Datenbank-Spiegelungssitzung &#40;Transact-SQL&#41;](manually-fail-over-a-database-mirroring-session-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-187">[Manually Fail Over a Database Mirroring Session &#40;Transact-SQL&#41;](manually-fail-over-a-database-mirroring-session-transact-sql.md).</span></span>  
  
##  <a name="automatic-failover"></a><a name="AutomaticFailover"></a> <span data-ttu-id="ca0ea-188">Automatic Failover</span><span class="sxs-lookup"><span data-stu-id="ca0ea-188">Automatic Failover</span></span>  
 <span data-ttu-id="ca0ea-189">Automatisches Failover wird nur in Datenbank-Spiegelungssitzungen unterstützt, die mit einem Zeugen im Modus für hohe Sicherheit ausgeführt werden (*Modus für hohe Sicherheit mit automatischem Failover*).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-189">Automatic failover is supported only in database mirroring sessions running with a witness in high-safety mode (*high-safety mode with automatic failover*).</span></span> <span data-ttu-id="ca0ea-190">Im Modus für hohe Sicherheit mit automatischem Failover wird nach dem Synchronisieren der Datenbank ein automatisches Failover ausgeführt, wenn die Prinzipaldatenbank ausfällt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-190">In high-safety mode with automatic failover, once the database is synchronized, if the principal database becomes unavailable, an automatic failover occurs.</span></span> <span data-ttu-id="ca0ea-191">Bei einem automatischen Failover übernimmt der Spiegelserver die Rolle des Prinzipalservers und schaltet die eigene Datenbankkopie als Prinzipaldatenbank online.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-191">An automatic failover causes the mirror server to take over the role of principal server and bring its copy of the database online as the principal database.</span></span> <span data-ttu-id="ca0ea-192">Aufgrund der Voraussetzung, dass die Datenbank synchronisiert sein muss, werden Datenverluste während des Failovers verhindert, da für jede Transaktion, für die auf der Prinizipaldatenbank ein Commit ausgeführt wird, auch ein Commit auf der Spiegeldatenbank ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-192">Requiring that the database be synchronized prevents data loss during failover, because every transaction committed on the principal database is also committed on the mirror database.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="ca0ea-193">Damit das automatische Failover eine Verbesserung der Verfügbarkeit bedeutet, müssen sich Spiegel- und Prinzipaldatenbank auf verschiedenen Computern befinden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-193">For automatic failover to improve reliability, the mirror and principal databases must reside on different computers.</span></span>  
  
  
  
###  <a name="conditions-required-for-an-automatic-failover"></a><a name="ConditionsForAutoFo"></a> <span data-ttu-id="ca0ea-194">Für ein automatisches Failover erforderliche Bedingungen</span><span class="sxs-lookup"><span data-stu-id="ca0ea-194">Conditions Required for an Automatic Failover</span></span>  
 <span data-ttu-id="ca0ea-195">Für automatisches Failover müssen folgende Bedingungen erfüllt sein:</span><span class="sxs-lookup"><span data-stu-id="ca0ea-195">Automatic failover requires the following conditions:</span></span>  
  
-   <span data-ttu-id="ca0ea-196">Die Datenbank-Spiegelungssitzung muss im Modus für hohe Sicherheit ausgeführt werden und einen Zeugen besitzen.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-196">The database mirroring session must be running in high-safety mode and must possess a witness.</span></span> <span data-ttu-id="ca0ea-197">Weitere Informationen finden Sie unter [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-197">For more information, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
-   <span data-ttu-id="ca0ea-198">Die Spiegeldatenbank muss bereits synchronisiert sein.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-198">The mirror database must already be synchronized.</span></span> <span data-ttu-id="ca0ea-199">Dadurch wird sichergestellt, dass sämtliche an den Spiegelserver gesendeten Protokolleinträge auf den Datenträger geschrieben wurden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-199">This guarantees that all of the log sent to the mirror server has been written to disk.</span></span>  
  
-   <span data-ttu-id="ca0ea-200">Die Kommunikation des Prinzipalservers mit dem Rest der Datenbankspiegelungskonfiguration wurde unterbrochen, während der Spiegelserver und der Zeugenserver das Quorum behalten.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-200">The principal server has lost communication with the rest of the database mirroring configuration, while the mirror and witness retain quorum.</span></span> <span data-ttu-id="ca0ea-201">Wenn jedoch alle Serverinstanzen die Kommunikation verlieren und der Zeugenserver und der Spiegelserver später die Kommunikation wieder aufnehmen, erfolgt kein automatisches Failover.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-201">If all server instances lose communication, however, and the witness and the mirror server later regain communication, automatic failover does not occur.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="ca0ea-202">Weitere Informationen finden Sie unter [Quorum: Auswirkungen eines Zeugen auf die Datenbankverfügbarkeit &#40;Datenbankspiegelung&#41;](quorum-how-a-witness-affects-database-availability-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-202">For more information, see [Quorum: How a Witness Affects Database Availability &#40;Database Mirroring&#41;](quorum-how-a-witness-affects-database-availability-database-mirroring.md).</span></span>  
  
-   <span data-ttu-id="ca0ea-203">Der Spiegelserver hat den Verlust des Prinzipalservers erkannt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-203">The mirror server has detected the loss of the principal server.</span></span>  
  
     <span data-ttu-id="ca0ea-204">Wie der Spiegelserver einen Ausfall des Prinzipalservers erkennt, hängt davon ab, ob es sich um einen Hardware- oder Softwarefehler handelt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-204">How the mirror server detects a failure of the principal server depends on whether it is a hard or soft failure.</span></span> <span data-ttu-id="ca0ea-205">Weitere Informationen finden Sie unter [Possible Failures During Database Mirroring](possible-failures-during-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-205">For more information, see [Possible Failures During Database Mirroring](possible-failures-during-database-mirroring.md).</span></span>  
  
###  <a name="how-automatic-failover-works"></a><a name="HowAutoFoWorks"></a> <span data-ttu-id="ca0ea-206">So funktioniert ein automatisches Failover</span><span class="sxs-lookup"><span data-stu-id="ca0ea-206">How Automatic Failover Works</span></span>  
 <span data-ttu-id="ca0ea-207">Unter den oben genannten Bedingungen wird beim automatischen Failover die folgende Aktionsfolge initiiert:</span><span class="sxs-lookup"><span data-stu-id="ca0ea-207">Under the preceding conditions, automatic failover initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="ca0ea-208">Wird der Prinzipalserver noch immer ausgeführt, ändert er den Status der Prinzipaldatenbank in DISCONNECTED und trennt alle Clientverbindungen zur Prinzipaldatenbank.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-208">If the principal server is still running, it changes the state of the principal database to DISCONNECTED and disconnects all clients from the principal database.</span></span>  
  
2.  <span data-ttu-id="ca0ea-209">Der Zeugen- und der Spiegelserver registrieren, dass der Prinzipalserver nicht verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-209">The witness and mirror servers register that the principal server is unavailable.</span></span>  
  
3.  <span data-ttu-id="ca0ea-210">Wartet ein Protokoll in der Wiederholungswarteschlange, schließt der Spiegelserver den Rollforward der Spiegeldatenbank ab.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-210">If any log is waiting in the redo queue, the mirror server finishes rolling forward the mirror database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="ca0ea-211">Die zum Anwenden des Protokolls erforderliche Zeit hängt von der Systemgeschwindigkeit, der aktuellen Arbeitsauslastung und der Menge an Protokollen in der Wiederholungswarteschlange ab.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-211">The amount of time required to apply the log depends on the speed of the system, the recent work load, and the amount of log in the redo queue.</span></span>  
  
4.  <span data-ttu-id="ca0ea-212">Die frühere Spiegeldatenbank wird als neue Prinzipaldatenbank online geschaltet. Bei der Wiederherstellung werden alle Transaktionen, für die kein Commit ausgeführt wurde, möglichst schnell durch ein Rollback dieser Transaktionen bereinigt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-212">The former mirror database moves online as the new principal database, and recovery cleans up all uncommitted transactions by rolling them back as quickly as possible.</span></span> <span data-ttu-id="ca0ea-213">Diese Transaktionen werden durch Sperren isoliert.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-213">Locks isolate those transactions.</span></span>  
  
5.  <span data-ttu-id="ca0ea-214">Wenn sich der frühere Prinzipalserver der Sitzung wieder anschließt, erkennt er, dass sein Failoverpartner jetzt die Prinzipalrolle besitzt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-214">When the former principal server rejoins the session, it recognizes that its failover partner now owns the principal role.</span></span> <span data-ttu-id="ca0ea-215">Der frühere Prinzipalserver übernimmt die Rolle des Spiegels und macht seine Datenbank zur Spiegeldatenbank.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-215">The former principal server takes on the role of mirror, making its database the mirror database.</span></span> <span data-ttu-id="ca0ea-216">Der neue Spiegelserver synchronisiert die neue Spiegeldatenbank so schnell wie möglich mit der Prinzipaldatenbank.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-216">The new mirror server synchronizes the new mirror database with the principal database as quickly as possible.</span></span> <span data-ttu-id="ca0ea-217">Sobald der neue Spiegelserver die Datenbanken synchronisiert hat, ist ein Failover wieder möglich, jedoch in umgekehrter Richtung.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-217">As soon as the new mirror server has resynchronized the databases, failover is again possible, but in the reverse direction.</span></span>  
  
 <span data-ttu-id="ca0ea-218">In der folgenden Abbildung wird eine einzelne Instanz von automatischem Failover veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-218">The following illustration shows a single instance of automatic failover.</span></span>  
  
 <span data-ttu-id="ca0ea-219">![Automatisches Failover](../media/dbm-failovauto1round.gif "Automatisches Failover")</span><span class="sxs-lookup"><span data-stu-id="ca0ea-219">![Automatic failover](../media/dbm-failovauto1round.gif "Automatic failover")</span></span>  
  
 <span data-ttu-id="ca0ea-220">Anfänglich besitzen alle drei Server eine Verbindung (die Sitzung verfügt über ein vollständiges Quorum).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-220">Initially, all three servers are connected (the session has full quorum).</span></span> <span data-ttu-id="ca0ea-221">**Partner_A** ist der Prinzipalserver und **Partner_B** ist der Spiegelserver.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-221">**Partner_A** is the principal server and **Partner_B** is the mirror server.</span></span> <span data-ttu-id="ca0ea-222">**Partner_A** (oder die Prinzipaldatenbank auf **Partner_A**) steht nicht länger zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-222">**Partner_A** (or the principal database on **Partner_A**) becomes unavailable.</span></span> <span data-ttu-id="ca0ea-223">Der Zeuge und **Partner_B** erkennen, dass der Prinzipalserver nicht mehr verfügbar ist, die Sitzung behält jedoch das Quorum.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-223">The witness and **Partner_B** both recognize that the principal is no longer available the session retains quorum.</span></span> <span data-ttu-id="ca0ea-224">**Partner_B** wird zum Prinzipalserver und macht seine Kopie der Datenbank als neue Prinzipaldatenbank verfügbar.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-224">**Partner_B** becomes the principal server and makes its copy of the database available as the new principal database.</span></span> <span data-ttu-id="ca0ea-225">Schließlich stellt **Partner_A** wieder eine Verbindung mit der Sitzung her und erkennt, dass **Partner_B** jetzt die Prinzipalrolle besitzt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-225">Eventually, **Partner_A** reconnects to the session and discovers that **Partner_B** now owns the principal role.</span></span> <span data-ttu-id="ca0ea-226">**Partner_A** übernimmt dann die Spiegelrolle.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-226">**Partner_A** then takes on the mirror role.</span></span>  
  
 <span data-ttu-id="ca0ea-227">Nach dem Failover müssen die Clients erneut eine Verbindung zur aktuellen Prinzipaldatenbank herstellen.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-227">After failover, clients must reconnect to the current principal database.</span></span> <span data-ttu-id="ca0ea-228">Weitere Informationen finden Sie unter [Verbinden von Clients mit einer Datenbank-Spiegelungssitzung &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md)ausgetauscht werden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-228">For more information, see [Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ca0ea-229">Transaktionen, die mit dem [!INCLUDE[msCoName](../../includes/msconame-md.md)] Distributed Transaction Coordinator vorbereitet wurden, für die beim Auftreten eines Failovers jedoch noch kein Commit ausgeführt wurde, werden nach dem Failover der Datenbank als abgebrochen betrachtet.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-229">Transactions that have been prepared using the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Distributed Transaction Coordinator but are still not committed when a failover occurs, are considered aborted after the database has failed over.</span></span>  
  
###  <a name="to-disable-automatic-failover-sql-server-management-studio"></a><a name="DisableAutoSSMS"></a> <span data-ttu-id="ca0ea-230">So deaktivieren Sie das automatische Failover (SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="ca0ea-230">To Disable Automatic Failover (SQL Server Management Studio)</span></span>  
 <span data-ttu-id="ca0ea-231">Öffnen Sie die Seite **Datenbankeigenschaften – Spiegelung** , und ändern Sie den Betriebsmodus durch Auswählen einer der folgenden Optionen:</span><span class="sxs-lookup"><span data-stu-id="ca0ea-231">Open the **Database PropertiesMirroring** page, and change the operating mode by selecting one of the following options:</span></span>  
  
-   <span data-ttu-id="ca0ea-232">**Hohe Sicherheit ohne automatisches Failover (synchron)**</span><span class="sxs-lookup"><span data-stu-id="ca0ea-232">**High safety without automatic failover (synchronous)**</span></span>  
  
     <span data-ttu-id="ca0ea-233">In diesem Modus wird die Datenbank weiterhin synchronisiert, und manuelles Failover ist weiterhin möglich.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-233">In this mode, the database continues to be synchronized, and manual failover remains possible.</span></span>  
  
-   <span data-ttu-id="ca0ea-234">**Hohe Leistung (asynchron)**</span><span class="sxs-lookup"><span data-stu-id="ca0ea-234">**High performance (asynchronous)**</span></span>  
  
     <span data-ttu-id="ca0ea-235">In diesem Modus kann es vorkommen, dass die Spiegeldatenbank leicht hinter die Prinzipaldatenbank zurückfällt; manuelles Failover ist nicht mehr möglich.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-235">In this mode, the mirror database might lag somewhat behind the principal database, and manual failover is no longer possible.</span></span>  
  
### <a name="to-disable-automatic-failover-using-transact-sql"></a><span data-ttu-id="ca0ea-236">So deaktivieren Sie das automatische Failover (mithilfe von Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="ca0ea-236">To Disable Automatic Failover (Using Transact-SQL)</span></span>  
 <span data-ttu-id="ca0ea-237">Der Datenbankbesitzer kann jederzeit in einer Datenbank-Spiegelungssitzung das automatische Failover deaktivieren, indem er den Zeugen deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-237">At any point in a database mirroring session, the database owner can disable automatic failover by turning off the witness.</span></span>  
  
 <span data-ttu-id="ca0ea-238">**So deaktivieren Sie den Zeugen**</span><span class="sxs-lookup"><span data-stu-id="ca0ea-238">**To turn off the witness**</span></span>  
  
-   [<span data-ttu-id="ca0ea-239">Entfernen des Zeugen aus einer Datenbank-Spiegelungssitzung &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="ca0ea-239">Remove the Witness from a Database Mirroring Session &#40;SQL Server&#41;</span></span>](remove-the-witness-from-a-database-mirroring-session-sql-server.md)  
  
    > [!NOTE]  
    >  <span data-ttu-id="ca0ea-240">Wenn der Zeuge deaktiviert wird, während die Transaktionssicherheitsstufe FULL beibehalten wird, wird die Sitzung in den Modus für hohe Sicherheit mit automatischem Failover versetzt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-240">Turning off the witness while retaining full transaction safety puts the session into high-safety mode without automatic failover.</span></span>  
  
##  <a name="forced-service-with-possible-data-loss"></a><a name="ForcedService"></a> <span data-ttu-id="ca0ea-241">Forced Service (with Possible Data Loss)</span><span class="sxs-lookup"><span data-stu-id="ca0ea-241">Forced Service (with Possible Data Loss)</span></span>  
 <span data-ttu-id="ca0ea-242">Im Rahmen der Datenbankspiegelung wird das Erzwingen des Dienstes (bei möglichem Datenverlust) als eine Methode der Notfallwiederherstellung bereitgestellt, bei der Ihnen die Verwendung eines Spiegelservers als betriebsbereiter Standbyserver ermöglicht wird.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-242">Database mirroring provides forcing service (with possible data loss) as a disaster recovery method to allow you to use a mirror server as a warm standby server.</span></span> <span data-ttu-id="ca0ea-243">Das Erzwingen des Dienstes ist nur möglich, wenn keine Verbindung in einer Spiegelungssitzung zwischen Prinzipalserver und Spiegelserver besteht.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-243">Forcing service is possible only if the principal server is disconnected from the mirror server in a mirroring session.</span></span> <span data-ttu-id="ca0ea-244">Da es beim Erzwingen des Dienstes zu Datenverlusten kommen kann, sollte diese Methode unter Vorbehalt und selten angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-244">Because forcing service risks possible data loss, it should be used cautiously and sparingly.</span></span>  
  
 <span data-ttu-id="ca0ea-245">Die Unterstützung des erzwungenen Dienstes hängt wie folgt vom Betriebsmodus und dem Status der Sitzung ab:</span><span class="sxs-lookup"><span data-stu-id="ca0ea-245">Support for forced service depends on the operating mode and the state of the session, as follows:</span></span>  
  
-   <span data-ttu-id="ca0ea-246">In der Regel unterstützt der Modus für hohe Leistung das Erzwingen des Dienstes, wenn keine Verbindung mit dem Prinzipalserver besteht.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-246">Typically, high-performance mode supports forcing service whenever the principal server is disconnected.</span></span> <span data-ttu-id="ca0ea-247">Obwohl nicht erforderlich, kann jedoch ein Zeuge für eine Sitzung im Modus für hohe Leistung eingerichtet werden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-247">However, though unnecessary, a witness can exist for a high-performance mode session.</span></span> <span data-ttu-id="ca0ea-248">In diesem Fall ist zum Erzwingen des Dienstes erforderlich, dass der Spiegelserver und der Zeuge miteinander verbunden sind.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-248">In this case, forcing service requires that the mirror server and witness are connected to each other.</span></span>  
  
-   <span data-ttu-id="ca0ea-249">Der Modus für hohe Sicherheit mit automatischem Failover unterstützt das Erzwingen des Dienstes, wenn keine Verbindung mit dem Prinzipalserver besteht.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-249">High-safety mode without automatic failover supports forcing service whenever the principal server is disconnected.</span></span>  
  
-   <span data-ttu-id="ca0ea-250">Der Modus für hohe Sicherheit mit automatischem Failover unterstützt das Erzwingen des Dienstes, wenn eine Verbindung zwischen Spiegelserver und Zeuge besteht und keiner der beiden mit dem Prinzipalserver verbunden ist (solange der Spiegelserver gerade kein Rollback der Spiegeldatenbank ausgeführt hat, als zuletzt eine Verbindung mit dem Prinzipalserver bestand).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-250">High-safety mode with automatic failover supports forcing service whenever the mirror server and witness are connected to each other and neither is connected to the principal server (as long as the mirror server was not in the process of rolling back the mirror database when it was last connected to the principal).</span></span>  
  
 <span data-ttu-id="ca0ea-251">Es wird empfohlen, den Dienst nur dann zu erzwingen, wenn Sie den Dienst für die Datenbank sofort wiederherstellen müssen und bereit sind, das Risiko des Datenverlustes in Kauf zu nehmen.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-251">We recommend forcing service only if you must restore service to the database immediately and are willing to risk losing data.</span></span> <span data-ttu-id="ca0ea-252">Die Auswirkungen aus dem Erzwingen des Dienstes sind vergleichbar mit dem Entfernen der Spiegelung, außer dass durch das Erzwingen des Dienstes das erneute Synchronisieren der Datenbanken (bei möglichem Datenverlust) vereinfacht wird, wenn die Spiegelung fortgesetzt wird.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-252">The effect of forcing service is similar to removing mirroring, except that forcing service facilitates resynchronizing the databases when mirroring is resumed, at the risk of possible data loss.</span></span> <span data-ttu-id="ca0ea-253">Durch das Erzwingen des Dienstes wird ein sanfter Übergang von der Prinzipalrolle zur Spiegeldatenbank gestartet.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-253">Forcing service initiates a smooth transition of the principal role to the mirror database.</span></span> <span data-ttu-id="ca0ea-254">Der Spiegelserver nimmt die Rolle des Prinzipalservers an und bietet seine Datenbankkopie den Clients sofort an.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-254">The mirror server assumes the role of principal server and immediately serves its copy of the database to clients.</span></span> <span data-ttu-id="ca0ea-255">Die neue Prinzipaldatenbank wird ohne einen Spiegel ausgeführt (sie wird also ungeschützt ausgeführt).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-255">The new principal database runs without a mirror (that is, it runs exposed).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="ca0ea-256">Wurde der Prinzipalserver nur von der Datenbank-Spiegelungssitzung getrennt, wird jedoch weiter ausgeführt, greifen einige Clients möglicherweise weiterhin auf die ursprüngliche Prinzipaldatenbank zu.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-256">If the principal server was merely disconnected from the database mirroring session and is still running, some clients might continue to access the original principal database.</span></span> <span data-ttu-id="ca0ea-257">Vor dem Erzwingen des Dienstes müssen Sie verhindern, dass Clients weiterhin auf den ursprünglichen Prinzipalserver zugreifen.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-257">Before you force service, it is important to prevent clients from accessing the original principal server.</span></span> <span data-ttu-id="ca0ea-258">Andernfalls ist es nach dem Erzwingen des Dienstes möglich, dass die ursprüngliche Prinzipaldatenbank und die aktuelle Prinzipaldatenbank unabhängig voneinander aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-258">Otherwise, after service is forced, the original principal database and the current principal database could be updated independently of the other.</span></span>  
  
  
  
###  <a name="typical-case-of-forced-service"></a><a name="TypicalCaseFS"></a> <span data-ttu-id="ca0ea-259">Typischer Fall eines erzwungenen Dienstes</span><span class="sxs-lookup"><span data-stu-id="ca0ea-259">Typical Case of Forced Service</span></span>  
 <span data-ttu-id="ca0ea-260">Die folgende Abbildung veranschaulicht einen typischen Fall eines erzwungenen Dienstes (mit möglichem Datenverlust).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-260">The following figure illustrates a typical case of forced service (with possible data loss).</span></span>  
  
 <span data-ttu-id="ca0ea-261">![Diensterzwingung mit möglichem Datenverlust](../media/dbm-forced-service.gif "Diensterzwingung mit möglichem Datenverlust")</span><span class="sxs-lookup"><span data-stu-id="ca0ea-261">![Forcing service with possible data loss](../media/dbm-forced-service.gif "Forcing service with possible data loss")</span></span>  
  
 <span data-ttu-id="ca0ea-262">In der Abbildung fällt der ursprüngliche Prinzipalserver ( **Partner_A**) aus und steht dem Spiegelserver ( **Partner_B**) nicht mehr zur Verfügung, wodurch die Spiegeldatenbank getrennt wird.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-262">In the figure, the original principal server, **Partner_A**, becomes unavailable to the mirror server, **Partner_B**, causing the mirror database to be disconnected.</span></span> <span data-ttu-id="ca0ea-263">Nachdem sichergestellt wurde, dass **Partner_A** Clients nicht zur Verfügung steht, erzwingt der Datenbankadministrator den Dienst, mit möglichem Datenverlust, auf **Partner_B**.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-263">After ensuring that **Partner_A** is not available to clients, the database administrator forces service, with possible data loss, on **Partner_B**.</span></span> <span data-ttu-id="ca0ea-264">**Partner_B** wird zum Prinzipalserver, und die Datenbank wird *ungeschützt* (d.h. ungespiegelt) ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-264">**Partner_B** becomes the principal server and runs with the database *exposed* (that is, unmirrored).</span></span> <span data-ttu-id="ca0ea-265">An diesem Punkt können Clients die Verbindung mit **Partner_B**wieder herstellen.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-265">At this point, clients can reconnect to **Partner_B**.</span></span>  
  
 <span data-ttu-id="ca0ea-266">Wenn **Partner_A** wieder zur Verfügung steht, stellt er die Verbindung mit dem neuen Prinzipalserver her, tritt der Sitzung wieder bei und übernimmt die Rolle des Spiegelservers.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-266">When **Partner_A** becomes available, it reconnects to the new principal server, rejoining the session and assuming the mirror role.</span></span> <span data-ttu-id="ca0ea-267">Die Spiegelungssitzung wird sofort angehalten, ohne dass die neue Spiegeldatenbank synchronisiert wird.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-267">The mirroring session is suspended immediately, without having synchronized the new mirror database.</span></span> <span data-ttu-id="ca0ea-268">Durch das Anhalten der Sitzung kann der Datenbankadministrator entscheiden, ob die Sitzung fortgesetzt, oder in Extremfällen, die Spiegelung entfernt und der Versuch unternommen werden soll, Daten aus der früheren Prinzipaldatenbank zu retten.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-268">Suspending the session allows the database administrator to decide whether to resume the session or, in extreme cases, remove mirroring and attempt to salvage data from the former principal database.</span></span> <span data-ttu-id="ca0ea-269">In diesem Fall entscheidet sich der Datenbankadministrator für das Fortsetzen der Spiegelung.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-269">In this case, the database administrator chooses to resume mirroring.</span></span> <span data-ttu-id="ca0ea-270">An dieser Stelle übernimmt **Partner_A** die Rolle des Spiegelservers und führt einen Rollback der früheren Prinzipaldatenbank auf den Zeitpunkt der letzten erfolgreich synchronisierten Transaktion aus. Wenn Transaktionen, für die ein Commit ausgeführt wurde, vor dem Erzwingen des Diensts nicht auf den Datenträger des Spiegelservers geschrieben wurden, gehen sie verloren.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-270">At that point, **Partner_A** takes over the role of mirror server and rolls back the former principal database to the point in time of the last successfully synchronized transaction; if any committed transactions were not written to disk on the mirror server before service was forced, they are lost.</span></span> <span data-ttu-id="ca0ea-271">**Partner_A** führt dann einen Rollforward der neuen Spiegeldatenbank aus, indem alle Änderungen angewendet werden, die an der neuen Prinzipaldatenbank vorgenommen wurden, seit der vorherige Spiegelserver die Rolle des neuen Prinzipalservers übernommen hat.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-271">**Partner_A** then rolls forward the new mirror database by applying any changes made on the new principal database since the former mirror server became the new principal server.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ca0ea-272">Wurde im Modus für hohe Leistung ein Zeuge konfiguriert (dies ist nicht notwendig), ist das Erzwingen des Dienstes nur möglich, wenn der Zeuge derzeit mit dem Spiegelserver verbunden ist.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-272">Although high-performance mode does not require a witness, if one is configured, forcing service is possible only if the witness is currently connected to the mirror server.</span></span>  
  
###  <a name="risks-of-forcing-service"></a><a name="FSrisks"></a> <span data-ttu-id="ca0ea-273">Risiken beim Erzwingen des Dienstes</span><span class="sxs-lookup"><span data-stu-id="ca0ea-273">Risks of Forcing Service</span></span>  
 <span data-ttu-id="ca0ea-274">Sie sollten unbedingt bedenken, dass durch das Erzwingen des Dienstes Daten verloren gehen können.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-274">It is essential to understand that forcing service can cause data loss.</span></span> <span data-ttu-id="ca0ea-275">Zu einem Datenverlust kann es kommen, weil der Spiegelserver nicht mit dem Prinzipalserver kommunizieren und somit nicht sicherstellen kann, dass beide Datenbanken synchronisiert sind.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-275">Data loss is possible because the mirror server cannot communicate with the principal server and, therefore, cannot guarantee that the two databases are synchronized.</span></span> <span data-ttu-id="ca0ea-276">Durch das Erzwingen des Dienstes wird ein neuer Wiederherstellungs-Verzweigungspunkt gestartet.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-276">Forcing service starts a new recovery fork.</span></span> <span data-ttu-id="ca0ea-277">Da sich die ursprüngliche Prinzipaldatenbank und die Spiegeldatenbank auf verschiedenen Wiederherstellungsverzweigungen befinden, enthält jede Datenbank nun Daten, die in der jeweils anderen Datenbank nicht vorhanden sind: Die ursprüngliche Prinzipaldatenbank enthält die Änderungen, die noch nicht aus der Sendewarteschlange an die frühere Spiegeldatenbank gesendet wurden (die nicht gesendeten Protokolle). Die frühere Spiegeldatenbank enthält die Änderungen, die nach dem Erzwingen des Dienstes vorgenommen wurden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-277">Because the original principal database and mirror database are on different recovery forks, each database now contains data that the other database does not: the original principal database contains whatever changes were not yet sent from its send queue to the former mirror database (the unsent log); the former mirror database contains whatever changes occur after service was forced.</span></span>  
  
 <span data-ttu-id="ca0ea-278">Wird der Dienst aufgrund eines Fehlers des Prinzipalservers erzwungen, hängt der potenzielle Datenverlust davon ab, ob Transaktionsprotokolle vorhanden sind, die vor dem Fehler nicht an den Spiegelserver gesendet wurden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-278">If service is forced because the principal server has failed, potential data loss is depends on whether any transaction logs were not sent to the mirror server before the failure.</span></span> <span data-ttu-id="ca0ea-279">Im Modus für hohe Sicherheit ist dies nur bis zum Synchronisieren der Spiegeldatenbank möglich.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-279">Under high-safety mode, this is possible only until the mirror database becomes synchronized.</span></span> <span data-ttu-id="ca0ea-280">Im Modus für hohe Leistung besteht immer die Möglichkeit, dass sich nicht gesendete Protokolle ansammeln.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-280">Under the high-performance mode, accumulated unsent log is always a possibility.</span></span>  
  
 <span data-ttu-id="ca0ea-281">Die Auswirkungen aus dem Erzwingen des Dienstes hängen teilweise davon ab, ob die Sitzung über einen Zeugen verfügt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-281">The implications of forcing service depend partly on whether the session has a witness:</span></span>  
  
-   <span data-ttu-id="ca0ea-282">Ohne einen Zeugen kann der Dienst erzwungen werden, wenn die Verbindung der Partner beispielsweise aufgrund einer unterbrochenen Netzwerkverbindung getrennt wird.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-282">In the absence of a witness, service can be forced if the partners become disconnected, for example, because their network connection is broken.</span></span> <span data-ttu-id="ca0ea-283">Wird der ursprüngliche Prinzipalserver weiterhin ausgeführt, haben beide Partner die Rolle des Prinzipals inne.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-283">If the original principal server is still running, both partners own the principal role.</span></span> <span data-ttu-id="ca0ea-284">Clients, die eine Verbindung mit dem neuen Prinzipalserver herstellen, greifen auf die aktuelle Datenbankversion zu, während Clients, die eine Verbindung mit dem ursprünglichen Prinzipalserver herstellen, auf die ursprüngliche Prinzipaldatenbank zugreifen.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-284">Clients connecting to the new principal server will access the current version of the database, while clients connecting to the original principal server will access the original principal database.</span></span> <span data-ttu-id="ca0ea-285">In dieser Situation steigt die Wahrscheinlichkeit eines Datenverlusts.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-285">This situation increases the potential for data loss.</span></span> <span data-ttu-id="ca0ea-286">Wenn es den Partnern möglich ist, die Verbindung wiederherzustellen, nimmt der ursprüngliche Server die Rolle des Spiegelservers an und ändert den Status seiner Datenbank zu "Wird wiederhergestellt", ehe die Spiegelung angehalten wird.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-286">If the partners are allowed to reconnect, the original principal server assumes the mirror role and changes the status of its database to "recovering," before mirroring is suspended.</span></span> <span data-ttu-id="ca0ea-287">Wenn die Sitzung fortgesetzt wird, gehen Transaktionen in der ursprünglichen Datenbank, deren Protokolle sich zum Zeitpunkt der letzten Verbindungsunterbrechung in der Sendewarteschlange befanden, verloren.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-287">If the session is resumed, transactions on the original principal database whose log was in the send queue as of the most recent disconnection are lost.</span></span> <span data-ttu-id="ca0ea-288">Außerdem gehen alle Transaktionen verloren, die nach dem Erzwingen des Dienstes stattfanden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-288">In addition, any the transactions that occurred after service was forced are also lost.</span></span>  
  
-   <span data-ttu-id="ca0ea-289">Ist ein Zeuge vorhanden und der Spiegelserver wird sowohl vom Prinzipalserver als auch vom Zeugen getrennt, wird der Prinzipalserver ungeschützt ausgeführt, solange die Verbindung zwischen Prinzipalserver und Zeuge weiter besteht.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-289">In the presence of a witness, if the mirror server is disconnected from both the principal server and the witness, as long as the latter two remain connected to each other, the principal runs exposed.</span></span> <span data-ttu-id="ca0ea-290">Wird die Verbindung des Prinzipalservers mit dem Zeugen dann getrennt, stellt er die Datenbank nicht länger bereit.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-290">If the principal server then becomes disconnected from the witness, it stops serving the database.</span></span> <span data-ttu-id="ca0ea-291">Wenn der Spiegelserver die Verbindung mit dem Zeugen wiederherstellt, ist es danach möglich, den Dienst zu erzwingen.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-291">Thereafter, if the mirror server reconnects to the witness, forcing service becomes possible.</span></span> <span data-ttu-id="ca0ea-292">Wird der Dienst erzwungen, gehen alle Änderungen verloren, die während des ungeschützten Ausführens des ursprünglichen Prinzipalservers vorgenommen wurden, sobald der ursprüngliche Prinzipalserver die Verbindung wiederherstellt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-292">If service is forced, all the changes made while the original principal server was running exposed will be lost if the original principal server reconnects.</span></span>  
  
 <span data-ttu-id="ca0ea-293">Weitere Informationen finden Sie weiter unten in diesem Thema unter [Umgang mit potenziellem Datenverlust](#ManageDataLoss).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-293">For more information, see [Managing the Potential Data Loss](#ManageDataLoss), later in this topic.</span></span>  
  
###  <a name="managing-the-potential-data-loss"></a><a name="ManageDataLoss"></a> <span data-ttu-id="ca0ea-294">Umgang mit potenziellem Datenverlust</span><span class="sxs-lookup"><span data-stu-id="ca0ea-294">Managing the Potential Data Loss</span></span>  
 <span data-ttu-id="ca0ea-295">Sobald der frühere Prinzipalserver verfügbar ist, können Sie nach dem Erzwingen des Dienstes versuchen, den potenziellen Datenverlust zu verwalten, vorausgesetzt die Datenbank ist unbeschädigt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-295">After service is forced, once the former principal server is available, assuming that its database is undamaged, you can attempt to manage the potential data loss.</span></span> <span data-ttu-id="ca0ea-296">Der jeweilige Ansatz für die Verwaltung des potenziellen Datenverlusts hängt davon ab, ob der ursprüngliche Prinzipalserver die Verbindung zu seinem Partner wiederhergestellt hat und wieder an der Spiegelungssitzung teilnimmt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-296">The available approach for managing potential data loss depends on whether the original principal server has reconnected to its partner and rejoined the mirroring session.</span></span> <span data-ttu-id="ca0ea-297">Vorausgesetzt, dass der ursprüngliche Prinzipalserver auf die neue Prinzipalinstanz zugreifen kann, wird die Verbindung automatisch und transparent wiederhergestellt.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-297">Assuming that the original principal server can access the new principal instance, reconnecting occurs automatically and transparently.</span></span>  
  
#### <a name="the-original-principal-server-has-reconnected"></a><span data-ttu-id="ca0ea-298">Der ursprüngliche Prinzipalserver hat die Verbindung wiederhergestellt</span><span class="sxs-lookup"><span data-stu-id="ca0ea-298">The Original Principal Server Has Reconnected</span></span>  
 <span data-ttu-id="ca0ea-299">Normalerweise stellt der ursprüngliche Prinzipalserver nach einem Fehler beim Neustarten rasch die Verbindung zu seinem Partner wieder her.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-299">Typically, after a failure, when the original principal server restarts it quickly reconnects to its partner.</span></span> <span data-ttu-id="ca0ea-300">Beim Wiederherstellen der Verbindung wird der ursprüngliche Prinzipalserver zum Spiegelserver.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-300">On reconnecting, the original principal server becomes the mirror server.</span></span> <span data-ttu-id="ca0ea-301">Seine Datenbank wird zur Spiegeldatenbank und nimmt vor dem Anhalten der Sitzung des Status "Wird wiederhergestellt" an.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-301">Its database becomes the mirror database and enters the recovering state before the session is suspended.</span></span> <span data-ttu-id="ca0ea-302">Es wird nur dann ein Rollback der Spiegeldatenbank ausgeführt, wenn Sie die Spiegelung fortsetzen.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-302">The mirror database will not be not rolled back unless you resume mirroring.</span></span>  
  
 <span data-ttu-id="ca0ea-303">Der Zugriff auf die Datenbank, die wiederhergestellt wird, ist jedoch nicht möglich; deshalb können Sie sie nicht überprüfen, um festzustellen, welche Daten im Falle der fortgesetzten Spiegelung verloren gehen würden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-303">However, the recovering database is inaccessible; therefore, you cannot inspect it to evaluate what data would be lost if you were to resume mirroring.</span></span> <span data-ttu-id="ca0ea-304">Die Entscheidung, ob die Spiegelung fortgesetzt oder entfernt werden soll, hängt somit davon ab, ob Sie bereit sind, Datenverluste grundsätzlich in Kauf zu nehmen.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-304">Therefore, the decision on whether to resume or remove mirroring depends on whether you are willing to accept any data loss at all.</span></span>  
  
-   <span data-ttu-id="ca0ea-305">Wenn der Verlust von Daten inakzeptabel ist, sollten Sie die Spiegelung entfernen, um die Daten zu retten.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-305">If losing any data would be unacceptable, you should remove mirroring to salvage them.</span></span>  
  
     <span data-ttu-id="ca0ea-306">Durch das Entfernen der Spiegelung kann der Datenbankadministrator die ursprüngliche Prinzipaldatenbank wiederherstellen und den Versuch unternehmen, die Daten wiederherzustellen.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-306">Removing mirroring would allow the database administrator to recover the original principal database and attempt to recover the data that would have been lost.</span></span> <span data-ttu-id="ca0ea-307">Wird die frühere Spiegeldatenbank jedoch online geschaltet, stellen die früheren Partner unterschiedliche Datenbanken unter demselben Namen bereit.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-307">However, when the former mirror database comes online, the former partners will be serving divergent databases with the same name.</span></span> <span data-ttu-id="ca0ea-308">Der Datenbankadministrator muss dafür sorgen, dass Clients auf eine der Datenbanken nicht zugreifen können, um weitere Abweichungen der Datenbanken sowie Clientfailoverprobleme zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-308">The database administrator needs to make one of the databases inaccessible to clients to avoid further divergence of the database and to prevent client-failover issues.</span></span>  
  
-   <span data-ttu-id="ca0ea-309">Wenn der Verlust von Daten akzeptabel ist, können Sie die Spiegelung fortsetzen.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-309">If losing any data would be acceptable, you can resume mirroring.</span></span>  
  
     <span data-ttu-id="ca0ea-310">Beim Fortsetzen der Spiegelung wird in einem ersten Schritt ein Rollback der neuen Spiegeldatenbank ausgeführt, um die Datenbank zu synchronisieren.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-310">Resuming mirroring causes the new mirror database to be rolled back as the first step in synchronizing the database.</span></span> <span data-ttu-id="ca0ea-311">Waren zum Zeitpunkt des Fehlers Protokolldatensätze in der Sendewarteschlange enthalten, gehen die entsprechenden Transaktionen verloren, selbst wenn ein Commit für sie ausgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-311">If any log records were waiting in the send queue at the time of failure, the corresponding transactions are lost, even if they were committed.</span></span>  
  
#### <a name="the-original-principal-server-has-not-reconnected"></a><span data-ttu-id="ca0ea-312">Der ursprüngliche Prinzipalserver hat die Verbindung nicht wiederhergestellt</span><span class="sxs-lookup"><span data-stu-id="ca0ea-312">The Original Principal Server Has Not Reconnected</span></span>  
 <span data-ttu-id="ca0ea-313">Wenn Sie zeitweise verhindern können, dass der ursprüngliche Prinzipalserver wieder eine Verbindung über das Netzwerk mit dem neuen Prinzipalserver herstellt, können Sie die ursprüngliche Prinzipaldatenbank überprüfen und so feststellen, welche Daten im Falle einer fortgesetzten Spiegelung verloren gehen würden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-313">If you can temporarily prevent the original principal server from reconnecting over the network to the new principal server, you can inspect the original principal database to evaluate what data would be lost if mirroring were resumed.</span></span>  
  
-   <span data-ttu-id="ca0ea-314">Der potenzielle Datenverlust ist akzeptabel</span><span class="sxs-lookup"><span data-stu-id="ca0ea-314">If the potential data loss is acceptable</span></span>  
  
     <span data-ttu-id="ca0ea-315">Ermöglichen Sie es dem ursprünglichen Prinzipalserver, die Verbindung mit seinem Partner wiederherzustellen.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-315">Allow the original principal server to reconnect to its partner.</span></span> <span data-ttu-id="ca0ea-316">Durch das Wiederherstellen der Verbindung wird die Spiegelung angehalten.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-316">Reconnecting causes mirroring to be suspended.</span></span> <span data-ttu-id="ca0ea-317">Wenn Sie mit der Spiegelung fortfahren möchten, setzen Sie die Sitzung einfach fort.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-317">To proceed with mirroring, simply resume the session.</span></span> <span data-ttu-id="ca0ea-318">Der frühere Prinzipalserver übernimmt die Rolle des Spiegelservers.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-318">The former principal server assumes the mirror role.</span></span> <span data-ttu-id="ca0ea-319">Der neue Spiegelserver löscht den ursprünglichen Wiederherstellungs-Verzweigungspunkt, wobei alle Transaktionen verloren gehen, die nie an den früheren Spiegelserver gesendet wurden bzw. von ihm empfangen wurden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-319">The new mirror server drops the original recovery fork, losing any transactions that were never sent to or received by the former mirror server.</span></span>  
  
-   <span data-ttu-id="ca0ea-320">Ist der Datenverlust nicht akzeptabel, gehen Sie folgendermaßen vor:</span><span class="sxs-lookup"><span data-stu-id="ca0ea-320">If the data loss is unacceptable</span></span>  
  
     <span data-ttu-id="ca0ea-321">Wenn die ursprüngliche Prinzipaldatenbank wichtige Daten enthält, die verloren gehen würden, wenn Sie die Sitzung fortsetzen, können Sie Daten auf dem ursprünglichen Prinzipalserver durch Entfernen der Spiegelung beibehalten.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-321">If the original principal database contains critical data that would be lost if you resumed the session, you can preserve the data on the original principal server by removing mirroring.</span></span> <span data-ttu-id="ca0ea-322">Sie sollten in diesem Fall versuchen, das Protokollfragment des Prinzipals zu sichern.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-322">We recommend that you attempt to back up the tail of the principal's log at this point.</span></span> <span data-ttu-id="ca0ea-323">Sie können dann den aktuellen Prinzipalserver (die frühere Spiegeldatenbank) durch Exportieren der in der ursprünglichen Prinzipaldatenbank zu erhaltenden Daten und Importieren der Daten in die aktuelle Prinzipaldatenbank aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-323">Then, you can update the current principal (the former mirror database) by exporting the data you want to salvage from the original principal database and importing it into the current principal database.</span></span> <span data-ttu-id="ca0ea-324">Es wird empfohlen, so schnell wie möglich eine vollständige Datenbanksicherung der aktualisierten Datenbank zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-324">We recommend taking a full database backup of the updated database as quickly as possible.</span></span>  
  
     <span data-ttu-id="ca0ea-325">Wenn Sie die Spiegelung mit der aktualisierten Datenbank als erste Prinzipaldatenbank wieder aufnehmen möchten, verwenden Sie diese Sicherung (und mindestens eine nachfolgende Protokollsicherung), um eine neue Spiegeldatenbank zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-325">To re-establish mirroring with the updated database as the initial principal database, use this backup (and least one subsequent log backup) to create a new mirror database.</span></span> <span data-ttu-id="ca0ea-326">Jede Protokollsicherung, die nach dem Entfernen der Spiegelung erstellt wurde, muss angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-326">Every log backup taken after mirroring was removed must be applied.</span></span> <span data-ttu-id="ca0ea-327">Deshalb wird empfohlen, zusätzliche Protokollsicherungen der Prinzipaldatenbank bis zum Starten der neuen Spiegelungssitzung hinauszuzögern.</span><span class="sxs-lookup"><span data-stu-id="ca0ea-327">Therefore, we recommend delaying additional log backups of the principal database until the new mirroring session starts.</span></span>  
  
###  <a name="related-tasks-for-managing-a-forced-failover"></a><a name="RelatedTasksForFS"></a> <span data-ttu-id="ca0ea-328">Verwandte Aufgaben zum Verwalten eines erzwungenen Failovers</span><span class="sxs-lookup"><span data-stu-id="ca0ea-328">Related Tasks For Managing a Forced Failover</span></span>  
 <span data-ttu-id="ca0ea-329">**So erzwingen Sie einen Dienst**</span><span class="sxs-lookup"><span data-stu-id="ca0ea-329">**To force service**</span></span>  
  
-   <span data-ttu-id="ca0ea-330">[Erzwingen des Diensts in einer Datenbank-Spiegelungssitzung &#40;Transact-SQL&#41;](force-service-in-a-database-mirroring-session-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="ca0ea-330">[Force Service in a Database Mirroring Session &#40;Transact-SQL&#41;](force-service-in-a-database-mirroring-session-transact-sql.md).</span></span>  
  
 <span data-ttu-id="ca0ea-331">**So setzen Sie die Datenbankspiegelung fort**</span><span class="sxs-lookup"><span data-stu-id="ca0ea-331">**To resume database mirroring**</span></span>  
  
-   [<span data-ttu-id="ca0ea-332">Anhalten oder Fortsetzen einer Datenbank-Spiegelungssitzung &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="ca0ea-332">Pause or Resume a Database Mirroring Session &#40;SQL Server&#41;</span></span>](pause-or-resume-a-database-mirroring-session-sql-server.md)  
  
 <span data-ttu-id="ca0ea-333">**So erstellen Sie eine neue Spiegeldatenbank**</span><span class="sxs-lookup"><span data-stu-id="ca0ea-333">**To create a new mirror database**</span></span>  
  
 [<span data-ttu-id="ca0ea-334">Vorbereiten einer Spiegeldatenbank auf die Spiegelung &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="ca0ea-334">Prepare a Mirror Database for Mirroring &#40;SQL Server&#41;</span></span>](prepare-a-mirror-database-for-mirroring-sql-server.md)  
  
 <span data-ttu-id="ca0ea-335">**So starten Sie die Datenbankspiegelung**</span><span class="sxs-lookup"><span data-stu-id="ca0ea-335">**To start up database mirroring**</span></span>  
  
-   [<span data-ttu-id="ca0ea-336">Einrichten der Datenbankspiegelung &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="ca0ea-336">Setting Up Database Mirroring &#40;SQL Server&#41;</span></span>](setting-up-database-mirroring-sql-server.md)  
  
-   [<span data-ttu-id="ca0ea-337">Einrichten einer Datenbank-Spiegelungssitzung mithilfe der Windows-Authentifizierung &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="ca0ea-337">Establish a Database Mirroring Session Using Windows Authentication &#40;SQL Server Management Studio&#41;</span></span>](establish-database-mirroring-session-windows-authentication.md)  
  
## <a name="see-also"></a><span data-ttu-id="ca0ea-338">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="ca0ea-338">See Also</span></span>  
 <span data-ttu-id="ca0ea-339">[Einschätzen der Unterbrechung des Diensts während des Rollenwechsels &#40;Datenbankspiegelung&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md) </span><span class="sxs-lookup"><span data-stu-id="ca0ea-339">[Estimate the Interruption of Service During Role Switching &#40;Database Mirroring&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md) </span></span>  
 <span data-ttu-id="ca0ea-340">[Mögliche Fehler während der Datenbankspiegelung](possible-failures-during-database-mirroring.md) </span><span class="sxs-lookup"><span data-stu-id="ca0ea-340">[Possible Failures During Database Mirroring](possible-failures-during-database-mirroring.md) </span></span>  
 <span data-ttu-id="ca0ea-341">[Verbinden von Clients mit einer Datenbank-Spiegelungssitzung (SQL Server)](connect-clients-to-a-database-mirroring-session-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="ca0ea-341">[Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md) </span></span>  
 <span data-ttu-id="ca0ea-342">[Datenbank-Spiegelungszeuge](database-mirroring-witness.md) </span><span class="sxs-lookup"><span data-stu-id="ca0ea-342">[Database Mirroring Witness](database-mirroring-witness.md) </span></span>  
 <span data-ttu-id="ca0ea-343">[Vollständige Datenbankwiederherstellungen &#40;vollständiges Wiederherstellungsmodell&#41;](../../relational-databases/backup-restore/complete-database-restores-full-recovery-model.md) </span><span class="sxs-lookup"><span data-stu-id="ca0ea-343">[Complete Database Restores &#40;Full Recovery Model&#41;](../../relational-databases/backup-restore/complete-database-restores-full-recovery-model.md) </span></span>  
 <span data-ttu-id="ca0ea-344">[Betriebsmodi der Datenbankspiegelung](database-mirroring-operating-modes.md) </span><span class="sxs-lookup"><span data-stu-id="ca0ea-344">[Database Mirroring Operating Modes](database-mirroring-operating-modes.md) </span></span>  
 [<span data-ttu-id="ca0ea-345">Spiegelungsstatus &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="ca0ea-345">Mirroring States &#40;SQL Server&#41;</span></span>](mirroring-states-sql-server.md)  
  
  

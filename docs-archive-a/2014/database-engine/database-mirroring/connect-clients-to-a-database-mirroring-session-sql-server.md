---
title: Verbinden von Clients mit einer Datenbankspiegelungssitzung (SQL Server) | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- partners [SQL Server], connecting clients to
- database mirroring [SQL Server], connecting clients to
- client connections [SQL Server], database mirroring
- connections [SQL Server], database mirroring
ms.assetid: 0d5d2742-2614-43de-9ab9-864addb6299b
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 16faa8d02a22fba3e4cfa4cbe0bd6558fc140fdd
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87615576"
---
# <a name="connect-clients-to-a-database-mirroring-session-sql-server"></a><span data-ttu-id="7d0b1-102">Verbinden von Clients mit einer Datenbank-Spiegelungssitzung (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="7d0b1-102">Connect Clients to a Database Mirroring Session (SQL Server)</span></span>
  <span data-ttu-id="7d0b1-103">Zum Herstellen einer Verbindung mit einer Datenbank-Spiegelungssitzung kann ein Client entweder [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client oder .NET Framework-Datenanbieter für [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]verwenden.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-103">To connect to a database mirroring session, a client can use either [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client or .NET Framework Data Provider for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="7d0b1-104">Wenn sie für eine [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] -Datenbank konfiguriert sind, unterstützen beide Datenzugriffsanbieter die Datenbankspiegelung.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-104">When configured for a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] database, these data access providers both fully support database mirroring.</span></span> <span data-ttu-id="7d0b1-105">Informationen zu Programmierüberlegungen in Bezug auf das Verwenden einer gespiegelten Datenbank finden Sie unter [Verwenden der Datenbankspiegelung](../../relational-databases/native-client/features/using-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="7d0b1-105">For information about programming considerations for using a mirrored database, see [Using Database Mirroring](../../relational-databases/native-client/features/using-database-mirroring.md).</span></span> <span data-ttu-id="7d0b1-106">Zusätzlich muss die aktuelle Prinzipalserverinstanz verfügbar sein, und der Anmeldename des Clients muss auf der Serverinstanz erstellt worden sein.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-106">In addition, the current principal server instance must be available and the login of the client must have been created on the server instance.</span></span> <span data-ttu-id="7d0b1-107">Weitere Informationen finden Sie unter [Problembehandlung bei verwaisten Benutzern &#40;SQL Server&#41;](../../sql-server/failover-clusters/troubleshoot-orphaned-users-sql-server.md)aus.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-107">For more information, see [Troubleshoot Orphaned Users &#40;SQL Server&#41;](../../sql-server/failover-clusters/troubleshoot-orphaned-users-sql-server.md).</span></span> <span data-ttu-id="7d0b1-108">Sofern eine Zeugenserverinstanz vorhanden ist, werden Clientverbindungen mit einer Datenbank-Spiegelungssitzung ohne Beteiligung dieser Instanz hergestellt.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-108">Client connections to a database mirroring session do not involve the witness server instance, if one exists.</span></span>  
  
 ##  <a name="making-the-initial-connection-to-a-database-mirroring-session"></a><a name="InitialConnection"></a> <span data-ttu-id="7d0b1-109">Herstellen der Anfangsverbindung mit einer Datenbank-Spiegelungssitzung</span><span class="sxs-lookup"><span data-stu-id="7d0b1-109">Making the Initial Connection to a Database Mirroring Session</span></span>  
 <span data-ttu-id="7d0b1-110">Für die Anfangsverbindung mit einer gespiegelten Datenbank muss ein Client eine Verbindungszeichenfolge bereitstellen, die zumindest den Namen einer Serverinstanz nennt.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-110">For the initial connection to a mirrored database, a client must supply a connection string that minimally supplies the name of a server instance.</span></span> <span data-ttu-id="7d0b1-111">Dieser erforderliche Servername sollte die aktuelle Prinzipalserverinstanz identifizieren und wird auch als *erster Partnername*bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-111">This required server name should identify the current principal server instance and is known as the *initial partner name*.</span></span>  
  
 <span data-ttu-id="7d0b1-112">Optional kann in der Verbindungszeichenfolge auch der Name einer anderen Serverinstanz bereitgestellt werden, um die aktuelle Spiegelserverinstanz zu identifizieren, die dann verwendet wird, wenn der erste Partner während des ersten Verbindungsversuchs nicht verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-112">Optionally, the connection string can also supply the name of another server instance, which should identify the current mirror server instance, for use if the initial partner is unavailable during the first connection attempt.</span></span> <span data-ttu-id="7d0b1-113">Der zweite Name wird auch als *Failoverpartnername*bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-113">The second name is known as the *failover partner name*.</span></span>  
  
 <span data-ttu-id="7d0b1-114">In der Verbindungszeichenfolge muss darüber hinaus ein Datenbankname bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-114">The connection string must also supply a database name.</span></span> <span data-ttu-id="7d0b1-115">Dies ist notwendig, um Failoverversuche des Datenzugriffsanbieters zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-115">This is necessary to enable failover attempts by the data access provider.</span></span>  
  
 <span data-ttu-id="7d0b1-116">Beim Erhalt einer Verbindungszeichenfolge speichert der Datenzugriffsanbieter den Namen des ersten Partners sowie ggf. des Failoverpartners in einem Cache im flüchtigen Speicher des Clients (bei verwaltetem Code ist der Cache auf die Anwendungsdomäne begrenzt).</span><span class="sxs-lookup"><span data-stu-id="7d0b1-116">On receiving a connection string, the data access provider stores the initial partner name and the failover partner name, if supplied, in a cache in the client's volatile memory (for managed code, the cache is scoped to the application domain).</span></span> <span data-ttu-id="7d0b1-117">Anschließend wird der Name des ersten Partnernamens vom Datenzugriffsanbieter nie mehr aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-117">Once cached, the initial partner name is never updated by the data access provider.</span></span> <span data-ttu-id="7d0b1-118">Wenn der Client den Failoverpartnernamen bereitstellt, speichert der Datenzugriffsanbieter auch diesen Namen zeitweise, falls der Anbieter keine Verbindung über den Namen des ersten Partners herstellen kann.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-118">When the client supplies the failover partner name, the data access provider also stores this failover partner name temporarily in case the provider cannot connect using the initial partner name.</span></span>  
  
 <span data-ttu-id="7d0b1-119">Eine Datenbank-Spiegelungssitzung schützt nicht vor clientspezifischen Serverzugriffsproblemen, z. B. wenn ein Clientcomputer Probleme mit der Kommunikation mit dem Netzwerk hat.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-119">A database mirroring session does not protect against server-access problems that are specific to clients, such as when a client computer is having a problems communicating with the network.</span></span> <span data-ttu-id="7d0b1-120">Ein Verbindungsversuch mit einer gespiegelten Datenbank kann aus den verschiedensten Gründen fehlschlagen, die nicht mit dem Datenzugriffsanbieter zusammenhängen. So kann beispielsweise ein Verbindungsversuch fehlschlagen, weil die Prinzipalserverinstanz inaktiv ist (was bei einem Failover der Datenbank der Fall ist) oder ein Netzwerkfehler aufgetreten ist.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-120">A connection attempt to a mirrored database can also fail for a variety of reasons that are unrelated to the data-access provider; for example, a connection attempt can fail because the principal server instance is inactive, as occurs when the database is failing over, or because of a network error.</span></span>  
  
 <span data-ttu-id="7d0b1-121">Bei einem Verbindungsversuch verwendet der Datenzugriffsanbieter zunächst den Namen des ersten Partners.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-121">When attempting to connect, the data access provider begins by using the initial partner name.</span></span> <span data-ttu-id="7d0b1-122">Steht die angegebene Serverinstanz zur Verfügung und bildet die aktuelle Prinzipalserverinstanz, ist der Verbindungsversuch in der Regel erfolgreich.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-122">If the specified server instance is available and is the current principal server instance, the connection attempt typically succeeds.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7d0b1-123">Wird die Spiegelungssitzung angehalten, stellt der Client normalerweise eine Verbindung mit dem Prinzipalserver her und lädt den Namen des Partners herunter.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-123">If the mirroring session is paused, the client typically connects to the principal server and the downloads the partner name.</span></span> <span data-ttu-id="7d0b1-124">Die Datenbank steht dem Client jedoch erst nach dem Fortsetzen der Spiegelung wieder zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-124">However, the database is unavailable to the client until mirroring resumes.</span></span>  
  
 <span data-ttu-id="7d0b1-125">Wenn dieser Versuch nicht erfolgreich ist, verwendet der Datenzugriffsanbieter beim nächsten Verbindungsversuch den Namen des Failoverpartners (sofern vorhanden).</span><span class="sxs-lookup"><span data-stu-id="7d0b1-125">If that attempt does not work, the data access provider tries the failover partner name, if available.</span></span> <span data-ttu-id="7d0b1-126">Identifiziert einer der Partnernamen den aktuellen Prinzipalserver richtig, kann der Datenzugriffsanbieter die Anfangsverbindung normalerweise erfolgreich herstellen.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-126">If either partner name correctly identifies the current principal server, the data access provider normally succeeds in opening the initial connection.</span></span> <span data-ttu-id="7d0b1-127">Beim Abschließen der Verbindung lädt der Datenzugriffsanbieter den Serverinstanznamen des aktuellen Spiegelservers herunter.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-127">On completing this connection, the data access provider downloads the server instance name of the current mirror server.</span></span> <span data-ttu-id="7d0b1-128">Dieser Name wird als Failoverpartnername im Cache gespeichert und überschreibt die vom Client bereitgestellten Failoverpartnernamen (sofern vorhanden).</span><span class="sxs-lookup"><span data-stu-id="7d0b1-128">This name is stored in the cache as the failover partner name, overwriting the client-supplied failover partner name, if any.</span></span> <span data-ttu-id="7d0b1-129">Der Failoverpartnername wird danach vom .NET Framework-Datenanbieter für [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] nicht mehr aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-129">Thereafter, the .NET Framework Data Provider for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] does not update the failover partner name.</span></span> <span data-ttu-id="7d0b1-130">Im Gegensatz hierzu wird der Cache von [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client immer aktualisiert, wenn eine nachfolgende Verbindung oder das Zurücksetzen einer Verbindung einen anderen Partnernamen zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-130">In contrast, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client updates the cache whenever a subsequent connection or connection reset returns a different partner name.</span></span>  
  
 <span data-ttu-id="7d0b1-131">In der folgenden Abbildung wird eine Clientverbindung mit dem ersten Partner, **Partner_A**, für eine gespiegelte Datenbank namens **Db_1**dargestellt.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-131">The following figure illustrates a client connection to the initial partner, **Partner_A**, for a mirrored database named **Db_1**.</span></span> <span data-ttu-id="7d0b1-132">Die Abbildung stellt einen Fall dar, in dem der vom Client bereitgestellte Name des ersten Partners den aktuellen Prinzipalserver, **Partner_A**, korrekt identifiziert.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-132">This figure shows a case in which the initial partner name supplied by the client correctly identifies the current principal server, **Partner_A**.</span></span> <span data-ttu-id="7d0b1-133">Der Anfangsverbindungsversuch ist erfolgreich, und der Datenzugriffsanbieter speichert den Namen des Spiegelservers (derzeit **Partner_B**) als Failoverpartnername im lokalen Cache.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-133">The initial connection attempt succeeds, and the data access provider stores the name of the mirror server (currently **Partner_B**) as the failover partner name in the local cache.</span></span> <span data-ttu-id="7d0b1-134">Schließlicht stellt der Client die Verbindung mit der Prinzipalkopie der **Db_1** -Datenbank her.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-134">Finally, the client connects to the principal copy of the **Db_1** database.</span></span>  
  
 <span data-ttu-id="7d0b1-135">![Clientverbindung, wenn der Anfangspartner der Prinzipal ist](../media/dbm-initial-connection.gif "Clientverbindung, wenn der Anfangspartner der Prinzipal ist")</span><span class="sxs-lookup"><span data-stu-id="7d0b1-135">![Client connection if initial partner is principal](../media/dbm-initial-connection.gif "Client connection if initial partner is principal")</span></span>  
  
 <span data-ttu-id="7d0b1-136">Der Anfangsverbindungsversuch kann beispielsweise aufgrund eines Netzwerkfehlers oder einer inaktiven Serverinstanz fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-136">The initial connection attempt may fail, for example, because of a network error or an inactive server instance.</span></span> <span data-ttu-id="7d0b1-137">Da der erste Partner nicht verfügbar ist, muss für den Client ein Failoverpartnername in der Verbindungszeichenfolge angegeben sein, damit der Datenzugriffsanbieter versucht, die Verbindung mit dem Failoverpartner herzustellen.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-137">Because the initial partner is unavailable, for the data access provider to attempt to connect to the failover partner, the client must have supplied the failover partner name in the connection string.</span></span>  
  
 <span data-ttu-id="7d0b1-138">Steht der Failoverpartnername in diesem Fall nicht zur Verfügung, wird der ursprüngliche Verbindungsversuch so lange fortgesetzt, bis das Netzwerkverbindungstimeout erreicht ist oder ein Fehler zurückgegeben wird (wie bei einer nicht gespiegelten Datenbank).</span><span class="sxs-lookup"><span data-stu-id="7d0b1-138">In that case, if the failover partner name is unavailable, the original connection attempt continues until the network connection timeout or an error is returned (just as for a non-mirrored database).</span></span>  
  
 <span data-ttu-id="7d0b1-139">Wird der Failoverpartnername in der Verbindungszeichenfolge bereitgestellt, hängt das Verhalten des Datenzugriffsanbieters wie folgt vom Netzwerkprotokoll und Betriebssystem des Clients ab:</span><span class="sxs-lookup"><span data-stu-id="7d0b1-139">When the failover partner name is supplied in the connection string, the behavior of the data access provider depends on the network protocol and operating system of the client, as follows:</span></span>  
  
-   <span data-ttu-id="7d0b1-140">Für TCP/IP werden die Verbindungsversuche durch einem speziellen Verbindungswiederholungsalgorithmus für Datenbankspiegelungen geregelt.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-140">For TCP/IP, the connection attempts are regulated by a connection retry algorithm that is specific to database mirroring.</span></span> <span data-ttu-id="7d0b1-141">Der *Algorithmus für zu wiederholende Verbindungsversuche* gibt die maximale Zeitdauer (die *Wiederholungszeit*) an, die zum Öffnen einer Verbindung in einem bestimmten Verbindungsversuch zugeteilt wurde.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-141">The *connection retry algorithm* determines the maximum time (the *retry time*) allotted for opening a connection in a given connection attempt.</span></span>  
  
-   <span data-ttu-id="7d0b1-142">Für andere Netzwerkprotokolle</span><span class="sxs-lookup"><span data-stu-id="7d0b1-142">For other network protocols</span></span>  
  
     <span data-ttu-id="7d0b1-143">Tritt ein Fehler auf oder ist der erste Partner nicht verfügbar, wartet der Anfangsverbindungsversuch, bis das Netzwerkverbindungstimeout oder das Anmeldungstimeout für den Datenzugriffsanbieter abgelaufen ist.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-143">If an error occurs or if the initial partner is unavailable, the initial connection attempt waits until the network connection timeout period expires or the login timeout period expires on the data access provider.</span></span> <span data-ttu-id="7d0b1-144">Die Wartedauer liegt in der Regel zwischen 20 und 30 Sekunden.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-144">Typically, this wait is on the order of 20 to 30 seconds.</span></span> <span data-ttu-id="7d0b1-145">Ohne Timeout des Datenzugriffsanbieters versucht dieser, eine Verbindung mit dem Failoverpartner herzustellen.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-145">Thereafter, if the data access provider has not timed out, it attempts to connect to the failover partner.</span></span> <span data-ttu-id="7d0b1-146">Läuft das Verbindungstimeout vor dem erfolgreichen Herstellen der Verbindung ab oder der Failoverpartner ist nicht verfügbar, schlägt der Verbindungsversuch fehl.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-146">If the connection timeout period expires before the connection succeeds or the failover partner is unavailable, the connection attempt fails.</span></span> <span data-ttu-id="7d0b1-147">Steht der Failoverpartner innerhalb des Anmeldungstimeouts zur Verfügung und stellt nun den Prinzipalserver dar, verläuft der Verbindungsversuch in der Regel erfolgreich.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-147">If failover partner is available within the login timeout period and is now the principal server, the connection attempt normally succeeds.</span></span>  

  
### <a name="connection-strings-for-a-mirrored-database"></a><span data-ttu-id="7d0b1-148">Verbindungszeichenfolgen für eine gespiegelte Datenbank</span><span class="sxs-lookup"><span data-stu-id="7d0b1-148">Connection Strings for a Mirrored Database</span></span>  
 <span data-ttu-id="7d0b1-149">Die vom Client bereitgestellte Verbindungszeichenfolge enthält Informationen, die der Datenzugriffsanbieter zum Herstellen der Verbindung mit der Datenbank verwendet.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-149">The connection string supplied by the client contains information that the data access provider uses to connect to the database.</span></span> <span data-ttu-id="7d0b1-150">In diesem Abschnitt werden die Schlüsselwörter erläutert, die speziell zum Herstellen einer Verbindung mit einer gespiegelten Datenbank mithilfe einer ODBC-Treiberverbindung für [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client relevant sind.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-150">This section discusses the keywords that are specifically relevant for connecting to a mirrored database using a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC Driver Connection.</span></span>  
  
#### <a name="network-attribute"></a><span data-ttu-id="7d0b1-151">Network-Attribut</span><span class="sxs-lookup"><span data-stu-id="7d0b1-151">Network Attribute</span></span>  
 <span data-ttu-id="7d0b1-152">Die Verbindungszeichenfolge sollte das Attribut **Network** zur Angabe des Netzwerkprotokolls enthalten.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-152">The connection string should contain the **Network** attribute to specify the network protocol.</span></span> <span data-ttu-id="7d0b1-153">So wird sichergestellt, dass das angegebene Netzwerkprotokoll zwischen Verbindungen mit verschiedenen Partnern dauerhaft gespeichert wird.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-153">This ensures that the specified network protocol persists between connections to different partners.</span></span> <span data-ttu-id="7d0b1-154">TCP/IP ist das Protokoll, das sich am besten zum Herstellen einer Verbindung mit einer gespiegelten Datenbank eignet.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-154">The best protocol for connecting to a mirrored database is TCP/IP.</span></span> <span data-ttu-id="7d0b1-155">Damit der Client TCP/IP für jede Verbindung mit den Partnern anfordert, stellt eine Verbindungszeichenfolge das folgende Attribut bereit:</span><span class="sxs-lookup"><span data-stu-id="7d0b1-155">To ensure that the client requests TCP/IP for every connection to the partners, a connection string supplies the following attribute:</span></span>  
  
```  
Network=dbmssocn;   
```  
  
> [!IMPORTANT]  
>  <span data-ttu-id="7d0b1-156">Es wird empfohlen, TCP/IP an oberster Stelle der Protokollliste eines Clients zu belassen.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-156">We recommend keeping TCP/IP at the top of a client's protocol list.</span></span> <span data-ttu-id="7d0b1-157">Wenn die Verbindungszeichenfolge jedoch das Attribut **Network** angibt, wird die Reihenfolge der Liste dadurch überschrieben.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-157">However, if the connection string specifies the **Network** attribute, this overrides the list order.</span></span>  
  
 <span data-ttu-id="7d0b1-158">Um alternativ sicherzustellen, dass der Client Named Pipes für jede Verbindung mit den Partnern anfordert, stellt eine Verbindungszeichenfolge das folgende Attribut bereit:</span><span class="sxs-lookup"><span data-stu-id="7d0b1-158">Alternatively, to ensure that the client requests named pipes for every connection to the partners, a connection string supplies the following attribute:</span></span>  
  
```  
Network=dbnmpntw;   
```  
  
> [!IMPORTANT]  
>  <span data-ttu-id="7d0b1-159">Da Named Pipes den TCP/IP-Wiederholungsalgorithmus nicht verwenden, erreicht ein Verbindungsversuch mit Named Pipes häufig zuerst ein Timeout, ehe eine Verbindung mit einer gespiegelten Datenbank hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-159">Because named pipes does not use the TCP/IP retry algorithm, in many cases, a named pipes connection attempt may time out before connecting to a mirrored database.</span></span>  
  
#### <a name="server-attribute"></a><span data-ttu-id="7d0b1-160">Server-Attribut</span><span class="sxs-lookup"><span data-stu-id="7d0b1-160">Server Attribute</span></span>  
 <span data-ttu-id="7d0b1-161">Die Verbindungszeichenfolge muss ein `Server`-Attribut enthalten, das den Namen des ersten Partners bereitstellt, der die aktuelle Prinzipalserverinstanz identifizieren sollte.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-161">The connection string must contain a `Server` attribute that supplies the initial partner name, which should identify the current principal server instance.</span></span>  
  
 <span data-ttu-id="7d0b1-162">Die einfachste Art, die Serverinstanz zu identifizieren, besteht darin, ihren Namen ( *<Servername>* [ **\\** _<SQL_Server_Instanzname>_ ]) anzugeben.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-162">The simplest way to identify the server instance is by specifying its name , *<server_name>*[**\\**_<SQL_Server_instance_name>_].</span></span> <span data-ttu-id="7d0b1-163">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="7d0b1-163">For example:</span></span>  
  
 `Server=Partner_A;`  
  
 <span data-ttu-id="7d0b1-164">oder</span><span class="sxs-lookup"><span data-stu-id="7d0b1-164">or</span></span>  
  
 `Server=Partner_A\Instance_2;`  
  
 <span data-ttu-id="7d0b1-165">Wenn jedoch der Systemname verwendet wird, muss der Client ein DNS-Lookup ausführen, um die IP-Adresse des Servers zu erhalten, und eine SQL Server-Browser-Abfrage, um die Portnummer des Servers abzurufen, auf dem sich der Partner befindet.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-165">However, when the system name is used, the client must perform a DNS lookup to obtain the IP address of the server and a SQL Server Browser query to obtain the port number of the server on which the partner resides.</span></span> <span data-ttu-id="7d0b1-166">Diese Lookups und Abfragen können durch Angabe der IP-Adresse und Portnummer des Partners im `Server`-Attribut anstelle des Servernamens umgangen werden.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-166">Those lookups and queries can be bypassed by specifying the IP address and port number of the partner in the `Server` attribute, rather than specifying the server name.</span></span> <span data-ttu-id="7d0b1-167">Diese Vorgehensweise wird empfohlen, um die Möglichkeit externer Verzögerungen beim Verbinden mit diesem Partner zu minimieren.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-167">This is recommended to minimize the possibility of external delays while connecting to that partner.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7d0b1-168">Eine SQL Server-Browser-Abfrage ist erforderlich, wenn in der Verbindungszeichenfolge der benannte Instanzname und nicht der Port angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-168">A SQL Server Browser query is necessary if the connection string specifies the named instance name and not the port.</span></span>  
  
 <span data-ttu-id="7d0b1-169">Zum Angeben der IP-Adresse und des Ports hat das- `Server` Attribut die folgende Form, `Server=` *<ip_address>* `,` *\<port>* , z. b.:</span><span class="sxs-lookup"><span data-stu-id="7d0b1-169">To specify the IP address and port, the `Server` attribute takes the following form, `Server=`*<ip_address>*`,`*\<port>*, for example:</span></span>  
  
```  
Server=123.34.45.56,4724;   
```  
  
> [!NOTE]  
>  <span data-ttu-id="7d0b1-170">Die IP-Adresse kann im IPv4-Format (IP Version 4) oder im IPv6-Format (IP Version) vorliegen.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-170">The IP address can be IP Version 4 (IPv4) or IP Version 6 (IPv6).</span></span>  
  
#### <a name="database-attribute"></a><span data-ttu-id="7d0b1-171">Database-Attribut</span><span class="sxs-lookup"><span data-stu-id="7d0b1-171">Database Attribute</span></span>  
 <span data-ttu-id="7d0b1-172">Zusätzlich muss die Verbindungszeichenfolge das `Database`-Attribut angeben, um den Namen der gespiegelten Datenbank bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-172">In addition, the connection string must specify the `Database` attribute to supply the name of the mirrored database.</span></span> <span data-ttu-id="7d0b1-173">Wenn die Datenbank beim Verbindungsversuch des Clients nicht verfügbar ist, wird eine Ausnahme ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-173">If the database is unavailable when the client attempts to connect, an exception is raised.</span></span>  
  
 <span data-ttu-id="7d0b1-174">Um beispielsweise eine Verbindung mit der **AdventureWorks** -Datenbank auf dem Prinzipalserver Partner_A herzustellen, verwendet der Client die folgende Verbindungszeichenfolge:</span><span class="sxs-lookup"><span data-stu-id="7d0b1-174">For example, to expressly connect to the **AdventureWorks** database on the principal server Partner_A, a client uses the following connection string:</span></span>  
  
 `" Server=Partner_A; Database=AdventureWorks "`  
  
> [!NOTE]  
>  <span data-ttu-id="7d0b1-175">Die Authentifizierungsinformationen fehlen in dieser Zeichenfolge.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-175">This string omits authentication information.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="7d0b1-176">Die Bündelung des Protokoll Präfix mit dem- `Server` Attribut ( `Server=tcp:` *\<servername>* ) ist nicht mit dem **Network** -Attribut kompatibel, und die Angabe des Protokolls an beiden Stellen führt wahrscheinlich zu einem Fehler.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-176">Bundling the protocol prefix with the `Server` attribute (`Server=tcp:`*\<servername>*) is incompatible with the **Network** attribute, and specifying the protocol in both places will likely result in an error.</span></span> <span data-ttu-id="7d0b1-177">Daher wird empfohlen, dass eine Verbindungs Zeichenfolge das Protokoll mithilfe des **Network** -Attributs angibt und nur der Servername im- `Server` Attribut () angegeben wird `"Network=dbmssocn; Server=` *\<servername>* `"` .</span><span class="sxs-lookup"><span data-stu-id="7d0b1-177">Therefore, we recommend that a connection string specify the protocol using the **Network** attribute and specify only the server name in the `Server` attribute (`"Network=dbmssocn; Server=`*\<servername>*`"`).</span></span>  
  
#### <a name="failover-partner-attribute"></a><span data-ttu-id="7d0b1-178">Failover Partner-Attribut</span><span class="sxs-lookup"><span data-stu-id="7d0b1-178">Failover Partner Attribute</span></span>  
 <span data-ttu-id="7d0b1-179">Neben dem Namen des ersten Partners kann der Client auch den Namen des Failoverpartners angeben, der die aktuelle Spiegelserverinstanz identifizieren sollte.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-179">In addition to the initial partner name, the client can also specify failover partner name, which should identify the current mirror server instance.</span></span> <span data-ttu-id="7d0b1-180">Der Failoverpartner wird durch eines der Schlüsselwörter des Failover Partner-Attributs angegeben.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-180">The failover partner is specified by one of the keywords for the failover partner attribute.</span></span> <span data-ttu-id="7d0b1-181">Das Schlüsselwort für dieses Attribut hängt von der verwendeten API ab.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-181">The keyword for this attribute depends on the API that you are using.</span></span> <span data-ttu-id="7d0b1-182">In der folgenden Tabelle werden diese Schlüsselwörter aufgeführt:</span><span class="sxs-lookup"><span data-stu-id="7d0b1-182">The following table lists these keywords:</span></span>  
  
|<span data-ttu-id="7d0b1-183">API</span><span class="sxs-lookup"><span data-stu-id="7d0b1-183">API</span></span>|<span data-ttu-id="7d0b1-184">Schlüsselwort für das Failover Partner-Attribut</span><span class="sxs-lookup"><span data-stu-id="7d0b1-184">Keyword for failover partner attribute</span></span>|  
|---------|--------------------------------------------|  
|<span data-ttu-id="7d0b1-185">OLE DB-Anbieter</span><span class="sxs-lookup"><span data-stu-id="7d0b1-185">OLE DB Provider</span></span>|`FailoverPartner`|  
|<span data-ttu-id="7d0b1-186">ODBC-Treiber</span><span class="sxs-lookup"><span data-stu-id="7d0b1-186">ODBC Driver</span></span>|`Failover_Partner`|  
|<span data-ttu-id="7d0b1-187">ActiveX-Datenobjekte (ADO)</span><span class="sxs-lookup"><span data-stu-id="7d0b1-187">ActiveX Data Objects (ADO)</span></span>|`Failover Partner`|  
  
 <span data-ttu-id="7d0b1-188">Die einfachste Art, die Serverinstanz zu identifizieren, ist über ihren Systemnamen, *<Servername>* [ **\\** _<SQL_Server_Instanzname>_ ].</span><span class="sxs-lookup"><span data-stu-id="7d0b1-188">The simplest way to identify the server instance is by its system name, *<server_name>*[**\\**_<SQL_Server_instance_name>_].</span></span>  
  
 <span data-ttu-id="7d0b1-189">Alternativ können die IP-Adresse und die Portnummer im `Failover Partner`-Attribut bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-189">Alternatively, the IP address and port number can be supplied in the `Failover Partner` attribute.</span></span> <span data-ttu-id="7d0b1-190">Wenn der Anfangsverbindungsversuch während der ersten Verbindung mit der Datenbank fehlschlägt, wird beim Versuch, eine Verbindung mit dem Failoverpartner herzustellen, auf das Zurückgreifen auf DNS und SQL Server-Browser verzichtet.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-190">If the initial connection attempt fails during the first connection to the database, the attempt to connect to the failover partner will be freed from relying on DNS and SQL Server Browser.</span></span> <span data-ttu-id="7d0b1-191">Wenn eine Verbindung hergestellt wurde, wird der Failoverpartnername durch den Failoverpartnernamen überschrieben; bei einem Failover benötigen die umgeleiteten Verbindung somit DNS- und SQL Server-Browser.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-191">Once a connection is established, the failover partner name will be overwritten with the failover partner name, so if a failover occurs, the redirected connections will require DNS and SQL Server Browser.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7d0b1-192">Wenn nur der erste Partnername angegeben wird, müssen Anwendungsentwickler weder zusätzliche Schritte ergreifen noch zusätzlichen Code schreiben, außer um wieder eine Verbindung herzustellen.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-192">When only the initial partner name is provided, application developers do not need to take any action or write any code except about how to reconnect.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7d0b1-193">Entwickler von Anwendungen mit verwaltetem Code geben den Namen des Failoverpartners im `ConnectionString`-Objekt unter `SqlConnection` an.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-193">Managed code application developers supply the failover partner name in the `ConnectionString` of the `SqlConnection` object.</span></span> <span data-ttu-id="7d0b1-194">Informationen zum Verwenden dieser Verbindungszeichenfolge finden Sie in der zum [!INCLUDE[msCoName](../../includes/msconame-md.md)] .NET Framework SDK gehörigen Dokumentation zu ADO.NET im Kapitel zur Unterstützung der Datenbankspiegelung im .NET Framework-Datenanbieter für SQL Server.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-194">For information on using this connection string, see "Database Mirroring Support in the .NET Framework Data Provider for SQL Server" in the ADO.NET documentation, which is part of the [!INCLUDE[msCoName](../../includes/msconame-md.md)] .NET Framework SDK.</span></span>  
  
#### <a name="example-connection-string"></a><span data-ttu-id="7d0b1-195">Beispiel für eine Verbindungszeichenfolge</span><span class="sxs-lookup"><span data-stu-id="7d0b1-195">Example Connection String</span></span>  
 <span data-ttu-id="7d0b1-196">Um beispielsweise eine Verbindung mithilfe von TCP/IP mit der **AdventureWorks** -Datenbank auf Partner_A oder Partner_B herzustellen, kann durch eine Clientanwendung, die den ODBC-Treiber verwendet, die folgende Verbindungszeichenfolge bereitgestellt werden:</span><span class="sxs-lookup"><span data-stu-id="7d0b1-196">For example, to explicitly connect using TCP/IP to the **AdventureWorks** database on either Partner_A or Partner_B, a client application that uses the ODBC Driver could supply the following connection string:</span></span>  
  
```  
"Server=Partner_A; Failover_Partner=Partner_B; Database=AdventureWorks; Network=dbmssocn"  
```  
  
 <span data-ttu-id="7d0b1-197">Alternativ könnte der Client die IP-Adresse und Portnummer zum Identifizieren des ersten Partners, Partner_A, verwenden; wenn die IP-Adresse beispielsweise 250.65.43.21 und die Portnummer 4734 lautet, sieht die Verbindungszeichenfolge wie folgt aus:</span><span class="sxs-lookup"><span data-stu-id="7d0b1-197">Alternatively, the client could use the IP address and port number to identify the initial partner, Partner_A; for example, if the IP address is 250.65.43.21 and the port number is 4734, the connection string would be:</span></span>  
  
```  
"Server=250.65.43.21,4734; Failover_Partner=Partner_B; Database=AdventureWorks; Network=dbmssocn"  
```  
  
##  <a name="connection-retry-algorithm-for-tcpip-connections"></a><a name="RetryAlgorithm"></a> <span data-ttu-id="7d0b1-198">Algorithmus für zu wiederholende Verbindungsversuche (für TCP/IP-Verbindungen)</span><span class="sxs-lookup"><span data-stu-id="7d0b1-198">Connection Retry Algorithm (for TCP/IP Connections)</span></span>  
 <span data-ttu-id="7d0b1-199">Wenn beide Partnernamen im Cache vorhanden sind, hält der Datenzugriffsanbieter für eine TCP/IP-Verbindung an einem Verbindungswiederholungsalgorithmus fest.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-199">For a TCP/IP connection, when both partner names are in the cache, the data access provider adheres to a connection retry algorithm.</span></span> <span data-ttu-id="7d0b1-200">Dies gilt sowohl beim Herstellen der ersten Verbindung mit der Sitzung als auch beim erneuten Herstellen der Verbindung, nachdem eine bereits hergestellte Verbindung verloren ging.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-200">This is true both for making the initial connection to the session and for reconnecting after losing an established connection.</span></span> <span data-ttu-id="7d0b1-201">Sobald eine Verbindung geöffnet wurde, wird zum Ausführen der vor der Anmeldung und während der Anmeldung erforderlichen Schritte zusätzliche Zeit benötigt.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-201">Once a connection has been opened, completing the pre-login and login steps takes additional time.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7d0b1-202">Der zum Öffnen einer Verbindung erforderliche Zeitaufwand kann aufgrund von externen Faktoren, wie z. B. langsame DNS-Lookups, langsamer Domänencontroller oder langsames Kerberos-Schlüsselverteilungscenter (KDC), Zeitaufwand für die Kontaktherstellung mit dem SQL Server-Browser, Netzwerküberlastung usw., höher als die Wiederholungszeit sein.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-202">The time spent in opening a connection can exceed the retry time because of external factors, such as slow DNS lookups, slow domain controller/Kerberos Key Distribution Center (KDC), time spent contacting SQL Server Browser, network congestion, and so forth.</span></span> <span data-ttu-id="7d0b1-203">Solche externen Faktoren können verhindern, dass ein Client eine Verbindung mit einer gespiegelten Datenbank herstellen kann.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-203">Such external factors can prevent a client from connecting to a mirrored database.</span></span> <span data-ttu-id="7d0b1-204">Aufgrund externer Faktoren kann es auch vorkommen, dass eine Verbindung nicht innerhalb der zugeteilten Wiederholungszeit geöffnet werden kann.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-204">Also, external factors can cause a connection to take longer to open than the allotted retry time.</span></span> <span data-ttu-id="7d0b1-205">Informationen zum Umgehen des DNS- und SQL Server-Browsers bei Verbindungsversuchen mit dem ersten Partner finden Sie unter [Herstellen der Anfangsverbindung mit einer Datenbank-Spiegelungssitzung](#InitialConnection)weiter oben in diesem Thema.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-205">For information on bypassing DNS and SQL Server Browser for connection attempt to the initial partner, see [Making the Initial Connection to a Database Mirroring Session](#InitialConnection), earlier in this topic.</span></span>  
  
 <span data-ttu-id="7d0b1-206">Wenn ein Verbindungsversuch fehlschlägt oder die Wiederholungszeit abläuft, bevor eine Verbindung hergestellt werden kann, versucht der Datenzugriffsanbieter, eine Verbindung zu dem anderen Partner herzustellen.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-206">If a connection attempt fails or the retry time expires before it succeeds, the data access provider tries the other partner.</span></span> <span data-ttu-id="7d0b1-207">Wenn bis zu diesem Punkt noch keine Verbindung geöffnet wurde, versucht der Anbieter abwechselnd mit den Namen des ersten Partners und dem Namen des Failoverpartners eine Verbindung herzustellen, solange bis dies gelingt oder bis ein Anmeldungstimeout auftritt. Der Standardtimeoutwert für den Anmeldungszeitraum beträgt 15 Sekunden.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-207">If a connection is not opened by this point, the provider alternately tries the initial and failover partner names, until a connection is opened or the login period times out. The default login time-out period is 15 seconds.</span></span> <span data-ttu-id="7d0b1-208">Es wird empfohlen, den Anmeldungstimeout auf mindestens fünf Sekunden festzulegen.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-208">We recommend that the login time-out period be at least 5 seconds.</span></span> <span data-ttu-id="7d0b1-209">Bei einem kürzeren Timeoutwert können Verbindungen u. U. nicht mehr erfolgreich hergestellt werden.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-209">Specifying a smaller time-out period might prevent any of the connection attempts from succeeding.</span></span>  
  
 <span data-ttu-id="7d0b1-210">Die Wiederholungszeit ist ein Prozentsatz des Anmeldungszeitraums.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-210">The retry time is a percentage of the login period.</span></span> <span data-ttu-id="7d0b1-211">Die Wiederholungszeit für einen Verbindungsversuch verlängert sich mit jeder Folgerunde.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-211">The retry time for a connection attempt is larger in each successive round.</span></span> <span data-ttu-id="7d0b1-212">In der ersten Runde beträgt die Wiederholungszeit für jeden der zwei Versuche acht Prozent des gesamten Anmeldungszeitraums.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-212">In the first round, the retry time for each of the two attempts is 8 percent of the total login period.</span></span> <span data-ttu-id="7d0b1-213">In jeder Folgerunde erhöht der Wiederholungsalgorithmus die maximale Wiederholungszeit um denselben Faktor.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-213">In each successive round, the retry algorithm increases the maximum retry time by the same amount.</span></span> <span data-ttu-id="7d0b1-214">Die Wiederholungszeiten für die ersten acht Verbindungsversuche bemessen sich daher wie folgt:</span><span class="sxs-lookup"><span data-stu-id="7d0b1-214">Thus, the retry times for the first eight connection attempts is as follows:</span></span>  
  
 <span data-ttu-id="7d0b1-215">8%, 8%, 16%, 16%, 24%, 24%, 32%, 32%</span><span class="sxs-lookup"><span data-stu-id="7d0b1-215">8%, 8%, 16%, 16%, 24%, 24%, 32%, 32%</span></span>  
  
 <span data-ttu-id="7d0b1-216">Die Wiederholungszeit wird mit der folgenden Formel berechnet:</span><span class="sxs-lookup"><span data-stu-id="7d0b1-216">The retry time is calculated using the following formula:</span></span>  
  
 <span data-ttu-id="7d0b1-217">_RetryTime_ **=**  _PreviousRetryTime_  **+ (** 0,08  **&#42;** _LoginTimeout_ **)**</span><span class="sxs-lookup"><span data-stu-id="7d0b1-217">_RetryTime_ **=** _PreviousRetryTime_ **+(** 0.08 **&#42;**_LoginTimeout_**)**</span></span>  
  
 <span data-ttu-id="7d0b1-218">Hierbei gilt für *Vorhergehende Wiederholungszeit* ein Anfangswert von 0.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-218">Where *PreviousRetryTime* is initially 0.</span></span>  
  
 <span data-ttu-id="7d0b1-219">Bei Verwendung des Standardwerts für den Anmeldungstimeout von 15 Sekunden gilt *LoginTimeout*  *= 15*.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-219">For example, if using the default login time-out period of 15 seconds, *LoginTimeout* *= 15*.</span></span> <span data-ttu-id="7d0b1-220">In diesem Fall berechnen sich die Wiederholungszeiten in den ersten drei Runden wie folgt:</span><span class="sxs-lookup"><span data-stu-id="7d0b1-220">In this case, the retry times allotted in the first three rounds are as follows:</span></span>  
  
|<span data-ttu-id="7d0b1-221">Round</span><span class="sxs-lookup"><span data-stu-id="7d0b1-221">Round</span></span>|<span data-ttu-id="7d0b1-222">Berechnung der*Wiederholungszeit*</span><span class="sxs-lookup"><span data-stu-id="7d0b1-222">*RetryTime* calculation</span></span>|<span data-ttu-id="7d0b1-223">Wiederholungszeit pro Versuch</span><span class="sxs-lookup"><span data-stu-id="7d0b1-223">Retry time per attempt</span></span>|  
|-----------|-----------------------------|----------------------------|  
|<span data-ttu-id="7d0b1-224">1</span><span class="sxs-lookup"><span data-stu-id="7d0b1-224">1</span></span>|<span data-ttu-id="7d0b1-225">0 **+(** 0,08 **&#42;** 15 **)**</span><span class="sxs-lookup"><span data-stu-id="7d0b1-225">0 **+(** 0.08 **&#42;** 15 **)**</span></span>|<span data-ttu-id="7d0b1-226">1,2 Sekunden</span><span class="sxs-lookup"><span data-stu-id="7d0b1-226">1.2 seconds</span></span>|  
|<span data-ttu-id="7d0b1-227">2</span><span class="sxs-lookup"><span data-stu-id="7d0b1-227">2</span></span>|<span data-ttu-id="7d0b1-228">1.2 **+(** 0,08 **&#42;** 15 **)**</span><span class="sxs-lookup"><span data-stu-id="7d0b1-228">1.2 **+(** 0.08 **&#42;** 15 **)**</span></span>|<span data-ttu-id="7d0b1-229">2,4 Sekunden</span><span class="sxs-lookup"><span data-stu-id="7d0b1-229">2.4 seconds</span></span>|  
|<span data-ttu-id="7d0b1-230">3</span><span class="sxs-lookup"><span data-stu-id="7d0b1-230">3</span></span>|<span data-ttu-id="7d0b1-231">2.4 **+(** 0,08 **&#42;** 15 **)**</span><span class="sxs-lookup"><span data-stu-id="7d0b1-231">2.4 **+(** 0.08 **&#42;** 15 **)**</span></span>|<span data-ttu-id="7d0b1-232">3,6 Sekunden</span><span class="sxs-lookup"><span data-stu-id="7d0b1-232">3.6 seconds</span></span>|  
|<span data-ttu-id="7d0b1-233">4</span><span class="sxs-lookup"><span data-stu-id="7d0b1-233">4</span></span>|<span data-ttu-id="7d0b1-234">3.6 **+(** 0,08 **&#42;** 15 **)**</span><span class="sxs-lookup"><span data-stu-id="7d0b1-234">3.6 **+(** 0.08 **&#42;** 15 **)**</span></span>|<span data-ttu-id="7d0b1-235">4,8 Sekunden</span><span class="sxs-lookup"><span data-stu-id="7d0b1-235">4.8 seconds</span></span>|   
  
 <span data-ttu-id="7d0b1-236">In der folgenden Abbildung werden diese Wiederholungszeiten für aufeinander folgende Wiederholungsversuche, für die jeweils ein Timeout erfolgt, veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-236">The following figure illustrates these retry times for successive connection attempts, each of which times out.</span></span>  
  
 <span data-ttu-id="7d0b1-237">![Maximale Wiederholungsverzögerungen für ein 15-sekündiges Anmeldungstimeout](../media/dbm-retry-algorithm.gif "Maximale Wiederholungsverzögerungen für ein 15-sekündiges Anmeldungstimeout")</span><span class="sxs-lookup"><span data-stu-id="7d0b1-237">![Maximum retry delays for 15 second login timeout](../media/dbm-retry-algorithm.gif "Maximum retry delays for 15 second login timeout")</span></span>  
  
 <span data-ttu-id="7d0b1-238">Bei Verwendung des Standardtimeoutwerts für den Anmeldungszeitraum werden für die ersten drei Runden von Verbindungsversuchen maximal 14,4 Sekunden zugeteilt.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-238">For the default login time-out period, the maximum time allotted to the first three rounds of connection attempts is 14.4 seconds.</span></span> <span data-ttu-id="7d0b1-239">Würde bei jedem Versuch die gesamte dafür zugeteilte Zeit aufgebraucht, wären nur noch 0,6 Sekunden übrig, bevor der Anmeldungszeitraum abläuft. In diesem Fall würde die vierte Runde zeitlich beschnitten, sodass für die Verbindungsherstellung unter Verwendung des ersten Partnernamens nur noch ein letzter, kurzer Versuch möglich wäre.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-239">If every attempt were to use all of its allotted time, only 0.6 seconds of time would remain before the login period times out. In that case, the fourth round would be curtailed, allowing only a final quick attempt to connect using the initial partner name.</span></span> <span data-ttu-id="7d0b1-240">Ein Verbindungsversuch kann aber, besonders in nachfolgenden Runden, auch schon vor Ablauf der jeweils zugeteilten Wiederholungszeit fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-240">However, a connection attempt may fail in less than its allotted retry time, particularly in later rounds.</span></span> <span data-ttu-id="7d0b1-241">So würde z. B. bei einem Netzwerkfehler ein Versuch schon vorzeitig, also vor Ablauf der Wiederholungszeit, beendet werden.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-241">For example, receiving a network error can cause an attempt to end before the retry time expires.</span></span> <span data-ttu-id="7d0b1-242">Wenn frühere Versuche aufgrund eines Netzwerkfehlers fehlschlagen, dann wäre für die vierte Runde und möglicherweise auch noch für weitere Runden zusätzlich Zeit vorhanden.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-242">If earlier attempts fail due to a network error, additional time would be available for the fourth round and, perhaps, additional rounds.</span></span>  
  
 <span data-ttu-id="7d0b1-243">Eine weitere Ursache für einen fehlgeschlagenen Versuch ist eine nicht aktive Serverinstanz. Dies ist z. B. der Fall, wenn für die Datenbank einer Serverinstanz gerade ein Failover ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-243">Another cause of a failed attempt is an inactive server instance, as occurs when a server instance is engaged in failing over its database.</span></span> <span data-ttu-id="7d0b1-244">In diesem Fall tritt eine Wiederholungsverzögerung ein, um zu verhindern, dass Clients die Partner mit einer raschen Folge von Verbindungsversuchen überlasten.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-244">In this case, a retry delay is imposed to prevent clients from overloading the partners with a rapid succession of connection attempts.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7d0b1-245">Wenn beide Partnernamen verfügbar sind und für den Anmeldungszeitraum keine Zeitbegrenzung festgelegt ist, versucht der Client unbegrenzt lange, eine Verbindung zu den Servern herzustellen, wobei abwechselnd der Name des ersten Partners und der Name des Failoverpartners verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-245">When both partner names are available, if the login time-out period is infinite, the client attempts to reconnect to the servers indefinitely, alternating between the initial partner name and the failover partner name.</span></span>  
<span data-ttu-id="7d0b1-246">)</span><span class="sxs-lookup"><span data-stu-id="7d0b1-246">)</span></span>  
  
### <a name="retry-delays-during-failover"></a><span data-ttu-id="7d0b1-247">Wiederholungsverzögerungen während eines Failovers</span><span class="sxs-lookup"><span data-stu-id="7d0b1-247">Retry Delays During Failover</span></span>  
 <span data-ttu-id="7d0b1-248">Versucht ein Client, eine Verbindung mit einem Partner herzustellen, für den gerade ein Failover ausgeführt wird, antwortet der Partner sofort, dass er nicht aktiv ist.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-248">If a client attempts to connect to a partner that is failing over, the partner immediately responds that it is inactive.</span></span> <span data-ttu-id="7d0b1-249">In diesem Fall ist jede Runde von Verbindungsversuchen viel kürzer als die dafür zugeteilte Wiederholungszeit.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-249">In this case, each round of connection attempts are much briefer than the allotted retry time.</span></span> <span data-ttu-id="7d0b1-250">Dies bedeutet, dass viele Verbindungsversuchsrunden stattfinden können, bevor ein Timeout des Anmeldungszeitraums eintritt. Damit die Partner während eines Failovers nicht durch eine Serie von schnell aufeinander folgenden Verbindungsversuchen überlastet werden, fügt der Datenzugriffsanbieter nach jedem Wiederholungszyklus eine kurze Wiederholungsverzögerung hinzu.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-250">This means that many rounds of connection attempts could happen before the login period times out. To avoid overloading the partners with a rapid series of connection attempts during a failover, the data access provider adds a brief retry delay after each retry cycle.</span></span> <span data-ttu-id="7d0b1-251">Die Länge dieser Wiederholungsverzögerung wird vom Wiederholungsverzögerungsalgorithmus bestimmt.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-251">The length of a given retry delay is determined by the retry-delay algorithm.</span></span> <span data-ttu-id="7d0b1-252">Nach der ersten Runde beträgt die Verzögerung 100 Millisekunden.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-252">After the first round, the delay is 100 milliseconds.</span></span> <span data-ttu-id="7d0b1-253">Nach jeder der nächsten drei Runden verdoppelt sich die Wiederholungsverzögerung – auf 200, 400 und 800.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-253">After each of the next three rounds, the retry delay doubles-to 200, 400, and 800.</span></span> <span data-ttu-id="7d0b1-254">Für alle späteren Runden beträgt die Wiederholungsverzögerung 1 Sekunde, bis der Verbindungsversuch erfolgreich ist oder das Timeout erreicht wird.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-254">For all later rounds, the retry delay is 1 second until the connection attempt succeeds or times out.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7d0b1-255">Wenn die Serverinstanz beendet wird, wird die Verbindungsanforderung sofort abgebrochen.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-255">If the server instance is stopped, then the connection request fails immediately.</span></span>  
  
 <span data-ttu-id="7d0b1-256">Die folgende Abbildung veranschaulicht, wie sich die Verbindungsverzögerung während eines manuellen Failovers, in dem die Partner ihre Rollen tauschen, auf Verbindungsversuche auswirkt.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-256">The following figure illustrates how the retry delay affects connection attempts during a manual failover, in which the partners switch their roles.</span></span> <span data-ttu-id="7d0b1-257">Der Timeoutwert für den Anmeldungszeitraum beträgt 15 Sekunden.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-257">The login time-out period is 15 seconds.</span></span>  
  
 <span data-ttu-id="7d0b1-258">![Wiederholungsverzögerungsalgorithmus](../media/dbm-retry-delay-algorithm.gif "Wiederholungsverzögerungsalgorithmus")</span><span class="sxs-lookup"><span data-stu-id="7d0b1-258">![Retry-delay algorithm](../media/dbm-retry-delay-algorithm.gif "Retry-delay algorithm")</span></span>  
  
##  <a name="reconnecting-to-a-database-mirroring-session"></a><a name="Reconnecting"></a> <span data-ttu-id="7d0b1-259">Erneutes Herstellen einer Verbindung mit einer Datenbank-Spiegelungssitzung</span><span class="sxs-lookup"><span data-stu-id="7d0b1-259">Reconnecting to a Database Mirroring Session</span></span>  
 <span data-ttu-id="7d0b1-260">Wenn eine bereits bestehende Verbindung mit einer Datenbank-Spiegelungssitzung aus irgendeinem Grund ausfällt, z. B. wegen eines Datenbank-Spiegelungsfailovers, und die Anwendung versucht, erneut eine Verbindung mit dem ersten Server herzustellen, kann der Datenzugriffsanbieter versuchen, die Verbindung mit dem im Clientcache enthaltenen Namen des Failoverpartners herzustellen.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-260">If an established connection to a database mirroring session fails for any reason, for example, due to a database mirroring failover, and the application attempts to reconnect to the initial server, the data access provider can attempt to reconnect using the failover partner name stored in the client's cache.</span></span> <span data-ttu-id="7d0b1-261">Die Verbindung wird jedoch nicht automatisch wiederhergestellt.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-261">Reconnecting is not automatic, however.</span></span> <span data-ttu-id="7d0b1-262">Die Anwendung muss über den Fehler informiert werden.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-262">The application must become aware of the error.</span></span> <span data-ttu-id="7d0b1-263">Anschließend muss die Anwendung die fehlgeschlagene Verbindung schließen und eine neue Verbindung mit den gleichen Attributen für die Verbindungszeichenfolge öffnen.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-263">Then, the application needs to close the failed connection and open a new connection using the same connection string attributes.</span></span> <span data-ttu-id="7d0b1-264">An diesem Punkt leitet der Datenzugriffsanbieter die Verbindung an den Failoverpartner um.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-264">At this point, the data access provider redirects the connection to the failover partner.</span></span> <span data-ttu-id="7d0b1-265">Wenn die durch diesen Namen identifizierte Serverinstanz aktuell als Prinzipalserver fungiert, ist der Verbindungsversuch im Allgemeinen erfolgreich.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-265">If the server instance identified by this name is currently the principal server, the connection attempt usually succeeds.</span></span> <span data-ttu-id="7d0b1-266">Wenn unklar ist, ob für eine Transaktion ein Commit oder ein Rollback ausgeführt wurde, muss die Anwendung wie bei einer erneuten Verbindung zu einer eigenständigen Serverinstanz den Status der Transaktion überprüfen.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-266">If it is unclear whether a transaction was committed or rolled back, the application must check on the state of the transaction, in the same way as when reconnecting to a stand-alone server instance.</span></span>  
  
 <span data-ttu-id="7d0b1-267">Das erneute Herstellen einer Verbindung ähnelt der ursprünglichen Verbindung, für die in der Verbindungszeichenfolge der Name eines Failoverpartners angegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-267">Reconnecting resembles an initial connection for which the connection string supplied a failover partner name.</span></span> <span data-ttu-id="7d0b1-268">Wenn der erste Verbindungsversuch nicht gelingt, werden abwechselnd mit dem Namen des ersten Partners und mit dem Namen des Failoverpartners weitere Verbindungsversuche unternommen, bis der Client entweder eine Verbindung mit dem Prinzipalserver herstellt oder beim Datenzugriffsanbieter ein Timeout auftritt.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-268">If the first connection attempt fails, connection attempts alternate back and forth between the initial partner name and failover partner name until either the client connects to the  principal server or the data access provider times out.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="7d0b1-269">Native Client überprüft zwar, ob die Verbindung zu einer Prinzipalserverinstanz hergestellt wird, aber nicht, ob diese Instanz der Partner der Serverinstanz ist, die im ersten Partnernamen der Verbindungszeichenfolge angegeben war.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-269">Native Client verifies that it connects to a principal server instance but not whether this instance is the partner of server instance specified in the initial partner name of the connection string.</span></span>  
  
 <span data-ttu-id="7d0b1-270">Wenn die Verbindungen TCP/IP verwenden, wird durch den Algorithmus für zu wiederholende Verbindungsversuche bestimmt, wie viel Zeit für die Verbindungsversuche in jeder Runde zur Verfügung steht.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-270">If the connections use TCP/IP, the connection retry algorithm determines the amount of time allotted to the connection attempts in each round.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="7d0b1-271">Wenn die Verbindung des Clients zur Datenbank getrennt wird, versucht der Datenzugriffsanbieter nicht, die Verbindung wiederherzustellen.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-271">If the client gets disconnected from the database, the data access provider does not attempt to reconnect.</span></span> <span data-ttu-id="7d0b1-272">Der Client muss eine neue Verbindungsanforderung ausgeben.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-272">The client must issue a new connection request.</span></span> <span data-ttu-id="7d0b1-273">Außerdem verliert eine Anwendung, falls sie nach dem Verlust der Verbindung herunterfährt, die im Cache enthaltenen Partnernamen.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-273">Also, if an application shuts down on losing the connection, it will lose the cached partner names.</span></span> <span data-ttu-id="7d0b1-274">Wurde die Verbindung getrennt, weil der Prinzipalserver nicht mehr verfügbar war, kann die Anwendung die Verbindung zum Spiegelserver nur noch herstellen, wenn in ihrer Verbindungszeichenfolge der Name des Failoverpartners angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-274">If the connection was lost because the principal server became unavailable, the only way that the application can reconnect to the mirror server is by supplying the failover partner name in its connection string.</span></span>  
  
  
### <a name="impact-of-redirection-on-a-client-application"></a><span data-ttu-id="7d0b1-275">Auswirkungen einer Umleitung auf eine Clientanwendung</span><span class="sxs-lookup"><span data-stu-id="7d0b1-275">Impact of Redirection on a Client Application</span></span>  
 <span data-ttu-id="7d0b1-276">Nach einem Failover leitet der Datenzugriffsanbieter die Verbindung an die aktuelle Prinzipalserverinstanz um.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-276">After a failover, the data access provider redirects the connection to the current principal server instance.</span></span> <span data-ttu-id="7d0b1-277">Die Umleitung ist für die Clients jedoch transparent.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-277">However, the redirection is transparent to clients.</span></span> <span data-ttu-id="7d0b1-278">Für einen Client stellt sich eine umgeleitete Verbindung wie eine Verbindung mit der durch den ersten Partnernamen identifizierten Serverinstanz dar.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-278">To a client, a redirected connection appears to be a connection to the server instance identified by the initial partner name.</span></span> <span data-ttu-id="7d0b1-279">Wenn der erste Partner zu diesem Zeitpunkt gerade als Spiegelserver fungiert, kann es so aussehen, als wäre der Client mit dem Spiegelserver verbunden und würde die Spiegeldatenbank aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-279">When the initial partner is currently the mirror server, the client can appear to be connected to the mirror server and updating the mirror database.</span></span> <span data-ttu-id="7d0b1-280">Tatsächlich wurde der Client jedoch an den Failoverpartner umgeleitet, bei dem es sich um die aktuelle Prinzipaldatenbank handelt, und der Client aktualisiert die neue Prinzipaldatenbank.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-280">Actually, however, the client has been redirected to the failover partner, which is the current principal database, and the client is updating the new principal database.</span></span>  
  
 <span data-ttu-id="7d0b1-281">Nach der Umleitung an den Failoverpartner erhält ein Client möglicherweise unerwartete Ergebnisse, wenn er mithilfe einer [!INCLUDE[tsql](../../includes/tsql-md.md)] USE-Anweisung eine andere Datenbank verwendet.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-281">After being redirected to the failover partner, a client can experience unexpected results when using a [!INCLUDE[tsql](../../includes/tsql-md.md)] USE statement to use a different database.</span></span> <span data-ttu-id="7d0b1-282">Dies kann der Fall sein, wenn die aktuelle Prinzipalserverinstanz (der Failoverpartner) über einen anderen Satz Datenbanken verfügt als der ursprüngliche Prinzipalserver (der erste Partner).</span><span class="sxs-lookup"><span data-stu-id="7d0b1-282">This can happen if the current principal server instance (the failover partner) has a different set of databases than the original principal server (the initial partner).</span></span>  
  
##  <a name="the-impact-of-a-stale-failover-partner-name"></a><a name="StalePartnerName"></a> <span data-ttu-id="7d0b1-283">Auswirkungen eines veralteten Failoverpartnernamens</span><span class="sxs-lookup"><span data-stu-id="7d0b1-283">The Impact of a Stale Failover Partner Name</span></span>  
 <span data-ttu-id="7d0b1-284">Der Failoverpartner kann vom Datenbankadministrator jederzeit geändert werden.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-284">The database administrator can change the failover partner at any time.</span></span> <span data-ttu-id="7d0b1-285">Deshalb kann es vorkommen, dass ein vom Client bereitgestellter Failoverpartnername nicht mehr auf dem neuesten Stand ist oder als *veraltet*betrachtet werden kann.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-285">Therefore, a client-supplied failover partner name might be out of date, or *stale*.</span></span> <span data-ttu-id="7d0b1-286">Angenommen, ein Failoverpartner namens Partner_B wird durch eine andere Serverinstanz, Partner_C, ersetzt.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-286">For example, consider a failover partner named Partner_B that is replaced by another server instance, Partner_C.</span></span> <span data-ttu-id="7d0b1-287">Stellt nun ein Client Partner_B als Failoverpartnernamen bereit, gilt dieser Name als veraltet.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-287">Now, if a client supplies Partner_B as the failover partner name, that name is stale.</span></span> <span data-ttu-id="7d0b1-288">Bei Bereitstellung eines veralteten Failoverpartnernamens durch den Client verhält sich der Datenzugriffsanbieter genau so, als wäre durch den Client überhaupt kein Failoverpartnername bereitgestellt worden.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-288">When the client-supplied failover partner name is stale, the behavior of the data access provider equates to the case in which a failover partner name is not supplied by the client.</span></span>  
  
 <span data-ttu-id="7d0b1-289">Im folgenden Beispiel verwendet ein Client eine Verbindungszeichenfolge für vier aufeinander folgende Verbindungsversuche.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-289">For example, consider situation in which a client uses one connection string for a series of four connection attempts.</span></span> <span data-ttu-id="7d0b1-290">Dabei wird in der Verbindungszeichenfolge als erster Partnername Partner_A und als Failoverpartnername Partner_B angegeben:</span><span class="sxs-lookup"><span data-stu-id="7d0b1-290">In the connection string, the initial partner name is Partner_A, and the failover partner name is Partner_B:</span></span>  
  
```  
"Server=Partner_A; Failover Partner=Partner_B; Database=AdventureWorks"  
```  
  
 <span data-ttu-id="7d0b1-291">In der folgenden Tabelle sind vier Partnerkonfigurationen aufgelistet, für die angegeben wird, ob die Verbindungszeichenfolge beim ersten Verbindungsaufbau des Clients funktionsfähig ist.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-291">The following table shows four partner configurations and indicates for each whether this connection string works for connecting the client for the first time.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7d0b1-292">Eine Anwendung kann Konfigurationsänderungen nachverfolgen und die Verbindungszeichenfolge entsprechend ändern.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-292">An application can track configuration changes and change its connection string accordingly.</span></span> <span data-ttu-id="7d0b1-293">Dafür ist zusätzlicher Code erforderlich, doch sinkt der Verwaltungsaufwand.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-293">This requires extra code but reduces the administrative burden.</span></span>  
  
|<span data-ttu-id="7d0b1-294">Konfiguration</span><span class="sxs-lookup"><span data-stu-id="7d0b1-294">Configuration</span></span>|<span data-ttu-id="7d0b1-295">Prinzipalserver</span><span class="sxs-lookup"><span data-stu-id="7d0b1-295">Principal server</span></span>|<span data-ttu-id="7d0b1-296">Spiegelserver</span><span class="sxs-lookup"><span data-stu-id="7d0b1-296">Mirror server</span></span>|<span data-ttu-id="7d0b1-297">Verhalten beim Versuch, eine Verbindung unter Angabe von Partner_A und Partner_B herzustellen</span><span class="sxs-lookup"><span data-stu-id="7d0b1-297">Behavior when attempting to connect specifying Partner_A and Partner_B</span></span>|  
|-------------------|----------------------|-------------------|------------------------------------------------------------------------------|  
|<span data-ttu-id="7d0b1-298">Ursprüngliche Spiegelungskonfiguration.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-298">Original mirroring configuration.</span></span>|<span data-ttu-id="7d0b1-299">Partner_A</span><span class="sxs-lookup"><span data-stu-id="7d0b1-299">Partner_A</span></span>|<span data-ttu-id="7d0b1-300">Partner_B</span><span class="sxs-lookup"><span data-stu-id="7d0b1-300">Partner_B</span></span>|<span data-ttu-id="7d0b1-301">Partner_A wird im Cache als erster Partnername zwischengespeichert.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-301">Partner_A is cached as the initial partner name.</span></span> <span data-ttu-id="7d0b1-302">Der Client hat damit erfolgreich eine Verbindung mit Partner_A hergestellt.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-302">The client succeeds in connecting to Partner_A.</span></span> <span data-ttu-id="7d0b1-303">Der Name des Spiegelservers Partner_B wird vom Client heruntergeladen und zwischengespeichert, d. h. der vom Client bereitgestellte Failoverpartnername wird ignoriert.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-303">The client downloads the name of mirror server, Partner_B, and caches it, ignoring the client-supplied failover partner name.</span></span>|  
|<span data-ttu-id="7d0b1-304">Bei Partner_A kommt es aufgrund eines Hardwarefehlers zu einem Failover (Clientverbindungen werden getrennt).</span><span class="sxs-lookup"><span data-stu-id="7d0b1-304">Partner_A experiences a hardware failure, and failover occurs (disconnecting clients).</span></span>|<span data-ttu-id="7d0b1-305">Partner_B</span><span class="sxs-lookup"><span data-stu-id="7d0b1-305">Partner_B</span></span>|<span data-ttu-id="7d0b1-306">none</span><span class="sxs-lookup"><span data-stu-id="7d0b1-306">none</span></span>|<span data-ttu-id="7d0b1-307">Partner_A ist weiterhin als erster Partnername zwischengespeichert. Da vom Client jedoch Partner_B als Failoverpartnername bereitgestellt wird, kann der Client die Verbindung zum aktuellen Prinzipalserver herstellen.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-307">The Partner_A is still cached as the initial partner name, but the client-supplied failover partner name, Partner_B, permits the client to connect to the current principal server.</span></span>|  
|<span data-ttu-id="7d0b1-308">Der Datenbankadministrator beendet die Spiegelung (Trennen der Clientverbindungen), ersetzt Partner_A durch Partner_C und startet die Spiegelung dann erneut.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-308">The database administrator stops mirroring (disconnecting clients), replaces Partner_A with Partner_C, and restarts mirroring.</span></span>|<span data-ttu-id="7d0b1-309">Partner_B</span><span class="sxs-lookup"><span data-stu-id="7d0b1-309">Partner_B</span></span>|<span data-ttu-id="7d0b1-310">Partner_C</span><span class="sxs-lookup"><span data-stu-id="7d0b1-310">Partner_C</span></span>|<span data-ttu-id="7d0b1-311">Der Versuch des Clients, eine Verbindung mit Partner_A herzustellen, schlägt fehl. Der daraufhin unternommene Verbindungsversuch des Clients mit Partner_B (dem aktuellen Prinzipalserver) verläuft jedoch erfolgreich.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-311">The client attempts to connect to Partner_A and fails; then the client tries Partner_B (the current principal server) and succeeds.</span></span> <span data-ttu-id="7d0b1-312">Der Name des aktuellen Spiegelservers, Partner_C, wird vom Datenzugriffsanbieter heruntergeladen und als aktueller Failoverpartnername zwischengespeichert.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-312">The data access provider downloads the name of the current mirror server, Partner_C, and caches it as the current failover partner name.</span></span>|  
|<span data-ttu-id="7d0b1-313">Für den Dienst wird ein manuelles Failover zu Partner_C ausgeführt (Trennung der Clientverbindungen).</span><span class="sxs-lookup"><span data-stu-id="7d0b1-313">Service is manually failed over to Partner_C (disconnecting clients).</span></span>|<span data-ttu-id="7d0b1-314">Partner_C</span><span class="sxs-lookup"><span data-stu-id="7d0b1-314">Partner_C</span></span>|<span data-ttu-id="7d0b1-315">Partner_B</span><span class="sxs-lookup"><span data-stu-id="7d0b1-315">Partner_B</span></span>|<span data-ttu-id="7d0b1-316">Client versucht, anfänglich eine Verbindung mit Partner_A herzustellen und dann mit Partner_B.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-316">Client attempts to connect to Partner_A initially, and then to Partner_B.</span></span> <span data-ttu-id="7d0b1-317">Beide Namen schlagen fehl, und schließlich wird das Timeout der Verbindungsanforderung erreicht, und die Anforderung schlägt fehl.</span><span class="sxs-lookup"><span data-stu-id="7d0b1-317">Both names fail, and eventually the connection request times out and fails.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="7d0b1-318">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="7d0b1-318">See Also</span></span>  
 <span data-ttu-id="7d0b1-319">[Datenbankspiegelung &#40;SQL Server&#41;](database-mirroring-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="7d0b1-319">[Database Mirroring &#40;SQL Server&#41;](database-mirroring-sql-server.md) </span></span>  
 [<span data-ttu-id="7d0b1-320">Mögliche Fehler während der Datenbankspiegelung</span><span class="sxs-lookup"><span data-stu-id="7d0b1-320">Possible Failures During Database Mirroring</span></span>](possible-failures-during-database-mirroring.md)  
  
  

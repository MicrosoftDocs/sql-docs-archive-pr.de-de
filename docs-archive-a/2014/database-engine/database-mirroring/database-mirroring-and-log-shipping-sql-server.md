---
title: Datenbankspiegelung und Protokollversand (SQL Server) | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- database mirroring [SQL Server], interoperability
- log shipping [SQL Server], database mirroring
ms.assetid: 53e98134-e274-4dfd-8b72-0cc0fd5c800e
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: fe11f4244eff98923a6f4ee291caca9c094237f4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87615569"
---
# <a name="database-mirroring-and-log-shipping-sql-server"></a><span data-ttu-id="6b31b-102">Datenbankspiegelung und Protokollversand (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="6b31b-102">Database Mirroring and Log Shipping (SQL Server)</span></span>
  <span data-ttu-id="6b31b-103">Für eine Datenbank kann eine Datenbankspiegelung oder ein Protokollversand ausgeführt werden. Datenbankspiegelung und Protokollversand können auch gleichzeitig ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="6b31b-103">A given database can be mirrored or log shipped; it can also be simultaneously mirrored and log shipped.</span></span> <span data-ttu-id="6b31b-104">Bei der Entscheidung für eine Methode sollten Sie Folgendes berücksichtigen:</span><span class="sxs-lookup"><span data-stu-id="6b31b-104">To choose what approach to use, consider the following:</span></span>  
  
-   <span data-ttu-id="6b31b-105">Wie viele Zielserver benötigen Sie?</span><span class="sxs-lookup"><span data-stu-id="6b31b-105">How many destination servers do you require?</span></span>  
  
     <span data-ttu-id="6b31b-106">Falls Sie nur eine einzige Zieldatenbank benötigen, ist die Datenbankspiegelung die empfohlene Lösung.</span><span class="sxs-lookup"><span data-stu-id="6b31b-106">If you require only a single destination database, database mirroring is the recommended solution.</span></span>  
  
     <span data-ttu-id="6b31b-107">Falls Sie mehrere Zieldatenbanken benötigen, müssen Sie den Protokollversand verwenden, und zwar entweder alleine oder zusammen mit der Datenbankspiegelung.</span><span class="sxs-lookup"><span data-stu-id="6b31b-107">If you require more than one destination database, you need to use log shipping, either alone or with database mirroring.</span></span> <span data-ttu-id="6b31b-108">Durch die Kombination dieser Vorgehensweise profitieren Sie von den Vorteilen der Datenbankspiegelung sowie der Unterstützung mehrerer Ziele mithilfe des Protokollversands.</span><span class="sxs-lookup"><span data-stu-id="6b31b-108">Combining these approaches gives you the benefits of database mirroring along with the support for multiple destinations provided by log shipping.</span></span>  
  
-   <span data-ttu-id="6b31b-109">Falls Sie das Wiederherstellen von Protokollen für die Zieldatenbank verzögern müssen (um in der Regel Schutz vor logischen Fehlern zu bieten), verwenden Sie den Protokollversand, und zwar entweder alleine oder zusammen mit der Datenbankspiegelung.</span><span class="sxs-lookup"><span data-stu-id="6b31b-109">If you need to delay restoring log on the destination database (typically, to protect against logical errors), use log shipping, alone or with database mirroring.</span></span>  
  
 <span data-ttu-id="6b31b-110">In diesem Thema werden Aspekte für das Kombinieren des Protokollversands und der Datenbankspiegelung behandelt.</span><span class="sxs-lookup"><span data-stu-id="6b31b-110">This topic discusses considerations for combining log shipping and database mirroring.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6b31b-111">Einführungen zu diesen Technologien finden Sie unter [Datenbankspiegelung &#40;SQL Server&#41;](database-mirroring-sql-server.md) und [Informationen zum Protokollversand &#40;SQL Server&#41;](../log-shipping/about-log-shipping-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="6b31b-111">For introductions to these technologies, see [Database Mirroring &#40;SQL Server&#41;](database-mirroring-sql-server.md) and [About Log Shipping &#40;SQL Server&#41;](../log-shipping/about-log-shipping-sql-server.md).</span></span>  
  
## <a name="combining-log-shipping-and-database-mirroring"></a><span data-ttu-id="6b31b-112">Kombinieren von Protokollversand und Datenbankspiegelung</span><span class="sxs-lookup"><span data-stu-id="6b31b-112">Combining Log Shipping and Database Mirroring</span></span>  
 <span data-ttu-id="6b31b-113">Die Prinzipaldatenbank in einer Spiegelungssitzung kann auch als primäre Datenbank bei der Protokollversandkonfiguration dienen, oder umgekehrt, da die Sicherungsfreigabe für den Protokollversand intakt ist.</span><span class="sxs-lookup"><span data-stu-id="6b31b-113">The principal database in a mirroring session can also act as the primary database in a log shipping configuration, or vice versa, as the log shipping backup share is intact.</span></span> <span data-ttu-id="6b31b-114">Die Datenbank-Spiegelungssitzung wird in einem beliebigen Betriebsmodus ausgeführt, egal ob synchron (mit der Transaktionssicherheit festgelegt auf FULL) oder asynchron (mit der Transaktionssicherheit festgelegt auf OFF).</span><span class="sxs-lookup"><span data-stu-id="6b31b-114">The database mirroring session run in any operating mode, whether synchronous (with transaction safety set to FULL) or asynchronous (with transaction safety set to OFF).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6b31b-115">Um die Datenbankspiegelung auf einer Datenbank zu verwenden, ist immer das vollständige Wiederherstellungsmodell erforderlich.</span><span class="sxs-lookup"><span data-stu-id="6b31b-115">To use database mirroring on a database, the full recovery model is always required.</span></span>  
  
 <span data-ttu-id="6b31b-116">Wenn der Protokollversand und die Datenbankspiegelung kombiniert wird, wird in der Regel die Spiegelungssitzung vor dem Protokollversand eingerichtet, obwohl dies nicht erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="6b31b-116">Typically, when combining log shipping and database mirroring, the mirroring session is established before log shipping, although this is not required.</span></span> <span data-ttu-id="6b31b-117">Anschließend wird die aktuelle Prinzipaldatenbank als primäre Datenbank für den Protokollversand konfiguriert (die *Prinzipaldatenbank oder primäre Datenbank*), zusammen mit mindestens einer sekundären Remotedatenbank.</span><span class="sxs-lookup"><span data-stu-id="6b31b-117">Then the current principal database is configured as the log shipping primary (the *principal/primary database*), along with one or more remote secondary databases.</span></span> <span data-ttu-id="6b31b-118">Außerdem muss die Spiegeldatenbank als primäre Datenbank für den Protokollversand konfiguriert werden (die *Spiegeldatenbank oder primäre Datenbank*).</span><span class="sxs-lookup"><span data-stu-id="6b31b-118">Also, the mirror database must be configured as a log shipping primary (the *mirror/primary database*).</span></span> <span data-ttu-id="6b31b-119">Die sekundären Datenbanken für den Protokollversand sollten auf anderen Serverinstanzen als der Prinzipalserver bzw. der primäre Server oder der Spiegelserver bzw. der primäre Server gespeichert sein.</span><span class="sxs-lookup"><span data-stu-id="6b31b-119">The log shipping secondary databases should be on different server instances than either the principal/primary server or mirror/primary server.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6b31b-120">Die Einstellungen für die Unterscheidung nach Groß-/Kleinschreibung der am Protokollversand beteiligten Server sollten übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="6b31b-120">The case sensitivity settings of the servers involved in log shipping should match.</span></span>  
  
 <span data-ttu-id="6b31b-121">Während einer Protokollversandsitzung erstellen Sicherungsaufträge in der primären Datenbank Protokollsicherungen in einem Sicherungsordner.</span><span class="sxs-lookup"><span data-stu-id="6b31b-121">During a log shipping session, backup jobs on the primary database create log backups in a backup folder.</span></span> <span data-ttu-id="6b31b-122">Von dort werden die Sicherungen von den Kopieraufträgen der sekundären Server kopiert.</span><span class="sxs-lookup"><span data-stu-id="6b31b-122">From there, the backups are copied by the copy jobs of the secondary servers.</span></span> <span data-ttu-id="6b31b-123">Damit die Sicherungs- und Kopieraufträge erfolgreich ausgeführt werden, benötigen sie Zugriff auf den Sicherungsordner des Protokollversands.</span><span class="sxs-lookup"><span data-stu-id="6b31b-123">For the backup jobs and copy jobs to succeed, they must have access to the log shipping backup folder.</span></span> <span data-ttu-id="6b31b-124">Zur Optimierung der Verfügbarkeit des primären Servers empfiehlt es sich, den Sicherungsordner in einem freigegebenen Sicherungsspeicherort auf einem separaten Hostcomputer anzulegen.</span><span class="sxs-lookup"><span data-stu-id="6b31b-124">To maximize availability of the primary server, we recommend that you establish the backup folder in a shared backup location on a separate host computer.</span></span> <span data-ttu-id="6b31b-125">Stellen Sie sicher, dass alle Protokollversandserver, einschließlich des Spiegelservers bzw. des primären Servers, Zugriff auf den freigegebenen Sicherungsspeicherort haben (wird als *Sicherungsfreigabe*bezeichnet).</span><span class="sxs-lookup"><span data-stu-id="6b31b-125">Ensure that all the log shipping servers, including the mirror/primary server, can access the shared backup location (known as a *backup share*).</span></span>  
  
 <span data-ttu-id="6b31b-126">Damit der Protokollversand nach einem Failover der Datenbankspiegelung fortgesetzt wird, müssen Sie auch den Spiegelserver als primären Server konfigurieren. Verwenden Sie dabei die gleiche Konfiguration wie für den primären Server in der Prinzipaldatenbank.</span><span class="sxs-lookup"><span data-stu-id="6b31b-126">To allow log shipping to continue after database mirroring fails over, you must also configure the mirror server as a primary server, using the same configuration you use for the primary on the principal database.</span></span> <span data-ttu-id="6b31b-127">Die Spiegeldatenbank befindet sich im Wiederherstellungsstatus, wodurch die Sicherungsaufträge am Wiederherstellen des Protokolls in der Spiegeldatenbank gehindert werden.</span><span class="sxs-lookup"><span data-stu-id="6b31b-127">The mirror database is in the restoring state, which prevents the backup jobs from backing up the log on the mirror database.</span></span> <span data-ttu-id="6b31b-128">Dadurch wird sichergestellt, dass die Spiegeldatenbank bzw. primäre Datenbank die Prinzipaldatenbank bzw. primäre Datenbank nicht beeinträchtigt, deren Protokollsicherungen aktuell von sekundären Servern kopiert werden.</span><span class="sxs-lookup"><span data-stu-id="6b31b-128">This ensures that the mirror/primary database does not interfere with the principal/primary database whose log backups are currently being copied by secondary servers.</span></span> <span data-ttu-id="6b31b-129">Nach der Ausführung des Sicherungsauftrags für die Spiegeldatenbank bzw. primäre Datenbank protokolliert der Sicherungsauftrag eine Meldung in der**log_shipping_monitor_history_detail** -Tabelle, und der Agentauftrag gibt einen Erfolgsstatus zurück. Dadurch sollen unbegründete Warnungen vermieden werden.</span><span class="sxs-lookup"><span data-stu-id="6b31b-129">To prevent spurious alerts, after the backup job executes on the mirror/primary database, the backup job logs a message to the l**og_shipping_monitor_history_detail** table, and the agent job returns a status of success.</span></span>  
  
 <span data-ttu-id="6b31b-130">Die Spiegeldatenbank bzw. primäre Datenbank ist in der Protokollversandsitzung inaktiv.</span><span class="sxs-lookup"><span data-stu-id="6b31b-130">The mirror/primary database is inactive in the log shipping session.</span></span> <span data-ttu-id="6b31b-131">Bei einem Failover der Spiegelung wird die ehemalige Spiegeldatenbank als Prinzipaldatenbank online geschaltet.</span><span class="sxs-lookup"><span data-stu-id="6b31b-131">However, if mirroring fails over, the former mirror database comes online as the principal database.</span></span> <span data-ttu-id="6b31b-132">Nun wird diese Datenbank auch als primäre Datenbank für den Protokollversand aktiviert.</span><span class="sxs-lookup"><span data-stu-id="6b31b-132">At that point, that database also becomes active as the log shipping primary database.</span></span> <span data-ttu-id="6b31b-133">Die Sicherungsaufträge für den Protokollversand, die zuvor keinen Protokollversand für diese Datenbank ausführen konnten, starten den Protokollversand.</span><span class="sxs-lookup"><span data-stu-id="6b31b-133">The log shipping backup jobs that were previously unable to ship log on that database, begin shipping log.</span></span> <span data-ttu-id="6b31b-134">Dagegen wird durch ein Failover die ehemalige Prinzipaldatenbank bzw. die primäre Datenbank zur neuen Spiegeldatenbank bzw. primären Datenbank und sie erhalten den Wiederherstellungsstatus. Für Sicherungsaufträge in dieser Datenbank wird dann keine Protokollsicherung mehr ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="6b31b-134">Conversely, a failover causes the former principal/primary database to become the new mirror/primary database and enter the restoring state, and backup jobs on that database cease to backup log.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6b31b-135">Bei einem automatischen Failover erfolgt der Wechsel zur Spiegelrolle, wenn die ehemalige Prinzipaldatenbank bzw. primäre Datenbank wieder an der Spiegelungssitzung teilnimmt.</span><span class="sxs-lookup"><span data-stu-id="6b31b-135">In the event of an automatic failover, the switch to the mirror role occurs when the former principal/primary database rejoins the mirroring session.</span></span>  
  
 <span data-ttu-id="6b31b-136">Zur Ausführung in einem Modus für hohe Sicherheit mit automatischem Failover wird die Datenbankspiegelungssitzung mit einer zusätzlichen Serverinstanz konfiguriert, die als *Zeuge*bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="6b31b-136">To run in high-safety mode with automatic failover the mirroring session is configured with an additional server instance known as the *witness*.</span></span> <span data-ttu-id="6b31b-137">Falls die Prinzipaldatenbank aus irgendeinem Grund verloren geht, nachdem die Datenbank synchronisiert wurde, und falls der Spiegelserver und der Zeuge noch miteinander kommunizieren können, wird ein automatisches Failover ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="6b31b-137">If the principal database is lost for any reason after the database is synchronized and if the mirror server and witness can still communicate with each other, automatic failover occurs.</span></span> <span data-ttu-id="6b31b-138">Durch ein automatisches Failover übernimmt der Spiegelserver die Prinzipalrolle und die Datenbank wird als Prinzipaldatenbank online geschaltet.</span><span class="sxs-lookup"><span data-stu-id="6b31b-138">An automatic failover causes mirror server to assume the principal role and bring its database online as the principal database.</span></span> <span data-ttu-id="6b31b-139">Falls der Sicherungsspeicherort für den Protokollversand für den neuen Prinzipalserver bzw. primären Server zugänglich ist, werden von dessen Sicherungsaufträgen Protokollsicherungen an diesen Speicherort gesendet.</span><span class="sxs-lookup"><span data-stu-id="6b31b-139">If the log shipping backup location is accessible to the new principal/primary server, its backup jobs begin to ship log backups to that location.</span></span> <span data-ttu-id="6b31b-140">Mit dem synchronen Modus der Datenbankspiegelung wird sichergestellt, dass die Protokollkette nicht von einem Spiegelungsfailover betroffen ist und dass nur ein gültiges Protokoll wiederhergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="6b31b-140">The database mirroring synchronous mode guarantees that the log chain is unaffected by a mirroring failover and that only valid log is restored.</span></span> <span data-ttu-id="6b31b-141">Die sekundären Server kopieren weiterhin Protokollsicherung, ohne zu wissen, dass eine andere Serverinstanz nun der primäre Server ist.</span><span class="sxs-lookup"><span data-stu-id="6b31b-141">The secondary servers continue to copy log backups without knowing that a different server instance has become the primary server.</span></span>  
  
 <span data-ttu-id="6b31b-142">Wenn Sie eine lokale Protokollversandüberwachung verwenden, müssen für dieses Szenario keine besonderen Aspekte beachtet werden.</span><span class="sxs-lookup"><span data-stu-id="6b31b-142">When using a local log shipping monitor, no special considerations are necessary to accommodate this scenario.</span></span> <span data-ttu-id="6b31b-143">Informationen zum Verwenden einer Remoteüberwachungsinstanz für dieses Szenario finden Sie weiter unten im Abschnitt "Auswirkungen der Datenbankspiegelung auf eine Remoteüberwachungsinstanz".</span><span class="sxs-lookup"><span data-stu-id="6b31b-143">For information about using a remote monitoring instance with this scenario, see, "The Impact of Database Mirroring on a Remote Monitoring Instance," later in this topic.</span></span>  
  
## <a name="failing-over-from-the-principal-to-the-mirror-database"></a><span data-ttu-id="6b31b-144">Failover von der Prinzipaldatenbank zur Spiegeldatenbank</span><span class="sxs-lookup"><span data-stu-id="6b31b-144">Failing over from the Principal to the Mirror database</span></span>  
 <span data-ttu-id="6b31b-145">Die folgende Abbildung veranschaulicht die Interaktion von Protokollversand und Datenbankspiegelung, wenn die Spiegelung im Modus für hohe Sicherheit mit automatischem Failover ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="6b31b-145">The following figure shows how log shipping and database mirroring work together when mirroring is running in high-safety mode with automatic failover.</span></span> <span data-ttu-id="6b31b-146">Zunächst ist **Server_A** sowohl der Prinzipalserver für die Spiegelung als auch der primäre Server für den Protokollversand.</span><span class="sxs-lookup"><span data-stu-id="6b31b-146">Initially, **Server_A** is both the principal server for mirroring and the primary server for log shipping.</span></span> <span data-ttu-id="6b31b-147">**Server_B** ist der Spiegelserver und ist auch als primärer Server konfiguriert, der derzeit inaktiv ist.</span><span class="sxs-lookup"><span data-stu-id="6b31b-147">**Server_B** is the mirror server and is also configured as a primary server, which is currently inactive.</span></span> <span data-ttu-id="6b31b-148">**Server_C** und **Server_D** sind sekundäre Protokollversandserver.</span><span class="sxs-lookup"><span data-stu-id="6b31b-148">**Server_C** and **Server_D** are log shipping secondary servers.</span></span> <span data-ttu-id="6b31b-149">Zur Optimierung der Verfügbarkeit der Protokollversandsitzung befindet sich der Sicherungsspeicherort in einem Freigabeverzeichnis auf einem separaten Hostcomputer.</span><span class="sxs-lookup"><span data-stu-id="6b31b-149">To maximize availability of the log shipping session, the backup location is on a share directory on a separate host computer.</span></span>  
  
 <span data-ttu-id="6b31b-150">![Protokollversand und Datenbankspiegelung](../media/logshipping-and-dbm-automatic-failover.gif "Protokollversand und Datenbankspiegelung")</span><span class="sxs-lookup"><span data-stu-id="6b31b-150">![Log shipping and database mirroring](../media/logshipping-and-dbm-automatic-failover.gif "Log shipping and database mirroring")</span></span>  
  
 <span data-ttu-id="6b31b-151">Nach einem Spiegelungsfailover ist der auf dem sekundären Server definierte Name des primären Servers unverändert.</span><span class="sxs-lookup"><span data-stu-id="6b31b-151">After a mirroring failover, the primary server name defined on the secondary server is unchanged.</span></span> <span data-ttu-id="6b31b-152">.</span><span class="sxs-lookup"><span data-stu-id="6b31b-152">.</span></span>  
  
## <a name="the-impact-of-database-mirroring-on-a-remote-monitoring-instance"></a><span data-ttu-id="6b31b-153">Auswirkungen der Datenbankspiegelung auf eine Remoteüberwachungsinstanz</span><span class="sxs-lookup"><span data-stu-id="6b31b-153">The Impact of Database Mirroring on a Remote Monitoring Instance</span></span>  
 <span data-ttu-id="6b31b-154">Wenn der Protokollversand mit einer Remoteüberwachungsinstanz verwendet wird, hat das Kombinieren der Protokollversandsitzung und der Datenbankspiegelung Auswirkungen auf die Informationen in den Überwachungstabellen.</span><span class="sxs-lookup"><span data-stu-id="6b31b-154">When log shipping uses with a remote monitoring instance, combining the log shipping session and database mirroring affects the information in the monitor tables.</span></span> <span data-ttu-id="6b31b-155">Die Informationen zum primären Server sind eine Kombination der Informationen, die auf dem Prinzipalserver bzw. primären Server konfiguriert sind, und der auf jedem sekundären Server konfigurierten Überwachung.</span><span class="sxs-lookup"><span data-stu-id="6b31b-155">The information about the primary is a combination of the one configured at the principal/primary and the monitor configured on each secondary.</span></span>  
  
 <span data-ttu-id="6b31b-156">Für eine möglichst nahtlose Überwachung sollten Sie bei Verwendung der Remoteüberwachung den ursprünglichen primären Namen angeben, wenn Sie den primären Server auf dem sekundären Server konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="6b31b-156">To keep monitoring as seamless as possible, when you use a remote monitor, we recommend that you specify the original primary name when configuring the primary at the secondary.</span></span> <span data-ttu-id="6b31b-157">Diese Vorgehensweise erleichtert außerdem das Ändern der Protokollversandkonfiguration des Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-Agents.</span><span class="sxs-lookup"><span data-stu-id="6b31b-157">This approach also facilitates changing the log shipping configuration from Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span></span> <span data-ttu-id="6b31b-158">Weitere Informationen zur Überwachung finden Sie unter [Überwachen des Protokollversands &#40;Transact-SQL&#41;](../log-shipping/monitor-log-shipping-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="6b31b-158">For more information about monitoring, see [Monitor Log Shipping &#40;Transact-SQL&#41;](../log-shipping/monitor-log-shipping-transact-sql.md).</span></span>  
  
## <a name="setting-up-mirroring-and-log-shipping-together"></a><span data-ttu-id="6b31b-159">Einrichten der Kombination aus Spiegelung und Protokollversand</span><span class="sxs-lookup"><span data-stu-id="6b31b-159">Setting Up Mirroring and Log Shipping Together</span></span>  
 <span data-ttu-id="6b31b-160">Um die Datenbankspiegelung und den Protokollversand gemeinsam einzurichten, sind die folgenden Schritte erforderlich:</span><span class="sxs-lookup"><span data-stu-id="6b31b-160">To set up database mirroring and log shipping together, the following steps are required:</span></span>  
  
1.  <span data-ttu-id="6b31b-161">Stellen Sie Sicherungen der Prinzipaldatenbank bzw. primären Datenbank mit der Option NORECOVERY auf einer anderen Serverinstanz wieder her, die dann später von der Datenbankspiegelung als Spiegeldatenbank für die Prinzipaldatenbank bzw. primäre Datenbank verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="6b31b-161">Restore backups of the principal/primary database with NORECOVERY onto another server instance to be later used as database mirroring mirror database for the principal/primary database.</span></span> <span data-ttu-id="6b31b-162">Weitere Informationen finden Sie unter [Vorbereiten einer Spiegeldatenbank auf die Spiegelung &#40;SQL Server&#41;](prepare-a-mirror-database-for-mirroring-sql-server.md)verwendet.</span><span class="sxs-lookup"><span data-stu-id="6b31b-162">For more information, see [Prepare a Mirror Database for Mirroring &#40;SQL Server&#41;](prepare-a-mirror-database-for-mirroring-sql-server.md).</span></span>  
  
2.  <span data-ttu-id="6b31b-163">Einrichten der Datenbankspiegelung</span><span class="sxs-lookup"><span data-stu-id="6b31b-163">Set up database mirroring.</span></span> <span data-ttu-id="6b31b-164">Weitere Informationen finden Sie unter [Einrichten einer Datenbank-Spiegelungssitzung mithilfe der Windows-Authentifizierung &#40;SQL Server Management Studio&#41;](establish-database-mirroring-session-windows-authentication.md) oder [Einrichten der Datenbankspiegelung &#40;SQL Server&#41;](setting-up-database-mirroring-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="6b31b-164">For more information, see [Establish a Database Mirroring Session Using Windows Authentication &#40;SQL Server Management Studio&#41;](establish-database-mirroring-session-windows-authentication.md) or [Setting Up Database Mirroring &#40;SQL Server&#41;](setting-up-database-mirroring-sql-server.md).</span></span>  
  
3.  <span data-ttu-id="6b31b-165">Stellen Sie Sicherungen der Prinzipaldatenbank bzw. primären Datenbank auf anderen Serverinstanzen wieder her, die dann später als sekundäre Datenbanken für den Protokollversand für die primäre Datenbank verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="6b31b-165">Restore backups of the principal/primary database to other server instances to be later used as log shipping secondary databases for the primary database.</span></span>  
  
4.  <span data-ttu-id="6b31b-166">Richten Sie den Protokollversand auf der Prinzipaldatenbank als primäre Datenbank für mindestens eine sekundäre Datenbank ein.</span><span class="sxs-lookup"><span data-stu-id="6b31b-166">Set up log shipping on the principal database as the primary database for one or more secondary databases.</span></span>  
  
     <span data-ttu-id="6b31b-167">Sie sollten eine einzige Freigabe als Sicherungsverzeichnis (Sicherungsfreigabe) einrichten.</span><span class="sxs-lookup"><span data-stu-id="6b31b-167">You should set up a single share as the backup directory (a backup share).</span></span> <span data-ttu-id="6b31b-168">Dadurch ist sichergestellt, dass nach dem Rollenwechsel zwischen dem Prinzipalserver und dem Spiegelserver Sicherungsaufträge weiterhin in dasselbe Verzeichnis wie zuvor schreiben.</span><span class="sxs-lookup"><span data-stu-id="6b31b-168">This ensures that after role switching between the principal and mirror servers, backup jobs continue to write to the same directory as before.</span></span> <span data-ttu-id="6b31b-169">Eine bewährte Methode besteht darin, sicherzustellen, dass sich diese Freigabe auf einem anderen physischen Server befindet als die Server, auf denen die Datenbanken für die Spiegelung und den Protokollversand bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="6b31b-169">A best practice is to ensure that this share is located on a different physical server from the servers hosting the databases involved in mirroring and log shipping.</span></span>  
  
     <span data-ttu-id="6b31b-170">Weitere Informationen finden Sie unter [Konfigurieren des Protokollversands &#40;SQL Server&#41;](../log-shipping/configure-log-shipping-sql-server.md)eingeführt.</span><span class="sxs-lookup"><span data-stu-id="6b31b-170">For more information, see [Configure Log Shipping &#40;SQL Server&#41;](../log-shipping/configure-log-shipping-sql-server.md).</span></span>  
  
5.  <span data-ttu-id="6b31b-171">Manuelles Failover vom Prinzipal zum Spiegel.</span><span class="sxs-lookup"><span data-stu-id="6b31b-171">Manually failover from the principal to the mirror.</span></span>  
  
     <span data-ttu-id="6b31b-172">So führen Sie ein manuelles Failover aus:</span><span class="sxs-lookup"><span data-stu-id="6b31b-172">To perform a manual failover:</span></span>  
  
    -   [<span data-ttu-id="6b31b-173">Manueller Failover für eine Datenbank-Spiegelungssitzung &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="6b31b-173">Manually Fail Over a Database Mirroring Session &#40;SQL Server Management Studio&#41;</span></span>](manually-fail-over-a-database-mirroring-session-sql-server-management-studio.md)  
  
    -   [<span data-ttu-id="6b31b-174">Ausführen des manuellen Failovers einer Datenbank-Spiegelungssitzung &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="6b31b-174">Manually Fail Over a Database Mirroring Session &#40;Transact-SQL&#41;</span></span>](manually-fail-over-a-database-mirroring-session-transact-sql.md)  
  
6.  <span data-ttu-id="6b31b-175">Richten Sie den Protokollversand für den neuen Prinzipal (zuvor die Spiegelung) als primäre Datenbank ein.</span><span class="sxs-lookup"><span data-stu-id="6b31b-175">Set up log shipping on the new principal (previously mirror) as the primary database.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="6b31b-176">Führen Sie kein Setup von einer sekundären Datenbank aus.</span><span class="sxs-lookup"><span data-stu-id="6b31b-176">Do not perform any setup from a secondary.</span></span>  
  
     <span data-ttu-id="6b31b-177">Sie müssen die gleiche Sicherungsfreigabe verwenden, die Sie in Schritt 4 verwendet haben.</span><span class="sxs-lookup"><span data-stu-id="6b31b-177">You must use the same backup share that you used in step 4.</span></span>  
  
     <span data-ttu-id="6b31b-178">Die Schnittstelle für den **Transaktionsprotokollversand** in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] unterstützt nur eine einzige primäre Datenbank pro Protokollversandkonfiguration.</span><span class="sxs-lookup"><span data-stu-id="6b31b-178">The **Transaction Log Shipping** interface in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] supports only one primary database per log shipping configuration.</span></span> <span data-ttu-id="6b31b-179">Deshalb müssen Sie gespeicherte Prozeduren zum Einrichten des neuen Prinzipals als primären Server verwenden.</span><span class="sxs-lookup"><span data-stu-id="6b31b-179">Therefore, you must use stored procedures to set up the new principal as primary.</span></span>  
  
7.  <span data-ttu-id="6b31b-180">Führen Sie ein weiteres manuelles Failover durch, um zum ursprünglichen Prinzipal zurückzukehren.</span><span class="sxs-lookup"><span data-stu-id="6b31b-180">Perform another manual failover to fail back to the original principal.</span></span>  
  
  

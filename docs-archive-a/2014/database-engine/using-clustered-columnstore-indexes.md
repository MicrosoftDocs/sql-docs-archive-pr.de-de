---
title: Verwenden von gruppierten columnstore-Indizes | Microsoft-Dokumentation
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: table-view-index
ms.topic: conceptual
ms.assetid: 5af6b91c-724f-45ac-aff1-7555014914f4
author: mashamsft
ms.author: mathoma
ms.openlocfilehash: afc7da4e28ef7f32ca4a2b4ea762e5a5af442471
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87608792"
---
# <a name="using-clustered-columnstore-indexes"></a><span data-ttu-id="f7d33-102">Verwenden von gruppierten Columnstore-Indizes</span><span class="sxs-lookup"><span data-stu-id="f7d33-102">Using Clustered Columnstore Indexes</span></span>
  <span data-ttu-id="f7d33-103">Tasks für die Verwendung von gruppierten Columnstore-Indizes in [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f7d33-103">Tasks for using clustered columnstore indexes in [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span>

 <span data-ttu-id="f7d33-104">Eine Übersicht über Columnstore-Indizes finden Sie unter [Columnstore Indexes Described](../relational-databases/indexes/columnstore-indexes-described.md).</span><span class="sxs-lookup"><span data-stu-id="f7d33-104">For an overview of columnstore indexes, see [Columnstore Indexes Described](../relational-databases/indexes/columnstore-indexes-described.md).</span></span>

 <span data-ttu-id="f7d33-105">Informationen zum Verwenden von gruppierten Columnstore-Indizes finden Sie unter [Using Clustered Columnstore Indexes](../relational-databases/indexes/indexes.md).</span><span class="sxs-lookup"><span data-stu-id="f7d33-105">For information about clustered columnstore indexes, see [Using Clustered Columnstore Indexes](../relational-databases/indexes/indexes.md).</span></span>

## <a name="contents"></a><span data-ttu-id="f7d33-106">Inhalte</span><span class="sxs-lookup"><span data-stu-id="f7d33-106">Contents</span></span>

-   [<span data-ttu-id="f7d33-107">Erstellen eines gruppierten Columnstore-Indexes</span><span class="sxs-lookup"><span data-stu-id="f7d33-107">Create a Clustered Columnstore Index</span></span>](#create)

-   [<span data-ttu-id="f7d33-108">Löschen eines gruppierten Columnstore-Indexes</span><span class="sxs-lookup"><span data-stu-id="f7d33-108">Drop a Clustered Columnstore Index</span></span>](#drop)

-   [<span data-ttu-id="f7d33-109">Laden von Daten in einen gruppierten Columnstore-Index</span><span class="sxs-lookup"><span data-stu-id="f7d33-109">Load Data into a Clustered Columnstore Index</span></span>](#load)

-   [<span data-ttu-id="f7d33-110">Ändern der Daten in einem gruppierten Columnstore-Index</span><span class="sxs-lookup"><span data-stu-id="f7d33-110">Change Data in a Clustered Columnstore Index</span></span>](#change)

-   [<span data-ttu-id="f7d33-111">Neuerstellen eines gruppierten columnstore-Indexes</span><span class="sxs-lookup"><span data-stu-id="f7d33-111">Rebuild a Clustered Columnstore Index</span></span>](#rebuild)

-   [<span data-ttu-id="f7d33-112">Neuorganisieren eines gruppierten Columnstore-Indexes</span><span class="sxs-lookup"><span data-stu-id="f7d33-112">Reorganize a Clustered Columnstore Index</span></span>](#reorganize)

##  <a name="create-a-clustered-columnstore-index"></a><a name="create"></a><span data-ttu-id="f7d33-113">Erstellen eines gruppierten columnstore-Index</span><span class="sxs-lookup"><span data-stu-id="f7d33-113">Create a Clustered Columnstore Index</span></span>
 <span data-ttu-id="f7d33-114">Um einen gruppierten columnstore--Index zu erstellen, erstellen Sie zuerst eine rowstore-Tabelle als Heap oder gruppierten Index, und verwenden Sie dann den [Create gruppierten columnstore-Index &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-columnstore-index-transact-sql) -Anweisung, um die Tabelle in einen gruppierten columnstore--Index zu konvertieren.</span><span class="sxs-lookup"><span data-stu-id="f7d33-114">To create a clustered columnstore index, first create a rowstore table as a heap or clustered index, and then use the [CREATE CLUSTERED COLUMNSTORE INDEX &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-columnstore-index-transact-sql) statement to convert the table to a clustered columnstore index.</span></span> <span data-ttu-id="f7d33-115">Wenn der gruppierte Columnstore-Index denselben Namen erhalten soll wie der gruppierte Index, verwenden Sie die Option DROP_EXISTING.</span><span class="sxs-lookup"><span data-stu-id="f7d33-115">If you want the clustered columnstore index to have the same name as the clustered index, use the DROP_EXISTING option.</span></span>

 <span data-ttu-id="f7d33-116">In diesem Beispiel wird eine Tabelle als Heap erstellt und anschließend in einen gruppierten Columnstore-Index mit dem Namen cci_Simple konvertiert.</span><span class="sxs-lookup"><span data-stu-id="f7d33-116">This example creates a table as a heap and then converts it to a clustered columnstore index named cci_Simple.</span></span> <span data-ttu-id="f7d33-117">Dadurch wird der Speicher für die gesamte Tabelle von rowstore in columnstore geändert.</span><span class="sxs-lookup"><span data-stu-id="f7d33-117">This changes the storage for the entire table from rowstore to columnstore.</span></span>

```
CREATE TABLE T1(
    ProductKey [int] NOT NULL, 
    OrderDateKey [int] NOT NULL, 
    DueDateKey [int] NOT NULL, 
    ShipDateKey [int] NOT NULL);
GO
CREATE CLUSTERED COLUMNSTORE INDEX cci_T1 ON T1;
GO
```

 <span data-ttu-id="f7d33-118">Weitere Beispiele finden Sie im Abschnitt "Beispiele" unter [CREATE CLUSTERED columnstore Index &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-columnstore-index-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f7d33-118">For more examples, see the Examples section in [CREATE CLUSTERED COLUMNSTORE INDEX &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-columnstore-index-transact-sql).</span></span>

##  <a name="drop-a-clustered-columnstore-index"></a><a name="drop"></a><span data-ttu-id="f7d33-119">Löschen eines gruppierten columnstore-Index</span><span class="sxs-lookup"><span data-stu-id="f7d33-119">Drop a Clustered Columnstore Index</span></span>
 <span data-ttu-id="f7d33-120">Verwenden Sie die [Drop Index &#40;Transact-SQL](/sql/t-sql/statements/drop-index-transact-sql) -Anweisung&#41;, um einen gruppierten columnstore--Index zu löschen.</span><span class="sxs-lookup"><span data-stu-id="f7d33-120">Use the [DROP INDEX &#40;Transact-SQL&#41;](/sql/t-sql/statements/drop-index-transact-sql) statement to drop a clustered columnstore index.</span></span> <span data-ttu-id="f7d33-121">Bei diesem Vorgang wird der Index gelöscht, und die Columnstore-Tabelle wird in einen Rowstore-Heap konvertiert.</span><span class="sxs-lookup"><span data-stu-id="f7d33-121">This operation will drop the index and convert the columnstore table to a rowstore heap.</span></span>

##  <a name="load-data-into-a-clustered-columnstore-index"></a><a name="load"></a><span data-ttu-id="f7d33-122">Laden von Daten in einen gruppierten columnstore-Index</span><span class="sxs-lookup"><span data-stu-id="f7d33-122">Load Data into a Clustered Columnstore Index</span></span>
 <span data-ttu-id="f7d33-123">Sie können einem vorhandenen gruppierten Columnstore-Index Daten hinzufügen, indem Sie eine der Standardladenmethoden verwenden.</span><span class="sxs-lookup"><span data-stu-id="f7d33-123">You can add data to an existing clustered columnstore index by using any of the standard loading methods.</span></span>  <span data-ttu-id="f7d33-124">Beispielsweise das bcp-Massen Lade Tool, Integration Services und INSERT... Select kann alle Daten in einen gruppierten columnstore--Index laden.</span><span class="sxs-lookup"><span data-stu-id="f7d33-124">For example, the bcp bulk loading tool, Integration Services, and INSERT ... SELECT can all load data into a clustered columnstore index.</span></span>

 <span data-ttu-id="f7d33-125">Gruppierte Columnstore-Indizes nutzen den Deltastore, um eine Fragmentierung der Spaltensegmente im Columnstore zu verhindern.</span><span class="sxs-lookup"><span data-stu-id="f7d33-125">Clustered columnstore indexes leverage the deltastore in order to prevent fragmentation of column segments in the columnstore.</span></span>

### <a name="loading-into-a-partitioned-table"></a><span data-ttu-id="f7d33-126">Laden von Daten in eine partitionierte Tabelle</span><span class="sxs-lookup"><span data-stu-id="f7d33-126">Loading into a partitioned table</span></span>
 <span data-ttu-id="f7d33-127">Bei partitionierten Daten weist [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] zuerst jede Zeile einer Partition zu und führt dann Columnstore-Vorgänge für die Daten innerhalb der Partition aus.</span><span class="sxs-lookup"><span data-stu-id="f7d33-127">For partitioned data, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] first assigns each row to a partition, and then performs columnstore operations on the data within the partition.</span></span> <span data-ttu-id="f7d33-128">Jede Partition verfügt über eigene Zeilengruppen und mindestens einen Deltastore.</span><span class="sxs-lookup"><span data-stu-id="f7d33-128">Each partition has its own rowgroups and at least one deltastore.</span></span>

### <a name="deltastore-loading-scenarios"></a><span data-ttu-id="f7d33-129">Ladeszenarien für Deltastores</span><span class="sxs-lookup"><span data-stu-id="f7d33-129">Deltastore loading scenarios</span></span>
 <span data-ttu-id="f7d33-130">Zeilen werden im Deltastore gesammelt, bis ihre Anzahl die maximale Anzahl der Zeilen erreicht, die für eine Zeilengruppe zulässig sind.</span><span class="sxs-lookup"><span data-stu-id="f7d33-130">Rows accumulate in the deltastore until the number of rows is the maximum number of rows allowed for a rowgroup.</span></span> <span data-ttu-id="f7d33-131">Wenn der Delta Store die maximale Anzahl von Zeilen pro Zeilen Gruppe enthält, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] markiert die Zeilen Gruppe als "geschlossen".</span><span class="sxs-lookup"><span data-stu-id="f7d33-131">When the deltastore contains the maximum number of rows per rowgroup, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] marks the rowgroup as "CLOSED".</span></span> <span data-ttu-id="f7d33-132">Ein Hintergrundprozess, der als "tupelverschiebungsvorgang" bezeichnet wird, sucht die geschlossene Zeilen Gruppe und wechselt in den columnstore, in dem die Zeilen Gruppe in Spalten Segmente komprimiert wird und die Spalten Segmente im columnstore gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="f7d33-132">A background process, called the "tuple-mover", finds the CLOSED rowgroup and moves into the columnstore, where the rowgroup is compressed into column segments and the column segments are stored in the columnstore.</span></span>

 <span data-ttu-id="f7d33-133">Für jeden gruppierten Columnstore-Index können mehrere Deltastores vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="f7d33-133">For each clustered columnstore index there can be multiple deltastores.</span></span>

-   <span data-ttu-id="f7d33-134">Wenn ein Deltastore gesperrt ist, versucht [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] , eine Sperre für einen anderen Deltastore zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="f7d33-134">If a deltastore is locked, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] will try to obtain a lock on a different deltastore.</span></span> <span data-ttu-id="f7d33-135">Wenn keine Deltastores verfügbar sind, erstellt [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] einen neuen Deltastore.</span><span class="sxs-lookup"><span data-stu-id="f7d33-135">If there are no deltastores available, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] will create a new deltastore.</span></span>

-   <span data-ttu-id="f7d33-136">Für eine partitionierte Tabelle sind für jede Partition ein oder mehrere Deltastores vorhanden.</span><span class="sxs-lookup"><span data-stu-id="f7d33-136">For a partitioned table, there can be one or more deltastores for each partition.</span></span>

 <span data-ttu-id="f7d33-137">Die folgenden Szenarien gelten nur für gruppierte Columnstore-Indizes und veranschaulichen, in welchen Fällen geladene Zeilen direkt in den Columnstore und in welchen Fällen sie in den Deltastore aufgenommen werden.</span><span class="sxs-lookup"><span data-stu-id="f7d33-137">For clustered columnstore indexes only, the following scenarios describe when loaded rows go directly to the columnstore or when they go to the deltastore.</span></span>

 <span data-ttu-id="f7d33-138">In diesem Beispiel kann jede Zeilengruppe 102.400 bis 1.048.576 Zeilen pro Zeilengruppe enthalten.</span><span class="sxs-lookup"><span data-stu-id="f7d33-138">In the example, each rowgroup can have 102,400-1,048,576 rows per rowgroup.</span></span>

|<span data-ttu-id="f7d33-139">Zeilen für Massenladevorgang</span><span class="sxs-lookup"><span data-stu-id="f7d33-139">Rows to Bulk Load</span></span>|<span data-ttu-id="f7d33-140">Dem Columnstore hinzugefügte Zeilen</span><span class="sxs-lookup"><span data-stu-id="f7d33-140">Rows Added to the Columnstore</span></span>|<span data-ttu-id="f7d33-141">Dem Deltastore hinzugefügte Zeilen</span><span class="sxs-lookup"><span data-stu-id="f7d33-141">Rows Added to the Deltastore</span></span>|
|-----------------------|-----------------------------------|----------------------------------|
|<span data-ttu-id="f7d33-142">102.000</span><span class="sxs-lookup"><span data-stu-id="f7d33-142">102,000</span></span>|<span data-ttu-id="f7d33-143">0</span><span class="sxs-lookup"><span data-stu-id="f7d33-143">0</span></span>|<span data-ttu-id="f7d33-144">102.000</span><span class="sxs-lookup"><span data-stu-id="f7d33-144">102,000</span></span>|
|<span data-ttu-id="f7d33-145">145,000</span><span class="sxs-lookup"><span data-stu-id="f7d33-145">145,000</span></span>|<span data-ttu-id="f7d33-146">145,000</span><span class="sxs-lookup"><span data-stu-id="f7d33-146">145,000</span></span><br /><br /> <span data-ttu-id="f7d33-147">Zeilengruppengröße: 145,000</span><span class="sxs-lookup"><span data-stu-id="f7d33-147">Rowgroup size: 145,000</span></span>|<span data-ttu-id="f7d33-148">0</span><span class="sxs-lookup"><span data-stu-id="f7d33-148">0</span></span>|
|<span data-ttu-id="f7d33-149">1,048,577</span><span class="sxs-lookup"><span data-stu-id="f7d33-149">1,048,577</span></span>|<span data-ttu-id="f7d33-150">1,048,576</span><span class="sxs-lookup"><span data-stu-id="f7d33-150">1,048,576</span></span><br /><br /> <span data-ttu-id="f7d33-151">Zeilengruppengröße: 1.048.576</span><span class="sxs-lookup"><span data-stu-id="f7d33-151">Rowgroup size: 1,048,576.</span></span>|<span data-ttu-id="f7d33-152">1</span><span class="sxs-lookup"><span data-stu-id="f7d33-152">1</span></span>|
|<span data-ttu-id="f7d33-153">2,252,152</span><span class="sxs-lookup"><span data-stu-id="f7d33-153">2,252,152</span></span>|<span data-ttu-id="f7d33-154">2,252,152</span><span class="sxs-lookup"><span data-stu-id="f7d33-154">2,252,152</span></span><br /><br /> <span data-ttu-id="f7d33-155">Zeilengruppengrößen: 1.048.576, 1.048.576, 155.000</span><span class="sxs-lookup"><span data-stu-id="f7d33-155">Rowgroup sizes: 1,048,576, 1,048,576, 155,000.</span></span>|<span data-ttu-id="f7d33-156">0</span><span class="sxs-lookup"><span data-stu-id="f7d33-156">0</span></span>|

 <span data-ttu-id="f7d33-157">Im folgenden Beispiel werden die Ergebnisse des Ladens von 1.048.577 Zeilen in eine Partition angezeigt.</span><span class="sxs-lookup"><span data-stu-id="f7d33-157">The following example shows the results of loading 1,048,577 rows into a partition.</span></span> <span data-ttu-id="f7d33-158">Aus den Ergebnissen wird ersichtlich, dass eine COMPRESSED-Zeilengruppe im Columnstore (in Form von komprimierten Spaltensegmenten) und eine Zeile im Deltastore vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="f7d33-158">The results show that one COMPRESSED rowgroup in the columnstore (as compressed column segments), and 1 row in the deltastore.</span></span>

```sql
SELECT * FROM sys.column_store_row_groups;
```

 <span data-ttu-id="f7d33-159">![Zeilengruppe und Deltastore für einen Batchladevorgang](../../2014/database-engine/media/sql-server-pdw-columnstore-batchload.gif "Zeilengruppe und Deltastore für einen Batchladevorgang")</span><span class="sxs-lookup"><span data-stu-id="f7d33-159">![Rowgroup and deltastore for a batch load](../../2014/database-engine/media/sql-server-pdw-columnstore-batchload.gif "Rowgroup and deltastore for a batch load")</span></span>



##  <a name="change-data-in-a-clustered-columnstore-index"></a><a name="change"></a><span data-ttu-id="f7d33-160">Ändern von Daten in einem gruppierten columnstore-Index</span><span class="sxs-lookup"><span data-stu-id="f7d33-160">Change Data in a Clustered Columnstore Index</span></span>
 <span data-ttu-id="f7d33-161">Gruppierte Columnstore-Indizes unterstützen DML-Vorgänge zum Einfügen, Aktualisieren und Löschen.</span><span class="sxs-lookup"><span data-stu-id="f7d33-161">Clustered columnstore indexes support insert, update, and delete DML operations.</span></span>

 <span data-ttu-id="f7d33-162">Verwenden Sie [Insert &#40;Transact-SQL-&#41;](/sql/t-sql/statements/insert-transact-sql) , um eine Zeile einzufügen.</span><span class="sxs-lookup"><span data-stu-id="f7d33-162">Use [INSERT &#40;Transact-SQL&#41;](/sql/t-sql/statements/insert-transact-sql) to insert a row.</span></span> <span data-ttu-id="f7d33-163">Die Zeile wird dem Deltastore hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="f7d33-163">The row will be added to the deltastore.</span></span>

 <span data-ttu-id="f7d33-164">Verwenden Sie [DELETE &#40;Transact-SQL&#41;](/sql/t-sql/statements/delete-transact-sql) zum Löschen einer Zeile.</span><span class="sxs-lookup"><span data-stu-id="f7d33-164">Use [DELETE &#40;Transact-SQL&#41;](/sql/t-sql/statements/delete-transact-sql) to delete a row.</span></span>

-   <span data-ttu-id="f7d33-165">Wenn die Zeile im Columnstore-Index enthalten ist, markiert [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] die Zeile als logisch gelöscht, der physische Speicherplatz für die Zeile wird jedoch erst freigegeben, nachdem der Index neu erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="f7d33-165">If the row is in the columnstore, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] marks the row as logically deleted but does not reclaim the physical storage for the row until the index is rebuilt.</span></span>

-   <span data-ttu-id="f7d33-166">Wenn sich die Zeile im Deltastore befindet, löscht [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] die Zeile logisch und physisch.</span><span class="sxs-lookup"><span data-stu-id="f7d33-166">If the row is in the deltastore, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] logically and physically deletes the row.</span></span>

 <span data-ttu-id="f7d33-167">Verwenden Sie [UPDATE &#40;Transact-SQL&#41;](/sql/t-sql/queries/update-transact-sql) , um eine Zeile zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="f7d33-167">Use [UPDATE &#40;Transact-SQL&#41;](/sql/t-sql/queries/update-transact-sql) to update a row.</span></span>

-   <span data-ttu-id="f7d33-168">Wenn sich die Zeile im Columnstore befindet, markiert [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] die Zeile als logisch gelöscht und fügt die aktualisierte Zeile anschließend in den Deltastore ein.</span><span class="sxs-lookup"><span data-stu-id="f7d33-168">If the row is in the columnstore, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] marks the row as logically deleted, and then inserts the updated row into the deltastore.</span></span>

-   <span data-ttu-id="f7d33-169">Wenn sich die Zeile im Deltastore befindet, aktualisiert [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] die Zeile im Deltastore.</span><span class="sxs-lookup"><span data-stu-id="f7d33-169">If the row is in the deltastore, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] updates the row in the deltastore.</span></span>

##  <a name="rebuild-a-clustered-columnstore-index"></a><a name="rebuild"></a><span data-ttu-id="f7d33-170">Neuerstellen eines gruppierten columnstore-Indexes</span><span class="sxs-lookup"><span data-stu-id="f7d33-170">Rebuild a Clustered Columnstore Index</span></span>
 <span data-ttu-id="f7d33-171">Verwenden Sie [Create gruppierten columnstore-Index &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-columnstore-index-transact-sql) oder [Alter Index &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-index-transact-sql) , um einen vorhandenen gruppierten columnstore--Index vollständig neu zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="f7d33-171">Use [CREATE CLUSTERED COLUMNSTORE INDEX &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-columnstore-index-transact-sql) or [ALTER INDEX &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-index-transact-sql) to perform a full rebuild of an existing clustered columnstore index.</span></span> <span data-ttu-id="f7d33-172">Außerdem können Sie Alter Index... Erstellen Sie neu, um eine bestimmte Partition neu zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="f7d33-172">Additionally, you can use ALTER INDEX ... REBUILD to rebuild a specific partition.</span></span>

### <a name="rebuild-process"></a><span data-ttu-id="f7d33-173">Neuerstellungsprozess</span><span class="sxs-lookup"><span data-stu-id="f7d33-173">Rebuild Process</span></span>
 <span data-ttu-id="f7d33-174">Die Neuerstellung eines gruppierten columnstore-Indexes verläuft in [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] wie folgt:</span><span class="sxs-lookup"><span data-stu-id="f7d33-174">To rebuild a clustered columnstore index, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]:</span></span>

-   <span data-ttu-id="f7d33-175">Abrufen einer exklusiven Sperre für die Tabelle oder Partition, während die Neuerstellung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="f7d33-175">Acquires an exclusive lock on the table or partition while the rebuild occurs.</span></span>  <span data-ttu-id="f7d33-176">Die Daten sind während der Neuerstellung „offline“ und nicht verfügbar.</span><span class="sxs-lookup"><span data-stu-id="f7d33-176">The data is "offline" and unavailable during the rebuild.</span></span>

-   <span data-ttu-id="f7d33-177">Defragmentieren des Columnstore, indem physisch Zeilen gelöscht werden, die logisch aus der Tabelle gelöscht wurden. Die gelöschten Bytes werden auf dem physischen Medium freigegeben.</span><span class="sxs-lookup"><span data-stu-id="f7d33-177">Defragments the columnstore by physically deleting rows that have been logically deleted from the table; the deleted bytes are reclaimed on the physical media.</span></span>

-   <span data-ttu-id="f7d33-178">Führt die Rowstore-Daten im Deltastore mit den Daten im Columnstore zusammen, bevor der Index neu erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="f7d33-178">Merges the rowstore data in the deltastore with the data in the columnstore before it rebuilds the index.</span></span> <span data-ttu-id="f7d33-179">Nachdem die Neuerstellung abgeschlossen ist, sind alle Daten im Columnstore-Format gespeichert, und der Deltastore ist leer.</span><span class="sxs-lookup"><span data-stu-id="f7d33-179">When the rebuild is finished, all data is stored in columnstore format, and the deltastore is empty.</span></span>

-   <span data-ttu-id="f7d33-180">Neukomprimierung aller Daten im Columnstore.</span><span class="sxs-lookup"><span data-stu-id="f7d33-180">Re-compresses all data into the columnstore.</span></span> <span data-ttu-id="f7d33-181">Während die Neuerstellung ausgeführt wird, gibt es zwei Kopien des columnstore-Indexes.</span><span class="sxs-lookup"><span data-stu-id="f7d33-181">Two copies of the columnstore index exist while the rebuild is taking place.</span></span> <span data-ttu-id="f7d33-182">Nach Abschluss der Neuerstellung wird der ursprüngliche columnstore-Index in [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] gelöscht.</span><span class="sxs-lookup"><span data-stu-id="f7d33-182">When the rebuild is finished, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] deletes the original columnstore index.</span></span>

### <a name="recommendations-for-rebuilding-a-clustered-columnstore-index"></a><span data-ttu-id="f7d33-183">Empfehlungen zum Neuerstellen eines gruppierten Columnstore-Indexes</span><span class="sxs-lookup"><span data-stu-id="f7d33-183">Recommendations for Rebuilding a Clustered Columnstore Index</span></span>
 <span data-ttu-id="f7d33-184">Das Neuerstellen eines gruppierten Columnstore-Index ist sinnvoll, um Fragmentierungen zu beseitigen und um alle Zeilen in den Columnstore zu verschieben.</span><span class="sxs-lookup"><span data-stu-id="f7d33-184">Rebuilding a clustered columnstore index is useful for removing fragmentation, and for moving all rows into the columnstore.</span></span> <span data-ttu-id="f7d33-185">Berücksichtigen Sie die folgenden Empfehlungen:</span><span class="sxs-lookup"><span data-stu-id="f7d33-185">We have the following recommendations:</span></span>

-   <span data-ttu-id="f7d33-186">Erstellen Sie nur eine Partition neu und nicht die gesamte Tabelle.</span><span class="sxs-lookup"><span data-stu-id="f7d33-186">Rebuild a partition instead of the entire table.</span></span>

    1.  <span data-ttu-id="f7d33-187">Wenn der Index groß ist, nimmt das Neuerstellen der gesamten Tabelle viel Zeit in Anspruch, und es muss ausreichend Speicherplatz verfügbar sein, um während der Neuerstellung eine zusätzliche Kopie des Indexes speichern zu können.</span><span class="sxs-lookup"><span data-stu-id="f7d33-187">Rebuilding the entire table takes a long time if the index is large, and it requires enough disk space to store an additional copy of the index during the rebuild.</span></span> <span data-ttu-id="f7d33-188">In der Regel muss nur die zuletzt verwendete Partition neu erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="f7d33-188">Usually it is only necessary to rebuild the most recently used partition.</span></span>

    2.  <span data-ttu-id="f7d33-189">Bei partitionierten Tabellen müssen Sie nicht den gesamten Columnstore-Index neu erstellen, da die Fragmentierung wahrscheinlich nur in den Partitionen vorliegt, die kürzlich geändert wurden.</span><span class="sxs-lookup"><span data-stu-id="f7d33-189">For partitioned tables, you do not need to rebuild the entire columnstore index because fragmentation is likely to occur in only the partitions that have been modified recently.</span></span> <span data-ttu-id="f7d33-190">Faktentabellen und große Dimensionstabellen werden i. d. R. partitioniert, um Sicherungs- und Verwaltungsvorgänge für Segmente der Tabelle auszuführen.</span><span class="sxs-lookup"><span data-stu-id="f7d33-190">Fact tables and large dimension tables are usually partitioned in order to perform backup and management operations on chunks of the table.</span></span>

-   <span data-ttu-id="f7d33-191">Erstellen Sie eine Partition nach intensiven DML-Vorgängen neu.</span><span class="sxs-lookup"><span data-stu-id="f7d33-191">Rebuild a partition after heavy DML operations.</span></span>

     <span data-ttu-id="f7d33-192">Durch das Neuerstellen einer Partition wird die Partition defragmentiert und der benötigte Festplattenspeicherplatz reduziert.</span><span class="sxs-lookup"><span data-stu-id="f7d33-192">Rebuilding a partition will defragment the partition and reduce disk storage.</span></span> <span data-ttu-id="f7d33-193">Beim Neuerstellen werden alle zum Löschen markierten Zeilen aus dem Columnstore gelöscht und alle Zeilen aus dem Deltastore in den Columnstore verschoben.</span><span class="sxs-lookup"><span data-stu-id="f7d33-193">Rebuilding will delete all rows from the columnstore that are marked for deletion, and it will move all rows from the deltastore into the columnstore.</span></span>

-   <span data-ttu-id="f7d33-194">Erstellen Sie eine Partition neu, nachdem Sie Daten geladen haben.</span><span class="sxs-lookup"><span data-stu-id="f7d33-194">Rebuild a partition after loading data.</span></span>

     <span data-ttu-id="f7d33-195">Dadurch wird sichergestellt, dass alle Daten im Columnstore gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="f7d33-195">This ensures all data is stored in the columnstore.</span></span> <span data-ttu-id="f7d33-196">Wenn mehrere Ladevorgänge zur gleichen Zeit ausgeführt werden, kann dies ggf. dazu führen, dass für jede Partition mehrere Deltastores vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="f7d33-196">If multiple loads occur at the same time, each partition could end up having multiple deltastores.</span></span> <span data-ttu-id="f7d33-197">Durch das Neuerstellen werden alle Deltastore-Zeilen in den Columnstore verschoben.</span><span class="sxs-lookup"><span data-stu-id="f7d33-197">Rebuilding will move all deltastore rows into the columnstore.</span></span>

##  <a name="reorganize-a-clustered-columnstore-index"></a><a name="reorganize"></a><span data-ttu-id="f7d33-198">Neuorganisieren eines gruppierten columnstore-Indexes</span><span class="sxs-lookup"><span data-stu-id="f7d33-198">Reorganize a Clustered Columnstore Index</span></span>
 <span data-ttu-id="f7d33-199">Beim Neuorganisieren eines gruppierten Columnstore-Indexes werden alle Closed-Zeilengruppen in den Columnstore-Index verschoben.</span><span class="sxs-lookup"><span data-stu-id="f7d33-199">Reorganizing a clustered columnstore index moves all CLOSED rowgroups into the columnstore.</span></span> <span data-ttu-id="f7d33-200">Verwenden Sie zum Ausführen einer Neuorganisierung [Alter Index &#40;Transact-SQL-&#41;](/sql/t-sql/statements/alter-index-transact-sql)mit der reorganisierungs Option.</span><span class="sxs-lookup"><span data-stu-id="f7d33-200">To perform a reorganize, use [ALTER INDEX &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-index-transact-sql)with the REORGANIZE option.</span></span>

 <span data-ttu-id="f7d33-201">Die Neuorganisation ist für das Verschieben von CLOSED-Zeilengruppen in den Columnstore nicht zwingend erforderlich.</span><span class="sxs-lookup"><span data-stu-id="f7d33-201">Reorganizing is not required in order to move CLOSED rowgroups into the columnstore.</span></span> <span data-ttu-id="f7d33-202">Zuletzt werden alle CLOSED-Zeilengruppen vom TM (Tuple Mover)-Vorgang gesucht und verschoben.</span><span class="sxs-lookup"><span data-stu-id="f7d33-202">The tuple-mover process will eventually find all CLOSED rowgroups and move them.</span></span> <span data-ttu-id="f7d33-203">Da der Tuple Mover jedoch in einem einzelnen Thread ausgeführt wird, werden die Zeilengruppen für Ihre Arbeitsauslastung u. U. nicht schnell genug verschoben.</span><span class="sxs-lookup"><span data-stu-id="f7d33-203">However, the tuple-mover is single-threaded and might not move rowgroups fast enough for your workload.</span></span>

### <a name="recommendations-for-reorganizing"></a><span data-ttu-id="f7d33-204">Empfehlungen zum Neuorganisieren</span><span class="sxs-lookup"><span data-stu-id="f7d33-204">Recommendations for Reorganizing</span></span>
 <span data-ttu-id="f7d33-205">In folgenden Fällen muss ein gruppierter Columnstore-Index neuorganisiert werden:</span><span class="sxs-lookup"><span data-stu-id="f7d33-205">When to reorganize a clustered columnstore index:</span></span>

-   <span data-ttu-id="f7d33-206">Neuorganisieren Sie einen gruppierten Columnstore-Index nach einem oder mehreren Datenladevorgängen, um so schnell wie möglich die bessere Abfrageleistung nutzbar zu machen.</span><span class="sxs-lookup"><span data-stu-id="f7d33-206">Reorganize a clustered columnstore index after one or more data loads to achieve query performance benefits as quickly as possible.</span></span> <span data-ttu-id="f7d33-207">Beim Neuorganisieren sind zunächst zusätzliche CPU-Ressourcen zum Komprimieren der Daten erforderlich. Dies kann die Gesamtleistung des Systems beeinträchtigen.</span><span class="sxs-lookup"><span data-stu-id="f7d33-207">Reorganizing will initially require additional CPU resources to compress the data, which could slow overall system performance.</span></span> <span data-ttu-id="f7d33-208">Sobald die Daten jedoch komprimiert sind, kann sich die Abfrageleistung verbessern.</span><span class="sxs-lookup"><span data-stu-id="f7d33-208">However, as soon as the data is compressed, query performance can improve.</span></span>



---
title: Implementieren einer Connection-Klasse für Datenverarbeitungserweiterungen | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services
ms.topic: reference
helpviewer_keywords:
- connections [Reporting Services], data processing extensions
- Connection class
- data processing extensions [Reporting Services], connections
ms.assetid: 7047d29e-a2c9-4e6f-ad02-635851a38ed7
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 84caac40ec8df198d5c26ed89bf35fad71ad914f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87725269"
---
# <a name="implementing-a-connection-class-for-a-data-processing-extension"></a><span data-ttu-id="29d0f-102">Implementieren einer Connection-Klasse für Datenverarbeitungserweiterungen</span><span class="sxs-lookup"><span data-stu-id="29d0f-102">Implementing a Connection Class for a Data Processing Extension</span></span>
  <span data-ttu-id="29d0f-103">Das **Connection**-Objekt stellt eine Datenbankverbindung oder eine ähnliche Ressource dar und bildet den Ausgangspunkt für Benutzer einer [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)]-Datenverarbeitungserweiterung.</span><span class="sxs-lookup"><span data-stu-id="29d0f-103">The **Connection** object represents a database connection or similar resource and is the starting point for users of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] data processing extension.</span></span> <span data-ttu-id="29d0f-104">Es stellt Verbindungen zum Datenbankserver dar, obwohl auch jede Entität mit ähnlichem Verhalten als **Connection** zur Verfügung gestellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="29d0f-104">It represents connections to database servers, though any entity with similar behavior can be exposed as a **Connection**.</span></span>  
  
 <span data-ttu-id="29d0f-105">Erstellen Sie eine Klasse, die <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> und optional <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> implementiert, um ein **Connection**-Objekt zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="29d0f-105">To implement a **Connection** object, create a class that implements <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> and optionally implements <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension>.</span></span>  
  
 <span data-ttu-id="29d0f-106">Sie müssen in Ihrer Implementierung sicherstellen, dass eine Verbindung erstellt und geöffnet wird, bevor die Befehle ausgeführt werden können.</span><span class="sxs-lookup"><span data-stu-id="29d0f-106">In your implementation, you must ensure that a connection is created and opened before commands can be executed.</span></span> <span data-ttu-id="29d0f-107">Stellen Sie in Ihrer Implementierung sicher, dass Clients die Verbindungen ausdrücklich (und nicht implizit) öffnen und schließen.</span><span class="sxs-lookup"><span data-stu-id="29d0f-107">Ensure that your implementation requires clients to open and close connections explicitly, rather than having your implementation open and close connections implicitly for the client.</span></span> <span data-ttu-id="29d0f-108">Führen Sie die Sicherheitsprüfungen aus, wenn die Verbindung hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="29d0f-108">Perform your security checks when the connection is obtained.</span></span> <span data-ttu-id="29d0f-109">Dadurch, dass eine Verbindung für die anderen Klassen in der [!INCLUDE[ssRS](../../../includes/ssrs.md)]-Datenverarbeitungserweiterung vorhanden sein muss, wird sichergestellt, dass bei der Arbeit mit Ihrer Datenquelle stets Sicherheitsprüfungen durchgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="29d0f-109">Requiring an existing connection for the other classes in your [!INCLUDE[ssRS](../../../includes/ssrs.md)] data processing extension will then ensure that security checks are always performed when working with your data source.</span></span>  
  
 <span data-ttu-id="29d0f-110">Die Eigenschaften der gewünschten Verbindung werden als Verbindungszeichenfolge dargestellt.</span><span class="sxs-lookup"><span data-stu-id="29d0f-110">The properties of the desired connection are represented as a connection string.</span></span> <span data-ttu-id="29d0f-111">Die [!INCLUDE[ssRS](../../../includes/ssrs.md)]-Datenverarbeitungserweiterungen sollten unbedingt die Eigenschaft <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection.ConnectionString%2A> unterstützen und das bekannte Name/Wert-Paar verwenden, das von der OLE DB definiert ist.</span><span class="sxs-lookup"><span data-stu-id="29d0f-111">It is strongly recommended that [!INCLUDE[ssRS](../../../includes/ssrs.md)] data processing extensions support the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection.ConnectionString%2A> property using the familiar name/value pair system defined by OLE DB.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="29d0f-112">**Connection**-Objekte können häufig nur mit großem Ressourcenaufwand abgerufen werden. Daher sollten Sie zur Reduzierung dieses Effekts ein Pooling der Verbindungen oder andere Techniken in Erwägung ziehen.</span><span class="sxs-lookup"><span data-stu-id="29d0f-112">**Connection** objects are often resource-intensive to obtain, so you may want to consider pooling connections or other techniques to mitigate this.</span></span>  
  
 <span data-ttu-id="29d0f-113"><xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> erbt von <xref:Microsoft.ReportingServices.Interfaces.IExtension>.</span><span class="sxs-lookup"><span data-stu-id="29d0f-113"><xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> inherits from <xref:Microsoft.ReportingServices.Interfaces.IExtension>.</span></span> <span data-ttu-id="29d0f-114">Sie müssen die <xref:Microsoft.ReportingServices.Interfaces.IExtension>-Schnittstelle als Teil der Implementierung der Verbindungsklassen implementieren.</span><span class="sxs-lookup"><span data-stu-id="29d0f-114">You must implement the <xref:Microsoft.ReportingServices.Interfaces.IExtension> interface as part of your connection class implementation.</span></span> <span data-ttu-id="29d0f-115">Durch die <xref:Microsoft.ReportingServices.Interfaces.IExtension>-Schnittstelle kann eine Klasse einen lokalisierten Erweiterungsnamen implementieren und erweiterungsspezifische Konfigurationsdaten verarbeiten, die in der [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)]-Konfigurationsdatei gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="29d0f-115">The <xref:Microsoft.ReportingServices.Interfaces.IExtension> interface enables a class to implement a localized extension name and to process extension-specific configuration information stored in the [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] configuration file.</span></span>  
  
 <span data-ttu-id="29d0f-116">Das **Connection**-Objekt enthält die <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A>-Eigenschaft durch seine Implementierung von <xref:Microsoft.ReportingServices.Interfaces.IExtension>.</span><span class="sxs-lookup"><span data-stu-id="29d0f-116">Your **Connection** object contains the <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A> property through its implementation of <xref:Microsoft.ReportingServices.Interfaces.IExtension>.</span></span> <span data-ttu-id="29d0f-117">Die [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)]-Datenverarbeitungserweiterungen sollten unbedingt die Eigenschaft <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A> unterstützen, sodass die Benutzer einen bekannten und lokalisierten Namen auf der Benutzeroberfläche, z. B. dem Berichts-Manager, vorfinden.</span><span class="sxs-lookup"><span data-stu-id="29d0f-117">It is strongly recommended that [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] data processing extensions support the <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A> property, so that users encounter a familiar, localized name for the extension in a user interface, such as Report Manager.</span></span>  
  
 <span data-ttu-id="29d0f-118"><xref:Microsoft.ReportingServices.Interfaces.IExtension> versetzt das **Connection**-Objekt in die Lage, in der Datei „RSReportServer.config“ gespeicherte, benutzerdefinierte Konfigurationsdaten abzurufen und zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="29d0f-118"><xref:Microsoft.ReportingServices.Interfaces.IExtension> also enables your **Connection** object to retrieve and process custom configuration data stored in the RSReportServer.config file.</span></span> <span data-ttu-id="29d0f-119">Weitere Informationen zur Verarbeitung benutzerdefinierter Konfigurationsdaten finden Sie in der Methode <xref:Microsoft.ReportingServices.Interfaces.IExtension.SetConfiguration%2A>.</span><span class="sxs-lookup"><span data-stu-id="29d0f-119">For more information about processing custom configuration data, see the <xref:Microsoft.ReportingServices.Interfaces.IExtension.SetConfiguration%2A> method.</span></span>  
  
 <span data-ttu-id="29d0f-120">Die Klasse, mit der <xref:Microsoft.ReportingServices.Interfaces.IExtension> implementiert wird, wird nicht aus dem Arbeitsspeicher entladen, wenn der Rest der Datenverarbeitungserweiterungsklassen entladen wird.</span><span class="sxs-lookup"><span data-stu-id="29d0f-120">The class that implements <xref:Microsoft.ReportingServices.Interfaces.IExtension> is not unloaded from memory when the rest of your data processing extension classes are unloaded.</span></span> <span data-ttu-id="29d0f-121">Daher können Sie mithilfe der **Extension**-Klasse verbindungsübergreifende Statusdaten oder Daten speichern, die im Arbeitsspeicher zwischengespeichert werden können.</span><span class="sxs-lookup"><span data-stu-id="29d0f-121">Because of this, you can use your **Extension** class to store cross-connection state information or to store data that can be cached in memory.</span></span> <span data-ttu-id="29d0f-122">Die **Extension**-Klasse verbleibt im Arbeitsspeicher, solange der Berichtsserver ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="29d0f-122">Your **Extension** class remains in memory as long as the report server is running.</span></span>  
  
 <span data-ttu-id="29d0f-123">Sie können die **Connection**-Klasse so erweitern, dass Anmeldeinformationen in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] unterstützt werden, indem Sie <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> implementieren.</span><span class="sxs-lookup"><span data-stu-id="29d0f-123">You can extend your **Connection** class to include support for credentials in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] by implementing <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension>.</span></span> <span data-ttu-id="29d0f-124">Wenn Sie die Eigenschaften <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.IntegratedSecurity%2A>, <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.UserName%2A> und <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.Password%2A> der Schnittstelle <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> implementieren, aktivieren Sie das Kontrollkästchen **Integrierte Sicherheit** und die Textfelder **Benutzername** und **Kennwort** im Dialogfeld **Datenquelle** im Berichts-Designer.</span><span class="sxs-lookup"><span data-stu-id="29d0f-124">When you implement the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.IntegratedSecurity%2A>, <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.UserName%2A>, and <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.Password%2A> properties of the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> interface, you enable the **Integrated Security** check box and **Username** and **Password** text boxes of the **Data Source** dialog in Report Designer.</span></span> <span data-ttu-id="29d0f-125">Hierdurch kann der Berichts-Designer die Anmeldeinformationen für Datenquellen speichern und abrufen, die die Authentifizierung unterstützen.</span><span class="sxs-lookup"><span data-stu-id="29d0f-125">This enables Report Designer to store and retrieve credentials for data sources that support authentication.</span></span> <span data-ttu-id="29d0f-126">Die Anmeldeinformationen werden sicher gespeichert und verwendet, wenn Berichte im Vorschaumodus gerendert werden.</span><span class="sxs-lookup"><span data-stu-id="29d0f-126">The credentials are stored securely and used when rendering reports in preview mode.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="29d0f-127">Die Implementierung von <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> erfordert es implizit, dass Sie die Elemente der <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection>-Schnittstelle und der <xref:Microsoft.ReportingServices.Interfaces.IExtension>-Schnittstelle implementieren.</span><span class="sxs-lookup"><span data-stu-id="29d0f-127">Implementing <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> implicitly requires you to implement the members of the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> and <xref:Microsoft.ReportingServices.Interfaces.IExtension> interfaces.</span></span>  
>   
>  <span data-ttu-id="29d0f-128">Eine Beispiel-**Connection**-Klassenimplementierung finden Sie unter [SQL Server Reporting Services-Produktbeispiele](https://go.microsoft.com/fwlink/?LinkId=177889).</span><span class="sxs-lookup"><span data-stu-id="29d0f-128">For a sample **Connection** class implementation, see [SQL Server Reporting Services Product Samples](https://go.microsoft.com/fwlink/?LinkId=177889).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="29d0f-129">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="29d0f-129">See Also</span></span>  
 <span data-ttu-id="29d0f-130">[Erweiterungen für Reporting Services](../reporting-services-extensions.md) </span><span class="sxs-lookup"><span data-stu-id="29d0f-130">[Reporting Services Extensions](../reporting-services-extensions.md) </span></span>  
 <span data-ttu-id="29d0f-131">[Implementieren von Datenverarbeitungserweiterungen](implementing-a-data-processing-extension.md) </span><span class="sxs-lookup"><span data-stu-id="29d0f-131">[Implementing a Data Processing Extension](implementing-a-data-processing-extension.md) </span></span>  
 [<span data-ttu-id="29d0f-132">Reporting Services Extension Library (Reporting Services-Erweiterungsbibliothek)</span><span class="sxs-lookup"><span data-stu-id="29d0f-132">Reporting Services Extension Library</span></span>](../reporting-services-extension-library.md)  
  
  

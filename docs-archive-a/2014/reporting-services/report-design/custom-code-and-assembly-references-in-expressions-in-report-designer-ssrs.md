---
title: Benutzerdefinierter Code und Assemblyverweise in Ausdrücken im Berichts-Designer (SSRS) | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- items [Reporting Services], expressions
- data [Reporting Services], expressions
- expressions [Reporting Services], about expressions
- expressions [Reporting Services]
- SSRS, expressions
- formulas [Reporting Services]
- data manipulation [Reporting Services]
- SQL Server Reporting Services, expressions
ms.assetid: ae8a0166-2ccc-45f4-8d28-c150da7b73de
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 0f895d1ecc569092dfbae22b514d3470e020b94d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87721217"
---
# <a name="custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs"></a><span data-ttu-id="319c4-102">Benutzerdefinierter Code und Assemblyverweise in Ausdrücken in Berichts-Designer (SSRS)</span><span class="sxs-lookup"><span data-stu-id="319c4-102">Custom Code and Assembly References in Expressions in Report Designer (SSRS)</span></span>
  <span data-ttu-id="319c4-103">Sie können in einem Bericht eingebettetem, benutzerdefiniertem Code oder benutzerdefinierten Assemblys, die Sie erstellen und auf dem Computer speichern und auf dem Berichtsserver bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="319c4-103">You can add references to custom code embedded in a report or to custom assemblies that you build and save to your computer and deploy to the report server.</span></span> <span data-ttu-id="319c4-104">Verwenden Sie eingebetteten Code für benutzerdefinierte Konstanten, komplexe Funktionen oder für Funktionen, die mehrfach in demselben Bericht verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="319c4-104">Use embedded code for custom constants, complex functions or functions that are used multiple times in a single report.</span></span> <span data-ttu-id="319c4-105">Verwenden Sie benutzerdefinierte Codeassemblys, um Code an einer einzelnen Stelle zu verwalten und ihn zur Verwendung in mehreren Berichten freizugeben.</span><span class="sxs-lookup"><span data-stu-id="319c4-105">Use custom code assemblies to maintain code in a single place and share it for use by multiple reports.</span></span> <span data-ttu-id="319c4-106">In benutzerdefiniertem Code können neue benutzerdefinierte Konstanten, Variablen, Funktionen oder Unterroutinen eingeschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="319c4-106">Custom code can include new custom constants, variables, functions, or subroutines.</span></span> <span data-ttu-id="319c4-107">Sie können schreibgeschützte Verweise in integrierte Auflistungen, wie die Parameter-Auflistung, einbeziehen.</span><span class="sxs-lookup"><span data-stu-id="319c4-107">You can include read-only references to built-in collections such as the Parameters collection.</span></span> <span data-ttu-id="319c4-108">An benutzerdefinierte Funktionen können jedoch keine Sätze von Berichtsdatenwerten übergeben werden, insbesondere werden keine benutzerdefinierten Aggregate unterstützt.</span><span class="sxs-lookup"><span data-stu-id="319c4-108">However, you cannot pass sets of report data values to custom functions; specifically, custom aggregates are not supported.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="319c4-109">Für zeitempfindliche Berechnungen, die einmal zur Laufzeit ausgewertet werden und während der Berichtsverarbeitung denselben Wert behalten sollen, bietet sich eventuell die Verwendung einer Berichts- oder Gruppenvariablen an.</span><span class="sxs-lookup"><span data-stu-id="319c4-109">For time-sensitive calculations that are evaluated once at run-time and that you want to remain the same value throughout report processing, consider whether to use a report variable or group variable.</span></span> <span data-ttu-id="319c4-110">Weitere Informationen finden Sie unter [Verweise auf Berichts- und Gruppenvariablenauflistungen &#40;Berichts-Generator und SSRS&#41;](built-in-collections-report-and-group-variables-references-report-builder.md).</span><span class="sxs-lookup"><span data-stu-id="319c4-110">For more information, see [Report and Group Variables Collections References &#40;Report Builder and SSRS&#41;](built-in-collections-report-and-group-variables-references-report-builder.md).</span></span>  
  
 <span data-ttu-id="319c4-111">Berichts-Designer ist die bevorzugte Erstellungsumgebung für das Hinzufügen von benutzerdefiniertem Code zu einem Bericht.</span><span class="sxs-lookup"><span data-stu-id="319c4-111">Report Designer is the preferred authoring environment to use to add custom code to a report.</span></span> <span data-ttu-id="319c4-112">Berichts-Generator unterstützt das Verarbeiten von Berichten, die über gültige Ausdrücke verfügen, oder die Verweise auf benutzerdefinierte Assemblys auf einem Berichtsserver einschließen.</span><span class="sxs-lookup"><span data-stu-id="319c4-112">Report Builder supports processing reports that have valid expressions, or that include references to custom assemblies on a report server.</span></span> <span data-ttu-id="319c4-113">Berichts-Generator bietet keine Möglichkeit, einen Verweis auf eine benutzerdefinierte Assembly hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="319c4-113">Report Builder does not provide a way to add a reference to a custom assembly.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="319c4-114">Während des Upgrades eines Berichtsservers erfordern Berichte, die von benutzerdefinierten Assemblys abhängig sind, unter Umständen weitere Schritte zum Abschließen des Upgrades.</span><span class="sxs-lookup"><span data-stu-id="319c4-114">Be aware that during an upgrade of a report server, reports that depend on custom assemblies might require additional steps to complete the upgrade.</span></span> <span data-ttu-id="319c4-115">Weitere Informationen finden Sie unter [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="319c4-115">For more information, see [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
##  <a name="working-with-custom-code-in-report-builder"></a><a name="RB3"></a> <span data-ttu-id="319c4-116">Arbeiten mit benutzerdefiniertem Code in Berichts-Generator</span><span class="sxs-lookup"><span data-stu-id="319c4-116">Working with Custom Code in Report Builder</span></span>  
 <span data-ttu-id="319c4-117">In Berichts-Generator können Sie einen Bericht von einem Berichtsserver öffnen, der Verweise auf benutzerdefinierte Assemblys einschließt.</span><span class="sxs-lookup"><span data-stu-id="319c4-117">In Report Builder, you can open a report from a report server that includes references to custom assemblies.</span></span> <span data-ttu-id="319c4-118">Sie können z. B. Berichte bearbeiten, die mit Berichts-Designer in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]erstellt und bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="319c4-118">For example, you can edit reports that are created and deployed by using Report Designer in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="319c4-119">Die benutzerdefinierten Assemblys müssen auf dem Berichtsserver bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="319c4-119">The custom assemblies must be deployed to the report server.</span></span>  
  
 <span data-ttu-id="319c4-120">Sie können nicht die folgenden Schritte ausführen:</span><span class="sxs-lookup"><span data-stu-id="319c4-120">You cannot do the following:</span></span>  
  
1.  <span data-ttu-id="319c4-121">Hinzufügen von Verweisen oder Klassenmemberinstanzen zu einem Bericht.</span><span class="sxs-lookup"><span data-stu-id="319c4-121">Add references or class member instances to a report.</span></span>  
  
2.  <span data-ttu-id="319c4-122">Anzeigen eines Berichts in der Vorschau mit Verweisen auf benutzerdefinierte Assemblys im lokalen Modus.</span><span class="sxs-lookup"><span data-stu-id="319c4-122">Preview a report with references to custom assemblies in local mode.</span></span>  
  
##  <a name="including-references-to-commonly-used-functions"></a><a name="Common"></a><span data-ttu-id="319c4-123">Einschließen von Verweisen auf häufig verwendete Funktionen</span><span class="sxs-lookup"><span data-stu-id="319c4-123">Including References to Commonly Used Functions</span></span>  
 <span data-ttu-id="319c4-124">Verwenden Sie das Dialogfeld **Ausdruck** , um eine kategorisierte Liste allgemeiner, in [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]integrierter Funktionen anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="319c4-124">Use the **Expression** dialog box to view a categorized list of common functions built-in to [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].</span></span> <span data-ttu-id="319c4-125">Wenn Sie **Allgemeine Funktionen** erweitern und auf eine Kategorie klicken, wird im Bereich **Element** die Liste der Funktionen angezeigt, die Sie in einen Ausdruck einschließen.</span><span class="sxs-lookup"><span data-stu-id="319c4-125">When you expand **Common Functions** and click a category, the **Item** pane displays the list of functions that you include in an expression.</span></span> <span data-ttu-id="319c4-126">Die allgemeinen Funktionen umfassen Klassen aus den [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] <xref:System.Math> <xref:System.Convert> Namespaces und und [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] Lauf Zeit Bibliotheksfunktionen.</span><span class="sxs-lookup"><span data-stu-id="319c4-126">The common functions include classes from the [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] <xref:System.Math> and <xref:System.Convert> namespaces and [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] run-time library functions.</span></span> <span data-ttu-id="319c4-127">Die gängigsten Funktionen sind im Dialogfeld **Ausdruck** nach Kategorie sortiert aufgeführt: Text, Datum und Uhrzeit, Mathematische Funktionen, Qualitätskontrolle, Programmfluss, Aggregat, Finanzen, Konvertierung und Sonstiges.</span><span class="sxs-lookup"><span data-stu-id="319c4-127">For convenience, you can view the most commonly used functions in the **Expression** dialog box, where they are listed by category: Text, Date and Time, Math, Inspection, Program Flow, Aggregate, Financial, Conversion, and Miscellaneous.</span></span> <span data-ttu-id="319c4-128">Weniger häufig verwendete Funktionen werden nicht in der Liste angezeigt, können jedoch auch in einem Ausdruck verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="319c4-128">Less commonly used functions do not appear in the list but can still be used in an expression.</span></span>  
  
 <span data-ttu-id="319c4-129">Um eine integrierte Funktion zu verwenden, doppelklicken Sie auf den Funktionsnamen im Bereich Element.</span><span class="sxs-lookup"><span data-stu-id="319c4-129">To use a built-in function, double-click the function name in the Item pane.</span></span> <span data-ttu-id="319c4-130">Im Bereich Beschreibung wird eine Beschreibung der Funktion angezeigt, und ein Beispiel des Funktionsaufrufs finden Sie im Bereich Beispiel.</span><span class="sxs-lookup"><span data-stu-id="319c4-130">A description of the function appears in the Description pane and an example of the function call appears in the Example pane.</span></span> <span data-ttu-id="319c4-131">Wenn Sie im Code Bereich den Funktionsnamen gefolgt von einer linken Klammer **(**) eingeben, zeigt die IntelliSense-Hilfe jede gültige Syntax für den Funktionsbefehl an.</span><span class="sxs-lookup"><span data-stu-id="319c4-131">In the code pane, when you type the function name followed by a left parenthesis **(**, the IntelliSense help displays each valid syntax for the function call.</span></span> <span data-ttu-id="319c4-132">Zur Berechnung des Höchstwerts für ein Feld mit dem Namen `Quantity` in einer Tabelle fügen Sie dem Codebereich beispielsweise den einfachen Ausdruck `=Max(` hinzu und zeigen mithilfe der Smarttags alle gültigen Syntaxmöglichkeiten für den Funktionsaufruf an.</span><span class="sxs-lookup"><span data-stu-id="319c4-132">For example, to calculate the maximum value for a field named `Quantity` in a table, add the simple expression `=Max(` to the Code pane, and then use the smart tags to view all possible valid syntaxes for the function call.</span></span> <span data-ttu-id="319c4-133">Um dieses Beispiel zu vervollständigen, geben Sie `=Max(Fields!Quantity.Value)`ein.</span><span class="sxs-lookup"><span data-stu-id="319c4-133">To complete this example, type `=Max(Fields!Quantity.Value)`.</span></span>  
  
 <span data-ttu-id="319c4-134">Weitere Informationen zu den einzelnen Funktionen finden Sie unter <xref:System.Math>, <xref:System.Convert>und [Member der Visual Basic-Laufzeitbibliothek](https://go.microsoft.com/fwlink/?LinkId=198941) bei MSDN.</span><span class="sxs-lookup"><span data-stu-id="319c4-134">For more information about each function, see <xref:System.Math>, <xref:System.Convert>, and [Visual Basic Runtime Library Members](https://go.microsoft.com/fwlink/?LinkId=198941) on MSDN.</span></span>  
  
##  <a name="including-references-to-less-commonly-used-functions"></a><a name="NotCommon"></a><span data-ttu-id="319c4-135">Einschließen von Verweisen auf weniger häufig verwendete Funktionen</span><span class="sxs-lookup"><span data-stu-id="319c4-135">Including References to Less Commonly Used Functions</span></span>  
 <span data-ttu-id="319c4-136">Um einen Verweis auf andere, weniger häufig verwendete CLR-Namespaces (Common Language Runtime) einzuschließen, verwenden Sie einen vollqualifizierten Verweis, z.B. <xref:System.Text.StringBuilder>.</span><span class="sxs-lookup"><span data-stu-id="319c4-136">To include a reference to other less commonly used CLR namespaces, you must use a fully qualified reference, for example, <xref:System.Text.StringBuilder>.</span></span> <span data-ttu-id="319c4-137">IntelliSense wird für die seltener verwendeten Funktionen im Codebereich des Dialogfelds **Ausdruck** nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="319c4-137">IntelliSense is not supported in the code pane of the **Expression** dialog box for these less commonly used functions.</span></span>  
  
 <span data-ttu-id="319c4-138">Weitere Informationen finden Sie unter [Member der Visual Basic-Laufzeitbibliothek](https://go.microsoft.com/fwlink/?LinkId=198941) bei MSDN.</span><span class="sxs-lookup"><span data-stu-id="319c4-138">For more information, see [Visual Basic Runtime Library Members](https://go.microsoft.com/fwlink/?LinkId=198941) on MSDN.</span></span>  
  
##  <a name="including-references-to-external-assemblies"></a><a name="External"></a><span data-ttu-id="319c4-139">Einschließen von Verweisen auf externe Assemblys</span><span class="sxs-lookup"><span data-stu-id="319c4-139">Including References to External Assemblies</span></span>  
 <span data-ttu-id="319c4-140">Sie müssen die Assembly identifizieren, damit der Berichtsprozessor einen Verweis auf eine Klasse in eine externe Assembly einschließt.</span><span class="sxs-lookup"><span data-stu-id="319c4-140">To include a reference to a class in an external assembly, you must identify the assembly for the report processor.</span></span> <span data-ttu-id="319c4-141">Geben Sie den vollqualifizierten Namen der Assembly, die dem Bericht hinzugefügt werden soll, auf der Seite **Verweise** des Dialogfelds **Berichtseigenschaften** an.</span><span class="sxs-lookup"><span data-stu-id="319c4-141">Use the **References** page of the **Report Properties** dialog box to specify the fully qualified name of the assembly to add to the report.</span></span> <span data-ttu-id="319c4-142">Im Ausdruck müssen Sie den vollqualifizierten Namen für die Klasse in der Assembly verwenden.</span><span class="sxs-lookup"><span data-stu-id="319c4-142">In your expression, you must use the fully qualified name for the class in the assembly.</span></span> <span data-ttu-id="319c4-143">Klassen in einer externen Assembly werden nicht im Dialogfeld **Ausdruck** angezeigt. Geben Sie für diese Klassen den entsprechenden Namen an.</span><span class="sxs-lookup"><span data-stu-id="319c4-143">Classes in an external assembly do not appear in the **Expression** dialog box; you must provide the correct name for the class.</span></span> <span data-ttu-id="319c4-144">Ein vollqualifizierter Name umfasst den Namespace, den Klassennamen und den Elementnamen.</span><span class="sxs-lookup"><span data-stu-id="319c4-144">A fully qualified name includes the namespace, the class name, and the member name.</span></span>  
  
##  <a name="including-embedded-code"></a><a name="Embedded"></a><span data-ttu-id="319c4-145">Einschließen von eingebettetem Code</span><span class="sxs-lookup"><span data-stu-id="319c4-145">Including Embedded Code</span></span>  
 <span data-ttu-id="319c4-146">Auf der Registerkarte **Code** des Dialogfelds Berichtseigenschaften können Sie einem Bericht eingebetteten Code hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="319c4-146">To add embedded code to a report, use the Code tab of the **Report Properties** dialog box.</span></span> <span data-ttu-id="319c4-147">Der erstellte Codeblock kann mehrere Methoden enthalten.</span><span class="sxs-lookup"><span data-stu-id="319c4-147">The code block you create can contain multiple methods.</span></span> <span data-ttu-id="319c4-148">Methoden in eingebettetem Code müssen in geschrieben [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] und instanzbasiert sein.</span><span class="sxs-lookup"><span data-stu-id="319c4-148">Methods in embedded code must be written in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] and must be instance-based.</span></span> <span data-ttu-id="319c4-149">Vom Berichtsprozessor werden automatisch Verweise für den System.Convert-Namespace und den System.Math-Namespace hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="319c4-149">The report processor automatically adds references for the System.Convert and System.Math namespaces.</span></span> <span data-ttu-id="319c4-150">Fügen Sie zusätzliche Assemblyverweise auf der Seite **Verweise** des Dialogfelds **Berichtseigenschaften** hinzu.</span><span class="sxs-lookup"><span data-stu-id="319c4-150">Use the **References** page of the **Report Properties** dialog box to add additional assembly references.</span></span> <span data-ttu-id="319c4-151">Weitere Informationen finden Sie unter [Hinzufügen eines Assemblyverweises zu einem Bericht &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="319c4-151">For more information, see [Add an Assembly Reference to a Report &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md).</span></span>  
  
 <span data-ttu-id="319c4-152">Die Methoden im eingebetteten Code stehen über ein global definiertes `Code`-Element zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="319c4-152">Methods in embedded code are available through a globally defined `Code` member.</span></span> <span data-ttu-id="319c4-153">Zum Zugriff auf die Methoden verweisen Sie auf das `Code`-Element und den Methodennamen.</span><span class="sxs-lookup"><span data-stu-id="319c4-153">You access these by referring to the `Code` member and the method name.</span></span> <span data-ttu-id="319c4-154">Im folgenden Beispiel wird die Methode `ToUSD` aufgerufen, die den Wert des `StandardCost`-Felds in einen Dollarwert konvertiert:</span><span class="sxs-lookup"><span data-stu-id="319c4-154">The following example calls the method `ToUSD`, which converts the value in the `StandardCost` field to a dollar value:</span></span>  
  
```  
=Code.ToUSD(Fields!StandardCost.Value)  
```  
  
 <span data-ttu-id="319c4-155">Wenn Sie in Ihrem benutzerdefinierten Code auf integrierte Auflistungen verweisen möchten, nehmen Sie in das integrierte `Report`-Objekt einen Verweis auf.</span><span class="sxs-lookup"><span data-stu-id="319c4-155">To reference built-in collections in your custom code, include a reference to the built-in `Report` object:</span></span>  
  
```  
=Report.Parameters!Param1.Value  
```  
  
 <span data-ttu-id="319c4-156">In den folgenden Beispielen wird veranschaulicht, wie einige benutzerdefinierte Konstanten und Variablen definiert werden können.</span><span class="sxs-lookup"><span data-stu-id="319c4-156">The following examples show how to define some custom constants and variables.</span></span>  
  
```  
Public Const MyNote = "Authored by Bob"  
Public Const NCopies As Int32 = 2  
Public Dim  MyVersion As String = "123.456"  
Public Dim MyDoubleVersion As Double = 123.456  
```  
  
 <span data-ttu-id="319c4-157">Obwohl benutzerdefinierte Konstanten nicht in der **Konstanten** -Kategorie des Dialogfelds **Ausdruck** angezeigt werden (in der nur integrierte Konstanten angezeigt werden), können Sie Verweise darauf über einen beliebigen Ausdruck hinzufügen (wie in den folgenden Beispielen veranschaulicht).</span><span class="sxs-lookup"><span data-stu-id="319c4-157">Although custom constants do not appear in the **Constants** category in the **Expression** dialog box (which only displays built-in constants), you can add references to them from any expression, as shown in the following examples.</span></span> <span data-ttu-id="319c4-158">In einem Ausdruck wird eine benutzerdefinierte Konstante als `Variant` behandelt.</span><span class="sxs-lookup"><span data-stu-id="319c4-158">In an expression, a custom constant is treated as a `Variant`.</span></span>  
  
```  
=Code.MyNote  
=Code.NCopies  
=Code.MyVersion  
=Code.MyDoubleVersion  
```  
  
 <span data-ttu-id="319c4-159">In den folgenden Beispielen sind sowohl der Codeverweis als auch die Codeimplementierung der Funktion `FixSpelling` enthalten, mit der der Text "`"Bicycle"` für alle Vorkommen des Texts "Bike" im `SubCategory`-Feld ersetzt wird.</span><span class="sxs-lookup"><span data-stu-id="319c4-159">The following example includes both the code reference and the code implementation of the function `FixSpelling`, which substitutes the text `"Bicycle"` for all occurrences of the text "Bike" in the `SubCategory` field.</span></span>  
  
 `=Code.FixSpelling(Fields!SubCategory.Value)`  
  
 <span data-ttu-id="319c4-160">Mit dem folgenden Code wird eine Implementierung der `FixSpelling`-Methode veranschaulicht, wenn er in den Codeblock einer Berichtsdefinition eingebettet ist.</span><span class="sxs-lookup"><span data-stu-id="319c4-160">The following code, when embedded in a report definition code block, shows an implementation of the `FixSpelling` method.</span></span> <span data-ttu-id="319c4-161">In diesem Beispiel wird gezeigt, wie ein voll qualifizierter Verweis auf die-Klasse verwendet wird [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] `StringBuilder` .</span><span class="sxs-lookup"><span data-stu-id="319c4-161">This example shows you how to use a fully qualified reference to the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] `StringBuilder` class.</span></span>  
  
```vb  
Public Function FixSpelling(ByVal s As String) As String  
   Dim strBuilder As New System.Text.StringBuilder(s)  
   If s.Contains("Bike") Then  
      strBuilder.Replace("Bike", "Bicycle")  
      Return strBuilder.ToString()  
      Else : Return s  
   End If  
End Function  
```  
  
 <span data-ttu-id="319c4-162">Weitere Informationen zu integrierten Objektsammlungen und die Initialisierung finden Sie unter [Integrierte globale Werte und Benutzerverweise &#40;Berichts-Generator und SSRS&#41;](built-in-collections-built-in-globals-and-users-references-report-builder.md) und [Initialisieren von Objekten benutzerdefinierter Assemblys](../custom-assemblies/initializing-custom-assembly-objects.md).</span><span class="sxs-lookup"><span data-stu-id="319c4-162">For more information about built-in object collections and initialization, see [Built-in Globals and Users References &#40;Report Builder and SSRS&#41;](built-in-collections-built-in-globals-and-users-references-report-builder.md) and [Initializing Custom Assembly Objects](../custom-assemblies/initializing-custom-assembly-objects.md).</span></span>  
  
##  <a name="including-references-to-parameters-from-code"></a><a name="Parameters"></a><span data-ttu-id="319c4-163">Einschließen von Verweisen auf Parameter aus dem Code</span><span class="sxs-lookup"><span data-stu-id="319c4-163">Including References to Parameters from Code</span></span>  
 <span data-ttu-id="319c4-164">Sie können auf die globale Parameters-Auflistung per benutzerdefinierten Code über einen Codeblock der Berichtsdefinition oder über eine von Ihnen bereitgestellte benutzerdefinierte Assembly verweisen.</span><span class="sxs-lookup"><span data-stu-id="319c4-164">You can reference the global parameters collection via custom code in a Code block of the report definition or in a custom assembly that you provide.</span></span> <span data-ttu-id="319c4-165">Die Parameters-Auflistung ist schreibgeschützt und verfügt über keine öffentlichen Iteratoren.</span><span class="sxs-lookup"><span data-stu-id="319c4-165">The parameters collection is read-only and has no public iterators.</span></span> <span data-ttu-id="319c4-166">Sie können kein- [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] `For Each` Konstrukt verwenden, um die Auflistung zu durchlaufen.</span><span class="sxs-lookup"><span data-stu-id="319c4-166">You cannot use a [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] `For Each` construct to step through the collection.</span></span> <span data-ttu-id="319c4-167">Sie benötigen den in der Berichtsdefinition definierten Namen des Parameters, um in Ihrem Code auf ihn verweisen zu können.</span><span class="sxs-lookup"><span data-stu-id="319c4-167">You need to know the name of the parameter defined in the report definition before you can reference it in your code.</span></span> <span data-ttu-id="319c4-168">Allerdings ist es möglich, durch alle Werte eines mehrwertigen Parameters zu iterieren.</span><span class="sxs-lookup"><span data-stu-id="319c4-168">You can, however, iterate through all the values of a multivalue parameter.</span></span>  
  
 <span data-ttu-id="319c4-169">Die folgende Tabelle enthält Beispiele für Verweise auf die integrierte `Parameters` -Sammlung von benutzerdefiniertem Code:</span><span class="sxs-lookup"><span data-stu-id="319c4-169">The following table includes examples of referencing the built-in collection `Parameters` from custom code:</span></span>  
  
|<span data-ttu-id="319c4-170">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="319c4-170">Description</span></span>|<span data-ttu-id="319c4-171">Verweis in Ausdruck</span><span class="sxs-lookup"><span data-stu-id="319c4-171">Reference in Expression</span></span>|<span data-ttu-id="319c4-172">Benutzerdefinierte Codedefinition</span><span class="sxs-lookup"><span data-stu-id="319c4-172">Custom Code definition</span></span>|  
|-----------------|-----------------------------|----------------------------|  
|<span data-ttu-id="319c4-173">Übergeben einer gesamten globalen Parameters-Auflistung an benutzerdefinierten Code.</span><span class="sxs-lookup"><span data-stu-id="319c4-173">Passing an entire global parameter collection to custom code.</span></span><br /><br /> <span data-ttu-id="319c4-174">Diese Funktion gibt den Wert eines bestimmten Berichtsparameters *MyParameter*zurück.</span><span class="sxs-lookup"><span data-stu-id="319c4-174">This function returns the value of a specific report parameter *MyParameter*.</span></span>|`=Code.DisplayAParameterValue(Parameters)`|`Public Function DisplayAParameterValue(`<br /><br /> `ByVal parameters as Parameters) as Object`<br /><br /> `Return parameters("MyParameter").Value`<br /><br /> `End Function`|  
|<span data-ttu-id="319c4-175">Übergeben eines einzelnen Parameters an benutzerdefinierten Code.</span><span class="sxs-lookup"><span data-stu-id="319c4-175">Passing an individual parameter to custom code.</span></span><br /><br /> <span data-ttu-id="319c4-176">In diesem Beispiel wird der Wert des übergebenen Parameters zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="319c4-176">This example returns the value of the parameter passed in.</span></span> <span data-ttu-id="319c4-177">Entspricht der Parameter einem mehrwertigen Parameter, ist die Rückgabezeichenfolge eine Verkettung aller Werte.</span><span class="sxs-lookup"><span data-stu-id="319c4-177">If the parameter is a multivalue parameter, the return string is a concatenation of all the values.</span></span>|`=Code.ShowParametersValues(Parameters!DayOfTheWeek)`|`Public Function ShowParameterValues(ByVal parameter as Parameter)` <br />  `as String` <br /> `Dim s as String`  <br />  `If parameter.IsMultiValue then` <br />  `s = "Multivalue: "`  <br /> `For i as integer = 0 to parameter.Count-1` <br />  `s = s + CStr(parameter.Value(i)) + " "`  <br />  `Next` <br /> `Else` <br /> `s = "Single value: " + CStr(parameter.Value)` <br /> `End If` <br />  `Return s` <br /> `End Function`|  
  
##  <a name="including-references-to-code-from-custom-assemblies"></a><a name="Custom"></a><span data-ttu-id="319c4-178">Einschließen von Verweisen auf Code von benutzerdefinierten Assemblys</span><span class="sxs-lookup"><span data-stu-id="319c4-178">Including References to Code from Custom Assemblies</span></span>  
 <span data-ttu-id="319c4-179">Wenn Sie in einem Bericht benutzerdefinierte Assemblys verwenden möchten, müssen Sie zunächst die Assembly erstellen und für den Berichts-Designer zur Verfügung stellen. Anschließend fügen Sie im Bericht einen Verweis auf die Assembly hinzu und verwenden dann im Bericht einen Ausdruck, der auf die Methoden in dieser Assembly verweist.</span><span class="sxs-lookup"><span data-stu-id="319c4-179">To use custom assemblies in a report, you must first create the assembly, make it available to Report Designer, add a reference to the assembly in the report, and then use an expression in the report to refer to the methods contained in that assembly.</span></span> <span data-ttu-id="319c4-180">Beim Bereitstellen des Berichts auf dem Berichtsserver müssen Sie dort auch die benutzerdefinierte Assembly bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="319c4-180">When the report is deployed to the report server, you must also deploy the custom assembly to the report server.</span></span>  
  
 <span data-ttu-id="319c4-181">Informationen zum Erstellen einer benutzerdefinierten Assembly und zu ihrer Verwendung in [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]finden Sie unter [Verwenden benutzerdefinierter Assemblys mit Berichten](../custom-assemblies/using-custom-assemblies-with-reports.md).</span><span class="sxs-lookup"><span data-stu-id="319c4-181">For information about creating a custom assembly and making it available to [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], see [Using Custom Assemblies with Reports](../custom-assemblies/using-custom-assemblies-with-reports.md).</span></span>  
  
 <span data-ttu-id="319c4-182">Wenn Sie in einem Ausdruck auf benutzerdefinierten Code verweisen möchten, müssen Sie das Klassenelement in der Assembly aufrufen.</span><span class="sxs-lookup"><span data-stu-id="319c4-182">To refer to custom code in an expression, you must call the member of a class within the assembly.</span></span> <span data-ttu-id="319c4-183">Die Vorgehensweise hängt davon ab, ob es sich um eine statische oder um eine instanzbasierte Methode handelt.</span><span class="sxs-lookup"><span data-stu-id="319c4-183">How you do this depends on whether the method is static or instance-based.</span></span> <span data-ttu-id="319c4-184">Statische Methoden in einer benutzerdefinierten Assembly stehen global im Bericht zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="319c4-184">Static methods within a custom assembly are available globally within the report.</span></span> <span data-ttu-id="319c4-185">Auf statische Methoden können Sie in Ausdrücken durch Angeben des Namespace, der Klasse und des Methodennamens zugreifen.</span><span class="sxs-lookup"><span data-stu-id="319c4-185">You can access static methods in expressions by specifying the namespace, class, and method name.</span></span> <span data-ttu-id="319c4-186">Im folgenden Beispiel wird die-Methode aufgerufen `ToGBP` , die den Wert des **StandardCost** -Werts von Dollar in Pfund Sterling konvertiert:</span><span class="sxs-lookup"><span data-stu-id="319c4-186">The following example calls the method `ToGBP`, which converts the value of the **StandardCost** value from dollar to pounds sterling:</span></span>  
  
```  
=CurrencyConversion.DollarCurrencyConversion.ToGBP(Fields!StandardCost.Value)  
```  
  
 <span data-ttu-id="319c4-187">Instanzbasierte Methoden sind über ein global definiertes `Code`-Element verfügbar.</span><span class="sxs-lookup"><span data-stu-id="319c4-187">Instance-based methods are available through a globally defined `Code` member.</span></span> <span data-ttu-id="319c4-188">Zum Zugriff auf die Methoden verweisen Sie auf das `Code`-Element und anschließend auf die Instanz und den Methodennamen.</span><span class="sxs-lookup"><span data-stu-id="319c4-188">You access these by referring to the `Code` member, followed by the instance and method name.</span></span> <span data-ttu-id="319c4-189">Im folgenden Beispiel wird die-Instanzmethode aufgerufen `ToEUR` , die den Wert von **StandardCost** von Dollar in Euro konvertiert:</span><span class="sxs-lookup"><span data-stu-id="319c4-189">The following example calls the instance method `ToEUR`, which converts the value of **StandardCost** from dollar to euro:</span></span>  
  
```  
=Code.m_myDollarCoversion.ToEUR(Fields!StandardCost.Value)  
```  
  
> [!NOTE]  
>  <span data-ttu-id="319c4-190">Im Berichts-Designer wird eine benutzerdefinierte Assembly einmal geladen und erst beim Schließen von [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)]entladen.</span><span class="sxs-lookup"><span data-stu-id="319c4-190">In Report Designer, a custom assembly is loaded once and is not unloaded until you close [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)].</span></span> <span data-ttu-id="319c4-191">Wenn Sie einen Bericht in der Vorschau anzeigen, dann Änderungen an einer im Bericht verwendeten benutzerdefinierten Assembly vornehmen und anschließend die Vorschau des Berichts erneut anzeigen, werden diese Änderungen in der zweiten Vorschau nicht angezeigt.</span><span class="sxs-lookup"><span data-stu-id="319c4-191">If you preview a report, make changes to a custom assembly used in the report, and then preview the report again, the changes will not appear in the second preview.</span></span> <span data-ttu-id="319c4-192">Zum erneuten Laden der Assembly müssen Sie [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] schließen und neu öffnen und dann die Vorschau des Berichts anzeigen.</span><span class="sxs-lookup"><span data-stu-id="319c4-192">To reload the assembly, close and reopen [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] and then preview the report.</span></span>  
  
 <span data-ttu-id="319c4-193">Weitere Informationen zum Zugreifen auf Ihren Code finden Sie unter [Accessing Custom Assemblies Through Expressions](../custom-assemblies/accessing-custom-assemblies-through-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="319c4-193">For more information about accessing your code, see [Accessing Custom Assemblies Through Expressions](../custom-assemblies/accessing-custom-assemblies-through-expressions.md).</span></span>  
  
##  <a name="passing-built-in-collections-into-custom-assemblies"></a><a name="collections"></a><span data-ttu-id="319c4-194">Übergeben integrierter Auflistungen in benutzerdefinierte Assemblys</span><span class="sxs-lookup"><span data-stu-id="319c4-194">Passing Built-in Collections into Custom Assemblies</span></span>  
 <span data-ttu-id="319c4-195">Um integrierte Sammlungen wie die *Globals* - oder *Parameters* -Sammlung zur Verarbeitung an eine benutzerdefinierte Assembly zu übergeben, fügen Sie einen Assemblyverweis im Codeprojekt der Assembly hinzu, die die integrierten Auflistungen definiert, und greifen Sie auf den korrekten Namespace zu.</span><span class="sxs-lookup"><span data-stu-id="319c4-195">If you want to pass built-in collections, such as the *Globals* or *Parameters* collection, into a custom assembly for processing, you must add an assembly reference in your code project to the assembly that defines the built-in collections and access the correct namespace.</span></span> <span data-ttu-id="319c4-196">Abhängig davon, ob Sie die benutzerdefinierte Assembly für einen auf einem Berichtsserver ausgeführten Bericht (Serverbericht) oder einen in einer .NET-Anwendung lokal ausgeführten Bericht (lokaler Bericht) entwickeln, unterscheidet sich jeweils die zu referenzierende Assembly.</span><span class="sxs-lookup"><span data-stu-id="319c4-196">Depending on whether you are developing the custom assembly for a report that is run on a report server (server report) or a report that is run locally in a .NET application (local report), the assembly you need to reference is different.</span></span> <span data-ttu-id="319c4-197">Weitere Informationen siehe unten.</span><span class="sxs-lookup"><span data-stu-id="319c4-197">See below for details.</span></span>  
  
-   <span data-ttu-id="319c4-198">**Namespace** : Microsoft.ReportingServices.ReportProcessing.ReportObjectModel</span><span class="sxs-lookup"><span data-stu-id="319c4-198">**Namespace:** Microsoft.ReportingServices.ReportProcessing.ReportObjectModel</span></span>  
  
-   <span data-ttu-id="319c4-199">**Assembly (lokaler Bericht):** Microsoft.ReportingServices.ProcessingObjectModel.dll</span><span class="sxs-lookup"><span data-stu-id="319c4-199">**Assembly (local report):** Microsoft.ReportingServices.ProcessingObjectModel.dll</span></span>  
  
-   <span data-ttu-id="319c4-200">**Assembly (Serverbericht):** Microsoft.ReportViewer.ProcessingObjectModel.dll</span><span class="sxs-lookup"><span data-stu-id="319c4-200">**Assembly (server report):** Microsoft.ReportViewer.ProcessingObjectModel.dll</span></span>  
  
 <span data-ttu-id="319c4-201">Da sich der Inhalt der *Fields* - und *ReportItems* -Sammlung zur Laufzeit dynamisch ändern kann, sollten Sie über die Aufrufe in der benutzerdefinierten Assembly hinaus nicht daran festhalten (z.B. in einer Elementvariablen).</span><span class="sxs-lookup"><span data-stu-id="319c4-201">Since the content of the *Fields* and *ReportItems* collections can change dynamically at runtime, you should not hold onto them across calls into the custom assembly (for example, in a member variable).</span></span> <span data-ttu-id="319c4-202">Die gleiche Empfehlung gilt im Allgemeinen für alle integrierten Auflistungen.</span><span class="sxs-lookup"><span data-stu-id="319c4-202">The same recommendation applies generally to all built-in collections.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="319c4-203">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="319c4-203">See Also</span></span>  
 <span data-ttu-id="319c4-204">[Hinzufügen von Code zu einem Bericht &#40;SSRS&#41;](add-code-to-a-report-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="319c4-204">[Add Code to a Report &#40;SSRS&#41;](add-code-to-a-report-ssrs.md) </span></span>  
 <span data-ttu-id="319c4-205">[Verwenden benutzerdefinierter Assemblys mit Berichten](../custom-assemblies/using-custom-assemblies-with-reports.md) </span><span class="sxs-lookup"><span data-stu-id="319c4-205">[Using Custom Assemblies with Reports](../custom-assemblies/using-custom-assemblies-with-reports.md) </span></span>  
 <span data-ttu-id="319c4-206">[Hinzufügen eines Assemblyverweises zu einem Bericht &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="319c4-206">[Add an Assembly Reference to a Report &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md) </span></span>  
 <span data-ttu-id="319c4-207">[Reporting Services Tutorials &#40;SSRS&#41;](../reporting-services-tutorials-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="319c4-207">[Reporting Services Tutorials &#40;SSRS&#41;](../reporting-services-tutorials-ssrs.md) </span></span>  
 <span data-ttu-id="319c4-208">[Beispiele für Ausdrücke &#40;Berichts-Generator und SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="319c4-208">[Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="319c4-209">Berichtsbeispiele (Berichts-Generator und SSRS)</span><span class="sxs-lookup"><span data-stu-id="319c4-209">Report Samples (Report Builder and SSRS)</span></span>](https://go.microsoft.com/fwlink/?LinkId=198283)  
  
  

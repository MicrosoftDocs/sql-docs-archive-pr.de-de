---
title: Verweise auf Datasetfeldauflistungen (Berichts-Generator und SSRS) | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 006c6bd3-d776-4c20-9092-32e40688ac49
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 9e4140c35f8035e3ac8fae37aefb9d7f2afcaecc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87621378"
---
# <a name="dataset-fields-collection-references-report-builder-and-ssrs"></a><span data-ttu-id="07768-102">Verweise auf Datasetfeldauflistungen (Berichts-Generator und SSRS)</span><span class="sxs-lookup"><span data-stu-id="07768-102">Dataset Fields Collection References (Report Builder and SSRS)</span></span>
  <span data-ttu-id="07768-103">Jedes Dataset in einem Bericht enthält eine Fields-Sammlung.</span><span class="sxs-lookup"><span data-stu-id="07768-103">Each dataset in a report contains one Fields collection.</span></span> <span data-ttu-id="07768-104">Bei der Fields-Sammlung handelt es sich um eine Gruppe von Feldern, die von der Datasetabfrage und zusätzlichen berechneten Feldern angegeben werden, die Sie erstellen.</span><span class="sxs-lookup"><span data-stu-id="07768-104">The Fields collection is the set of fields specified by the dataset query plus any additional calculated fields that you create.</span></span> <span data-ttu-id="07768-105">Nachdem Sie ein Dataset erstellt haben, wird die Feldauflistung im **Berichtsdatenbereich** angezeigt.</span><span class="sxs-lookup"><span data-stu-id="07768-105">After you create a dataset, the field collection appears in the **Report Data** pane.</span></span>  
  
 <span data-ttu-id="07768-106">Ein einfacher Feldverweis in einem Ausdruck wird auf der Entwurfsoberfläche als einfacher Ausdruck angezeigt.</span><span class="sxs-lookup"><span data-stu-id="07768-106">A simple field reference in an expression displays on the design surface as a simple expression.</span></span> <span data-ttu-id="07768-107">Wenn Sie zum Beispiel das Feld `Sales` aus dem Bereich Berichtsdaten in eine Tabellenzelle der Entwurfsoberfläche ziehen, wird `[Sales]` angezeigt.</span><span class="sxs-lookup"><span data-stu-id="07768-107">For example, when you drag the field `Sales` from the Report Data pane to a table cell on the design surface, `[Sales]` is displayed.</span></span> <span data-ttu-id="07768-108">Dies ist der zugrunde liegende Ausdruck `=Fields!Sales.Value` , der in der Value-Eigenschaft des Textfelds festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="07768-108">This represents the underlying expression `=Fields!Sales.Value` that is set on the text box Value property.</span></span> <span data-ttu-id="07768-109">Wenn der Bericht ausgeführt wird, wertet der Berichtsprozessor diesen Ausdruck aus und zeigt die eigentlichen Daten der Datenquelle in der Tabellenzelle im Textfeld an.</span><span class="sxs-lookup"><span data-stu-id="07768-109">When the report runs, the report processor evaluates this expression and displays the actual data from the data source in the text box in the table cell.</span></span> <span data-ttu-id="07768-110">Weitere Informationen finden Sie unter [Ausdrücke (Berichts-Generator und SSRS)](expressions-report-builder-and-ssrs.md) und [Datasetfeldauflistung (Berichts-Generator und SSRS)](../report-data/dataset-fields-collection-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="07768-110">For more, see [Expressions &#40;Report Builder and SSRS&#41;](expressions-report-builder-and-ssrs.md) and [Dataset Fields Collection &#40;Report Builder and SSRS&#41;](../report-data/dataset-fields-collection-report-builder-and-ssrs.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="displaying-the-field-collection-for-a-dataset"></a><span data-ttu-id="07768-111">Anzeigen der Feldauflistung für ein Dataset</span><span class="sxs-lookup"><span data-stu-id="07768-111">Displaying the Field Collection for a Dataset</span></span>  
 <span data-ttu-id="07768-112">Ziehen Sie die Felder einzeln in eine Tabellendetailzeile, um die jeweiligen Werte für eine Feldauflistung anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="07768-112">To display the individual values for a field collection, drag each field to a table detail row and run the report.</span></span> <span data-ttu-id="07768-113">Die Verweise aus der Detailzeile eines Tabellen- oder Listendatenbereichs zeigen für jede Zeile im Dataset einen Wert an.</span><span class="sxs-lookup"><span data-stu-id="07768-113">References from the detail row of a table or list data region display a value for each row in the dataset.</span></span>  
  
 <span data-ttu-id="07768-114">Um zusammengefasste Werte für ein Feld anzuzeigen, ziehen Sie die einzelnen numerischen Felder in den Datenbereich einer Matrix.</span><span class="sxs-lookup"><span data-stu-id="07768-114">To display summarized values for a field, drag each numeric field to the data area of a matrix.</span></span> <span data-ttu-id="07768-115">Die Standardaggregatfunktion für die gesamte Zeile ist Sum, zum Beispiel `=Sum(Fields!Sales.Value)`.</span><span class="sxs-lookup"><span data-stu-id="07768-115">The default aggregate function for the total row is Sum, for example, `=Sum(Fields!Sales.Value)`.</span></span> <span data-ttu-id="07768-116">Sie können die Standardfunktion ändern, um andere Gesamtbeträge zu berechnen.</span><span class="sxs-lookup"><span data-stu-id="07768-116">You can change the default function in order to calculate different totals.</span></span> <span data-ttu-id="07768-117">Weitere Informationen finden Sie unter [Aggregatfunktionsreferenz &#40;Berichts-Generator und SSRS&#41;](report-builder-functions-aggregate-functions-reference.md).</span><span class="sxs-lookup"><span data-stu-id="07768-117">For more information, see [Aggregate Functions Reference &#40;Report Builder and SSRS&#41;](report-builder-functions-aggregate-functions-reference.md).</span></span>  
  
 <span data-ttu-id="07768-118">Sie müssen den Datasetnamen als Bereich für die Aggregatfunktion angeben, um die zusammengefassten Werte für eine Feldauflistung in einem Textfeld direkt auf der Entwurfsoberfläche anzuzeigen (ist nicht Teil eines Datenbereichs).</span><span class="sxs-lookup"><span data-stu-id="07768-118">To display summarized values for a field collection in a text box directly on the design surface (not part of a data region), you must specify the dataset name as a scope for the aggregate function.</span></span> <span data-ttu-id="07768-119">Für ein Dataset mit dem Namen `SalesData`gibt der folgende Ausdruck den Gesamtbetrag aller Werte für das Feld `Sales`an: `=Sum(Fields!Sales,"SalesData")`.</span><span class="sxs-lookup"><span data-stu-id="07768-119">For example, for a dataset named `SalesData`, the following expression specifies the total of all values for the field `Sales`: `=Sum(Fields!Sales,"SalesData")`.</span></span>  
  
 <span data-ttu-id="07768-120">Wenn Sie das Dialogfeld **Ausdruck** zum Definieren eines einfachen Feldverweises verwenden, können Sie die Fields-Sammlung im Bereich „Kategorie“ auswählen, um die Liste der verfügbaren Felder im Bereich **Feld** anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="07768-120">When you use the **Expression** dialog box to define a simple field reference, you can select the Fields collection in the Category pane and see the list of available fields in the **Field** pane.</span></span> <span data-ttu-id="07768-121">Jedes Feld verfügt über mehrere Eigenschaften, zum Beispiel Value und IsMissing.</span><span class="sxs-lookup"><span data-stu-id="07768-121">Each field has several properties, including Value and IsMissing.</span></span> <span data-ttu-id="07768-122">Bei den restlichen Eigenschaften handelt es sich um vordefinierte erweiterte Feldeigenschaften, die je nach Datenquellentyp für das Dataset verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="07768-122">The remaining properties are predefined extended field properties that may be available to the dataset depending on the data source type.</span></span>  
  
### <a name="detecting-nulls-for-a-dataset-field"></a><span data-ttu-id="07768-123">Erkennen von Nullen für ein Datasetfeld</span><span class="sxs-lookup"><span data-stu-id="07768-123">Detecting Nulls for a Dataset Field</span></span>  
 <span data-ttu-id="07768-124">Um einen Feldwert zu erkennen, der NULL (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]) ist, können Sie die Funktion `IsNothing` verwenden.</span><span class="sxs-lookup"><span data-stu-id="07768-124">To detect a field value that is null (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]), you can use the function `IsNothing`.</span></span> <span data-ttu-id="07768-125">Wenn der folgende Ausdruck in einem Textfeld in eine Tabellendetailzeile eingefügt wird, prüft dieser das Feld `MiddleName` und ersetzt den Text "No Middle Name", wenn der Wert NULL ist, und den Feldwert selbst, wenn der Wert nicht NULL ist:</span><span class="sxs-lookup"><span data-stu-id="07768-125">When placed in a text box in a table details row, the following expression tests the field `MiddleName` and substitutes the text "No Middle Name" when the value is null, and the field value itself when the value is not null:</span></span>  
  
 `=IIF(IsNothing(Fields!MiddleName.Value),"No Middle Name",Fields!MiddleName.Value)`  
  
### <a name="detecting-missing-fields-for-dynamic-queries-at-run-time"></a><span data-ttu-id="07768-126">Erkennen von fehlenden Feldern für dynamische Abfragen zur Laufzeit</span><span class="sxs-lookup"><span data-stu-id="07768-126">Detecting Missing Fields for Dynamic Queries at Run Time</span></span>  
 <span data-ttu-id="07768-127">Elemente in der Fields-Sammlung besitzen in der Standardeinstellung zwei Eigenschaften: Value und IsMissing.</span><span class="sxs-lookup"><span data-stu-id="07768-127">By default, items in the Fields collection have two properties: Value and IsMissing.</span></span> <span data-ttu-id="07768-128">Mit der IsMissing-Eigenschaft wird angegeben, ob ein zur Entwurfszeit für ein Dataset definiertes Feld in den Feldern enthalten ist, die zur Laufzeit abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="07768-128">The IsMissing property indicates whether a field that is defined for a dataset at design time is contained in the fields retrieved at run time.</span></span> <span data-ttu-id="07768-129">Beispielsweise kann die Abfrage eine gespeicherte Prozedur aufrufen, bei der das Resultset mit einem Eingabeparameter variiert, oder die Abfrage, in `SELECT * FROM` *\<table>* der sich die Tabellendefinition geändert hat.</span><span class="sxs-lookup"><span data-stu-id="07768-129">For example, your query might call a stored procedure in which the result set varies with an input parameter, or your query might be `SELECT * FROM` *\<table>* where the table definition changed.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="07768-130">IsMissing erkennt für alle Datenquellentypen Änderungen des Datasetschemas zwischen Entwurfs- und Laufzeit.</span><span class="sxs-lookup"><span data-stu-id="07768-130">IsMissing detects changes in the dataset schema between design time and run time for any type of data source.</span></span> <span data-ttu-id="07768-131">"IsMissing" kann nicht verwendet werden, um leere Member in einem mehrdimensionalen Cube zu erkennen, und ist nicht mit den Konzepten von und der MDX-Abfragesprache verknüpft `EMPTY` `NON EMPTY` .</span><span class="sxs-lookup"><span data-stu-id="07768-131">IsMissing cannot be used to detect empty members in a multidimensional cube and is not related to the MDX query language concepts of `EMPTY` and `NON EMPTY`.</span></span>  
  
 <span data-ttu-id="07768-132">Sie können die IsMissing-Eigenschaft in benutzerdefiniertem Code testen, um zu ermitteln, ob ein Feld im Resultset vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="07768-132">You can test the IsMissing property in custom code to determine if a field is present in the result set.</span></span> <span data-ttu-id="07768-133">Für diesen Test können Sie keinen Ausdruck mit einem [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]-Funktionsaufruf verwenden, wie `IIF` oder `SWITCH`, weil [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] alle Parameter im Aufruf basierend auf der Funktion auswertet. Dies führt zu einem Fehler, wenn der Verweis auf das fehlende Feld ausgewertet wird.</span><span class="sxs-lookup"><span data-stu-id="07768-133">You cannot test for its presence using an expression with a [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] function call such as `IIF` or `SWITCH`, because [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] evaluates all parameters in the call to the function, which results in an error when the reference to the missing is evaluated.</span></span>  
  
#### <a name="example-for-controlling-the-visibility-of-a-dynamic-column-for-a-missing-field"></a><span data-ttu-id="07768-134">Beispiel für die Steuerung der Sichtbarkeit einer dynamischen Spalte für ein fehlendes Feld</span><span class="sxs-lookup"><span data-stu-id="07768-134">Example for Controlling the Visibility of a Dynamic Column for a Missing Field</span></span>  
 <span data-ttu-id="07768-135">Um einen Ausdruck festzulegen, der die Sichtbarkeit einer Spalte steuert, die ein Feld in einem Dataset anzeigt, führen Sie Folgendes durch: Sie müssen zuerst eine benutzerdefinierte Codefunktion definieren, die einen booleschen Wert basierend darauf zurückgibt, ob das Feld fehlt.</span><span class="sxs-lookup"><span data-stu-id="07768-135">To set an expression that controls the visibility of a column that displays a field in a dataset, you must first define a custom code function that returns a Boolean value based on whether the field is missing.</span></span> <span data-ttu-id="07768-136">Beispielsweise gibt die folgende benutzerdefinierte Codefunktion true zurück, wenn das Feld fehlt, und false, wenn das Feld vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="07768-136">For example, the following custom code function returns true if the field is missing and false if the field exists.</span></span>  
  
```  
Public Function IsFieldMissing(field as Field) as Boolean  
 If (field.IsMissing) Then  
 Return True  
  Else   
  Return False  
 End If  
End Function  
```  
  
 <span data-ttu-id="07768-137">Legen Sie die Hidden-Eigenschaft der Spalte auf den folgenden Ausdruck fest, um diese Funktion zum Steuern der Sichtbarkeit einer Spalte zu verwenden:</span><span class="sxs-lookup"><span data-stu-id="07768-137">To use this function to control visibility of a column, set the Hidden property of the column to the following expression:</span></span>  
  
 `=Code.IsFieldMissing(Fields!FieldName)`  
  
 <span data-ttu-id="07768-138">Die Spalte wird ausgeblendet, wenn das Feld nicht vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="07768-138">The column is hidden when the field does not exist.</span></span>  
  
#### <a name="example-for-controlling-the-text-box-value-for-a-missing-field"></a><span data-ttu-id="07768-139">Beispiel für die Steuerung des Textfeldwerts für ein fehlendes Feld</span><span class="sxs-lookup"><span data-stu-id="07768-139">Example for Controlling the Text Box Value for a Missing Field</span></span>  
 <span data-ttu-id="07768-140">Um Text zu ersetzen, den Sie anstelle des Wertes eines fehlenden Felds schreiben, müssen Sie benutzerdefinierten Code schreiben. Der Code muss Text zurückgeben, den Sie anstelle eines Feldwertes verwenden können, wenn das Feld fehlt.</span><span class="sxs-lookup"><span data-stu-id="07768-140">To substitute text that you write in place of the value of a missing field, you must write custom code that returns text you can use in place of a field value when the field is missing.</span></span> <span data-ttu-id="07768-141">Die folgende benutzerdefinierte Codefunktion gibt den Wert des Felds zurück, wenn das Feld vorhanden ist, und die als zweiten Parameter angegebene Meldung, wenn das Feld nicht vorhanden ist:</span><span class="sxs-lookup"><span data-stu-id="07768-141">For example, the following custom code function returns the value of the field if the field exists, and the message that you specify as the second parameter if the field does not exist:</span></span>  
  
```  
Public Function IsFieldMissingThenString(field as Field, strMessage as String) as String  
 If (field.IsMissing) Then  
  Return strMessage  
 Else   
  Return field.Value  
  End If  
End Function  
```  
  
 <span data-ttu-id="07768-142">Fügen Sie den folgenden Ausdruck der Value-Eigenschaft hinzu, um diese Funktion in einem Textfeld zu verwenden:</span><span class="sxs-lookup"><span data-stu-id="07768-142">To use this function in a text box, add the following expression to the Value property:</span></span>  
  
 `=Code.IsFieldMissingThenString(Fields!FieldName,"Missing")`  
  
 <span data-ttu-id="07768-143">Das Textfeld zeigt entweder den Feldwert oder den Text an, den Sie angegeben haben.</span><span class="sxs-lookup"><span data-stu-id="07768-143">The text box displays either the field value or the text that you specified.</span></span>  
  
### <a name="using-extended-field-properties"></a><span data-ttu-id="07768-144">Verwenden von erweiterten Feldeigenschaften</span><span class="sxs-lookup"><span data-stu-id="07768-144">Using Extended Field Properties</span></span>  
 <span data-ttu-id="07768-145">Bei den erweiterten Feldeigenschaften handelt es sich um zusätzliche Eigenschaften, die für ein Feld über die Datenverarbeitungserweiterung definiert werden, die vom Datenquellentyp für das Dataset bestimmt wird.</span><span class="sxs-lookup"><span data-stu-id="07768-145">Extended field properties are additional properties defined on a field by the data processing extension, which is determined by the data source type for the dataset.</span></span> <span data-ttu-id="07768-146">Erweiterte Feldeigenschaften sind entweder vordefiniert oder gelten speziell für einen Datenquellentyp.</span><span class="sxs-lookup"><span data-stu-id="07768-146">Extended field properties are predefined or specific to a data source type.</span></span> <span data-ttu-id="07768-147">Weitere Informationen finden Sie unter [Erweiterte Feldeigenschaften für eine Analysis Services-Datenbank (SSRS)](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="07768-147">For more information, see [Extended Field Properties for an Analysis Services Database &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span></span>  
  
 <span data-ttu-id="07768-148">Wenn Sie eine Eigenschaft angeben, die für das Feld nicht unterstützt wird, wird der Verweis als `null` (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]) ausgewertet.</span><span class="sxs-lookup"><span data-stu-id="07768-148">If you specify a property that is not supported for that field, the expression evaluates to `null` (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]).</span></span> <span data-ttu-id="07768-149">Wenn ein Datenanbieter keine erweiterten Feldeigenschaften unterstützt oder wenn das Feld während des Ausführens der Abfrage nicht gefunden wird, entspricht der Wert für die Eigenschaft bei Eigenschaften vom Typ `null` und `Nothing` dem Wert `String` (`Object` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]), und bei Eigenschaften vom Typ `Integer` entspricht er Null (0).</span><span class="sxs-lookup"><span data-stu-id="07768-149">If a data provider does not support extended field properties, or if the field is not found when the query is executed, the value for the property is `null` (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]) for properties of type `String` and `Object`, and zero (0) for properties of type `Integer`.</span></span> <span data-ttu-id="07768-150">Für eine Datenverarbeitungserweiterung können die Vorteile der vordefinierten Eigenschaften genutzt werden, indem die Abfragen optimiert werden, die diese Syntax enthalten.</span><span class="sxs-lookup"><span data-stu-id="07768-150">A data processing extension may take advantage of predefined properties by optimizing queries that include this syntax.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="07768-151">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="07768-151">See Also</span></span>  
 <span data-ttu-id="07768-152">[Beispiele für Ausdrücke &#40;Berichts-Generator und SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="07768-152">[Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="07768-153">Hinzufügen von Daten zu einem Bericht &#40;Berichts-Generator und SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="07768-153">Add Data to a Report &#40;Report Builder and SSRS&#41;</span></span>](../report-data/report-datasets-ssrs.md)  
  
  

---
title: Datentypen in Ausdrücken (Berichts-Generator und SSRS) | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 94fdf921-270c-4c12-87b3-46b1cc98fae5
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 86aa646865ecfe3da6ed1ad4bacb75907ab39472
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87721187"
---
# <a name="data-types-in-expressions-report-builder-and-ssrs"></a><span data-ttu-id="f1e91-102">Datentypen in Ausdrücken (Berichts-Generator und SSRS)</span><span class="sxs-lookup"><span data-stu-id="f1e91-102">Data Types in Expressions (Report Builder and SSRS)</span></span>
  <span data-ttu-id="f1e91-103">Datentypen stellen verschiedene Arten von Daten dar, die auf diese Weise effizient gespeichert und verarbeitet werden können.</span><span class="sxs-lookup"><span data-stu-id="f1e91-103">Data types represent different kinds of data so that it can be stored and processed efficiently.</span></span> <span data-ttu-id="f1e91-104">Zu den gängigen Datentypen gehören Text (auch String oder Zeichenfolge genannt), Zahlen mit oder ohne Dezimalstellen, Datum und Uhrzeit sowie Bilder.</span><span class="sxs-lookup"><span data-stu-id="f1e91-104">Typical data types include text (also known as strings), numbers with and without decimal places, dates and times, and images.</span></span> <span data-ttu-id="f1e91-105">Werte in einem Bericht müssen dem RDL-Datentyp (Report Definition Language) entsprechen.</span><span class="sxs-lookup"><span data-stu-id="f1e91-105">Values in a report must be an Report Definition Language (RDL) data type.</span></span> <span data-ttu-id="f1e91-106">Sie können einen Wert beliebig formatieren, wenn Sie ihn in einem Bericht anzeigen.</span><span class="sxs-lookup"><span data-stu-id="f1e91-106">You can format a value according to your preference when you display it in a report.</span></span> <span data-ttu-id="f1e91-107">So kann ein Feld, das eine Währung darstellt, als Gleitkommazahl in der Berichtsdefinition gespeichert, jedoch je nach gewählter Formatierungseigenschaft in verschiedenen Formaten angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="f1e91-107">For example, a field that represents currency is stored in the report definition as a floating point number, but can be displayed in a variety of formats depending on the format property you choose.</span></span>  
  
 <span data-ttu-id="f1e91-108">Weitere Informationen zu Anzeigeformaten finden Sie unter [Formatieren von Berichtselementen &#40;Berichts-Generator und SSRS&#41;](formatting-report-items-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="f1e91-108">For more information about display formats, see [Formatting Report Items &#40;Report Builder and SSRS&#41;](formatting-report-items-report-builder-and-ssrs.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="report-definition-language-rdl-data-types-and-common-language-runtime-clr-data-types"></a><span data-ttu-id="f1e91-109">RDL-Datentypen (Report Definition Language) und CLR-Datentypen (Common Language Runtime)</span><span class="sxs-lookup"><span data-stu-id="f1e91-109">Report Definition Language (RDL) Data Types and Common Language Runtime (CLR) Data Types</span></span>  
 <span data-ttu-id="f1e91-110">Werte, die in einer RDL-Datei angegeben werden, müssen dem RDL-Datentyp entsprechen.</span><span class="sxs-lookup"><span data-stu-id="f1e91-110">Values that are specified in an RDL file must be an RDL data type.</span></span> <span data-ttu-id="f1e91-111">Wenn der Bericht kompiliert und verarbeitet wird, werden RDL-Datentypen in CLR-Datentypen konvertiert.</span><span class="sxs-lookup"><span data-stu-id="f1e91-111">When the report is compiled and processed, RDL data types are converted to CLR data types.</span></span> <span data-ttu-id="f1e91-112">In der folgenden Tabelle wird die Konvertierung angezeigt, die als Standardeinstellung markiert ist:</span><span class="sxs-lookup"><span data-stu-id="f1e91-112">The following table displays the conversion, which is marked Default:</span></span>  
  
|<span data-ttu-id="f1e91-113">RDL-Typ</span><span class="sxs-lookup"><span data-stu-id="f1e91-113">RDL Type</span></span>|<span data-ttu-id="f1e91-114">CLR-Typen</span><span class="sxs-lookup"><span data-stu-id="f1e91-114">CLR Types</span></span>|  
|--------------|---------------|  
|<span data-ttu-id="f1e91-115">String</span><span class="sxs-lookup"><span data-stu-id="f1e91-115">String</span></span>|<span data-ttu-id="f1e91-116">Standard: String</span><span class="sxs-lookup"><span data-stu-id="f1e91-116">Default: String</span></span><br /><br /> <span data-ttu-id="f1e91-117">Chart, GUID, Timespan</span><span class="sxs-lookup"><span data-stu-id="f1e91-117">Chart, GUID, Timespan</span></span>|  
|<span data-ttu-id="f1e91-118">Boolean</span><span class="sxs-lookup"><span data-stu-id="f1e91-118">Boolean</span></span>|<span data-ttu-id="f1e91-119">Standard: Boolesch</span><span class="sxs-lookup"><span data-stu-id="f1e91-119">Default: Boolean</span></span>|  
|<span data-ttu-id="f1e91-120">Integer</span><span class="sxs-lookup"><span data-stu-id="f1e91-120">Integer</span></span>|<span data-ttu-id="f1e91-121">Standard: Int64</span><span class="sxs-lookup"><span data-stu-id="f1e91-121">Default: Int64</span></span><br /><br /> <span data-ttu-id="f1e91-122">Int16, Int32, Uint16, Uint64, Byte, Sbyte</span><span class="sxs-lookup"><span data-stu-id="f1e91-122">Int16, Int32, Uint16, Uint64, Byte, Sbyte</span></span>|  
|<span data-ttu-id="f1e91-123">Datetime</span><span class="sxs-lookup"><span data-stu-id="f1e91-123">DateTime</span></span>|<span data-ttu-id="f1e91-124">Standard: DateTime</span><span class="sxs-lookup"><span data-stu-id="f1e91-124">Default: DateTime</span></span><br /><br /> <span data-ttu-id="f1e91-125">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="f1e91-125">DateTimeOffset</span></span>|  
|<span data-ttu-id="f1e91-126">Float</span><span class="sxs-lookup"><span data-stu-id="f1e91-126">Float</span></span>|<span data-ttu-id="f1e91-127">Standard: Double</span><span class="sxs-lookup"><span data-stu-id="f1e91-127">Default: Double</span></span><br /><br /> <span data-ttu-id="f1e91-128">Single, Decimal</span><span class="sxs-lookup"><span data-stu-id="f1e91-128">Single, Decimal</span></span>|  
|<span data-ttu-id="f1e91-129">Binary</span><span class="sxs-lookup"><span data-stu-id="f1e91-129">Binary</span></span>|<span data-ttu-id="f1e91-130">Standard: Byte[]</span><span class="sxs-lookup"><span data-stu-id="f1e91-130">Default: Byte[]</span></span>|  
|<span data-ttu-id="f1e91-131">Variant</span><span class="sxs-lookup"><span data-stu-id="f1e91-131">Variant</span></span>|<span data-ttu-id="f1e91-132">Beliebiger Wert von oben außer Byte []</span><span class="sxs-lookup"><span data-stu-id="f1e91-132">Any of the above except Byte[]</span></span>|  
|<span data-ttu-id="f1e91-133">VariantArray</span><span class="sxs-lookup"><span data-stu-id="f1e91-133">VariantArray</span></span>|<span data-ttu-id="f1e91-134">Array von Variant</span><span class="sxs-lookup"><span data-stu-id="f1e91-134">Array of Variant</span></span>|  
|<span data-ttu-id="f1e91-135">Serialisierbar</span><span class="sxs-lookup"><span data-stu-id="f1e91-135">Serializable</span></span>|<span data-ttu-id="f1e91-136">Variant oder Typen, die mit Serializable markiert sind oder ISerializable implementieren.</span><span class="sxs-lookup"><span data-stu-id="f1e91-136">Variant or types marked with Serializable or that implement ISerializable.</span></span>|  
  
## <a name="understanding-data-types-and-writing-expressions"></a><span data-ttu-id="f1e91-137">Grundlegendes zu Datentypen und zum Schreiben von Ausdrücken</span><span class="sxs-lookup"><span data-stu-id="f1e91-137">Understanding Data Types and Writing Expressions</span></span>  
 <span data-ttu-id="f1e91-138">Es ist wichtig, dass Sie mit Datentypen vertraut sind, wenn Sie Ausdrücke zum Vergleichen oder Kombinieren von Werten schreiben, zum Beispiel, wenn Sie Gruppierungs- oder Filterausdrücke definieren oder Aggregate berechnen.</span><span class="sxs-lookup"><span data-stu-id="f1e91-138">It is important to understand data types when you write expressions to compare or combine values, for example, when you define group or filter expressions, or calculate aggregates.</span></span> <span data-ttu-id="f1e91-139">Vergleiche und Berechnungen können nur mit Elementen des gleichen Datentyps durchgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="f1e91-139">Comparisons and calculations are valid only between items of the same data type.</span></span> <span data-ttu-id="f1e91-140">Wenn die Datentypen nicht übereinstimmen, müssen sie explizit in den Berichtselementen durch einen Ausdruck konvertiert werden.</span><span class="sxs-lookup"><span data-stu-id="f1e91-140">If the data types do not match, you must explicitly convert the data type in the report item by using an expression.</span></span>  
  
 <span data-ttu-id="f1e91-141">In den folgenden Situationen müssen Sie möglicherweise Daten in einen anderen Datentyp konvertieren:</span><span class="sxs-lookup"><span data-stu-id="f1e91-141">The following list describes cases when you may need to convert data to a different data type:</span></span>  
  
-   <span data-ttu-id="f1e91-142">Vergleichen des Werts eines Berichtsparameters mit einem Datentyp mit einem Datasetfeld eines anderen Datentyps</span><span class="sxs-lookup"><span data-stu-id="f1e91-142">Comparing the value of a report parameter of one data type to a dataset field of a different data type.</span></span>  
  
-   <span data-ttu-id="f1e91-143">Schreiben von Filterausdrücken, die Werte mit unterschiedlichen Datentypen vergleichen</span><span class="sxs-lookup"><span data-stu-id="f1e91-143">Writing filter expressions that compare values of different data types.</span></span>  
  
-   <span data-ttu-id="f1e91-144">Schreiben von Sortierungsausdrücken, die Felder mit unterschiedlichen Datentypen kombinieren</span><span class="sxs-lookup"><span data-stu-id="f1e91-144">Writing sort expressions that combine fields of different data types.</span></span>  
  
-   <span data-ttu-id="f1e91-145">Schreiben von Gruppierungsausdrücken, die Felder mit unterschiedlichen Datentypen kombinieren</span><span class="sxs-lookup"><span data-stu-id="f1e91-145">Writing group expressions that combine fields of different data types.</span></span>  
  
-   <span data-ttu-id="f1e91-146">Konvertieren eines aus der Datenquelle abgerufenen Werts von einem Datentyp in einen anderen Datentyp</span><span class="sxs-lookup"><span data-stu-id="f1e91-146">Converting a value retrieved from the data source from one data type to a different data type.</span></span>  
  
## <a name="determining-the-data-type-of-report-data"></a><span data-ttu-id="f1e91-147">Ermitteln des Datentyps von Berichtsdaten</span><span class="sxs-lookup"><span data-stu-id="f1e91-147">Determining the Data Type of Report Data</span></span>  
 <span data-ttu-id="f1e91-148">Zum Ermitteln des Datentyps von Berichtselementen können Sie einen Ausdruck schreiben, der den Datentyp zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="f1e91-148">To determine the data type of a report item, you can write an expression that returns its data type.</span></span> <span data-ttu-id="f1e91-149">Wenn Sie beispielsweise den Datentyp des Felds `MyField`anzeigen möchten, fügen Sie einer Tabellenzelle den folgenden Ausdruck hinzu: `=Fields!MyField.Value.GetType().ToString()`.</span><span class="sxs-lookup"><span data-stu-id="f1e91-149">For example, to show the data type for the field `MyField`, add the following expression to a table cell: `=Fields!MyField.Value.GetType().ToString()`.</span></span> <span data-ttu-id="f1e91-150">Das Ergebnis zeigt den CLR-Datentyp an, der `MyField` darstellt, zum Beispiel `System.String` oder `System.DateTime`.</span><span class="sxs-lookup"><span data-stu-id="f1e91-150">The result displays the CLR data type used to represent `MyField`, for example, `System.String` or `System.DateTime`.</span></span>  
  
## <a name="converting-dataset-fields-to-a-different-data-type"></a><span data-ttu-id="f1e91-151">Konvertieren von Datasetfeldern in einen anderen Datentyp</span><span class="sxs-lookup"><span data-stu-id="f1e91-151">Converting Dataset Fields to a Different Data Type</span></span>  
 <span data-ttu-id="f1e91-152">Sie können auch Datasetfelder konvertieren, bevor sie in einem Bericht verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="f1e91-152">You can also convert dataset fields before you use them in a report.</span></span> <span data-ttu-id="f1e91-153">Im Folgenden werden Methoden beschrieben, mit denen Sie ein vorhandenes Datasetfeld konvertieren können:</span><span class="sxs-lookup"><span data-stu-id="f1e91-153">The following list describes ways that you can convert an existing dataset field:</span></span>  
  
-   <span data-ttu-id="f1e91-154">Ändern Sie die Datasetabfrage so, dass ein neues Abfragefeld mit den konvertierten Daten hinzugefügt wird.</span><span class="sxs-lookup"><span data-stu-id="f1e91-154">Modify the dataset query to add a new query field with the converted data.</span></span> <span data-ttu-id="f1e91-155">Bei relationalen oder mehrdimensionalen Datenquellen werden in diesem Fall Datenquellenressourcen zum Durchführen der Konvertierung verwendet.</span><span class="sxs-lookup"><span data-stu-id="f1e91-155">For relational or multidimensional data sources, this uses data source resources to perform the conversion.</span></span>  
  
-   <span data-ttu-id="f1e91-156">Erstellen Sie ein berechnetes, auf einem bestehenden Berichtsdatasetfeld basierendes Feld, indem Sie einen Ausdruck schreiben, durch den alle Daten in einer Resultsetspalte in eine neue Spalte mit einem anderen Datentyp konvertiert werden.</span><span class="sxs-lookup"><span data-stu-id="f1e91-156">Create a calculated field based on an existing report dataset field by writing an expression that converts all the data in one result set column to a new column with a different data type.</span></span> <span data-ttu-id="f1e91-157">So wird beispielsweise durch den folgenden Ausdruck das Feld Year von einer Ganzzahl in eine Zeichenfolge konvertiert: `=CStr(Fields!Year.Value)`.</span><span class="sxs-lookup"><span data-stu-id="f1e91-157">For example, the following expression converts the field Year from an integer value to a string value: `=CStr(Fields!Year.Value)`.</span></span> <span data-ttu-id="f1e91-158">Weitere Informationen finden Sie unter [Hinzufügen, Bearbeiten und Aktualisieren von Feldern im Berichtsdatenbereich &#40;Berichts-Generator und SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="f1e91-158">For more information, see [Add, Edit, Refresh Fields in the Report Data Pane &#40;Report Builder and SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span></span>  
  
-   <span data-ttu-id="f1e91-159">Überprüfen Sie, ob die verwendete Datenverarbeitungserweiterung Metadaten zum Abrufen von vorformatierten Daten enthält.</span><span class="sxs-lookup"><span data-stu-id="f1e91-159">Check whether the data processing extension you are using includes metadata for retrieving preformatted data.</span></span> <span data-ttu-id="f1e91-160">So enthält beispielsweise eine [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]-MDX-Abfrage die erweiterte Eigenschaft FORMATTED_VALUE für Cube-Werte, die bereits während der Verarbeitung des Cubes formatiert wurden.</span><span class="sxs-lookup"><span data-stu-id="f1e91-160">For example, a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] MDX query includes a FORMATTED_VALUE extended property for cube values that have already been formatted when processing the cube.</span></span> <span data-ttu-id="f1e91-161">Weitere Informationen finden Sie unter [Erweiterte Feldeigenschaften für eine Analysis Services-Datenbank (SSRS)](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="f1e91-161">For more information, see [Extended Field Properties for an Analysis Services Database &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span></span>  
  
## <a name="understanding-parameter-data-types"></a><span data-ttu-id="f1e91-162">Parameterdatentypen</span><span class="sxs-lookup"><span data-stu-id="f1e91-162">Understanding Parameter Data Types</span></span>  
 <span data-ttu-id="f1e91-163">Berichtsparameter müssen einen der folgenden Datentypen aufweisen: Boolesch (Boolean), Datum/Zeit (DateTime), Ganzzahl (Integer), Gleitkomma (Float) oder Text (String).</span><span class="sxs-lookup"><span data-stu-id="f1e91-163">Report parameters must be one of five data types: Boolean, DateTime, Integer, Float, or Text (also known as String).</span></span> <span data-ttu-id="f1e91-164">Wenn eine Datasetabfrage Abfrageparameter enthält, werden automatisch Berichtsparameter erstellt und mit den Abfrageparametern verknüpft.</span><span class="sxs-lookup"><span data-stu-id="f1e91-164">When a dataset query includes query parameters, report parameters are automatically created and linked to the query parameters.</span></span> <span data-ttu-id="f1e91-165">Der Standarddatentyp für einen Berichtsparameter lautet String.</span><span class="sxs-lookup"><span data-stu-id="f1e91-165">The default data type for a report parameter is String.</span></span> <span data-ttu-id="f1e91-166">Wenn Sie den Standarddatentyp eines Berichtsparameters ändern möchten, wählen Sie im Dialogfeld **Berichtsparametereigenschaften** auf der Seite **Allgemein** in der Dropdownliste **Datentyp** den gewünschten Wert aus.</span><span class="sxs-lookup"><span data-stu-id="f1e91-166">To change the default data type of a report parameter, select the correct value from the **Data type** drop-down list on the **General** page of the **Report Parameter Properties** dialog box.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="f1e91-167">Berichtsparameter mit einem DateTime-Datentyp unterstützen keine Millisekunden.</span><span class="sxs-lookup"><span data-stu-id="f1e91-167">Report parameters that are DateTime data types do not support milliseconds.</span></span> <span data-ttu-id="f1e91-168">Sie können zwar einen Parameter erstellen, der auf Werten mit Millisekunden basiert, in der Dropdownliste mit den verfügbaren Werten kann jedoch kein Wert ausgewählt werden, der Datums- oder Zeitwerte mit Millisekunden enthält.</span><span class="sxs-lookup"><span data-stu-id="f1e91-168">Although you can create a parameter based on values that include milliseconds, you cannot select a value from an available values drop-down list that includes Date or Time values that include milliseconds.</span></span>  
  
## <a name="writing-expressions-that-convert-data-types-or-extract-parts-of-data"></a><span data-ttu-id="f1e91-169">Schreiben von Ausdrücken zum Konvertieren von Datentypen oder Extrahieren von Datenteilen</span><span class="sxs-lookup"><span data-stu-id="f1e91-169">Writing Expressions that Convert Data Types or Extract Parts of Data</span></span>  
 <span data-ttu-id="f1e91-170">Wenn Sie Text und Datasetfelder mit dem Verkettungsoperator (&) kombinieren, stellt die Common Language Runtime (CLR) im Allgemeinen Standardformate bereit.</span><span class="sxs-lookup"><span data-stu-id="f1e91-170">When you combine text and dataset fields using the concatenation operator (&), the common language runtime (CLR) generally provides default formats.</span></span> <span data-ttu-id="f1e91-171">Falls Sie ein Datasetfeld oder einen Parameter explizit in einen bestimmten Datentyp konvertieren müssen, müssen die Daten mit einer CLR-Methode oder einer Funktion der Visual Basic-Laufzeit konvertiert werden.</span><span class="sxs-lookup"><span data-stu-id="f1e91-171">When you need to explicitly convert a dataset field or parameter to a specific data type, you must use a CLR method or a Visual Basic runtime library function to convert the data.</span></span>  
  
 <span data-ttu-id="f1e91-172">Die folgende Tabelle enthält Beispiele zum Konvertieren von Datentypen.</span><span class="sxs-lookup"><span data-stu-id="f1e91-172">The following table shows examples of converting data types.</span></span>  
  
|<span data-ttu-id="f1e91-173">Art der Konvertierung</span><span class="sxs-lookup"><span data-stu-id="f1e91-173">Type of conversion</span></span>|<span data-ttu-id="f1e91-174">Beispiel</span><span class="sxs-lookup"><span data-stu-id="f1e91-174">Example</span></span>|  
|------------------------|-------------|  
|<span data-ttu-id="f1e91-175">DateTime zu String</span><span class="sxs-lookup"><span data-stu-id="f1e91-175">DateTime to String</span></span>|`=CStr(Fields!Date.Value)`|  
|<span data-ttu-id="f1e91-176">String zu DateTime</span><span class="sxs-lookup"><span data-stu-id="f1e91-176">String to DateTime</span></span>|`=DateTime.Parse(Fields!DateTimeinStringFormat.Value)`|  
|<span data-ttu-id="f1e91-177">String zu DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="f1e91-177">String to DateTimeOffset</span></span>|`=DateTimeOffset.Parse(Fields!DateTimeOffsetinStringFormat.Value)`|  
|<span data-ttu-id="f1e91-178">Extrahieren des Jahrs</span><span class="sxs-lookup"><span data-stu-id="f1e91-178">Extracting the Year</span></span>|`=Year(Fields!TimeinStringFormat.Value)`<br /><br /> `-- or --`<br /><br /> `=Year(Fields!TimeinDateTimeFormat.Value)`|  
|<span data-ttu-id="f1e91-179">Boolean zu Integer</span><span class="sxs-lookup"><span data-stu-id="f1e91-179">Boolean to Integer</span></span>|`=CInt(Parameters!BooleanField.Value)`<br /><br /> <span data-ttu-id="f1e91-180">-1 ist True und 0 ist False.</span><span class="sxs-lookup"><span data-stu-id="f1e91-180">-1 is True and 0 is False.</span></span>|  
|<span data-ttu-id="f1e91-181">Boolean zu Integer</span><span class="sxs-lookup"><span data-stu-id="f1e91-181">Boolean to Integer</span></span>|`=System.Convert.ToInt32(Fields!BooleanFormat.Value)`<br /><br /> <span data-ttu-id="f1e91-182">1 ist True und 0 ist False.</span><span class="sxs-lookup"><span data-stu-id="f1e91-182">1 is True and 0 is False.</span></span>|  
|<span data-ttu-id="f1e91-183">Nur der Datums-/Uhrzeitanteil (DateTime) des DateTimeOffset-Werts</span><span class="sxs-lookup"><span data-stu-id="f1e91-183">Just the DateTime part of a DateTimeOffset value</span></span>|`=Fields!MyDatetimeOffset.Value.DateTime`|  
|<span data-ttu-id="f1e91-184">Nur der Zeitverschiebungsanteil (Offset) des DateTimeOffset-Werts</span><span class="sxs-lookup"><span data-stu-id="f1e91-184">Just the Offset part of a DateTimeOffset value</span></span>|`=Fields!MyDatetimeOffset.Value.Offset`|  
  
 <span data-ttu-id="f1e91-185">Mit der Formatierungsfunktion können Sie zudem das Anzeigeformat des Werts steuern.</span><span class="sxs-lookup"><span data-stu-id="f1e91-185">You can also use the Format function to control the display format for value.</span></span> <span data-ttu-id="f1e91-186">Weitere Informationen finden Sie unter [Funktionen (Visual Basic)](https://go.microsoft.com/fwlink/?linkid=111483).</span><span class="sxs-lookup"><span data-stu-id="f1e91-186">For more information, see [Functions (Visual Basic)](https://go.microsoft.com/fwlink/?linkid=111483).</span></span>  
  
## <a name="advanced-examples"></a><span data-ttu-id="f1e91-187">Komplexere Beispiele</span><span class="sxs-lookup"><span data-stu-id="f1e91-187">Advanced Examples</span></span>  
 <span data-ttu-id="f1e91-188">Wenn Sie eine Datenquelle mit einem Datenanbieter verbinden, der nicht die Konvertierung aller Datentypen in der Datenquelle unterstützt, wird standardmäßig für alle nicht unterstützten Datentypen der Datentyp String verwendet.</span><span class="sxs-lookup"><span data-stu-id="f1e91-188">When you connect to a data source with a data provider that does not provide conversion support for all the data types on the data source, the default data type for unsupported data source types is String.</span></span> <span data-ttu-id="f1e91-189">In den folgenden Beispielen finden Sie Lösungen für bestimmte Datentypen, die als Zeichenfolge (String) zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="f1e91-189">The following examples provide solutions to specific data types that are returned as a string.</span></span>  
  
### <a name="concatenating-a-string-and-a-clr-datetimeoffset-data-type"></a><span data-ttu-id="f1e91-190">Verketten eines String-Datentyps und eines CLR-DateTimeOffset-Datentyps</span><span class="sxs-lookup"><span data-stu-id="f1e91-190">Concatenating a String and a CLR DateTimeOffset Data Type</span></span>  
 <span data-ttu-id="f1e91-191">Die CLR stellt für die meisten Datentypen eine Standardkonvertierung bereit, sodass Sie Werte mit unterschiedlichen Datentypen mithilfe des &-Operators in einer Zeichenfolge verketten können.</span><span class="sxs-lookup"><span data-stu-id="f1e91-191">For most data types, the CLR provides default conversions so that you can concatenate values that are different data types into one string by using the & operator.</span></span> <span data-ttu-id="f1e91-192">Der folgende Ausdruck verkettet zum Beispiel den Text „The date and time are:“ mit einem StartDate-Datasetfeld, bei dem es sich um einen <xref:System.DateTime> -Wert handelt: `="The date and time are: " & Fields!StartDate.Value`.</span><span class="sxs-lookup"><span data-stu-id="f1e91-192">For example, the following expression concatenates the text "The date and time are: " with a dataset field StartDate, which is a <xref:System.DateTime> value: `="The date and time are: " & Fields!StartDate.Value`.</span></span>  
  
 <span data-ttu-id="f1e91-193">Bei einigen Datentypen müssen Sie eventuell die ToString-Funktion verwenden.</span><span class="sxs-lookup"><span data-stu-id="f1e91-193">For some data types, you may need to include the ToString function.</span></span> <span data-ttu-id="f1e91-194">Der folgende Ausdruck zeigt das gleiche Beispiel mit dem CLR-Datentyp <xref:System.DateTimeOffset>, der das Datum, die Uhrzeit sowie eine Zeitzonenverschiebung relativ zur UTC-Zeitzone beinhaltet: `="The time is: " & Fields!StartDate.Value.ToString()`.</span><span class="sxs-lookup"><span data-stu-id="f1e91-194">For example, the following expression shows the same example using the CLR data type <xref:System.DateTimeOffset>, which include the date, the time, and a time-zone offset relative to the UTC time zone: `="The time is: " & Fields!StartDate.Value.ToString()`.</span></span>  
  
### <a name="converting-a-string-data-type-to-a-clr-datetime-data-type"></a><span data-ttu-id="f1e91-195">Konvertieren eines String-Datentyps in einen CLR-DateTime-Datentyp</span><span class="sxs-lookup"><span data-stu-id="f1e91-195">Converting a String Data Type to a CLR DateTime Data Type</span></span>  
 <span data-ttu-id="f1e91-196">Falls eine Datenverarbeitungserweiterung nicht alle in einer Datenquelle definierten Datentypen unterstützt, werden die Daten eventuell als Text abgerufen.</span><span class="sxs-lookup"><span data-stu-id="f1e91-196">If a data processing extension does not support all data types defined on a data source, the data may be retrieved as text.</span></span> <span data-ttu-id="f1e91-197">Beispiel: Der Datentypwert `datetimeoffset(7)` wird möglicherweise als String-Datentyp abgerufen.</span><span class="sxs-lookup"><span data-stu-id="f1e91-197">For example, a `datetimeoffset(7)` data type value may be retrieved as a String data type.</span></span> <span data-ttu-id="f1e91-198">Für Perth in Australien würde der Zeichenfolgenwert für den 1. Juli 2008, 6:05:07.9999999</span><span class="sxs-lookup"><span data-stu-id="f1e91-198">In Perth, Australia, the string value for July 1, 2008, at 6:05:07.9999999 A.M.</span></span> <span data-ttu-id="f1e91-199">in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="f1e91-199">would resemble:</span></span>  
  
 `2008-07-01 06:05:07.9999999 +08:00`  
  
 <span data-ttu-id="f1e91-200">Dieses Beispiel zeigt das Datum (1. Juli 2008), gefolgt von der Uhrzeit mit 7-stelliger Präzision (6:05:07.9999999), gefolgt von der UTC-Zeitzonenverschiebung in Stunden und Minuten (plus 8 Stunden, 0 Minuten).</span><span class="sxs-lookup"><span data-stu-id="f1e91-200">This example shows the date (July 1, 2008), followed by the time to a 7-digit precision (6:05:07.9999999 A.M.), followed by a UTC time zone offset in hours and minutes (plus 8 hours, 0 minutes).</span></span> <span data-ttu-id="f1e91-201">In den folgenden Beispielen befindet sich dieser Wert im `String`-Feld `MyDateTime.Value`.</span><span class="sxs-lookup"><span data-stu-id="f1e91-201">For the following examples, this value has been placed in a `String` field called `MyDateTime.Value`.</span></span>  
  
 <span data-ttu-id="f1e91-202">Sie können diese Daten mit einer der folgenden Methoden in einen oder mehrere CLR-Werte konvertieren:</span><span class="sxs-lookup"><span data-stu-id="f1e91-202">You can use one of the following strategies to convert this data to one or more CLR values:</span></span>  
  
-   <span data-ttu-id="f1e91-203">Verwenden Sie in einem Textfeld einen Ausdruck, um Teile der Zeichenfolge zu extrahieren.</span><span class="sxs-lookup"><span data-stu-id="f1e91-203">In a text box, use an expression to extract parts of the string.</span></span> <span data-ttu-id="f1e91-204">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="f1e91-204">For example:</span></span>  
  
    -   <span data-ttu-id="f1e91-205">Mit dem folgenden Ausdruck wird der Stundenwert der UTC-Zeitzonenverschiebung extrahiert und in Minuten konvertiert: `=CInt(Fields!MyDateTime.Value.Substring(Fields!MyDateTime.Value.Length-5,2)) * 60`</span><span class="sxs-lookup"><span data-stu-id="f1e91-205">The following expression extracts just the hour part of the UTC time zone offset and converts it to minutes: `=CInt(Fields!MyDateTime.Value.Substring(Fields!MyDateTime.Value.Length-5,2)) * 60`</span></span>  
  
         <span data-ttu-id="f1e91-206">Das Ergebnis ist `480`.</span><span class="sxs-lookup"><span data-stu-id="f1e91-206">The result is `480`.</span></span>  
  
    -   <span data-ttu-id="f1e91-207">Mit dem folgenden Ausdruck wird die Zeichenfolge in einen Datums- und Uhrzeitwert konvertiert: `=DateTime.Parse(Fields!MyDateTime.Value)`</span><span class="sxs-lookup"><span data-stu-id="f1e91-207">The following expression converts the string to a date and time value: `=DateTime.Parse(Fields!MyDateTime.Value)`</span></span>  
  
         <span data-ttu-id="f1e91-208">Falls die Zeichenfolge `MyDateTime.Value` eine UTC-Zeitverschiebung aufweist, passt die Funktion `DateTime.Parse` zunächst die UTC-Zeitverschiebung an (7:00</span><span class="sxs-lookup"><span data-stu-id="f1e91-208">If the `MyDateTime.Value` string has a UTC offset, the `DateTime.Parse` function first adjusts for the UTC offset (7 A.M.</span></span> <span data-ttu-id="f1e91-209">- [`+08:00`] zur UTC-Zeit 23:00</span><span class="sxs-lookup"><span data-stu-id="f1e91-209">- [`+08:00`] to the UTC time of 11 P.M.</span></span> <span data-ttu-id="f1e91-210">in der vorherigen Nacht).</span><span class="sxs-lookup"><span data-stu-id="f1e91-210">the night before).</span></span> <span data-ttu-id="f1e91-211">Anschließend wendet die Funktion `DateTime.Parse` die UTC-Zeitverschiebung des lokalen Berichtsservers an und passt die Zeit ggf. noch einmal an die Sommerzeit an.</span><span class="sxs-lookup"><span data-stu-id="f1e91-211">The `DateTime.Parse` function then applies the local report server UTC offset and, if necessary, adjusts the time again for Daylight Saving Time.</span></span> <span data-ttu-id="f1e91-212">So ist zum Beispiel in Redmond, Washington/USA die lokale Zeitverschiebung, angepasst an die Sommerzeit, `[-07:00]`, das heißt 7 Stunden früher als 23:00.</span><span class="sxs-lookup"><span data-stu-id="f1e91-212">For example, in Redmond, Washington, the local time offset adjusted for Daylight Saving Time is `[-07:00]`, or 7 hours earlier than 11 PM.</span></span> <span data-ttu-id="f1e91-213">Daraus ergibt sich der folgende `DateTime`-Wert: `2007-07-06 04:07:07 PM` (6. Juli 2007, 16:07).</span><span class="sxs-lookup"><span data-stu-id="f1e91-213">The result is the following `DateTime` value: `2007-07-06 04:07:07 PM` (July 6, 2007 at 4:07 P.M).</span></span>  
  
 <span data-ttu-id="f1e91-214">Weitere Informationen zum Einfügen von Zeichen folgen in-Datentypen finden Sie unter Generieren von `DateTime` [Datums-und Uhrzeit](https://go.microsoft.com/fwlink/?LinkId=89703)Zeichenfolgen, [Formatieren von Datum und Uhrzeit für eine bestimmte Kultur](https://go.microsoft.com/fwlink/?LinkId=89704)und [auswählen zwischen "DateTime", "DateTimeOffset" und "TimeZoneInfo](https://go.microsoft.com/fwlink/?linkid=110652) " auf MSDN.</span><span class="sxs-lookup"><span data-stu-id="f1e91-214">For more information about converting strings to `DateTime` data types, see [Parsing Date and Time Strings](https://go.microsoft.com/fwlink/?LinkId=89703), [Formatting Date and Time for a Specific Culture](https://go.microsoft.com/fwlink/?LinkId=89704), and [Choosing Between DateTime, DateTimeOffset, and TimeZoneInfo](https://go.microsoft.com/fwlink/?linkid=110652) on MSDN.</span></span>  
  
-   <span data-ttu-id="f1e91-215">Fügen Sie ein neues berechnetes Feld dem Berichtsdataset hinzu, das einen Ausdruck verwendet, mit dem Teile der Zeichenfolge extrahiert werden.</span><span class="sxs-lookup"><span data-stu-id="f1e91-215">Add a new calculated field to the report dataset that uses an expression to extract parts of the string.</span></span> <span data-ttu-id="f1e91-216">Weitere Informationen finden Sie unter [Hinzufügen, Bearbeiten und Aktualisieren von Feldern im Berichtsdatenbereich &#40;Berichts-Generator und SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="f1e91-216">For more information, see [Add, Edit, Refresh Fields in the Report Data Pane &#40;Report Builder and SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span></span>  
  
-   <span data-ttu-id="f1e91-217">Ändern Sie die Berichtsdatasetabfrage so, dass mit [!INCLUDE[tsql](../../includes/tsql-md.md)] -Funktionen die Datums- und Uhrzeitwerte unabhängig voneinander abgerufen und separate Spalten erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="f1e91-217">Change the report dataset query to use [!INCLUDE[tsql](../../includes/tsql-md.md)] functions to extract the date and time values independently to create separate columns.</span></span> <span data-ttu-id="f1e91-218">Im folgenden Beispiel wird gezeigt, wie Sie mit der Funktion `DatePart` eine Spalte für das Jahr und eine Spalte für die in Minuten konvertierte UTC-Zeitzone hinzufügen können:</span><span class="sxs-lookup"><span data-stu-id="f1e91-218">The following example shows how to use the function `DatePart` to add a column for the year and a column for the UTC time zone converted to minutes:</span></span>  
  
     `SELECT`  
  
     `MyDateTime,`  
  
     `DATEPART(year, MyDateTime) AS Year,`  
  
     `DATEPART(tz, MyDateTime) AS OffsetinMinutes`  
  
     `FROM MyDates`  
  
     <span data-ttu-id="f1e91-219">Das Resultset hat drei Spalten.</span><span class="sxs-lookup"><span data-stu-id="f1e91-219">The result set has three columns.</span></span> <span data-ttu-id="f1e91-220">Die erste Spalte enthält Datum und Uhrzeit, die zweite das Jahr und die dritte die UTC-Zeitverschiebung in Minuten.</span><span class="sxs-lookup"><span data-stu-id="f1e91-220">The first column is the date and time, the second column is the year, and the third column is the UTC offset in minutes.</span></span> <span data-ttu-id="f1e91-221">Die folgende Zeile enthält Beispieldaten:</span><span class="sxs-lookup"><span data-stu-id="f1e91-221">The following row shows example data:</span></span>  
  
     `2008-07-01 06:05:07             2008                   480`  
  
 <span data-ttu-id="f1e91-222">Weitere Informationen zu [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-Datenbanktypen finden Sie unter [Datentypen (Transact-SQL)](/sql/t-sql/data-types/data-types-transact-sql) und [Datums- und Uhrzeitdatentypen und zugehörige Funktionen (Transact-SQL)](/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql) in der [SQL Server-Onlinedokumentation](https://go.microsoft.com/fwlink/?linkid=120955).</span><span class="sxs-lookup"><span data-stu-id="f1e91-222">For more information about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database data types, see [Data Types &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql), and [Date and Time Data Types and Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql) in [SQL Server Books Online](https://go.microsoft.com/fwlink/?linkid=120955).</span></span>  
  
 <span data-ttu-id="f1e91-223">Weitere Informationen zu den [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] -Datentypen fin derden Sie unter [Datentypen in der Analysis Services](https://docs.microsoft.com/analysis-services/multidimensional-models/olap-physical/data-types-in-analysis-services) in der [SQL Server Books Onlin dere](https://go.microsoft.com/fwlink/?linkid=120955).</span><span class="sxs-lookup"><span data-stu-id="f1e91-223">For more information about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data types, see [Data Types in Analysis Services](https://docs.microsoft.com/analysis-services/multidimensional-models/olap-physical/data-types-in-analysis-services) in [SQL Server Books Online](https://go.microsoft.com/fwlink/?linkid=120955).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f1e91-224">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="f1e91-224">See Also</span></span>  
 [<span data-ttu-id="f1e91-225">Formatieren von Berichtselementen &#40;Berichts-Generator und SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="f1e91-225">Formatting Report Items &#40;Report Builder and SSRS&#41;</span></span>](formatting-report-items-report-builder-and-ssrs.md)  
  
  

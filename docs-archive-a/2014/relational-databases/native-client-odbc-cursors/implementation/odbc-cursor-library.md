---
title: ODBC-Cursor Bibliothek | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- cursors [ODBC], library
- SQL_CUR_USE_DRIVER option
- ODBC applications, cursors
- ODBC cursors, library
- SQL_CUR_USE_IF_NEEDED option
- SQLSetConnectAttr function
- SQL_CUR_USE_ODBC option
ms.assetid: 3c610d3d-6e06-49cf-9a40-05b6a1c83a32
author: rothja
ms.author: jroth
ms.openlocfilehash: b0f0ad049c6b9e77f9888d582ab0cda2f5a5e0f7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87616067"
---
# <a name="odbc-cursor-library"></a><span data-ttu-id="bbe80-102">ODBC-Cursorbibliothek</span><span class="sxs-lookup"><span data-stu-id="bbe80-102">ODBC Cursor Library</span></span>
  <span data-ttu-id="bbe80-103">Einige ODBC-Treiber unterstützen nur die standardmäßigen Cursor Einstellungen. Diese Treiber unterstützen auch keine positionierten Cursor Vorgänge, wie z. b. **SQLSetPos**.</span><span class="sxs-lookup"><span data-stu-id="bbe80-103">Some ODBC drivers only support the default cursor settings; these drivers also do not support positioned cursor operations, such as **SQLSetPos**.</span></span> <span data-ttu-id="bbe80-104">Die ODBC-Cursorbibliothek ist eine Komponente von Microsoft Data Access Components (MDAC), mit der Block- oder statische Cursor in einem Treiber implementiert werden, der sie normalerweise nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="bbe80-104">The ODBC cursor library is a component of the Microsoft Data Access Components (MDAC) used to implement block or static cursors on a driver that normally does not support them.</span></span> <span data-ttu-id="bbe80-105">Die Cursor Bibliothek implementiert auch positionierte UPDATE-und DELETE-Anweisungen und **SQLSetPos** für die Cursor, die Sie erstellt.</span><span class="sxs-lookup"><span data-stu-id="bbe80-105">The cursor library also implements positioned UPDATE and DELETE statements and **SQLSetPos** for the cursors it creates.</span></span>  
  
 <span data-ttu-id="bbe80-106">Die ODBC-Cursorbibliothek wird als Ebene zwischen dem ODBC-Treiber-Manager und einem ODBC-Treiber implementiert.</span><span class="sxs-lookup"><span data-stu-id="bbe80-106">The ODBC cursor library is implemented as a layer between the ODBC Driver Manager and an ODBC driver.</span></span> <span data-ttu-id="bbe80-107">Wenn die ODBC-Cursorbibliothek geladen ist, leitet der ODBC-Treiber-Manager alle cursorspezifischen Befehle an die Cursorbibliothek statt an den Treiber weiter.</span><span class="sxs-lookup"><span data-stu-id="bbe80-107">If the ODBC cursor library is loaded, the ODBC Driver Manager routes all cursor-related commands to the cursor library instead of the driver.</span></span> <span data-ttu-id="bbe80-108">Die Cursorbibliothek implementiert einen Cursor durch Abrufen des gesamten Resultsets aus dem zugrunde liegenden Treiber und durch Zwischenspeichern des Resultsets auf dem Client.</span><span class="sxs-lookup"><span data-stu-id="bbe80-108">The cursor library implements a cursor by fetching the entire result set from the underlying driver and caching the result set on the client.</span></span> <span data-ttu-id="bbe80-109">Bei Verwendung der ODBC-Cursorbibliothek ist die Anwendung auf die Cursorfunktionen der Cursorbibliothek beschränkt. Zusätzliche Cursorfunktionen im zugrunde liegenden Treiber sind für die Anwendung nicht verfügbar.</span><span class="sxs-lookup"><span data-stu-id="bbe80-109">When using the ODBC cursor library, the application is limited to the cursor functionality of the cursor library; any support for additional cursor functionality in the underlying driver is not available to the application.</span></span>  
  
 <span data-ttu-id="bbe80-110">Es besteht kaum Bedarf, die ODBC-Cursorbibliothek mit dem [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC-Treiber zu verwenden, da der Treiber selbst mehr Cursorfunktionen unterstützt als die ODBC-Cursorbibliothek.</span><span class="sxs-lookup"><span data-stu-id="bbe80-110">There is little need to use the ODBC cursor library with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver because the driver itself supports more cursor functionality than the ODBC cursor library.</span></span> <span data-ttu-id="bbe80-111">Der einzige Grund für die Verwendung der ODBC-Cursor Bibliothek mit dem [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client-ODBC-Treiber besteht darin, dass der Treiber seine Cursor Unterstützung über Server Cursor implementiert und Server Cursor nicht alle SQL-Anweisungen unterstützen.</span><span class="sxs-lookup"><span data-stu-id="bbe80-111">The only reason to use the ODBC cursor library with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver is because the driver implements its cursor support through server cursors, and server cursors do not support all SQL statements.</span></span> <span data-ttu-id="bbe80-112">Erwägen Sie die Verwendung der ODBC-Cursorbibliothek, wenn ein statischer Cursor mit gespeicherten Prozeduren, Batches oder SLQ-Anweisungen, die COMPUTE, COMPUTE BY, FOR BROWSE oder INTO enthalten, erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="bbe80-112">Any time there is a need to have a static cursor with stored procedures, batches, or SQL statements containing COMPUTE, COMPUTE BY, FOR BROWSE, or INTO, consider using the ODBC cursor library.</span></span> <span data-ttu-id="bbe80-113">Gehen Sie mit der Cursorbibliothek jedoch sorgfältig um, da sie das gesamte Resultset auf dem Client zwischenspeichert und dadurch viel Speicherplatz belegt und die Leistung beeinträchtigt werden kann.</span><span class="sxs-lookup"><span data-stu-id="bbe80-113">However, care must be used with the cursor library because it caches the entire result set on the client, which can use large amounts of memory and slow performance.</span></span>  
  
 <span data-ttu-id="bbe80-114">Eine Anwendung ruft die Cursor Bibliothek auf Verbindungs Basis mithilfe von [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) auf, um das SQL_ATTR_ODBC_CURSORS Verbindungs Attribut festzulegen, bevor eine Verbindung mit einer Datenquelle hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="bbe80-114">An application invokes the cursor library on a connection-by-connection basis by using [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to set the SQL_ATTR_ODBC_CURSORS connection attribute before connecting to a data source.</span></span> <span data-ttu-id="bbe80-115">SQL_ATTR_ODBC_CURSORS wird auf einen von drei Werten festgelegt:</span><span class="sxs-lookup"><span data-stu-id="bbe80-115">SQL_ATTR_ODBC_CURSORS is set to one of three values:</span></span>  
  
 <span data-ttu-id="bbe80-116">SQL_CUR_USE_ODBC</span><span class="sxs-lookup"><span data-stu-id="bbe80-116">SQL_CUR_USE_ODBC</span></span>  
 <span data-ttu-id="bbe80-117">Wenn diese Option mit dem [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client-ODBC-Treiber festgelegt wird, überschreibt die ODBC-Cursor Bibliothek die [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] native Cursor Unterstützung des Native Client-ODBC-Treibers.</span><span class="sxs-lookup"><span data-stu-id="bbe80-117">When this option is set with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, the ODBC cursor library overrides the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver's native cursor support.</span></span> <span data-ttu-id="bbe80-118">Für die Verbindung können nur von der Cursorbibliothek unterstützte Cursortypen verwendet werden. Servercursor können nicht verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="bbe80-118">Only the cursor types supported by the cursor library can be used for the connection; server cursors cannot be used.</span></span>  
  
 <span data-ttu-id="bbe80-119">SQL_CUR_USE_DRIVER</span><span class="sxs-lookup"><span data-stu-id="bbe80-119">SQL_CUR_USE_DRIVER</span></span>  
 <span data-ttu-id="bbe80-120">Wenn diese Option festgelegt ist, kann die gesamte Cursor Unterstützung für den [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client-ODBC-Treiber für die Verbindung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="bbe80-120">When this option is set, all of the cursor support native to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver can be used for the connection.</span></span> <span data-ttu-id="bbe80-121">Die ODBC-Cursorbibliothek kann nicht verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="bbe80-121">The ODBC cursor library cannot be used.</span></span> <span data-ttu-id="bbe80-122">Alle Cursor werden als Servercursor implementiert.</span><span class="sxs-lookup"><span data-stu-id="bbe80-122">All cursors are implemented as server cursors.</span></span>  
  
 <span data-ttu-id="bbe80-123">SQL_CUR_USE_IF_NEEDED</span><span class="sxs-lookup"><span data-stu-id="bbe80-123">SQL_CUR_USE_IF_NEEDED</span></span>  
 <span data-ttu-id="bbe80-124">Wenn diese Option festgelegt ist, ist der Effekt identisch mit SQL_CUR_USE_DRIVER, wenn er mit dem [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client-ODBC-Treiber verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="bbe80-124">When this option is set, the effect is the same as SQL_CUR_USE_DRIVER when used with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver.</span></span> <span data-ttu-id="bbe80-125">Zur Verbindungszeit prüft der ODBC-Treiber-Manager, ob der ODBC-Treiber, mit dem eine Verbindung hergestellt wird, die SQL_FETCH_PRIOR-Option von [SQLFetchScroll](../../native-client-odbc-api/sqlfetchscroll.md)unterstützt.</span><span class="sxs-lookup"><span data-stu-id="bbe80-125">At connect time, the ODBC Driver Manager tests to see if the ODBC driver being connected to supports the SQL_FETCH_PRIOR option of [SQLFetchScroll](../../native-client-odbc-api/sqlfetchscroll.md).</span></span> <span data-ttu-id="bbe80-126">Wenn der Treiber die Option nicht unterstützt, lädt der ODBC-Treiber-Manager die ODBC-Cursorbibliothek.</span><span class="sxs-lookup"><span data-stu-id="bbe80-126">If the driver does not support the option, the ODBC Driver Manager loads the ODBC cursor library.</span></span> <span data-ttu-id="bbe80-127">Unterstützt der Treiber die Option, so lädt der ODBC-Treiber-Manager die ODBC-Cursorbibliothek nicht und die Anwendung verwendet die systemeigene Unterstützung des Treibers.</span><span class="sxs-lookup"><span data-stu-id="bbe80-127">If the driver does support the option, the ODBC Driver Manager does not load the ODBC cursor library and the application uses the native support of the driver.</span></span> <span data-ttu-id="bbe80-128">Da der ODBC- [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Treiber von Native Client SQL_FETCH_PRIOR unterstützt, lädt der ODBC-Treiber-Manager die ODBC-Cursor Bibliothek nicht.</span><span class="sxs-lookup"><span data-stu-id="bbe80-128">Because the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports SQL_FETCH_PRIOR, the ODBC Driver Manager does not load the ODBC cursor library.</span></span>  
  
 <span data-ttu-id="bbe80-129">Die Cursorbibliothek ermöglicht Anwendungen, mehrere aktive Anwendungen für eine Verbindung sowie bildlauffähige und aktualisierbare Cursor zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="bbe80-129">The cursor library allows applications to use multiple active statements on a connection, as well as scrollable, updatable cursors.</span></span> <span data-ttu-id="bbe80-130">Die Cursorbibliothek muss geladen sein, damit diese Funktion unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="bbe80-130">The cursor library must be loaded to support this functionality.</span></span> <span data-ttu-id="bbe80-131">Verwenden Sie [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) , um anzugeben, wie die Cursor Bibliothek verwendet werden soll, und [SQLSetStmtAttr](../../native-client-odbc-api/sqlsetstmtattr.md) , um den Cursortyp, die Parallelität und die Rowsetgröße anzugeben.</span><span class="sxs-lookup"><span data-stu-id="bbe80-131">Use [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to specify how the cursor library should be used and [SQLSetStmtAttr](../../native-client-odbc-api/sqlsetstmtattr.md) to specify the cursor type, concurrency, and rowset size.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bbe80-132">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="bbe80-132">See Also</span></span>  
 [<span data-ttu-id="bbe80-133">Implementieren von Cursorn</span><span class="sxs-lookup"><span data-stu-id="bbe80-133">How Cursors Are Implemented</span></span>](how-cursors-are-implemented.md)  
  
  

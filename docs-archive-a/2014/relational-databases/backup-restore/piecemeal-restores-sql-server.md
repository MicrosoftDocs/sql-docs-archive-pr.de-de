---
title: Schrittweise Wiederherstellungen [SQL Server] | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
helpviewer_keywords:
- partial updates [SQL Server]
- staged restores [SQL Server]
- piecemeal restores [SQL Server]
- restoring [SQL Server], piecemeal restore scenario
ms.assetid: 208f55e0-0762-4cfb-85c4-d36a76ea0f5b
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: ebc4ea11780908f847946a01338571211b57678a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87699813"
---
# <a name="piecemeal-restores-sql-server"></a><span data-ttu-id="e18e6-102">Schrittweise Wiederherstellungen [SQL Server]</span><span class="sxs-lookup"><span data-stu-id="e18e6-102">Piecemeal Restores (SQL Server)</span></span>
  <span data-ttu-id="e18e6-103">Dieses Thema ist nur für Datenbanken in der Enterprise Edition von [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] relevant, die mehrere Dateien oder Dateigruppen enthalten, und unter dem einfachen Modell nur für schreibgeschützte Dateigruppen.</span><span class="sxs-lookup"><span data-stu-id="e18e6-103">This topic is relevant only for databases in the Enterprise edition of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that contain multiple files or filegroups; and, under the simple model, only for read-only filegroups.</span></span>  
  
 <span data-ttu-id="e18e6-104">Weitere Informationen zur schrittweisen Wiederherstellung und speicheroptimierten Tabellen finden Sie unter [Schrittweise Wiederherstellung von Datenbanken mit speicheroptimierten Tabellen](../in-memory-oltp/memory-optimized-tables.md).</span><span class="sxs-lookup"><span data-stu-id="e18e6-104">For information about piecemeal restore and memory-optimized tables, see [Piecemeal Restore of Databases With Memory-Optimized Tables](../in-memory-oltp/memory-optimized-tables.md).</span></span>  
  
 <span data-ttu-id="e18e6-105">*Schritt-für-Schritt-Wiederherstellung* : Ermöglicht die Wiederherstellung von Datenbanken mit mehreren Dateigruppen in einzelnen Phasen.</span><span class="sxs-lookup"><span data-stu-id="e18e6-105">*Piecemeal restore* allows databases that contain multiple filegroups to be restored and recovered in stages.</span></span> <span data-ttu-id="e18e6-106">Die schrittweise Wiederherstellung umfasst eine Reihe von Wiederherstellungssequenzen, wobei mit der primären Dateigruppe und in einigen Fällen mit einer oder mehreren sekundären Dateigruppen begonnen wird.</span><span class="sxs-lookup"><span data-stu-id="e18e6-106">Piecemeal restore involves a series of restore sequences, starting with the primary filegroup and, in some cases, one or more secondary filegroups.</span></span> <span data-ttu-id="e18e6-107">Bei der schrittweisen Wiederherstellung finden Überprüfungen statt, um sicherzustellen, dass die Datenbank am Ende konsistent ist.</span><span class="sxs-lookup"><span data-stu-id="e18e6-107">Piecemeal restore maintains checks to ensure that the database will be consistent in the end.</span></span> <span data-ttu-id="e18e6-108">Nach Abschluss der Wiederherstellungssequenz können wiederhergestellte Dateien sofort online geschaltet werden, sofern diese Dateien gültig und mit der Datenbank konsistent sind.</span><span class="sxs-lookup"><span data-stu-id="e18e6-108">After the restore sequence is completed, recovered files, if they are valid and consistent with the database, can be brought online directly.</span></span>  
  
 <span data-ttu-id="e18e6-109">Die schrittweise Wiederherstellung ist für sämtliche Wiederherstellungsmodelle möglich, zeichnet sich jedoch durch höhere Flexibilität in Bezug auf die vollständigen und massenprotokollierten Modelle als in Bezug auf das einfache Modell aus.</span><span class="sxs-lookup"><span data-stu-id="e18e6-109">Piecemeal restore works with all recovery models, but is more flexible for the full and bulk-logged models than for the simple model.</span></span>  
  
 <span data-ttu-id="e18e6-110">Jede schrittweise Wiederherstellung beginnt mit einer anfänglichen Wiederherstellungssequenz, die als *Teilwiederherstellungssequenz*bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="e18e6-110">Every piecemeal restore starts with an initial restore sequence called the *partial-restore sequence*.</span></span> <span data-ttu-id="e18e6-111">Mit der Teilwiederherstellungssequenz wird mindestens die primäre Dateigruppe wiederhergestellt und beim einfachen Wiederherstellungsmodell alle Dateigruppen mit Lese-/Schreibzugriff.</span><span class="sxs-lookup"><span data-stu-id="e18e6-111">Minimally, the partial-restore sequence restores and recovers the primary filegroup and, under the simple recovery model, all read/write filegroups.</span></span> <span data-ttu-id="e18e6-112">Während der schrittweisen Wiederherstellungssequenz muss die gesamte Datenbank offline geschaltet werden.</span><span class="sxs-lookup"><span data-stu-id="e18e6-112">During the piecemeal-restore sequence, the whole database must go offline.</span></span> <span data-ttu-id="e18e6-113">Danach ist die Datenbank online, und die wiederhergestellten Dateigruppen sind verfügbar.</span><span class="sxs-lookup"><span data-stu-id="e18e6-113">Thereafter, the database is online and restored filegroups are available.</span></span> <span data-ttu-id="e18e6-114">Alle nicht wiederhergestellten Dateigruppen bleiben jedoch offline, und es ist kein Zugriff möglich.</span><span class="sxs-lookup"><span data-stu-id="e18e6-114">However, any unrestored filegroups remain offline and are not accessible.</span></span> <span data-ttu-id="e18e6-115">Alle Offlinedateigruppen können jedoch später durch eine Dateiwiederherstellung wiederhergestellt und online geschaltet werden.</span><span class="sxs-lookup"><span data-stu-id="e18e6-115">Any offline filegroups, however, can be restored and brought online later by a file restore.</span></span>  
  
 <span data-ttu-id="e18e6-116">Unabhängig davon, welches Wiederherstellungsmodell von der Datenbank verwendet wird, beginnt die Teilwiederherstellungssequenz mit einer RESTORE DATABASE-Anweisung, mit der eine vollständige Sicherung wiederhergestellt und die PARTIAL-Option angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="e18e6-116">Regardless of the recovery model that is used by the database, the partial-restore sequence starts with a RESTORE DATABASE statement that restores a full backup and specifies the PARTIAL option.</span></span> <span data-ttu-id="e18e6-117">Mit der Option PARTIAL wird stets eine neue schrittweise Wiederherstellung gestartet. Deshalb müssen Sie PARTIAL nur einmal in der Anfangsanweisung der Teilwiederherstellungssequenz angeben.</span><span class="sxs-lookup"><span data-stu-id="e18e6-117">The PARTIAL option always starts a new piecemeal restore; therefore, you must specify PARTIAL only one time in the initial statement of the partial-restore sequence.</span></span> <span data-ttu-id="e18e6-118">Wenn die Teilwiederherstellungssequenz abgeschlossen und die Datenbank online geschaltet wird, wird den übrigen Dateien der Status "Wiederherstellung ausstehend" zugewiesen, da ihre Wiederherstellung verschoben wurde.</span><span class="sxs-lookup"><span data-stu-id="e18e6-118">When the partial restore sequence finishes and the database is brought online, the state of the remaining files becomes "recovery pending" because their recovery has been postponed.</span></span>  
  
 <span data-ttu-id="e18e6-119">Anschließend schließt eine schrittweise Wiederherstellung normalerweise eine oder mehrere Wiederherstellungssequenzen ein, die als *Dateigruppen-Wiederherstellungssequenzen*bezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="e18e6-119">Subsequently, a piecemeal restore typically includes one or more restore sequences, which are called *filegroup-restore sequences*.</span></span> <span data-ttu-id="e18e6-120">Sie können mit der Ausführung einer bestimmten Dateigruppen-Wiederherstellungssequenz so lange warten, wie Sie möchten.</span><span class="sxs-lookup"><span data-stu-id="e18e6-120">You can wait to perform a specific filegroup-restore sequence for as long as you want.</span></span> <span data-ttu-id="e18e6-121">Mit jeder Dateigruppenwiederherstellungssequenz wird mindestens eine Offlinedateigruppe bis zu einem mit der Datenbank konsistenten Zeitpunkt wiederhergestellt.</span><span class="sxs-lookup"><span data-stu-id="e18e6-121">Each filegroup-restore sequence restores and recovers one or more offline filegroups to a point consistent with the database.</span></span> <span data-ttu-id="e18e6-122">Zeitpunkt und Anzahl der Dateigruppen-Wiederherstellungssequenzen richten sich nach Ihrem Wiederherstellungsziel, nach der Anzahl der wiederherzustellenden Offlinedateigruppen und danach, wie viele Sie davon pro Dateigruppen-Wiederherstellungssequenz wiederherstellen.</span><span class="sxs-lookup"><span data-stu-id="e18e6-122">The timing and number of filegroup-restore sequences depends on your recovery goal, the number of offline filegroups you want to restore, and on how many of them you restore per filegroup-restore sequence.</span></span>  
  
 <span data-ttu-id="e18e6-123">Die genauen Anforderungen zum Ausführen einer schrittweisen Wiederherstellung richten sich nach dem Wiederherstellungsmodell der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="e18e6-123">The exact requirements for performing a piecemeal restore depend on the recovery model of the database.</span></span> <span data-ttu-id="e18e6-124">Weitere Informationen finden Sie unter "Schrittweise Wiederherstellung mit dem einfachen Wiederherstellungsmodell" und "Schrittweise Wiederherstellung mit dem vollständigen Wiederherstellungsmodell" weiter unten in diesem Thema.</span><span class="sxs-lookup"><span data-stu-id="e18e6-124">For more information, see "Piecemeal Restore Under the Simple Recovery Model" and "Piecemeal Restore Under the Full Recovery Model," later in this topic.</span></span>  
  
## <a name="piecemeal-restore-scenarios"></a><span data-ttu-id="e18e6-125">Szenarien für die schrittweise Wiederherstellung</span><span class="sxs-lookup"><span data-stu-id="e18e6-125">Piecemeal Restore Scenarios</span></span>  
 <span data-ttu-id="e18e6-126">Alle Editionen von [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] unterstützen schrittweise Offlinewiederherstellungen.</span><span class="sxs-lookup"><span data-stu-id="e18e6-126">All editions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] support offline piecemeal restores.</span></span> <span data-ttu-id="e18e6-127">In der Enterprise Edition kann eine schrittweise Wiederherstellung entweder online oder offline erfolgen.</span><span class="sxs-lookup"><span data-stu-id="e18e6-127">In the Enterprise edition, a piecemeal restore can be either online or offline.</span></span> <span data-ttu-id="e18e6-128">Die Folgen der schrittweisen Offline- und der schrittweisen Onlinewiederherstellung werden anhand der folgenden Szenarien deutlich:</span><span class="sxs-lookup"><span data-stu-id="e18e6-128">The implications of offline and online piecemeal restores are as follows:</span></span>  
  
-   <span data-ttu-id="e18e6-129">Szenario für schrittweise Offlinewiederherstellung</span><span class="sxs-lookup"><span data-stu-id="e18e6-129">Offline piecemeal restore scenario</span></span>  
  
     <span data-ttu-id="e18e6-130">Bei einer schrittweisen Offlinewiederherstellung ist die Datenbank nach der Teilwiederherstellungssequenz offline.</span><span class="sxs-lookup"><span data-stu-id="e18e6-130">In an offline piecemeal restore, the database is online after the partial-restore sequence.</span></span> <span data-ttu-id="e18e6-131">Dateigruppen, die noch nicht wiederhergestellt wurden, bleiben offline. Sie können jedoch nach Bedarf wiederhergestellt werden, nachdem die Datenbank offline geschaltet wurde.</span><span class="sxs-lookup"><span data-stu-id="e18e6-131">Filegroups that have not yet been restored remain offline, but they can be restored as you need them after taking the database offline.</span></span>  
  
-   <span data-ttu-id="e18e6-132">Szenario für schrittweise Onlinewiederherstellung</span><span class="sxs-lookup"><span data-stu-id="e18e6-132">Online piecemeal restore scenario</span></span>  
  
     <span data-ttu-id="e18e6-133">Bei einer schrittweisen Onlinewiederherstellung ist die Datenbank nach der Teilwiederherstellungssequenz online, und die primäre Dateigruppe und wiederhergestellte sekundäre Dateigruppen sind verfügbar.</span><span class="sxs-lookup"><span data-stu-id="e18e6-133">In an online piecemeal restore, after the partial-restore sequence, the database is online, and the primary filegroup and any recovered secondary filegroups are available.</span></span> <span data-ttu-id="e18e6-134">Dateigruppen, die noch nicht wiederhergestellt wurden, bleiben offline. Sie können jedoch bei Bedarf wiederhergestellt werden, während die Datenbank online bleibt.</span><span class="sxs-lookup"><span data-stu-id="e18e6-134">Filegroups that have not yet been restored remain offline, but they can be restored as needed while the database remains online.</span></span>  
  
     <span data-ttu-id="e18e6-135">Schrittweise Onlinewiederherstellungen können zurückgestellte Transaktionen umfassen.</span><span class="sxs-lookup"><span data-stu-id="e18e6-135">Online piecemeal restores can involve deferred transactions.</span></span> <span data-ttu-id="e18e6-136">Wenn nur eine Teilmenge von Dateigruppen wiederhergestellt wurde, können Transaktionen in der Datenbank, die von Onlinedateigruppen abhängig sind, eventuell zurückgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="e18e6-136">When only a subset of filegroups has been restored, transactions in the database that depend on online filegroups might become deferred.</span></span> <span data-ttu-id="e18e6-137">Dies entspricht den Erwartungen, da die gesamte Datenbank konsistent sein muss.</span><span class="sxs-lookup"><span data-stu-id="e18e6-137">This is typical, because the whole database must be consistent.</span></span> <span data-ttu-id="e18e6-138">Weitere Informationen finden Sie unter [Markierte Transaktionen &#40;SQL Server&#41;](deferred-transactions-sql-server.md)entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="e18e6-138">For more information, see [Deferred Transactions &#40;SQL Server&#41;](deferred-transactions-sql-server.md).</span></span>  
  
-   [!INCLUDE[hek_1](../../includes/hek-1-md.md)] <span data-ttu-id="e18e6-139">Szenario für die schrittweise Wiederherstellung</span><span class="sxs-lookup"><span data-stu-id="e18e6-139">piecemeal restore scenario</span></span>  
  
     <span data-ttu-id="e18e6-140">Weitere Informationen zur schrittweisen Wiederherstellung von In-Memory OLTP-Datenbanken finden Sie unter [Schrittweise Sicherung und Wiederherstellung von Datenbanken mit speicheroptimierten Tabellen](../in-memory-oltp/memory-optimized-tables.md).</span><span class="sxs-lookup"><span data-stu-id="e18e6-140">For information on Piecemeal Restores of In-Memory OLTP databases see [Piecemeal Backup and Restore of Databases With Memory-Optimized Tables](../in-memory-oltp/memory-optimized-tables.md).</span></span>  
  
## <a name="restrictions"></a><span data-ttu-id="e18e6-141">Beschränkungen</span><span class="sxs-lookup"><span data-stu-id="e18e6-141">Restrictions</span></span>  
 <span data-ttu-id="e18e6-142">Wenn in einer Teilwiederherstellungssequenz eine [FILESTREAM](../blob/filestream-sql-server.md) -Dateigruppe ausgeschlossen wird, wird die Wiederherstellung bis zu einem bestimmten Zeitpunkt nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="e18e6-142">If a partial restore sequence excludes any [FILESTREAM](../blob/filestream-sql-server.md) filegroup, point-in-time restore is not supported.</span></span> <span data-ttu-id="e18e6-143">Sie können das Fortsetzen der Wiederherstellungssequenz erzwingen.</span><span class="sxs-lookup"><span data-stu-id="e18e6-143">You can force the restore sequence to continue.</span></span> <span data-ttu-id="e18e6-144">Die FILESTREAM-Dateigruppen, die nicht in die RESTORE-Anweisung eingeschlossen werden, können jedoch zu keinem Zeitpunkt wiederhergestellt werden.</span><span class="sxs-lookup"><span data-stu-id="e18e6-144">However the FILESTREAM filegroups that are omitted from your RESTORE statement can never be restored.</span></span> <span data-ttu-id="e18e6-145">Wenn Sie eine Wiederherstellung bis zu einem bestimmten Zeitpunkt erzwingen möchten, geben Sie die CONTINUE_AFTER_ERROR-Option zusammen mit der Option STOPAT, STOPATMARK oder STOPBEFOREMARK an. Diese müssen Sie auch in den folgenden RESTORE LOG-Anweisungen angeben.</span><span class="sxs-lookup"><span data-stu-id="e18e6-145">To force a point-in-time restore, specify the CONTINUE_AFTER_ERROR option together with the STOPAT, STOPATMARK, or STOPBEFOREMARK option, which you must also specify in your subsequent RESTORE LOG statements.</span></span> <span data-ttu-id="e18e6-146">Wenn Sie CONTINUE_AFTER_ERROR angeben, ist die Teilwiederherstellungssequenz erfolgreich, und die FILESTREAM-Dateigruppe wird nicht mehr wiederherstellbar.</span><span class="sxs-lookup"><span data-stu-id="e18e6-146">If you specify CONTINUE_AFTER_ERROR, the partial restore sequence succeeds and the FILESTREAM filegroup becomes unrecoverable.</span></span>  
  
## <a name="piecemeal-restore-under-the-simple-recovery-model"></a><span data-ttu-id="e18e6-147">Schrittweise Wiederherstellung mit dem einfachen Wiederherstellungsmodell</span><span class="sxs-lookup"><span data-stu-id="e18e6-147">Piecemeal Restore Under the Simple Recovery Model</span></span>  
 <span data-ttu-id="e18e6-148">Beim einfachen Wiederherstellungsmodell muss die schrittweise Wiederherstellungssequenz mit einer vollständigen Datenbanksicherung oder mit einer Teilsicherung beginnen.</span><span class="sxs-lookup"><span data-stu-id="e18e6-148">Under the simple recovery model, the piecemeal restore sequence must start with a full database or partial backup.</span></span> <span data-ttu-id="e18e6-149">Dann wird als Nächstes die letzte differenzielle Sicherung wiederhergestellt, wenn es sich bei der wiederhergestellten Sicherung um eine differenzielle Basis handelt.</span><span class="sxs-lookup"><span data-stu-id="e18e6-149">Then, if the restored backup is a differential base, restore the latest differential backup next.</span></span>  
  
 <span data-ttu-id="e18e6-150">Wenn Sie während der ersten Teilwiederherstellungssequenz nur eine Teilmenge von Dateigruppen mit Lese-/Schreibzugriff wiederherstellen, werden alle nicht wiederhergestellten Dateigruppen mit der Wiederherstellung der teilweise wiederhergestellten Datenbank als veraltet markiert (defunct-Status).</span><span class="sxs-lookup"><span data-stu-id="e18e6-150">During the first partial restore sequence, if you restore only a subset of read/write filegroups, any unrestored filegroups become defunct when you recover the partially restored database.</span></span> <span data-ttu-id="e18e6-151">Das Auslassen einer Dateigruppe mit Lese-/Schreibzugriff aus der Teilwiederherstellungssequenz empfiehlt sich nur in folgenden Fällen:</span><span class="sxs-lookup"><span data-stu-id="e18e6-151">Omitting a read/write filegroup from the partial-restore sequence is appropriate only in the following cases:</span></span>  
  
-   <span data-ttu-id="e18e6-152">Wenn Sie die nicht wiederhergestellten Dateigruppen außer Kraft setzen möchten.</span><span class="sxs-lookup"><span data-stu-id="e18e6-152">You intend for the unrestored filegroups to become defunct.</span></span>  
  
-   <span data-ttu-id="e18e6-153">Die Wiederherstellungssequenz erreicht einen Wiederherstellungspunkt, ab dem alle nicht wiederhergestellten Dateigruppen schreibgeschützt, gelöscht oder veraltet sind (infolge einer zuvor ausgeführten Wiederherstellungssequenz der schrittweisen Wiederherstellung).</span><span class="sxs-lookup"><span data-stu-id="e18e6-153">The restore sequence will arrive at a recovery point at which each unrestored filegroup has become read-only, dropped, or defunct (during a previous restore in the partial-restore sequence).</span></span>  
  
-   <span data-ttu-id="e18e6-154">Die vollständige Sicherung wurde ausgeführt, während die Datenbank das einfache Wiederherstellungsmodell verwendet hat, der Wiederherstellungspunkt jedoch an einem Zeitpunkt liegt, an dem die Datenbank das vollständige Wiederherstellungsmodell verwendet.</span><span class="sxs-lookup"><span data-stu-id="e18e6-154">The full backup was taken while the database was using the simple recovery model, but the recovery point is at a time when the database is using the full recovery model.</span></span> <span data-ttu-id="e18e6-155">Weitere Informationen finden Sie unter "Ausführen einer schrittweisen Wiederherstellung einer Datenbank, deren Wiederherstellungsmodell von einfach in vollständig geändert wurde" weiter unten in diesem Thema.</span><span class="sxs-lookup"><span data-stu-id="e18e6-155">For more information, see "Performing a Piecemeal Restore of a Database Whose Recovery Model Has Been Switched from Simple to Full," later in this topic.</span></span>  
  
### <a name="requirements-for-piecemeal-restore-under-the-simple-recovery-model"></a><span data-ttu-id="e18e6-156">Anforderungen bei der schrittweisen Wiederherstellung mit dem einfachen Wiederherstellungsmodell</span><span class="sxs-lookup"><span data-stu-id="e18e6-156">Requirements for Piecemeal Restore Under the Simple Recovery Model</span></span>  
 <span data-ttu-id="e18e6-157">Beim einfachen Wiederherstellungsmodell werden in der Anfangsphase die primäre Dateigruppe und alle sekundären Dateigruppen mit Lese-/Schreibzugriff wiederhergestellt.</span><span class="sxs-lookup"><span data-stu-id="e18e6-157">Under the simple recovery model, the initial stage restores and recovers the primary filegroup and all read/write secondary filegroups.</span></span> <span data-ttu-id="e18e6-158">Nach Abschluss der Anfangsphase können wiederhergestellte Dateien sofort online geschaltet werden, sofern diese Dateien gültig und mit der Datenbank konsistent sind.</span><span class="sxs-lookup"><span data-stu-id="e18e6-158">After the initial stage is completed, recovered files, if they are valid and consistent with the database, can be brought online directly.</span></span>  
  
 <span data-ttu-id="e18e6-159">Anschließend können schreibgeschützte Dateigruppen in einer oder mehreren zusätzlichen Phasen wiederhergestellt werden.</span><span class="sxs-lookup"><span data-stu-id="e18e6-159">Thereafter, read-only filegroups can be restored in one or more additional stages.</span></span>  
  
 <span data-ttu-id="e18e6-160">Die schrittweise Wiederherstellung für eine schreibgeschützte sekundäre Dateigruppe ist nur dann verfügbar, wenn folgende Aussagen zutreffen:</span><span class="sxs-lookup"><span data-stu-id="e18e6-160">Piecemeal restore is available for a read-only secondary filegroup only if the following are true:</span></span>  
  
-   <span data-ttu-id="e18e6-161">Sie war zum Zeitpunkt der Sicherung schreibgeschützt.</span><span class="sxs-lookup"><span data-stu-id="e18e6-161">Was read-only when backed up.</span></span>  
  
-   <span data-ttu-id="e18e6-162">Sie ist schreibgeschützt geblieben (wodurch sie logisch konsistent mit der primären Dateigruppe bleibt).</span><span class="sxs-lookup"><span data-stu-id="e18e6-162">Has remained read-only (keeping it logically consistent with the primary filegroup).</span></span>  
  
 <span data-ttu-id="e18e6-163">Beim Ausführen einer schrittweisen Wiederherstellung müssen die folgenden Richtlinien befolgt werden:</span><span class="sxs-lookup"><span data-stu-id="e18e6-163">To perform a piecemeal restore, the following guidelines must be followed:</span></span>  
  
-   <span data-ttu-id="e18e6-164">Ein vollständiger Sicherungssatz für die schrittweise Wiederherstellung einer Datenbank des einfachen Wiederherstellungsmodells muss Folgendes enthalten:</span><span class="sxs-lookup"><span data-stu-id="e18e6-164">A complete set of backups for the piecemeal restore of a simple recovery model database must contain the following:</span></span>  
  
    -   <span data-ttu-id="e18e6-165">Eine Teilsicherung oder eine vollständige Datenbanksicherung, die neben der primären Dateigruppe auch sämtliche Dateigruppen enthält, die zum Zeitpunkt der Sicherung über Lese-/Schreibzugriff verfügten.</span><span class="sxs-lookup"><span data-stu-id="e18e6-165">A partial or full database backup that contains the primary filegroup and all filegroups that were read/write at the time of the backup.</span></span>  
  
    -   <span data-ttu-id="e18e6-166">Eine Sicherung der einzelnen schreibgeschützten Dateien.</span><span class="sxs-lookup"><span data-stu-id="e18e6-166">A backup of each read-only file.</span></span>  
  
-   <span data-ttu-id="e18e6-167">Damit die Sicherung einer schreibgeschützten Datei mit der primären Dateigruppe konsistent ist, muss die sekundäre Dateigruppe ab dem Zeitpunkt der Sicherung bis zum Abschluss der Sicherung der primären Dateigruppe schreibgeschützt sein.</span><span class="sxs-lookup"><span data-stu-id="e18e6-167">For the backup of a read-only file to be consistent with the primary filegroup, the secondary filegroup must have been read-only from when it was backed up until the backup that contains the primary filegroup was completed.</span></span> <span data-ttu-id="e18e6-168">Sie können differenzielle Dateisicherungen verwenden, sofern sie vorgenommen wurden, nachdem der Schreibschutz für die Dateigruppe festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="e18e6-168">You can use differential file backups, if they were taken after the filegroup became read-only.</span></span>  
  
### <a name="piecemeal-restore-stages-simple-recovery-model"></a><span data-ttu-id="e18e6-169">Phasen der schrittweisen Wiederherstellung (einfaches Wiederherstellungsmodell)</span><span class="sxs-lookup"><span data-stu-id="e18e6-169">Piecemeal Restore Stages (Simple Recovery Model)</span></span>  
 <span data-ttu-id="e18e6-170">Das Szenario der schrittweisen Wiederherstellung umfasst folgende Phasen:</span><span class="sxs-lookup"><span data-stu-id="e18e6-170">The piecemeal restore scenario involves the following stages:</span></span>  
  
-   <span data-ttu-id="e18e6-171">Anfangsphase (Wiederherstellung der primären Dateigruppe und aller Dateigruppen mit Lese-/Schreibzugriff)</span><span class="sxs-lookup"><span data-stu-id="e18e6-171">Initial stage (restore and recover the primary filegroup and all read/write filegroups)</span></span>  
  
     <span data-ttu-id="e18e6-172">In der Anfangsphase wird eine Teilwiederherstellung ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="e18e6-172">The initial stage performs a partial restore.</span></span> <span data-ttu-id="e18e6-173">Durch die Teilwiederherstellungssequenz werden die primäre Dateigruppe, alle sekundären Dateigruppen mit Lese-/Schreibzugriff und (optional) einige schreibgeschützte Dateigruppen wiederhergestellt.</span><span class="sxs-lookup"><span data-stu-id="e18e6-173">The partial restore sequence restores the primary filegroup, all read/write secondary filegroups, and (optionally) some of the read-only filegroups.</span></span> <span data-ttu-id="e18e6-174">Während der Anfangsphase muss die gesamte Datenbank offline geschaltet werden.</span><span class="sxs-lookup"><span data-stu-id="e18e6-174">During the initial stage, the whole database must go offline.</span></span> <span data-ttu-id="e18e6-175">Nach der Anfangsphase befindet sich die Datenbank im Onlinezustand, und die wiederhergestellten Dateigruppen sind verfügbar.</span><span class="sxs-lookup"><span data-stu-id="e18e6-175">After the initial stage, the database is online, and restored filegroups are available.</span></span> <span data-ttu-id="e18e6-176">Schreibgeschützte Dateigruppen, die noch nicht wiederhergestellt wurden, bleiben jedoch offline.</span><span class="sxs-lookup"><span data-stu-id="e18e6-176">However, any read-only filegroups that have not yet been restored, remain offline.</span></span>  
  
     <span data-ttu-id="e18e6-177">Die erste RESTORE-Anweisung in der Anfangsphase muss folgende Voraussetzungen erfüllen:</span><span class="sxs-lookup"><span data-stu-id="e18e6-177">The first RESTORE statement in the initial stage must do the following:</span></span>  
  
    -   <span data-ttu-id="e18e6-178">Verwenden einer Teilsicherung oder einer vollständigen Datenbanksicherung, die neben der primären Dateigruppe auch sämtliche Dateigruppen enthält, die zum Zeitpunkt der Sicherung Dateigruppen mit Lese-/Schreibzugriff waren.</span><span class="sxs-lookup"><span data-stu-id="e18e6-178">Use a partial or full database backup that contains the primary filegroup and all filegroups that were read/write at the time of the backup.</span></span> <span data-ttu-id="e18e6-179">In vielen Fällen beginnt eine Teilwiederherstellungssequenz mit der Wiederherstellung einer Teilsicherung.</span><span class="sxs-lookup"><span data-stu-id="e18e6-179">It is common to start a partial restore sequence by restoring a partial backup.</span></span>  
  
    -   <span data-ttu-id="e18e6-180">Geben Sie die PARTIAL-Option an, mit der der Start einer schrittweisen Wiederherstellung angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="e18e6-180">Specify the PARTIAL option, which indicates the start of a piecemeal restore.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e18e6-181">Die PARTIAL-Option führt Sicherheitsüberprüfungen durch, mit denen sichergestellt wird, dass die resultierende Datenbank als Produktionsdatenbank geeignet ist.</span><span class="sxs-lookup"><span data-stu-id="e18e6-181">The PARTIAL option performs safety checks that ensure that the resulting database is suited for use as a production database.</span></span>  
  
    -   <span data-ttu-id="e18e6-182">Geben Sie die Option READ_WRITE_FILEGROUPS an, wenn es sich bei der Sicherung um eine vollständige Datenbanksicherung handelt.</span><span class="sxs-lookup"><span data-stu-id="e18e6-182">Specify the READ_WRITE_FILEGROUPS option if the backup is a full database backup.</span></span>  
  
-   <span data-ttu-id="e18e6-183">Während die Datenbank online ist, können Sie mit einer oder mehreren Onlinedateiwiederherstellungen schreibgeschützte Offlinedateien wiederherstellen, die zum Zeitpunkt der Sicherung schreibgeschützt waren.</span><span class="sxs-lookup"><span data-stu-id="e18e6-183">While the database is online, you can use one or more online file restores to restore and recover offline read-only files that were read-only at the time of backup.</span></span> <span data-ttu-id="e18e6-184">Die zeitliche Planung der Onlinedateiwiederherstellung richtet sich danach, wann die Daten online geschaltet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="e18e6-184">The timing of the online file restores depends on when you want to have the data online.</span></span>  
  
     <span data-ttu-id="e18e6-185">Ob Sie Daten in einer Datei wiederherstellen müssen, hängt von folgenden Faktoren ab:</span><span class="sxs-lookup"><span data-stu-id="e18e6-185">Whether you must restore data to a file depends on the following:</span></span>  
  
    -   <span data-ttu-id="e18e6-186">Gültige schreibgeschützte Dateien, die mit der Datenbank konsistent sind, können direkt online geschaltet werden, indem sie ohne Wiederherstellung von Daten wiederhergestellt werden.</span><span class="sxs-lookup"><span data-stu-id="e18e6-186">Valid read-only files that are consistent with the database can be brought online directly by recovering them without restoring any data.</span></span>  
  
    -   <span data-ttu-id="e18e6-187">Dateien, die beschädigt oder nicht mit der Datenbank konsistent sind, müssen gespeichert werden, bevor sie wiederhergestellt werden.</span><span class="sxs-lookup"><span data-stu-id="e18e6-187">Files that are damaged or inconsistent with the database must be restored before they are recovered.</span></span>  
  
### <a name="examples"></a><span data-ttu-id="e18e6-188">Beispiele</span><span class="sxs-lookup"><span data-stu-id="e18e6-188">Examples</span></span>  
  
-   [<span data-ttu-id="e18e6-189">Beispiel: Schrittweise Wiederherstellung einer Datenbank &#40;Einfaches Wiederherstellungsmodell&#41;</span><span class="sxs-lookup"><span data-stu-id="e18e6-189">Example: Piecemeal Restore of Database &#40;Simple Recovery Model&#41;</span></span>](example-piecemeal-restore-of-database-simple-recovery-model.md)  
  
-   [<span data-ttu-id="e18e6-190">Beispiel: Schrittweise Wiederherstellung nur bestimmter Dateigruppen &#40;einfaches Wiederherstellungsmodell&#41;</span><span class="sxs-lookup"><span data-stu-id="e18e6-190">Example: Piecemeal Restore of Only Some Filegroups &#40;Simple Recovery Model&#41;</span></span>](example-piecemeal-restore-of-only-some-filegroups-simple-recovery-model.md)  
  
## <a name="piecemeal-restore-under-the-full-recovery-model"></a><span data-ttu-id="e18e6-191">Schrittweise Wiederherstellung mit dem vollständigen Wiederherstellungsmodell</span><span class="sxs-lookup"><span data-stu-id="e18e6-191">Piecemeal Restore Under the Full Recovery Model</span></span>  
 <span data-ttu-id="e18e6-192">Beim vollständigen oder beim massenprotokollierten Wiederherstellungsmodell ist die schrittweise Wiederherstellung für jede Datenbank verfügbar, die mehrere Dateigruppen enthält, und Sie können eine Datenbank bis zu jedem beliebigen Zeitpunkt wiederherstellen.</span><span class="sxs-lookup"><span data-stu-id="e18e6-192">Under the full recovery model or bulk-logged recovery model, piecemeal restore is available for any database that contains multiple filegroups and you can restore a database to any point in time.</span></span> <span data-ttu-id="e18e6-193">Die Wiederherstellungssequenzen einer schrittweisen Wiederherstellung verhalten sich folgendermaßen:</span><span class="sxs-lookup"><span data-stu-id="e18e6-193">The restore sequences of a piecemeal restore behave as follows:</span></span>  
  
-   <span data-ttu-id="e18e6-194">Teilwiederherstellungssequenz</span><span class="sxs-lookup"><span data-stu-id="e18e6-194">Partial-restore sequence</span></span>  
  
     <span data-ttu-id="e18e6-195">Mit der Teilwiederherstellungssequenz werden die primäre Dateigruppe und optional einige sekundäre Dateigruppen wiederhergestellt.</span><span class="sxs-lookup"><span data-stu-id="e18e6-195">The partial restore sequence restores the primary filegroup and, optionally, some of the secondary filegroups.</span></span>  
  
     <span data-ttu-id="e18e6-196">Die erste RESTORE DATABASE-Anweisung muss folgende Voraussetzungen erfüllen:</span><span class="sxs-lookup"><span data-stu-id="e18e6-196">The first RESTORE DATABASE statement must do the following:</span></span>  
  
    -   <span data-ttu-id="e18e6-197">Angeben der Option PARTIAL.</span><span class="sxs-lookup"><span data-stu-id="e18e6-197">Specify the PARTIAL option.</span></span> <span data-ttu-id="e18e6-198">Damit wird der Start einer schrittweisen Wiederherstellung angegeben.</span><span class="sxs-lookup"><span data-stu-id="e18e6-198">This indicates the start of a piecemeal restore.</span></span>  
  
    -   <span data-ttu-id="e18e6-199">Sie muss eine vollständige Datenbanksicherung verwenden, die die primäre Dateigruppe enthält.</span><span class="sxs-lookup"><span data-stu-id="e18e6-199">Use any full database backup that contains the primary filegroup.</span></span> <span data-ttu-id="e18e6-200">In vielen Fällen beginnt eine Teilwiederherstellungssequenz mit der Wiederherstellung einer Teilsicherung.</span><span class="sxs-lookup"><span data-stu-id="e18e6-200">The common practice is to start a partial restore sequence by restoring a partial backup.</span></span>  
  
    -   <span data-ttu-id="e18e6-201">Wenn die Wiederherstellung zu einem bestimmten Zeitpunkt erfolgen soll, müssen Sie die Zeit in der Teilwiederherstellungssequenz angeben.</span><span class="sxs-lookup"><span data-stu-id="e18e6-201">To restore to a specific point in time, you must specify the time in the partial restore sequence.</span></span> <span data-ttu-id="e18e6-202">In jedem nachfolgenden Schritt der Wiederherstellungssequenz muss derselbe Zeitpunkt angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="e18e6-202">Every successive step of the restore sequence must specify the same point in time.</span></span>  
  
-   <span data-ttu-id="e18e6-203">Mit Dateigruppen-Wiederherstellungssequenzen werden zusätzliche Dateigruppen zu einem mit der Datenbank konsistenten Zeitpunkt online geschaltet.</span><span class="sxs-lookup"><span data-stu-id="e18e6-203">Filegroup-restore sequences bring additional filegroups online to a point consistent with the database.</span></span>  
  
     <span data-ttu-id="e18e6-204">In der Enterprise Edition kann jede sekundäre Offlinedateigruppe wiederhergestellt werden, während die Datenbank online bleibt.</span><span class="sxs-lookup"><span data-stu-id="e18e6-204">In the Enterprise edition, any offline secondary filegroup can be restored and recovered while the database remains online.</span></span> <span data-ttu-id="e18e6-205">Wenn eine bestimmte schreibgeschützte Datei unbeschädigt und mit der Datenbank konsistent ist, muss die Datei nicht wiederhergestellt werden.</span><span class="sxs-lookup"><span data-stu-id="e18e6-205">If a specific read-only file is undamaged and consistent with the database, the file does not have to be restored.</span></span> <span data-ttu-id="e18e6-206">Weitere Informationen finden Sie unter [Wiederherstellen einer Datenbank ohne Wiederherstellung von Daten &#40;Transact-SQL&#41;](recover-a-database-without-restoring-data-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="e18e6-206">For more information, see [Recover a Database Without Restoring Data &#40;Transact-SQL&#41;](recover-a-database-without-restoring-data-transact-sql.md).</span></span>  
  
### <a name="applying-log-backups"></a><span data-ttu-id="e18e6-207">Anwenden von Protokollsicherungen</span><span class="sxs-lookup"><span data-stu-id="e18e6-207">Applying Log Backups</span></span>  
 <span data-ttu-id="e18e6-208">Wenn eine schreibgeschützte Dateigruppe bereits vor der Erstellung der Dateisicherung schreibgeschützt war, ist die Anwendung von Protokollsicherungen auf die Dateigruppe unnötig und wird von der Dateiwiederherstellung ausgelassen.</span><span class="sxs-lookup"><span data-stu-id="e18e6-208">If a read-only filegroup has been read-only since before the file backup was created, applying log backups to the filegroup is unnecessary and is skipped by file restore.</span></span> <span data-ttu-id="e18e6-209">Bei einer Dateigruppe mit Lese-/Schreibzugriff muss eine fortlaufende Kette von Protokollsicherungen auf die letzte vollständige oder differenzielle Wiederherstellung angewendet werden, um die Dateigruppe auf den Stand der aktuellen Protokolldatei zu bringen.</span><span class="sxs-lookup"><span data-stu-id="e18e6-209">If the filegroup is read/write, an unbroken chain of log backups must be applied to the last full or differential restore to bring the filegroup forward to the current log file.</span></span>  
  
### <a name="examples"></a><span data-ttu-id="e18e6-210">Beispiele</span><span class="sxs-lookup"><span data-stu-id="e18e6-210">Examples</span></span>  
  
-   [<span data-ttu-id="e18e6-211">Beispiel: Schrittweise Wiederherstellung einer Datenbank &#40;Vollständiges Wiederherstellungsmodell&#41;</span><span class="sxs-lookup"><span data-stu-id="e18e6-211">Example: Piecemeal Restore of Database &#40;Full Recovery Model&#41;</span></span>](example-piecemeal-restore-of-database-full-recovery-model.md)  
  
-   [<span data-ttu-id="e18e6-212">Beispiel: Schrittweise Wiederherstellung nur bestimmter Dateigruppen &#40;vollständiges Wiederherstellungsmodell&#41;</span><span class="sxs-lookup"><span data-stu-id="e18e6-212">Example: Piecemeal Restore of Only Some Filegroups &#40;Full Recovery Model&#41;</span></span>](example-piecemeal-restore-of-only-some-filegroups-full-recovery-model.md)  
  
## <a name="performing-a-piecemeal-restore-of-a-database-whose-recovery-model-has-been-switched-from-simple-to-full"></a><span data-ttu-id="e18e6-213">Ausführen einer schrittweisen Wiederherstellung einer Datenbank, deren Wiederherstellungsmodell von einfach in vollständig geändert wurde</span><span class="sxs-lookup"><span data-stu-id="e18e6-213">Performing a Piecemeal Restore of a Database Whose Recovery Model Has Been Switched from Simple to Full</span></span>  
 <span data-ttu-id="e18e6-214">Sie können eine schrittweise Wiederherstellung einer Datenbank ausführen, bei der nach der vollständigen Teil- oder Datenbanksicherung vom einfachen Wiederherstellungsmodell zum vollständigen Wiederherstellungsmodell gewechselt wurde.</span><span class="sxs-lookup"><span data-stu-id="e18e6-214">You can perform a piecemeal restore of a database that has been switched from the simple recovery model to the full recovery model since the full partial or database backup.</span></span> <span data-ttu-id="e18e6-215">Angenommen, Sie führen in einer Datenbank die folgenden Schritte aus:</span><span class="sxs-lookup"><span data-stu-id="e18e6-215">For example, consider a database for which you take the following steps:</span></span>  
  
1.  <span data-ttu-id="e18e6-216">Erstellen einer Teilsicherung (backup_1) von einer Datenbank mit einfachem Modell.</span><span class="sxs-lookup"><span data-stu-id="e18e6-216">Create a partial backup (backup_1) of a simple-model database.</span></span>  
  
2.  <span data-ttu-id="e18e6-217">Nach einer bestimmten Zeit erfolgt eine Änderung auf das vollständige Wiederherstellungsmodell.</span><span class="sxs-lookup"><span data-stu-id="e18e6-217">After some time, change the recovery model to full.</span></span>  
  
3.  <span data-ttu-id="e18e6-218">Erstellen einer differenziellen Sicherung.</span><span class="sxs-lookup"><span data-stu-id="e18e6-218">Create a differential backup.</span></span>  
  
4.  <span data-ttu-id="e18e6-219">Ausführen von ersten Protokollsicherungen.</span><span class="sxs-lookup"><span data-stu-id="e18e6-219">Start taking log backups.</span></span>  
  
 <span data-ttu-id="e18e6-220">Im Anschluss ist folgende Sequenz gültig:</span><span class="sxs-lookup"><span data-stu-id="e18e6-220">Thereafter, the following sequence is valid:</span></span>  
  
1.  <span data-ttu-id="e18e6-221">Eine Teilwiederherstellung, von der einige sekundäre Dateigruppen ausgenommen sind.</span><span class="sxs-lookup"><span data-stu-id="e18e6-221">A partial restore that omits some secondary filegroups.</span></span>  
  
2.  <span data-ttu-id="e18e6-222">Eine differenzielle Wiederherstellung, in deren Anschluss alle weiteren benötigten Wiederherstellungsvorgänge ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="e18e6-222">A differential restore followed by any other needed restores.</span></span>  
  
3.  <span data-ttu-id="e18e6-223">Eine später ausgeführte Wiederherstellung einer sekundären Dateigruppe mit Lese-/Schreibzugriff WITH NORECOVERY aus der Teilsicherung backup_1.</span><span class="sxs-lookup"><span data-stu-id="e18e6-223">Later, a file restore of a read/write secondary filegroup WITH NORECOVERY from the backup_1 partial backup</span></span>  
  
4.  <span data-ttu-id="e18e6-224">Die differenzielle Sicherung, die nach allen anderen Sicherungen ausgeführt wird, die in der ursprünglichen schrittweisen Wiederherstellung gespeichert wurden, um die Daten bis zum ursprünglichen Wiederherstellungszeitpunkt wiederherzustellen.</span><span class="sxs-lookup"><span data-stu-id="e18e6-224">The differential backup followed by any other backups that were restored in the original piecemeal restore sequence to restore the data up to the original recovery point.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e18e6-225">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="e18e6-225">See Also</span></span>  
 <span data-ttu-id="e18e6-226">[Anwenden von Transaktionsprotokollsicherungen &#40;SQL Server&#41;](transaction-log-backups-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="e18e6-226">[Apply Transaction Log Backups &#40;SQL Server&#41;](transaction-log-backups-sql-server.md) </span></span>  
 <span data-ttu-id="e18e6-227">[RESTORE &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-statements-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="e18e6-227">[RESTORE &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-statements-transact-sql) </span></span>  
 <span data-ttu-id="e18e6-228">[Wiederherstellen einer SQL Server-Datenbank zu einem Zeitpunkt &#40;vollständiges Wiederherstellungsmodell&#41;](restore-a-sql-server-database-to-a-point-in-time-full-recovery-model.md) </span><span class="sxs-lookup"><span data-stu-id="e18e6-228">[Restore a SQL Server Database to a Point in Time &#40;Full Recovery Model&#41;](restore-a-sql-server-database-to-a-point-in-time-full-recovery-model.md) </span></span>  
 <span data-ttu-id="e18e6-229">[Übersicht über Wiederherstellungsvorgänge &#40;SQL Server&#41;](restore-and-recovery-overview-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="e18e6-229">[Restore and Recovery Overview &#40;SQL Server&#41;](restore-and-recovery-overview-sql-server.md) </span></span>  
 [<span data-ttu-id="e18e6-230">Planen und Ausführen von Wiederherstellungssequenzen &#40;vollständiges Wiederherstellungsmodell&#41;</span><span class="sxs-lookup"><span data-stu-id="e18e6-230">Plan and Perform Restore Sequences &#40;Full Recovery Model&#41;</span></span>](plan-and-perform-restore-sequences-full-recovery-model.md)  
  
  

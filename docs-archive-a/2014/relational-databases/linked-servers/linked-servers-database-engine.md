---
title: Verbindungsserver (Datenbank-Engine) | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- OLE DB, linked servers
- OLE DB provider, linked servers
- server management [SQL Server], linked servers
- linked servers [SQL Server]
- distributed queries [SQL Server], linked servers
- servers [SQL Server], linked
- remote servers [SQL Server], linked servers
- linked servers [SQL Server], about linked servers
ms.assetid: 6ef578bf-8da7-46e0-88b5-e310fc908bb0
author: stevestein
ms.author: sstein
ms.openlocfilehash: 4a1de70882cdeb87ccc0ae42aa23a9b6c8b3248e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87608638"
---
# <a name="linked-servers-database-engine"></a><span data-ttu-id="9c582-102">Verbindungsserver (Datenbank-Engine)</span><span class="sxs-lookup"><span data-stu-id="9c582-102">Linked Servers (Database Engine)</span></span>
  <span data-ttu-id="9c582-103">Konfigurieren Sie einen Verbindungsserver, um [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] für die Ausführung von Befehlen für OLE DB-Datenquellen außerhalb der Instanz von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="9c582-103">Configure a linked server to enable the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] to execute commands against OLE DB data sources outside of the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="9c582-104">In der Regel werden Verbindungsserver so konfiguriert, um [!INCLUDE[ssDE](../../includes/ssde-md.md)] für die Ausführung einer [!INCLUDE[tsql](../../includes/tsql-md.md)] -Anweisung, die Tabellen in einer anderen Instanz von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]enthält, oder ein anderes Datenbankprodukt z. B. Oracle zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="9c582-104">Typically linked servers are configured to enable the [!INCLUDE[ssDE](../../includes/ssde-md.md)] to execute a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement that includes tables in another instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], or another database product such as Oracle.</span></span> <span data-ttu-id="9c582-105">Viele Typen von OLE DB-Datenquellen können als Verbindungsserver konfiguriert werden, einschließlich [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Access und Excel.</span><span class="sxs-lookup"><span data-stu-id="9c582-105">Many types OLE DB data sources can be configured as linked servers, including [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Access and Excel.</span></span> <span data-ttu-id="9c582-106">Verbindungsserver bieten die folgenden Vorteile:</span><span class="sxs-lookup"><span data-stu-id="9c582-106">Linked servers offer the following advantages:</span></span>

-   <span data-ttu-id="9c582-107">Die Fähigkeit, auf Daten von außerhalb von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="9c582-107">The ability to access data from outside of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>

-   <span data-ttu-id="9c582-108">Die Fähigkeit, verteilte Abfragen, Updates, Befehle und Transaktionen auf heterogenen Datenquellen im gesamten Unternehmen auszugeben.</span><span class="sxs-lookup"><span data-stu-id="9c582-108">The ability to issue distributed queries, updates, commands, and transactions on heterogeneous data sources across the enterprise.</span></span>

-   <span data-ttu-id="9c582-109">Die Möglichkeit, verschiedene Datenquellen ähnlich zu adressieren.</span><span class="sxs-lookup"><span data-stu-id="9c582-109">The ability to address diverse data sources similarly.</span></span>

 <span data-ttu-id="9c582-110">Ein Verbindungsserver kann mit [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] oder mithilfe der Anweisung [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="9c582-110">You can configure a linked server by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or by using the [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) statement.</span></span> <span data-ttu-id="9c582-111">OLE DB-Anbieter variieren stark in Hinblick auf Typ und Anzahl der erforderlichen Parameter.</span><span class="sxs-lookup"><span data-stu-id="9c582-111">OLE DB providers vary greatly in the type and number of parameters required.</span></span> <span data-ttu-id="9c582-112">Bei manchen Anbietern müssen Sie beispielsweise mit [sp_addlinkedsrvlogin &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql)zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="9c582-112">For example some providers require you to provide a security context for the connection using [sp_addlinkedsrvlogin &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql).</span></span> <span data-ttu-id="9c582-113">Einige OLE DB-Anbieter ermöglichen es [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , Daten in der OLE DB-Quelle zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="9c582-113">Some OLE DB providers allow [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to update data on the OLE DB source.</span></span> <span data-ttu-id="9c582-114">Andere Anbieter stellen nur schreibgeschützten Datenzugriff bereit.</span><span class="sxs-lookup"><span data-stu-id="9c582-114">Others provide only read-only data access.</span></span> <span data-ttu-id="9c582-115">Informationen zu den einzelnen OLE DB-Anbietern finden Sie in der jeweiligen Dokumentation des OLE DB-Anbieters.</span><span class="sxs-lookup"><span data-stu-id="9c582-115">For information about each OLE DB provider, consult documentation for that OLE DB provider.</span></span>

## <a name="linked-server-components"></a><span data-ttu-id="9c582-116">Verbindungsserverkomponenten</span><span class="sxs-lookup"><span data-stu-id="9c582-116">Linked Server Components</span></span>
 <span data-ttu-id="9c582-117">Eine Verbindungsserverdefinition gibt die folgenden Objekte an:</span><span class="sxs-lookup"><span data-stu-id="9c582-117">A linked server definition specifies the following objects:</span></span>

-   <span data-ttu-id="9c582-118">Einen OLE DB-Anbieter.</span><span class="sxs-lookup"><span data-stu-id="9c582-118">An OLE DB provider</span></span>

-   <span data-ttu-id="9c582-119">Eine OLE DB-Datenquelle.</span><span class="sxs-lookup"><span data-stu-id="9c582-119">An OLE DB data source</span></span>

 <span data-ttu-id="9c582-120">Ein *OLE DB-Anbieter* ist eine DLL (Dynamic Link Library), die mit einer bestimmten Datenquelle interagiert und sie verwaltet.</span><span class="sxs-lookup"><span data-stu-id="9c582-120">An *OLE DB provider* is a DLL that manages and interacts with a specific data source.</span></span> <span data-ttu-id="9c582-121">Eine *OLE DB-Datenquelle* identifiziert die spezielle Datenbank, auf die über OLE DB zugegriffen werden kann.</span><span class="sxs-lookup"><span data-stu-id="9c582-121">An *OLE DB data source* identifies the specific database that can be accessed through OLE DB.</span></span> <span data-ttu-id="9c582-122">Obwohl es sich bei Datenquellen, die über Verbindungsserverdefinitionen abgefragt werden, normalerweise um Datenbanken handelt, sind OLE DB-Anbieter für eine Vielzahl von Dateien und Dateiformaten verfügbar.</span><span class="sxs-lookup"><span data-stu-id="9c582-122">Although data sources queried through linked server definitions are ordinarily databases, OLE DB providers exist for a variety of files and file formats.</span></span> <span data-ttu-id="9c582-123">Dazu gehören Textdateien, Kalkulationstabellendaten und die Ergebnisse aus Volltextsuchläufen.</span><span class="sxs-lookup"><span data-stu-id="9c582-123">These include text files, spreadsheet data, and the results of full-text content searches.</span></span>

 <span data-ttu-id="9c582-124">Der [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB Provider (ProgID: SQLNCLI11) ist der offizielle OLE DB Anbieter für [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="9c582-124">The [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB Provider (PROGID: SQLNCLI11) is the official OLE DB provider for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>

> [!NOTE]
>  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="9c582-125">sind jedoch so entworfen, dass sie mit jedem OLE DB-Anbieter zusammenarbeiten, der die erforderlichen OLE DB-Schnittstellen implementiert.</span><span class="sxs-lookup"><span data-stu-id="9c582-125">distributed queries are designed to work with any OLE DB provider that implements the required OLE DB interfaces.</span></span> <span data-ttu-id="9c582-126">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] wurde jedoch nur für den OLE DB-Anbieter für [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client und bestimmte andere Anbieter getestet.</span><span class="sxs-lookup"><span data-stu-id="9c582-126">However, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] has been tested against only the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB Provider and certain other providers.</span></span>

## <a name="linked-server-details"></a><span data-ttu-id="9c582-127">Einzelheiten zu Verbindungsservern</span><span class="sxs-lookup"><span data-stu-id="9c582-127">Linked Server Details</span></span>
 <span data-ttu-id="9c582-128">Die folgende Abbildung zeigt die Grundlagen einer Verbindungsserverkonfiguration.</span><span class="sxs-lookup"><span data-stu-id="9c582-128">The following illustration shows the basics of a linked server configuration.</span></span>

 <span data-ttu-id="9c582-129">![Client-, Server- und Datenbankserverebene](../../database-engine/media/lsvr.gif "Client-, Server- und Datenbankserverebene")</span><span class="sxs-lookup"><span data-stu-id="9c582-129">![Client tier, server tier, and database server tier](../../database-engine/media/lsvr.gif "Client tier, server tier, and database server tier")</span></span>

 <span data-ttu-id="9c582-130">Verbindungsserver werden in der Regel für die Verarbeitung verteilter Abfragen verwendet.</span><span class="sxs-lookup"><span data-stu-id="9c582-130">Typically, linked servers are used to handle distributed queries.</span></span> <span data-ttu-id="9c582-131">Führt eine Clientanwendung eine verteilte Abfrage über einen Verbindungsserver aus, analysiert [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] den Befehl und sendet Anforderungen an OLE DB.</span><span class="sxs-lookup"><span data-stu-id="9c582-131">When a client application executes a distributed query through a linked server, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] parses the command and sends requests to OLE DB.</span></span> <span data-ttu-id="9c582-132">Für eine Rowsetanforderung kann eine Abfrage für den Anbieter ausgeführt oder eine Basistabelle vom Anbieter geöffnet werden.</span><span class="sxs-lookup"><span data-stu-id="9c582-132">The rowset request may be in the form of executing a query against the provider or opening a base table from the provider.</span></span>

 <span data-ttu-id="9c582-133">Damit eine Datenquelle Daten über einen Verbindungsserver zurückgibt, muss der OLE DB-Anbieter (DLL) für diese Datenquelle auf demselben Server wie die Instanz von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="9c582-133">For a data source to return data through a linked server, the OLE DB provider (DLL) for that data source must be present on the same server as the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>

 <span data-ttu-id="9c582-134">Wenn ein OLE DB-Anbieter eines Drittanbieters verwendet wird, müssen dem Konto, unter dem der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] -Dienst ausgeführt wird, Lese- und Ausführungsberechtigungen für das Verzeichnis (und alle Unterverzeichnisse) erteilt worden sein, in dem der Anbieter installiert ist.</span><span class="sxs-lookup"><span data-stu-id="9c582-134">When a third-party OLE DB provider is used, the account under which the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service runs must have read and execute permissions for the directory, and all subdirectories, in which the provider is installed.</span></span>

## <a name="managing-providers"></a><span data-ttu-id="9c582-135">Verwalten von Anbietern</span><span class="sxs-lookup"><span data-stu-id="9c582-135">Managing Providers</span></span>
 <span data-ttu-id="9c582-136">Eine Gruppe von Optionen steuert, wie [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] OLE DB-Anbieter lädt und verwendet, die in der Registrierung angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="9c582-136">There is a set of options that control how [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] loads and uses OLE DB providers that are specified in the registry.</span></span>

## <a name="managing-linked-server-definitions"></a><span data-ttu-id="9c582-137">Verwalten von Verbindungsserverdefinitionen</span><span class="sxs-lookup"><span data-stu-id="9c582-137">Managing Linked Server Definitions</span></span>
 <span data-ttu-id="9c582-138">Beim Einrichten eines Verbindungsservers sollten die Verbindungsinformationen und Datenquelleninformationen in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]registriert werden.</span><span class="sxs-lookup"><span data-stu-id="9c582-138">When you are setting up a linked server, register the connection information and data source information with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="9c582-139">Nach der Registrierung kann über einen einzelnen logischen Namen auf diese Datenquelle verwiesen werden.</span><span class="sxs-lookup"><span data-stu-id="9c582-139">After registered, that data source can be referred to with a single logical name.</span></span>

 <span data-ttu-id="9c582-140">Sie können gespeicherte Prozeduren und Katalogsichten zum Verwalten von Verbindungsserverdefinitionen verwenden:</span><span class="sxs-lookup"><span data-stu-id="9c582-140">You can use stored procedures and catalog views to manage linked server definitions:</span></span>

-   <span data-ttu-id="9c582-141">Erstellen Sie eine Verbindungsserverdefinition, indem Sie **sp_addlinkedserver**ausführen.</span><span class="sxs-lookup"><span data-stu-id="9c582-141">Create a linked server definition by running **sp_addlinkedserver**.</span></span>

-   <span data-ttu-id="9c582-142">Zeigen Sie Informationen zu den in einer bestimmten Instanz von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] definierten Verbindungsservern an, indem Sie eine Abfrage der **sys.servers** -Systemkatalogsichten ausführen.</span><span class="sxs-lookup"><span data-stu-id="9c582-142">View information about the linked servers defined in a specific instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] by running a query against the **sys.servers** system catalog views.</span></span>

-   <span data-ttu-id="9c582-143">Löschen Sie eine Verbindungsserverdefinition, indem Sie **sp_dropserver**ausführen.</span><span class="sxs-lookup"><span data-stu-id="9c582-143">Delete a linked server definition by running **sp_dropserver**.</span></span> <span data-ttu-id="9c582-144">Sie können mit dieser gespeicherten Prozedur auch einen Remoteserver entfernen.</span><span class="sxs-lookup"><span data-stu-id="9c582-144">You can also use this stored procedure to remove a remote server.</span></span>

 <span data-ttu-id="9c582-145">Sie können Verbindungsserver auch mithilfe von [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]definieren.</span><span class="sxs-lookup"><span data-stu-id="9c582-145">You can also define linked servers by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="9c582-146">Klicken Sie im Objekt-Explorer mit der rechten Maustaste auf **Serverobjekte**, klicken Sie auf **Neu**, und klicken Sie dann auf **Verbindungsserver**.</span><span class="sxs-lookup"><span data-stu-id="9c582-146">In the Object Explorer, right-click **Server Objects**, select **New**, and select **Linked Server**.</span></span> <span data-ttu-id="9c582-147">Sie können eine Verbindungsserverdefinition löschen, indem Sie mit der rechten Maustaste auf den Namen des Verbindungsservers und dann auf **Löschen**klicken.</span><span class="sxs-lookup"><span data-stu-id="9c582-147">You can delete a linked server definition by right-clicking the linked server name and selecting **Delete**.</span></span>

 <span data-ttu-id="9c582-148">Wenn Sie eine verteilte Abfrage auf einem Verbindungsserver ausführen, sollten Sie einen vollqualifizierten vierteiligen Tabellennamen für jede Datenquelle einschließen, die abgefragt werden soll.</span><span class="sxs-lookup"><span data-stu-id="9c582-148">When you execute a distributed query against a linked server, include a fully qualified, four-part table name for each data source to query.</span></span> <span data-ttu-id="9c582-149">Dieser vierteilige Name sollte in der Form _linked_server_name. catalog_\*\*. _`schema`_ \*\* lauten. _object_name_.</span><span class="sxs-lookup"><span data-stu-id="9c582-149">This four-part name should be in the form _linked_server_name.catalog_**._`schema`_.**_object_name_.</span></span>

> [!NOTE]
>  <span data-ttu-id="9c582-150">Verbindungsserver können so definiert werden, dass sie zurück auf den Server zeigen, auf dem sie definiert sind (zurücklaufen = loop back).</span><span class="sxs-lookup"><span data-stu-id="9c582-150">Linked servers can be defined to point back (loop back) to the server on which they are defined.</span></span> <span data-ttu-id="9c582-151">Loopbackserver sind sehr nützlich, um eine Anwendung, von der verteilte Abfragen verwendet werden, in einem Netzwerk mit einem einzelnen Server zu testen.</span><span class="sxs-lookup"><span data-stu-id="9c582-151">Loopback servers are most useful when testing an application that uses distributed queries on a single server network.</span></span> <span data-ttu-id="9c582-152">Loopbackverbindungsserver sind für Tests bestimmt und werden für viele Vorgänge, z. B. verteilte Transaktionen, nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="9c582-152">Loopback linked servers are intended for testing and are not supported for many operations, such as distributed transactions.</span></span>

## <a name="related-tasks"></a><span data-ttu-id="9c582-153">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="9c582-153">Related Tasks</span></span>
 [<span data-ttu-id="9c582-154">Erstellen von Verbindungsservern &#40;SQL Server-Datenbank-Engine&#41;</span><span class="sxs-lookup"><span data-stu-id="9c582-154">Create Linked Servers &#40;SQL Server Database Engine&#41;</span></span>](create-linked-servers-sql-server-database-engine.md)

 [<span data-ttu-id="9c582-155">sp_addlinkedserver &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="9c582-155">sp_addlinkedserver &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql)

 [<span data-ttu-id="9c582-156">sp_addlinkedsrvlogin &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="9c582-156">sp_addlinkedsrvlogin &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql)

 [<span data-ttu-id="9c582-157">sp_dropserver &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="9c582-157">sp_dropserver &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-dropserver-transact-sql)

## <a name="related-content"></a><span data-ttu-id="9c582-158">Verwandte Inhalte</span><span class="sxs-lookup"><span data-stu-id="9c582-158">Related Content</span></span>
 [<span data-ttu-id="9c582-159">sys.servers &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="9c582-159">sys.servers &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-catalog-views/sys-servers-transact-sql)

 [<span data-ttu-id="9c582-160">sp_linkedservers &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="9c582-160">sp_linkedservers &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-linkedservers-transact-sql)



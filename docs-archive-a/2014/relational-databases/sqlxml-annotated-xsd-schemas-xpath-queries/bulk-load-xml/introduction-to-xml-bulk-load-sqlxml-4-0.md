---
title: Einführung in XML-Massen laden (SQLXML 4,0) | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: xml
ms.topic: reference
helpviewer_keywords:
- nontransacted XML Bulk Load operations
- XML Bulk Load [SQLXML], about XML Bulk Load
- bulk load [SQLXML], about bulk load
- transacted XML Bulk Load operations
- streaming XML data
ms.assetid: 38bd3cbd-65ef-4c23-9ef3-e70ecf6bb88a
author: rothja
ms.author: jroth
ms.openlocfilehash: 4f3e0e78edd967e5fcb7377312c1811d34cb1ef8
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87695501"
---
# <a name="introduction-to-xml-bulk-load-sqlxml-40"></a><span data-ttu-id="3be10-102">Einführung in XML-Massenladen (SQLXML 4.0)</span><span class="sxs-lookup"><span data-stu-id="3be10-102">Introduction to XML Bulk Load (SQLXML 4.0)</span></span>
  <span data-ttu-id="3be10-103">Beim XML-Massen laden handelt es sich um ein eigenständiges com-Objekt, mit dem Sie semistrukturierte XML-Daten in Microsoft-Tabellen laden können [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="3be10-103">XML Bulk Load is a stand-alone COM object that allows you to load semistructured XML data into Microsoft [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] tables.</span></span>  
  
 <span data-ttu-id="3be10-104">Sie können XML-Daten in eine [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-Datenbank einfügen, indem Sie eine INSERT-Anweisung und die OPENXML-Funktion verwenden. Das Massenladen-Hilfsprogramm zeigt jedoch eine bessere Leistung beim Einfügen großer XML-Datenmengen.</span><span class="sxs-lookup"><span data-stu-id="3be10-104">You can insert XML data into a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database by using an INSERT statement and the OPENXML function; however, the Bulk Load utility provides better performance when you need to insert large amounts of XML data.</span></span>  
  
 <span data-ttu-id="3be10-105">Die Execute-Methode des XML-Massen laden-Objektmodells nimmt zwei Parameter an:</span><span class="sxs-lookup"><span data-stu-id="3be10-105">The Execute method of the XML Bulk Load object model takes two parameters:</span></span>  
  
-   <span data-ttu-id="3be10-106">Eine XML-Schemadefinition (XSD) mit Anmerkungen oder ein XDR-Schema (XML-Data Reduced).</span><span class="sxs-lookup"><span data-stu-id="3be10-106">An annotated XML Schema Definition (XSD) or XML-Data Reduced (XDR) schema.</span></span> <span data-ttu-id="3be10-107">Das XML-Massenladen-Hilfsprogramm interpretiert dieses Zuordnungsschema und die im Schema angegebenen Anmerkungen durch Identifizieren der SQL Server-Tabellen, in die die XML-Daten eingefügt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="3be10-107">The XML Bulk Load utility interprets this mapping schema and the annotations that are specified in the schema in identifying the SQL Server tables into which the XML data is to be inserted.</span></span>  
  
-   <span data-ttu-id="3be10-108">Ein XML-Dokument oder Dokumentfragment (ein Dokumentfragment ist ein Dokument ohne Einzelelement auf der obersten Ebene).</span><span class="sxs-lookup"><span data-stu-id="3be10-108">An XML document or document fragment (a document fragment is a document without a single top-level element).</span></span> <span data-ttu-id="3be10-109">Sie können einen Dateinamen oder einen Datenstrom angeben, von dem XML-Massenladen lesen kann.</span><span class="sxs-lookup"><span data-stu-id="3be10-109">A file name or a stream from which XML Bulk Load can read can be specified.</span></span>  
  
 <span data-ttu-id="3be10-110">Das XML-Massenladen-Hilfsprogramm interpretiert das Zuordnungsschema und identifiziert die Tabelle(n), in die die XML-Daten eingefügt werden soll(en).</span><span class="sxs-lookup"><span data-stu-id="3be10-110">XML Bulk Load interprets the mapping schema and identifies the table(s) into which the XML data is to be inserted.</span></span>  
  
 <span data-ttu-id="3be10-111">Es wird vorausgesetzt, dass Sie mit den folgenden [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-Funktionen vertraut sind:</span><span class="sxs-lookup"><span data-stu-id="3be10-111">It is assumed that you are familiar with the following [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] features:</span></span>  
  
-   <span data-ttu-id="3be10-112">XSD- und XDR-Schemas mit Anmerkungen</span><span class="sxs-lookup"><span data-stu-id="3be10-112">Annotated XSD and XDR schemas.</span></span> <span data-ttu-id="3be10-113">Weitere Informationen zu XSD-Schemas mit Anmerkungen finden Sie unter [Einführung in XSD-Schemas mit Anmerkungen &#40;SQLXML 4,0&#41;](../../sqlxml/annotated-xsd-schemas/introduction-to-annotated-xsd-schemas-sqlxml-4-0.md).</span><span class="sxs-lookup"><span data-stu-id="3be10-113">For more information about annotated XSD schemas, see [Introduction to Annotated XSD Schemas &#40;SQLXML 4.0&#41;](../../sqlxml/annotated-xsd-schemas/introduction-to-annotated-xsd-schemas-sqlxml-4-0.md).</span></span> <span data-ttu-id="3be10-114">Informationen zu XDR-Schemas mit Anmerkungen finden Sie unter [mit Anmerkungen versehene XDR-Schemas &#40;in SQLXML 4,0&#41;veraltet ](../../sqlxml/annotated-xsd-schemas/annotated-xdr-schemas-deprecated-in-sqlxml-4-0.md).</span><span class="sxs-lookup"><span data-stu-id="3be10-114">For information about annotated XDR schemas, see [Annotated XDR Schemas &#40;Deprecated in SQLXML 4.0&#41;](../../sqlxml/annotated-xsd-schemas/annotated-xdr-schemas-deprecated-in-sqlxml-4-0.md).</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="3be10-115">-Masseneinfügemechanismen, z. B. die [!INCLUDE[tsql](../../../includes/tsql-md.md)] BULK INSERT-Anweisung und das bcp-Hilfsprogramm.</span><span class="sxs-lookup"><span data-stu-id="3be10-115">bulk insert mechanisms, such as the [!INCLUDE[tsql](../../../includes/tsql-md.md)] BULK INSERT statement and the bcp utility.</span></span> <span data-ttu-id="3be10-116">Weitere Informationen finden Sie unter [Bulk Insert &#40;Transact-SQL-&#41;](/sql/t-sql/statements/bulk-insert-transact-sql) und [bcp-Hilfsprogramm](../../../tools/bcp-utility.md).</span><span class="sxs-lookup"><span data-stu-id="3be10-116">For more information, see [BULK INSERT &#40;Transact-SQL&#41;](/sql/t-sql/statements/bulk-insert-transact-sql) and [bcp Utility](../../../tools/bcp-utility.md).</span></span>  
  
## <a name="streaming-of-xml-data"></a><span data-ttu-id="3be10-117">Streaming von XML-Daten</span><span class="sxs-lookup"><span data-stu-id="3be10-117">Streaming of XML Data</span></span>  
 <span data-ttu-id="3be10-118">Da das XML-Quelldokument unter Umständen groß ist, wird das gesamte Dokument für die Massenladenverarbeitung nicht in den Speicher gelesen.</span><span class="sxs-lookup"><span data-stu-id="3be10-118">Because the source XML document can be large, the entire document is not read into memory for bulk load processing.</span></span> <span data-ttu-id="3be10-119">Stattdessen interpretiert XML-Massenladen die XML-Daten als Datenstrom und liest diesen.</span><span class="sxs-lookup"><span data-stu-id="3be10-119">Instead, XML Bulk Load interprets the XML data as a stream and reads it.</span></span> <span data-ttu-id="3be10-120">Während das Hilfsprogramm die Daten liest, identifiziert es die Datenbanktabelle(n), generiert den entsprechenden Datensatz bzw. Datensätze aus der XML-Datenquelle und sendet den Datensatz bzw. die Datensätze zum Einfügen an [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3be10-120">As the utility reads the data, it identifies the database table(s), generates the appropriate record(s) from the XML data source, and then sends the record(s) to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] for insertion.</span></span>  
  
 <span data-ttu-id="3be10-121">Das folgende XML-Quelldokument besteht z. b. aus **\<Customer>** Elementen und untergeordneten **\<Order>** Elementen:</span><span class="sxs-lookup"><span data-stu-id="3be10-121">For example, the following source XML document consists of **\<Customer>** elements and **\<Order>** child elements:</span></span>  
  
```  
<Customer ...>  
    <Order.../>  
    <Order .../>  
     ...  
</Customer>  
...  
```  
  
 <span data-ttu-id="3be10-122">Wenn XML-Massen laden das- **\<Customer>** Element liest, generiert es einen Datensatz für die CustomerTable.</span><span class="sxs-lookup"><span data-stu-id="3be10-122">As XML Bulk Load reads the **\<Customer>** element, it generates a record for the Customertable.</span></span> <span data-ttu-id="3be10-123">Beim Lesen des **\</Customer>** Endtags fügt XML-Massen laden diesen Datensatz in die Tabelle in ein [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="3be10-123">When it reads the **\</Customer>** end tag, XML Bulk Load inserts that record into the table in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="3be10-124">Auf dieselbe Weise **\<Order>** generiert XML-Massen Laden beim Lesen des-Elements einen Datensatz für ordertable und fügt diesen Datensatz beim [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Lesen des Endtags in die-Tabelle ein **\</Order>** .</span><span class="sxs-lookup"><span data-stu-id="3be10-124">In the same way, when it reads the **\<Order>** element, XML Bulk Load generates a record for the Ordertable, and then inserts that record into the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table upon reading the **\</Order>** end tag.</span></span>  
  
## <a name="transacted-and-nontransacted-xml-bulk-load-operations"></a><span data-ttu-id="3be10-125">Transaktive und nicht durchgeführte XML-Massenladevorgänge</span><span class="sxs-lookup"><span data-stu-id="3be10-125">Transacted and Nontransacted XML Bulk Load Operations</span></span>  
 <span data-ttu-id="3be10-126">XML-Massenladen kann entweder in einem transaktiven oder einem nicht durchgeführten Modus operieren.</span><span class="sxs-lookup"><span data-stu-id="3be10-126">XML Bulk Load can operate in either a transacted or a nontransacted mode.</span></span> <span data-ttu-id="3be10-127">Die Leistung ist in der Regel optimal, wenn Sie ein Massen laden in einem nicht transaktiven Modus ausführen, das heißt, die Transaction-Eigenschaft ist auf false festgelegt, und eine der folgenden Bedingungen ist erfüllt:</span><span class="sxs-lookup"><span data-stu-id="3be10-127">Performance is usually optimal if you are bulk loading in a nontransacted mode: that is, the Transaction property is set to FALSE) and either of the following conditions is true:</span></span>  
  
-   <span data-ttu-id="3be10-128">Die Tabellen, in die die Daten massengeladen werden, sind leer und ohne Indizes.</span><span class="sxs-lookup"><span data-stu-id="3be10-128">The tables into which the data is bulk loaded are empty with no indexes.</span></span>  
  
-   <span data-ttu-id="3be10-129">Die Tabellen weisen Daten und eindeutige Indizes auf.</span><span class="sxs-lookup"><span data-stu-id="3be10-129">The tables have data and unique indexes.</span></span>  
  
 <span data-ttu-id="3be10-130">Der nicht durchgeführte Ansatz garantiert keinen Rollback, wenn beim Massenladen ein Fehler auftritt (Teilrollbacks sind allerdings möglich).</span><span class="sxs-lookup"><span data-stu-id="3be10-130">The nontransacted approach does not guarantee a rollback if something goes wrong in the bulk load process (although partial rollbacks can happen).</span></span> <span data-ttu-id="3be10-131">Das nicht durchgeführte Massenladen ist geeignet, wenn die Datenbank leer ist.</span><span class="sxs-lookup"><span data-stu-id="3be10-131">The nontransacted bulk load is appropriate when the database is empty.</span></span> <span data-ttu-id="3be10-132">Wenn ein Fehler auftritt, können Sie so die Datenbank bereinigen und das XML-Massenladen erneut starten.</span><span class="sxs-lookup"><span data-stu-id="3be10-132">Therefore, if something does go wrong, you can clean the database and start XML Bulk Load again.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3be10-133">Im nicht durchgeführten Modus verwendet XML-Massenladen eine interne Standardtransaktion und führt einen Commit dafür aus.</span><span class="sxs-lookup"><span data-stu-id="3be10-133">In nontransacted mode, XML Bulk Load uses a default internal transaction and commits it.</span></span> <span data-ttu-id="3be10-134">Wenn die Transaction-Eigenschaft auf true festgelegt ist, ruft der XML-Massen Ladevorgang für diese Transaktion keinen Commit auf.</span><span class="sxs-lookup"><span data-stu-id="3be10-134">When the Transaction property is set to TRUE, XML Bulk Load does not call commit on this transaction.</span></span>  
  
 <span data-ttu-id="3be10-135">Wenn die Transaction-Eigenschaft auf true festgelegt ist, erstellt das XML-Massen laden temporäre Dateien, eine für jede Tabelle, die im Zuordnungsschema identifiziert wird.</span><span class="sxs-lookup"><span data-stu-id="3be10-135">If the Transaction property is set to TRUE, XML Bulk Load creates temporary files, one for each table that is identified in the mapping schema.</span></span> <span data-ttu-id="3be10-136">XML-Massenladen speichert zunächst die Datensätze aus dem XML-Quelldokument in diesen temporären Dateien.</span><span class="sxs-lookup"><span data-stu-id="3be10-136">XML Bulk Load first stores the records from the source XML document in these temporary files.</span></span> <span data-ttu-id="3be10-137">Anschließend ruft eine [!INCLUDE[tsql](../../../includes/tsql-md.md)] BULK INSERT-Anweisung diese Datensätze aus den Dateien ab und speichert sie in den entsprechenden Tabellen.</span><span class="sxs-lookup"><span data-stu-id="3be10-137">Then, a [!INCLUDE[tsql](../../../includes/tsql-md.md)] BULK INSERT statement retrieves these records from the files and stores them in the corresponding tables.</span></span> <span data-ttu-id="3be10-138">Sie können den Speicherort für diese temporären Dateien mithilfe der TempFilePath-Eigenschaft angeben.</span><span class="sxs-lookup"><span data-stu-id="3be10-138">You can specify the location for these temporary files by using the TempFilePath property.</span></span> <span data-ttu-id="3be10-139">Das für XML-Massenladen verwendete [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-Konto muss auf diesen Pfad zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="3be10-139">You must ensure that the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] account used with XML Bulk Load has access to this path.</span></span> <span data-ttu-id="3be10-140">Wenn die TempFilePath-Eigenschaft nicht angegeben ist, wird der in der TEMP-Umgebungsvariablen angegebene Standard Dateipfad zum Erstellen der temporären Dateien verwendet.</span><span class="sxs-lookup"><span data-stu-id="3be10-140">If the TempFilePath property is not specified, the default file path that is specified in the TEMP environment variable is used to create the temporary files.</span></span>  
  
 <span data-ttu-id="3be10-141">Wenn die Transaction-Eigenschaft auf false festgelegt ist (Standardeinstellung), verwendet XML-Massen laden die OLE DB-Schnittstelle IRowsetFastLoad zum Massen Laden der Daten.</span><span class="sxs-lookup"><span data-stu-id="3be10-141">If the Transaction property is set to FALSE (the default setting), XML Bulk Load uses the OLE DB interface IRowsetFastLoad to bulk load the data.</span></span>  
  
 <span data-ttu-id="3be10-142">Wenn die ConnectionString-Eigenschaft die Verbindungs Zeichenfolge festlegt und die Transaction-Eigenschaft auf true festgelegt ist, wird das XML-Massen laden in einem eigenen Transaktionskontext betrieben.</span><span class="sxs-lookup"><span data-stu-id="3be10-142">If the ConnectionString property sets the connection string, and the Transaction property is set to TRUE, XML Bulk Load operates in its own transaction context.</span></span> <span data-ttu-id="3be10-143">(Zum Beispiel startet XML-Massenladen eine eigene Transaktion und führt ggf. einen Commit oder Rollback aus.)</span><span class="sxs-lookup"><span data-stu-id="3be10-143">(For example, XML Bulk Load starts its own transaction, and commits or rolls back as appropriate.)</span></span>  
  
 <span data-ttu-id="3be10-144">Wenn die ConnectionCommand-Eigenschaft die Verbindung mit einem vorhandenen Verbindungs Objekt festlegt und die Transaction-Eigenschaft auf true festgelegt ist, gibt das XML-Massen laden keine Commit-oder Rollback-Anweisung im Falle eines Erfolgs oder Fehlers aus.</span><span class="sxs-lookup"><span data-stu-id="3be10-144">If the ConnectionCommand property sets the connection with an existing connection object and the Transaction property is set to TRUE, XML Bulk Load does not issue a COMMIT or ROLLBACK statement in the case of a success or a failure, respectively.</span></span> <span data-ttu-id="3be10-145">Tritt ein Fehler auf, gibt XML-Massenladen die entsprechende Fehlermeldung zurück.</span><span class="sxs-lookup"><span data-stu-id="3be10-145">If there is an error, XML Bulk Load returns the appropriate error message.</span></span> <span data-ttu-id="3be10-146">Die Entscheidung, ob eine COMMIT- oder ROLLBACK-Anweisung ausgegeben wird, obliegt dem Client, der das Massenladen gestartet hat.</span><span class="sxs-lookup"><span data-stu-id="3be10-146">The decision to issue a COMMIT or ROLLBACK statement is left to the client that initiated the bulk load.</span></span> <span data-ttu-id="3be10-147">Das Verbindungs Objekt, das für XML-Massen Laden verwendet wird, muss vom Typ ICommand oder ein ADO-Befehls Objekt sein.</span><span class="sxs-lookup"><span data-stu-id="3be10-147">The connection object that is used for XML Bulk Load should be of type ICommand or be an ADO command object.</span></span>  
  
 <span data-ttu-id="3be10-148">In SQLXML 4,0 kann ein ConnectionObject nicht verwendet werden, wenn die Transaction-Eigenschaft auf false festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="3be10-148">In SQLXML 4.0, a ConnectionObject cannot be used with the Transaction property set to FALSE.</span></span> <span data-ttu-id="3be10-149">Der nicht transaktive Modus wird mit einem ConnectionObject nicht unterstützt, da es nicht möglich ist, mehr als eine IRowsetFastLoad-Schnittstelle für eine übergebenen Sitzung zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="3be10-149">The nontransacted mode is not supported with a ConnectionObject because it is impossible to open more than one IRowsetFastLoad interface on a passed-in session.</span></span>  
  
  

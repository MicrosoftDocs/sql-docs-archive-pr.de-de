---
title: Datenbank-Momentaufnahmen (SQL Server) | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: configuration
ms.topic: conceptual
helpviewer_keywords:
- static database views
- snapshots [SQL Server database snapshots]
- source databases [SQL Server]
- snapshots [SQL Server database snapshots], about database snapshots
- database snapshots [SQL Server]
- read-only database views
- database snapshots [SQL Server], about database snapshots
ms.assetid: 00179314-f23e-47cb-a35c-da6f180f86d3
author: stevestein
ms.author: sstein
ms.openlocfilehash: 8a0fa9b6cee2287d4e6060d4cb39f34d909e7db9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87725894"
---
# <a name="database-snapshots-sql-server"></a><span data-ttu-id="fb5ab-102">Datenbank-Momentaufnahmen (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="fb5ab-102">Database Snapshots (SQL Server)</span></span>
  <span data-ttu-id="fb5ab-103">Eine Datenbankmomentaufnahme ist eine schreibgeschützte statische Sicht einer [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] -Datenbank (die *Quelldatenbank*).</span><span class="sxs-lookup"><span data-stu-id="fb5ab-103">A database snapshot is a read-only, static view of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database (the *source database*).</span></span> <span data-ttu-id="fb5ab-104">Die Datenbankmomentaufnahme ist hinsichtlich der Transaktionen mit der Quelldatenbank zum Zeitpunkt der Momentaufnahmeerstellung konsistent.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-104">The database snapshot is transactionally consistent with the source database as of the moment of the snapshot's creation.</span></span> <span data-ttu-id="fb5ab-105">Eine Datenbankmomentaufnahme befindet sich immer auf derselben Serverinstanz wie ihre Quelldatenbank.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-105">A database snapshot always resides on the same server instance as its source database.</span></span> <span data-ttu-id="fb5ab-106">Beim Aktualisieren der Quelldatenbank wird auch die Datenbankmomentaufnahme aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-106">As the source database is updated, the database snapshot is updated.</span></span> <span data-ttu-id="fb5ab-107">Daher wird wahrscheinlich der verfügbare Speicherplatz aufgebraucht, je länger eine Datenbankmomentaufnahme besteht.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-107">Therefore, the longer a database snapshot exists, the more likely it is to use up its available disk space.</span></span>  
  
 <span data-ttu-id="fb5ab-108">In einer bestimmten Quelldatenbank können mehrere Momentaufnahmen vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-108">Multiple snapshots can exist on a given source database.</span></span> <span data-ttu-id="fb5ab-109">Jede Datenbankmomentaufnahme ist so lange vorhanden, bis sie explizit vom Datenbankbesitzer gelöscht wird.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-109">Each database snapshot persists until it is explicitly dropped by the database owner.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fb5ab-110">Datenbank-Momentaufnahmen stehen in keinerlei Zusammenhang mit Momentaufnahmesicherungen, Momentaufnahmeisolationen von Transaktionen oder Momentaufnahmereplikationen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-110">Database snapshots are unrelated to snapshot backups, snapshot isolation of transactions, or snapshot replication.</span></span>  
  
 <span data-ttu-id="fb5ab-111">**In diesem Thema:**</span><span class="sxs-lookup"><span data-stu-id="fb5ab-111">**In this Topic:**</span></span>  
  
-   [<span data-ttu-id="fb5ab-112">Übersicht über die Funktionen</span><span class="sxs-lookup"><span data-stu-id="fb5ab-112">Feature Overview</span></span>](#FeatureOverview)  
  
-   [<span data-ttu-id="fb5ab-113">Vorteile der Datenbankmomentaufnahmen</span><span class="sxs-lookup"><span data-stu-id="fb5ab-113">Benefits of Database Snapshots</span></span>](#Benefits)  
  
-   [<span data-ttu-id="fb5ab-114">Begriffe und Definitionen</span><span class="sxs-lookup"><span data-stu-id="fb5ab-114">Terms and Definitions</span></span>](#TermsAndDefinitions)  
  
-   [<span data-ttu-id="fb5ab-115">Voraussetzungen und Einschränkungen bei Datenbankmomentaufnahmen</span><span class="sxs-lookup"><span data-stu-id="fb5ab-115">Prerequisites for and Limitations on Database Snapshots</span></span>](#LimitationsRequirements)  
  
-   [<span data-ttu-id="fb5ab-116">Verwandte Aufgaben</span><span class="sxs-lookup"><span data-stu-id="fb5ab-116">Related Tasks</span></span>](#RelatedTasks)  
  
##  <a name="feature-overview"></a><a name="FeatureOverview"></a> <span data-ttu-id="fb5ab-117">Übersicht über die Funktionen</span><span class="sxs-lookup"><span data-stu-id="fb5ab-117">Feature Overview</span></span>  
 <span data-ttu-id="fb5ab-118">Datenbankmomentaufnahmen arbeiten auf der Ebene der Datenseiten.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-118">Database snapshots operate at the data-page level.</span></span> <span data-ttu-id="fb5ab-119">Bevor eine Seite der Quellendatenbank zum ersten Mal geändert wird, wird die Originalseite der Quellendatenbank auf die Momentaufnahme kopiert.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-119">Before a page of the source database is modified for the first time, the original page is copied from the source database to the snapshot.</span></span> <span data-ttu-id="fb5ab-120">In der Momentaufnahme wird die Originalseite gespeichert, wodurch die Datensätze in dem Zustand erhalten werden, wie sie zum Zeitpunkt der Momentaufnahmeerstellung vorhanden waren.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-120">The snapshot stores the original page, preserving the data records as they existed when the snapshot was created.</span></span> <span data-ttu-id="fb5ab-121">Der gleiche Vorgang wird für jede Seite wiederholt, die zum ersten Mal geändert wird.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-121">The same process is repeated for every page that is being modified for the first time.</span></span> <span data-ttu-id="fb5ab-122">Für den Benutzer scheint sich eine Datenbankmomentaufnahme niemals zu ändern, weil von Lesevorgängen auf einer Datenbankmomentaufnahme immer auf die Originaldatenseiten zugegriffen wird, unabhängig von deren Speicherort.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-122">To the user, a database snapshot appears never to change, because read operations on a database snapshot always access the original data pages, regardless of where they reside.</span></span>  
  
 <span data-ttu-id="fb5ab-123">Um die kopierten Originalseiten zu speichern, wird von der Momentaufnahme mindestens eine *Sparsedatei*verwendet.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-123">To store the copied original pages, the snapshot uses one or more *sparse files*.</span></span> <span data-ttu-id="fb5ab-124">Ursprünglich ist eine Sparsedatei im Wesentlichen eine leere Datei, die keine Benutzerdaten enthält und für die noch kein Speicherplatz für Benutzerdaten auf einem Speichermedium zugeordnet worden ist.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-124">Initially, a sparse file is an essentially empty file that contains no user data and has not yet been allocated disk space for user data.</span></span> <span data-ttu-id="fb5ab-125">Je mehr Seiten in der Quellendatenbank aktualisiert werden, desto größer wird die Datei.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-125">As more and more pages are updated in the source database, the size of the file grows.</span></span> <span data-ttu-id="fb5ab-126">Die folgende Abbildung veranschaulicht die Auswirkungen zweier unterschiedlicher Updatemuster auf die Größe einer Momentaufnahme.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-126">The following figure illustrates the effects of two contrasting update patterns on the size of a snapshot.</span></span> <span data-ttu-id="fb5ab-127">Das Updatemuster A spiegelt eine Umgebung wider, in der nur 30 Prozent der Originalseiten während der Lebensspanne der Momentaufnahme aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-127">Update pattern A reflects an environment in which only 30 percent of the original pages are updated during the life of the snapshot.</span></span> <span data-ttu-id="fb5ab-128">Das Updatemuster B spiegelt eine Umgebung wider, in der 80 Prozent der Originalseiten während der Lebensspanne der Momentaufnahme aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-128">Update pattern B reflects an environment in which 80 percent of the original pages are updated during the life of the snapshot.</span></span>  
  
 <span data-ttu-id="fb5ab-129">![Alternative Updatemuster und Momentaufnahmegrößen](../../database-engine/media/dbview-04.gif "Alternative Updatemuster und Momentaufnahmegrößen")</span><span class="sxs-lookup"><span data-stu-id="fb5ab-129">![Alternative update patterns and snapshot size](../../database-engine/media/dbview-04.gif "Alternative update patterns and snapshot size")</span></span>  
  
##  <a name="benefits-of-database-snapshots"></a><a name="Benefits"></a> <span data-ttu-id="fb5ab-130">Vorteile der Datenbankmomentaufnahmen</span><span class="sxs-lookup"><span data-stu-id="fb5ab-130">Benefits of Database Snapshots</span></span>  
  
-   <span data-ttu-id="fb5ab-131">Momentaufnahmen können zur Berichterstellung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-131">Snapshots can be used for reporting purposes.</span></span>  
  
     <span data-ttu-id="fb5ab-132">Datenbankmomentaufnahmen können auch von den Clients abgefragt werden und sind daher beim Schreiben von Berichten hilfreich, die auf den zum Zeitpunkt der Momentaufnahmeerstellung verfügbaren Daten basieren.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-132">Clients can query a database snapshot, which makes it useful for writing reports based on the data at the time of snapshot creation.</span></span>  
  
-   <span data-ttu-id="fb5ab-133">Verwalten von Vergangenheitsdaten zur Berichterstellung.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-133">Maintaining historical data for report generation.</span></span>  
  
     <span data-ttu-id="fb5ab-134">Eine Momentaufnahme kann Benutzerzugriff auf Daten eines bestimmten Zeitpunkts erweitern.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-134">A snapshot can extend user access to data from a particular point in time.</span></span> <span data-ttu-id="fb5ab-135">Beispielsweise können Sie eine Datenbankmomentaufnahme am Ende einer bestimmten Periode (z. B. ein Geschäftsquartal) erstellen, um später auf dieser Grundlage einen Bericht zu generieren.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-135">For example, you can create a database snapshot at the end of a given time period (such as a financial quarter) for later reporting.</span></span> <span data-ttu-id="fb5ab-136">Auf diese Weise können Sie Quartalsabschlussberichte in der Momentaufnahme ausführen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-136">You can then run end-of-period reports on the snapshot.</span></span> <span data-ttu-id="fb5ab-137">Bei ausreichendem Speicherplatz können Sie diese Quartalsabschluss-Momentaufnahmen für unbestimmte Zeit aufbewahren. Darüber hinaus können Sie zu den Ergebnissen dieser Quartale Abfragen ausführen, z. B. um die Leistung des Unternehmens zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-137">If disk space permits, you can also maintain end-of-period snapshots indefinitely, allowing queries against the results from these periods; for example, to investigate organizational performance.</span></span>  
  
-   <span data-ttu-id="fb5ab-138">Verwenden einer Spiegeldatenbank, die aus Gründen der Verfügbarkeit verwaltet wird, für die ausgelagerte Berichterstellung.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-138">Using a mirror database that you are maintaining for availability purposes to offload reporting.</span></span>  
  
     <span data-ttu-id="fb5ab-139">Wenn Sie Datenbankmomentaufnahmen mit Datenbankspiegelungen verwenden, können Sie die auf dem Spiegelserver gespeicherten Daten für die Berichterstellung zugreifbar machen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-139">Using database snapshots with database mirroring permits you to make the data on the mirror server accessible for reporting.</span></span> <span data-ttu-id="fb5ab-140">Darüber hinaus können Sie in der Spiegeldatenbank Abfragen ausführen und so auf dem Prinzipal Ressourcen freigeben.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-140">Additionally, running queries on the mirror database can free up resources on the principal.</span></span> <span data-ttu-id="fb5ab-141">Weitere Informationen finden Sie unter [Datenbankspiegelung und Datenbankmomentaufnahmen &#40;SQL Server&#41;](database-snapshots-sql-server.md)verwendet.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-141">For more information, see [Database Mirroring and Database Snapshots &#40;SQL Server&#41;](database-snapshots-sql-server.md).</span></span>  
  
-   <span data-ttu-id="fb5ab-142">Schützen der Daten vor administrativen Fehlern.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-142">Safeguarding data against administrative error.</span></span>  
  
-   <span data-ttu-id="fb5ab-143">Sie können bei einem Benutzerfehler auf einer Quellendatenbank die Quellendatenbank in den Zustand zurückversetzen, in der sie zum Zeitpunkt der Erstellung einer bestimmten Datenbankmomentaufnahme gewesen ist.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-143">In the event of a user error on a source database, you can revert the source database to the state it was in when a given database snapshot was created.</span></span> <span data-ttu-id="fb5ab-144">Der Datenverlust beschränkt sich auf Updates der Datenbank, die nach der Erstellung der Momentaufnahme vorgenommen wurden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-144">Data loss is confined to updates to the database since the snapshot's creation.</span></span>  
  
     <span data-ttu-id="fb5ab-145">Beispiel: Vor dem Ausführen wesentlicher Updates, wie beispielsweise eines Massenupdates oder einer Schemaänderung, sollten Sie die Daten sichern, indem Sie eine Datenbankmomentaufnahme von der Datenbank erstellen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-145">For example, before doing major updates, such as a bulk update or a schema change, create a database snapshot on the database protects data.</span></span> <span data-ttu-id="fb5ab-146">Im Falle eines Fehlers können Sie die Datenbank mithilfe des Snapshots in dem Status wiederherstellen, der bei Erstellen des Snapshots vorlag.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-146">If you make a mistake, you can use the snapshot to recover by reverting the database to the snapshot.</span></span> <span data-ttu-id="fb5ab-147">Diese Art der Wiederherstellung kann für diesen Zweck potenziell schneller ausgeführt werden als die Wiederherstellung von Daten aus einer Sicherung. Allerdings können Sie anschließend keinen Rollforward ausführen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-147">Reverting is potentially much faster for this purpose than restoring from a backup; however, you cannot roll forward afterward.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="fb5ab-148">Die Wiederherstellung kann nicht für Offlinedatenbanken oder für beschädigte Datenbanken verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-148">Reverting does not work in an offline or corrupted database.</span></span> <span data-ttu-id="fb5ab-149">Regelmäßige Sicherungen und Tests des Wiederherstellungsplans sind deshalb für den Schutz einer Datenbank erforderlich.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-149">Therefore, taking regular backups and testing your restore plan are necessary to protect a database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="fb5ab-150">Datenbankmomentaufnahmen sind von der Quelldatenbank abhängig.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-150">Database snapshots are dependent on the source database.</span></span> <span data-ttu-id="fb5ab-151">Die Wiederherstellung von Datenbanken mithilfe von Datenbankmomentaufnahmen stellt daher keinen Ersatz für eine reguläre Sicherungs- und Wiederherstellungsstrategie dar.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-151">Therefore, using database snapshots for reverting a database is not a substitute for your backup and restore strategy.</span></span> <span data-ttu-id="fb5ab-152">Daher ist es wichtig, dass Sie die Sicherungen wie geplant ausführen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-152">Performing all your scheduled backups remains essential.</span></span> <span data-ttu-id="fb5ab-153">Wenn Sie die Quelldatenbank zu dem Zeitpunkt wiederherstellen müssen, an dem Sie eine Datenbankmomentaufnahme erstellt haben, implementieren Sie eine Sicherungsrichtlinie, die Ihnen dies ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-153">If you must restore the source database to the point in time at which you created a database snapshot, implement a backup policy that enables you to do that.</span></span>  
  
-   <span data-ttu-id="fb5ab-154">Schützen der Daten vor Benutzerfehlern.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-154">Safeguarding data against user error.</span></span>  
  
     <span data-ttu-id="fb5ab-155">Indem Sie regelmäßig Datenbankmomentaufnahmen erstellen, können Sie die Auswirkungen von schwerwiegenden Benutzerfehlern, z. B. eine gelöschte Tabelle, verringern.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-155">By creating database snapshots on a regular basis, you can mitigate the impact of a major user error, such as a dropped table.</span></span> <span data-ttu-id="fb5ab-156">Bei einer hohen Sicherheitsstufe sollten Sie für einen ausreichend großen Zeitraum eine Reihe von Datenbankmomentaufnahmen erstellen, sodass die meisten Benutzerfehler erkannt werden und entsprechend reagiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-156">For a high level of protection, you can create a series of database snapshots spanning enough time to recognize and respond to most user errors.</span></span> <span data-ttu-id="fb5ab-157">Beispielsweise können Sie je nach den verfügbaren Datenträgerressourcen für einen 24-Stunden-Zyklus 6 bis 12 parallele Momentaufnahmen verwalten.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-157">For instance, you might maintain 6 to 12 rolling snapshots spanning a 24-hour interval, depending on your disk resources.</span></span> <span data-ttu-id="fb5ab-158">Immer wenn eine neue Momentaufnahme erstellt wird, kann die jeweils älteste Momentaufnahme gelöscht werden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-158">Then, each time a new snapshot is created, the earliest snapshot can be deleted.</span></span>  
  
    -   <span data-ttu-id="fb5ab-159">Bei der Wiederherstellung im Falle eines Benutzerfehlers können Sie die Datenbank in dem Status des Snapshots wiederherstellen, der unmittelbar vor Auftreten des Fehlers erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-159">To recover from a user error, you can revert the database to the snapshot immediately before the error.</span></span> <span data-ttu-id="fb5ab-160">Diese Art der Wiederherstellung kann für diesen Zweck potenziell schneller ausgeführt werden als die Wiederherstellung von Daten aus einer Sicherung. Allerdings können Sie anschließend keinen Rollforward ausführen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-160">Reverting is potentially much faster for this purpose than restoring from a backup; however, you cannot roll forward afterward.</span></span>  
  
    -   <span data-ttu-id="fb5ab-161">Wahlweise können Sie eine gelöschte Tabelle oder andere verlorene Daten auch auf Basis der in einer Momentaufnahme verfügbaren Informationen wiederherstellen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-161">Alternatively, you may be able to manually reconstruct a dropped table or other lost data from the information in a snapshot.</span></span> <span data-ttu-id="fb5ab-162">Beispielsweise können Sie die Daten aus der Momentaufnahme in die Datenbank massenkopieren und die Daten manuell mit den in der Datenbank gespeicherten Daten zusammenführen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-162">For instance, you could bulk copy the data out of the snapshot into the database and manually merge the data back into the database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="fb5ab-163">Die jeweiligen Gründe für die Verwendung von Datenbankmomentaufnahmen entscheiden darüber, wie viele gleichzeitige Momentaufnahmen von einer Datenbank benötigt werden, wie regelmäßig eine neue Momentaufnahme erstellt wird und wie lange eine Momentaufnahme aufbewahrt wird.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-163">Your reasons for using database snapshots determine how many concurrent snapshots you need on a database, how frequently to create a new snapshot, and how long to keep it.</span></span>  
  
-   <span data-ttu-id="fb5ab-164">Verwalten einer Testdatenbank</span><span class="sxs-lookup"><span data-stu-id="fb5ab-164">Managing a test database</span></span>  
  
     <span data-ttu-id="fb5ab-165">In einer Testumgebung kann es hilfreich sein, wenn beim wiederholten Ausführen eines Testprotokolls die Datenbank zu Beginn jeder Testrunde immer dieselben Daten enthält.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-165">In a testing environment, it can be useful when repeatedly running a test protocol for the database to contain identical data at the start of each round of testing.</span></span> <span data-ttu-id="fb5ab-166">Vor der ersten Testrunde kann ein Anwendungsentwickler oder -tester eine Datenbankmomentaufnahme für die Testdatenbank erstellen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-166">Before running the first round, an application developer or tester can create a database snapshot on the test database.</span></span> <span data-ttu-id="fb5ab-167">Nach jeder Testrunde kann die Datenbank durch Wiederherstellen des Datenbankmomentaufnahmen schnell wieder in den früheren Zustand zurückversetzt werden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-167">After each test run, the database can be quickly returned to its prior state by reverting the database snapshot.</span></span>  
  
##  <a name="terms-and-definitions"></a><a name="TermsAndDefinitions"></a> <span data-ttu-id="fb5ab-168">Begriffe und Definitionen</span><span class="sxs-lookup"><span data-stu-id="fb5ab-168">Terms and Definitions</span></span>  
 <span data-ttu-id="fb5ab-169">Datenbank-Momentaufnahme</span><span class="sxs-lookup"><span data-stu-id="fb5ab-169">database snapshot</span></span>  
 <span data-ttu-id="fb5ab-170">Eine im Hinblick auf Transaktionen konsistente, schreibgeschützte statische Sicht einer Datenbank (die Quelldatenbank).</span><span class="sxs-lookup"><span data-stu-id="fb5ab-170">A transactionally consistent, read-only, static view of a database (the source database).</span></span>  
  
 <span data-ttu-id="fb5ab-171">Quelldatenbank</span><span class="sxs-lookup"><span data-stu-id="fb5ab-171">source database</span></span>  
 <span data-ttu-id="fb5ab-172">Bei einer Datenbankmomentaufnahme die Datenbank, für die die Momentaufnahme erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-172">For a database snapshot, the database on which the snapshot was created.</span></span> <span data-ttu-id="fb5ab-173">Datenbankmomentaufnahmen sind von der Quelldatenbank abhängig.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-173">Database snapshots are dependent on the source database.</span></span> <span data-ttu-id="fb5ab-174">Die Momentaufnahmen einer Datenbank müssen sich auf der gleichen Serverinstanz wie die Datenbank selbst befinden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-174">The snapshots of a database must be on the same server instance as the database.</span></span> <span data-ttu-id="fb5ab-175">Ist diese Datenbank außerdem aus irgendeinem Grund nicht verfügbar, stehen die zugehörigen Datenbankmomentaufnahmen ebenfalls nicht zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-175">Furthermore, if that database becomes unavailable for any reason, all of its database snapshots also become unavailable.</span></span>  
  
 <span data-ttu-id="fb5ab-176">Sparsedatei</span><span class="sxs-lookup"><span data-stu-id="fb5ab-176">sparse file</span></span>  
 <span data-ttu-id="fb5ab-177">Eine vom NTFS-Dateisystem bereitgestellte Datei, die so verarbeitet wird, dass sie viel weniger Speicherplatz benötigt als bei gewöhnlicher Verarbeitung.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-177">A file provided by the NTFS file system that requires much less disk space than would otherwise be needed.</span></span> <span data-ttu-id="fb5ab-178">Eine Sparsedatei wird zum Speichern von in eine Datenbankmomentaufnahme kopierten Seiten verwendet.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-178">A sparse file is used to store pages copied to a database snapshot.</span></span> <span data-ttu-id="fb5ab-179">Unmittelbar nach dem Erstellen beanspruchen Sparsedateien nur wenig Speicherplatz.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-179">When first created, a sparse file takes up little disk space.</span></span> <span data-ttu-id="fb5ab-180">Während Daten in eine Datenbankmomentaufnahme geschrieben werden, ordnet NTFS der entsprechenden Sparsedatei schrittweise den Speicherplatz zu.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-180">As data is written to a database snapshot, NTFS allocates disk space gradually to the corresponding sparse file.</span></span>  
  
##  <a name="prerequisites-for-and-limitations-on-database-snapshots"></a><a name="LimitationsRequirements"></a> <span data-ttu-id="fb5ab-181">Voraussetzungen und Einschränkungen bei Datenbankmomentaufnahmen</span><span class="sxs-lookup"><span data-stu-id="fb5ab-181">Prerequisites for and Limitations on Database Snapshots</span></span>  
 <span data-ttu-id="fb5ab-182">**In diesem Abschnitt:**</span><span class="sxs-lookup"><span data-stu-id="fb5ab-182">**In This Section:**</span></span>  
  
-   [<span data-ttu-id="fb5ab-183">Voraussetzungen</span><span class="sxs-lookup"><span data-stu-id="fb5ab-183">Prerequisites</span></span>](#Prerequisites)  
  
-   [<span data-ttu-id="fb5ab-184">Einschränkungen für die Quelldatenbank</span><span class="sxs-lookup"><span data-stu-id="fb5ab-184">Limitations on the Source Database</span></span>](#LimitsOnSourceDb)  
  
-   [<span data-ttu-id="fb5ab-185">Einschränkungen für Datenbankmomentaufnahmen</span><span class="sxs-lookup"><span data-stu-id="fb5ab-185">Limitations on Database Snapshots</span></span>](#LimitsOnDbSS)  
  
-   [<span data-ttu-id="fb5ab-186">Anforderungen an den Datenträgerspeicher</span><span class="sxs-lookup"><span data-stu-id="fb5ab-186">Disk Space Requirements</span></span>](#DiskSpace)  
  
-   [<span data-ttu-id="fb5ab-187">Datenbankmomentaufnahmen mit Offlinedateigruppen</span><span class="sxs-lookup"><span data-stu-id="fb5ab-187">Database Snapshots with Offline Filegroups</span></span>](#OfflineFGs)  
  
###  <a name="prerequisites"></a><a name="Prerequisites"></a> <span data-ttu-id="fb5ab-188">Voraussetzungen</span><span class="sxs-lookup"><span data-stu-id="fb5ab-188">Prerequisites</span></span>  
 <span data-ttu-id="fb5ab-189">Die Quelldatenbank, die ein Wiederherstellungsmodell verwenden kann, muss die folgenden Voraussetzungen erfüllen:</span><span class="sxs-lookup"><span data-stu-id="fb5ab-189">The source database, which can use any recovery model, must meet the following prerequisites:</span></span>  
  
-   <span data-ttu-id="fb5ab-190">Die Serverinstanz muss auf einer Edition von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ausgeführt werden, die Datenbankmomentaufnahmen unterstützt.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-190">The server instance must be running on an edition of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that supports database snapshots.</span></span> <span data-ttu-id="fb5ab-191">Weitere Informationen finden Sie unter [Features Supported by the Editions of SQL Server 2014](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span><span class="sxs-lookup"><span data-stu-id="fb5ab-191">For more information, see [Features Supported by the Editions of SQL Server 2014](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span>  
  
-   <span data-ttu-id="fb5ab-192">Die Quelldatenbank muss online sein, es sei denn, bei der Datenbank handelt es sich um eine Spiegeldatenbank innerhalb einer Datenbank-Spiegelungssitzung.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-192">The source database must be online, unless the database is a mirror database within a database mirroring session.</span></span>  
  
-   <span data-ttu-id="fb5ab-193">Sie können auf jeder primären oder sekundären Datenbank in einer Verfügbarkeitsgruppe eine Datenbankmomentaufnahme erstellen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-193">You can create a database snapshot on any primary or secondary database in an availability group.</span></span> <span data-ttu-id="fb5ab-194">Die Replikatrolle muss entweder PRIMARY oder SECONDARY sein und darf nicht den Status RESOLVING aufweisen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-194">The replica role must be either PRIMARY or SECONDARY, not in the RESOLVING state.</span></span>  
  
     <span data-ttu-id="fb5ab-195">Der Datenbanksynchronisierungsstatus sollte SYNCHRONIZING oder SYNCHRONIZED sein, wenn Sie eine Datenbankmomentaufnahme erstellen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-195">We recommend that the database synchronization state be SYNCHRONIZING or SYNCHRONIZED when you create a database snapshot.</span></span> <span data-ttu-id="fb5ab-196">Datenbankmomentaufnahmen können jedoch auch erstellt werden, wenn der Datenbanksynchronisierungsstatus NOT SYNCHRONIZING lautet.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-196">However, database snapshots can be created when the database synchronization state is NOT SYNCHRONIZING.</span></span>  
  
     <span data-ttu-id="fb5ab-197">Weitere Informationen finden Sie unter [Datenbankmomentaufnahmen bei Always On-Verfügbarkeitsgruppen &#40;SQL Server&#41;](../../database-engine/availability-groups/windows/database-snapshots-with-always-on-availability-groups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="fb5ab-197">For more information, see [Database Snapshots with AlwaysOn Availability Groups &#40;SQL Server&#41;](../../database-engine/availability-groups/windows/database-snapshots-with-always-on-availability-groups-sql-server.md).</span></span>  
  
-   <span data-ttu-id="fb5ab-198">Zum Erstellen einer Datenbankmomentaufnahme für die Spiegeldatenbank muss sich die Datenbank im synchronisierten Spiegelungsstatus befinden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-198">To create a database snapshot on a mirror database, the database must be in the SYNCHRONIZED mirroring state.</span></span>  
  
-   <span data-ttu-id="fb5ab-199">Die Quelldatenbank kann nicht als skalierbare freigegebene Datenbank konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-199">The source database cannot be configured as a scalable shared database.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fb5ab-200">Alle Wiederherstellungsmodelle unterstützen Datenbankmomentaufnahmen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-200">All recovery models support database snapshots.</span></span>  
  
###  <a name="limitations-on-the-source-database"></a><a name="LimitsOnSourceDb"></a> <span data-ttu-id="fb5ab-201">Einschränkungen für die Quelldatenbank</span><span class="sxs-lookup"><span data-stu-id="fb5ab-201">Limitations on the Source Database</span></span>  
 <span data-ttu-id="fb5ab-202">Solange eine Datenbankmomentaufnahme vorhanden ist, sind die folgenden Einschränkungen für die Quelldatenbank der Momentaufnahme vorhanden:</span><span class="sxs-lookup"><span data-stu-id="fb5ab-202">As long as a database snapshot exists, the following limitations exist on the snapshot's source database:</span></span>  
  
-   <span data-ttu-id="fb5ab-203">Die Datenbank kann nicht gelöscht, getrennt oder wiederhergestellt werden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-203">The database cannot be dropped, detached, or restored.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="fb5ab-204">Das Sichern der Quelldatenbank arbeitet normal. Datenbankmomentaufnahmen haben hierauf keine Auswirkungen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-204">Backing up the source database works normally; it is unaffected by database snapshots.</span></span>  
  
-   <span data-ttu-id="fb5ab-205">Die Leistung ist aufgrund einer Erhöhung der E/A-Vorgänge in der Quelldatenbank reduziert. Diese Erhöhung wird dadurch verursacht, dass bei jeder Aktualisierung einer Seite ein Kopie-bei-Schreibvorgang in der Momentaufnahme ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-205">Performance is reduced, due to increased I/O on the source database resulting from a copy-on-write operation to the snapshot every time a page is updated.</span></span>  
  
-   <span data-ttu-id="fb5ab-206">In der Quelldatenbank oder in den Momentaufnahmen können keine Dateien gelöscht werden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-206">Files cannot be dropped from the source database or from any snapshots.</span></span>  
  
###  <a name="limitations-on-database-snapshots"></a><a name="LimitsOnDbSS"></a> <span data-ttu-id="fb5ab-207">Einschränkungen für Datenbankmomentaufnahmen</span><span class="sxs-lookup"><span data-stu-id="fb5ab-207">Limitations on Database Snapshots</span></span>  
 <span data-ttu-id="fb5ab-208">Für Datenbankmomentaufnahmen gelten die folgenden Einschränkungen:</span><span class="sxs-lookup"><span data-stu-id="fb5ab-208">The following limitations apply to database snapshots:</span></span>  
  
-   <span data-ttu-id="fb5ab-209">Eine Datenbankmomentaufnahme muss auf der gleichen Serverinstanz erstellt und gespeichert werden, auf der sich auch die Quelldatenbank befindet.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-209">A database snapshot must be created and remain on the same server instance as the source database.</span></span>  
  
-   <span data-ttu-id="fb5ab-210">Datenbankmomentaufnahmen gelten immer für die gesamte Datenbank.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-210">Database snapshots always work on an entire database.</span></span>  
  
-   <span data-ttu-id="fb5ab-211">Datenbankmomentaufnahmen sind von der Quelldatenbank abhängig und sind kein redundanter Speicher.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-211">Database snapshots are dependent on the source database and are not redundant storage.</span></span> <span data-ttu-id="fb5ab-212">Sie schützen nicht vor Datenträgerfehlern oder anderen Formen der Beschädigung.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-212">They do not protect against disk errors or other types of corruption.</span></span> <span data-ttu-id="fb5ab-213">Die Wiederherstellung von Datenbanken mithilfe von Datenbankmomentaufnahmen stellt daher keinen Ersatz für eine reguläre Sicherungs- und Wiederherstellungsstrategie dar.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-213">Therefore, using database snapshots for reverting a database is not a substitute for your backup and restore strategy.</span></span> <span data-ttu-id="fb5ab-214">Daher ist es wichtig, dass Sie die Sicherungen wie geplant ausführen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-214">Performing all your scheduled backups remains essential.</span></span> <span data-ttu-id="fb5ab-215">Wenn Sie die Quelldatenbank zu dem Zeitpunkt wiederherstellen müssen, an dem Sie eine Datenbankmomentaufnahme erstellt haben, implementieren Sie eine Sicherungsrichtlinie, die Ihnen dies ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-215">If you must restore the source database to the point in time at which you created a database snapshot, implement a backup policy that enables you to do that.</span></span>  
  
-   <span data-ttu-id="fb5ab-216">Wenn eine Seite, die gerade in der Quelldatenbank aktualisiert wird, mithilfe von Push in eine Momentaufnahme übertragen wird und für dei Momentaufnahme dabei nicht genügend Speicherplatz vorhanden ist oder ein anderer Fehler in der Momentaufnahme auftritt, wird die Momentaufnahme fehlerverdächtig und muss gelöscht werden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-216">When a page getting updated on the source database is pushed to a snapshot, if the snapshot runs out of disk space or encounters some other error, the snapshot becomes suspect and must be deleted.</span></span>  
  
-   <span data-ttu-id="fb5ab-217">Momentaufnahmen sind schreibgeschützt.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-217">Snapshots are read-only.</span></span> <span data-ttu-id="fb5ab-218">Da sie schreibgeschützt sind, können sie nicht aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-218">Since they are read only, they cannot be upgraded.</span></span> <span data-ttu-id="fb5ab-219">Deshalb sind Datenbankmomentaufnahmen nach einer Aktualisierung nicht mehr gültig.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-219">Therefore, database snapshots are not expected to be viable after an upgrade.</span></span>  
  
-   <span data-ttu-id="fb5ab-220">Momentaufnahmen der Datenbanken **model**, **master**und **tempdb** sind nicht zulässig.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-220">Snapshots of the **model**, **master**, and **tempdb** databases are prohibited.</span></span>  
  
-   <span data-ttu-id="fb5ab-221">Sie können die Spezifikationen der Datenbankmomentaufnahmedateien nicht ändern.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-221">You cannot change any of the specifications of the database snapshot files.</span></span>  
  
-   <span data-ttu-id="fb5ab-222">Sie können in einer Datenbankmomentaufnahme keine Dateien löschen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-222">You cannot drop files from a database snapshot.</span></span>  
  
-   <span data-ttu-id="fb5ab-223">Sie können Datenbankmomentaufnahmen nicht sichern oder wiederherstellen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-223">You cannot back up or restore database snapshots.</span></span>  
  
-   <span data-ttu-id="fb5ab-224">Sie können Datenbankmomentaufnahmen nicht anfügen oder trennen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-224">You cannot attach or detach database snapshots.</span></span>  
  
-   <span data-ttu-id="fb5ab-225">Sie können keine Datenbankmomentaufnahmen auf Partitionen mit dem FAT32-Dateisystem oder auf RAW-Partitionen erstellen.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-225">You cannot create database snapshots on FAT32 file system or RAW partitions.</span></span> <span data-ttu-id="fb5ab-226">Die von Datenbankmomentaufnahmen verwendeten Sparsedateien werden vom NTFS-Dateisystem bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-226">The sparse files used by database snapshots are provided by the NTFS file system.</span></span>  
  
-   <span data-ttu-id="fb5ab-227">Die Volltextindizierung wird für Datenbankmomentaufnahmen nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-227">Full-text indexing is not supported on database snapshots.</span></span> <span data-ttu-id="fb5ab-228">Volltextkataloge werden nicht von der Quelldatenbank aus weitergegeben.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-228">Full-text catalogs are not propagated from the source database.</span></span>  
  
-   <span data-ttu-id="fb5ab-229">Eine Datenbankmomentaufnahme erbt die Sicherheitseinschränkungen seiner Quelldatenbank zum Zeitpunkt der Erstellung der Momentaufnahme.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-229">A database snapshot inherits the security constraints of its source database at the time of snapshot creation.</span></span> <span data-ttu-id="fb5ab-230">Da Momentaufnahmen schreibgeschützt sind, können geerbte Berechtigungen nicht geändert werden, und an der Quelle vorgenommene Berechtigungsänderungen werden nicht in vorhandenen Momentaufnahmen wiedergegeben.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-230">Because snapshots are read-only, inherited permissions cannot be changed and permission changes made to the source will not be reflected in existing snapshots.</span></span>  
  
-   <span data-ttu-id="fb5ab-231">Eine Momentaufnahme gibt stets den Status von Dateigruppen zum Zeitpunkt der Erstellung der Momentaufnahmen wieder: Onlinedateigruppen bleiben online und Offlinedateigruppen offline.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-231">A snapshot always reflects the state of filegroups at the time of snapshot creation: online filegroups remain online, and offline filegroups remain offline.</span></span> <span data-ttu-id="fb5ab-232">Weitere Informationen finden Sie unter "Datenbankmomentaufnahmen mit Offlinedateigruppen" weiter unten in diesem Thema.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-232">For more information, see "Database Snapshots with Offline Filegroups" later in this topic.</span></span>  
  
-   <span data-ttu-id="fb5ab-233">Wenn eine Quelldatenbank den Status RECOVERY_PENDING erhält, kann auf ihre Datenbankmomentaufnahmen möglicherweise nicht mehr zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-233">If a source database becomes RECOVERY_PENDING, its database snapshots may become inaccessible.</span></span> <span data-ttu-id="fb5ab-234">Nachdem das Problem mit der Quelldatenbank gelöst wurde, sollten ihre Momentaufnahmen jedoch wieder verfügbar werden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-234">After the issue on the source database is resolved, however, its snapshots should become available again.</span></span>  
  
-   <span data-ttu-id="fb5ab-235">Die Wiederherstellung wird für schreibgeschützte Dateigruppen und für komprimierte Dateigruppen nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-235">Reverting is unsupported for read-only filegroups and for compressed filegroups.</span></span> <span data-ttu-id="fb5ab-236">Wiederherstellungsversuche für eine Datenbank mit diesen Typen von Dateigruppen sind fehlerhaft.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-236">Attempts to revert a database containing either of these types of filegroups fail.</span></span>  
  
-   <span data-ttu-id="fb5ab-237">In einer Protokollversandkonfiguration können Datenbankmomentaufnahmen nur für die primäre Datenbank erstellt werden, nicht für eine sekundäre Datenbank.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-237">In a log shipping configuration, database snapshots can be created only on the primary database, not on a secondary database.</span></span> <span data-ttu-id="fb5ab-238">Falls Sie die Rollen zwischen der primären Serverinstanz und einer sekundären Serverinstanz vertauschen, müssen Sie alle Datenbankmomentaufnahmen löschen, bevor Sie die primäre Datenbank als sekundäre Datenbank einrichten können.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-238">If you switch roles between the primary server instance and a secondary server instance, you must drop all the database snapshots before you can set the primary database up as a secondary database.</span></span>  
  
-   <span data-ttu-id="fb5ab-239">Eine Datenbankmomentaufnahme kann nicht als skalierbare freigegebene Datenbank konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-239">A database snapshot cannot be configured as a scalable shared database.</span></span>  
  
-   <span data-ttu-id="fb5ab-240">FILESTREAM-Dateigruppen werden von Datenbankmomentaufnahmen nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-240">FILESTREAM filegroups are not supported by database snapshots.</span></span> <span data-ttu-id="fb5ab-241">Wenn in einer Quelldatenbank FILESTREAM-Dateigruppen vorhanden sind, werden diese in den entsprechenden Datenbankmomentaufnahmen als offline markiert, und die Datenbankmomentaufnahmen können nicht für das Zurückversetzen der Datenbank in den früheren Zustand verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-241">If FILESTREAM filegroups exist in a source database, they are marked as offline in its database snapshots, and the database snapshots cannot be used for reverting the database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="fb5ab-242">In einer SELECT-Anweisung, die für eine Datenbankmomentaufnahme ausgeführt wird, darf keine FILESTREAM-Spalte angegeben werden, da andernfalls die folgende Fehlermeldung zurückgegeben wird: `Could not continue scan with NOLOCK due to data movement.`</span><span class="sxs-lookup"><span data-stu-id="fb5ab-242">A SELECT statement that is executed on a database snapshot must not specify a FILESTREAM column; otherwise, the following error message will be returned: `Could not continue scan with NOLOCK due to data movement.`</span></span>  
  
-   <span data-ttu-id="fb5ab-243">Wenn Statistiken zu einer schreibgeschützten Momentaufnahme fehlen oder veraltet sind, erstellt und verwaltet [!INCLUDE[ssDE](../../includes/ssde-md.md)] temporäre Statistiken in tempdb.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-243">When statistics on a read-only snapshot are missing or stale, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] creates and maintains temporary statistics in tempdb.</span></span> <span data-ttu-id="fb5ab-244">Weitere Informationen finden Sie unter [Verwalten von Statistiken für Tabellen in SQL Data Warehouse](../statistics/statistics.md).</span><span class="sxs-lookup"><span data-stu-id="fb5ab-244">For more information, see [Statistics](../statistics/statistics.md).</span></span>  
  
###  <a name="disk-space-requirements"></a><a name="DiskSpace"></a> <span data-ttu-id="fb5ab-245">Anforderungen an den Datenträgerspeicher</span><span class="sxs-lookup"><span data-stu-id="fb5ab-245">Disk Space Requirements</span></span>  
 <span data-ttu-id="fb5ab-246">Datenbankmomentaufnahmen belegen Datenträgerspeicher.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-246">Database snapshots consume disk space.</span></span> <span data-ttu-id="fb5ab-247">Wenn für eine Datenbankmomentaufnahme nicht genügend Speicherplatz vorhanden ist, wird er als fehlerverdächtig gekennzeichnet und muss gelöscht werden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-247">If a database snapshot runs out of disk space, it is marked as suspect and must be dropped.</span></span> <span data-ttu-id="fb5ab-248">(Auf die Quelldatenbank hat dies jedoch keine Auswirkungen. Aktionen in ihr werden normal fortgesetzt.) Im Vergleich zu einer vollständigen Kopie einer Datenbank sind Momentaufnahmen jedoch äußerst speicherplatzeffizient.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-248">(The source database, however, is not affected; actions on it continue normally.) Compared to a full copy of a database, however, snapshots are highly space efficient.</span></span> <span data-ttu-id="fb5ab-249">Bei einer Momentaufnahme ist nur genügend Speicher für die Seiten erforderlich, die während seiner Lebensdauer geändert werden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-249">A snapshot requires only enough storage for the pages that change during its lifetime.</span></span> <span data-ttu-id="fb5ab-250">Im Allgemeinen werden Momentaufnahmen nur für eine begrenzte Zeit gespeichert. Daher spielt ihre Größe keine wesentliche Rolle.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-250">Generally, snapshots are kept for a limited time, so their size is not a major concern.</span></span>  
  
 <span data-ttu-id="fb5ab-251">Je länger eine Momentaufnahme jedoch gespeichert wird, desto wahrscheinlicher belegt er verfügbaren Speicherplatz.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-251">The longer you keep a snapshot, however, the more likely it is to use up available space.</span></span> <span data-ttu-id="fb5ab-252">Die maximale Größe, auf die eine Sparsedatei anwachsen kann, ist die Größe der entsprechenden Quelldatenbankdatei zum Zeitpunkt der Erstellung der Momentaufnahme.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-252">The maximum size to which a sparse file can grow is the size of the corresponding source database file at the time of the snapshot creation.</span></span>  
  
 <span data-ttu-id="fb5ab-253">Wenn für eine Datenbankmomentaufnahme nicht genügend Speicherplatz vorhanden ist, muss sie gelöscht werden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-253">If a database snapshot runs out of disk space, it must be deleted (dropped).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fb5ab-254">Abgesehen vom Dateispeicherplatz nimmt eine Datenbankmomentaufnahme ungefähr so viele Ressourcen in Anspruch wie eine Datenbank.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-254">Except for file space, a database snapshot consumes roughly as many resources as a database.</span></span>  
  
###  <a name="database-snapshots-with-offline-filegroups"></a><a name="OfflineFGs"></a> <span data-ttu-id="fb5ab-255">Datenbankmomentaufnahmen mit Offlinedateigruppen</span><span class="sxs-lookup"><span data-stu-id="fb5ab-255">Database Snapshots with Offline Filegroups</span></span>  
 <span data-ttu-id="fb5ab-256">Offlinedateigruppen in der Quelldatenbank haben Auswirkungen auf Datenbankmomentaufnahmen, wenn Sie versuchen, einen der folgenden Vorgänge auszuführen:</span><span class="sxs-lookup"><span data-stu-id="fb5ab-256">Offline filegroups in the source database affect database snapshots when you try to do any of the following:</span></span>  
  
-   <span data-ttu-id="fb5ab-257">Erstellen einer Momentaufnahme</span><span class="sxs-lookup"><span data-stu-id="fb5ab-257">Create a snapshot</span></span>  
  
     <span data-ttu-id="fb5ab-258">Wenn eine Quelldatenbank über eine oder mehrere Offlinedateigruppen verfügt, verläuft die Erstellung der Momentaufnahme erfolgreich, wenn die Dateigruppen offline sind.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-258">When a source database has one or more offline filegroups, snapshot creation succeeds with the filegroups offline.</span></span> <span data-ttu-id="fb5ab-259">Dateien mit geringer Dichte werden für die Offlinedateigruppen nicht erstellt.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-259">Sparse files are not created for the offline filegroups.</span></span>  
  
-   <span data-ttu-id="fb5ab-260">Offlineschalten einer Dateigruppe</span><span class="sxs-lookup"><span data-stu-id="fb5ab-260">Take a filegroup offline</span></span>  
  
     <span data-ttu-id="fb5ab-261">Sie können eine Datei in der Quelldatenbank offline schalten.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-261">You can take a file offline in the source database.</span></span> <span data-ttu-id="fb5ab-262">Die Dateigruppe bleibt in Datenbankmomentaufnahmen jedoch online, wenn sie zum Zeitpunkt der Erstellung der Momentaufnahme online war.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-262">However, the filegroup remains online in database snapshots if it was online when the snapshot was created.</span></span> <span data-ttu-id="fb5ab-263">Wenn die abgefragten Daten seit der Erstellung der Momentaufnahme geändert wurden, kann in der Momentaufnahme auf die ursprüngliche Datenseite zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-263">If the queried data has changed since snapshot creation, the original data page will be accessible in the snapshot.</span></span> <span data-ttu-id="fb5ab-264">Abfragen, die mithilfe der Momentaufnahmen auf ungeänderte Daten in der Dateigruppe zugreifen, schlagen jedoch wahrscheinlich mit E/A-Fehlern fehl.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-264">However, queries that use the snapshot to access unmodified data in the filegroup are likely to fail with input/output (I/O) errors.</span></span>  
  
-   <span data-ttu-id="fb5ab-265">Onlineschalten einer Dateigruppe</span><span class="sxs-lookup"><span data-stu-id="fb5ab-265">Bring a filegroup online</span></span>  
  
     <span data-ttu-id="fb5ab-266">Sie können eine Dateigruppe in einer Datenbank, die über eine Datenbankmomentaufnahme verfügt, nicht online schalten.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-266">You cannot bring a filegroup online in a database that has any database snapshots.</span></span> <span data-ttu-id="fb5ab-267">Wenn sich eine Dateigruppe während der Momentaufnahmeerstellung offline befindet oder offline geschaltet wird, während eine Datenbankmomentaufnahme vorhanden ist, bleibt die Dateigruppe offline.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-267">If a filegroup is offline at the time of snapshot creation or is taken offline while a database snapshot exists, the filegroup remains offline.</span></span> <span data-ttu-id="fb5ab-268">Das liegt daran, dass eine Datei beim Onlineschalten wiederhergestellt wird; dies ist jedoch nicht möglich, wenn in der Datenbank eine Datenbankmomentaufnahme vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-268">This is because bringing a file back online involves restoring it, which is not possible if a database snapshot exists on the database.</span></span>  
  
-   <span data-ttu-id="fb5ab-269">Wiederherstellen der Quelldatenbank mit der Momentaufnahme</span><span class="sxs-lookup"><span data-stu-id="fb5ab-269">Revert the source database to the snapshot</span></span>  
  
     <span data-ttu-id="fb5ab-270">Für das Wiederherstellen einer Quelldatenbank aus einer Datenbankmomentaufnahme ist es erforderlich, dass alle Dateigruppen online sind, mit Ausnahme der Dateigruppen, die zum Zeitpunkt der Erstellung der Momentaufnahme offline waren.</span><span class="sxs-lookup"><span data-stu-id="fb5ab-270">Reverting a source database to a database snapshot requires that all of the filegroups are online except for filegroups that were offline when the snapshot was created.</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="fb5ab-271">Verwandte Aufgaben</span><span class="sxs-lookup"><span data-stu-id="fb5ab-271">Related Tasks</span></span>  
  
-   [<span data-ttu-id="fb5ab-272">Erstellen einer Datenbankmomentaufnahme &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="fb5ab-272">Create a Database Snapshot &#40;Transact-SQL&#41;</span></span>](create-a-database-snapshot-transact-sql.md)  
  
-   [<span data-ttu-id="fb5ab-273">Anzeigen einer Datenbank-Momentaufnahme &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="fb5ab-273">View a Database Snapshot &#40;SQL Server&#41;</span></span>](view-a-database-snapshot-sql-server.md)  
  
-   [<span data-ttu-id="fb5ab-274">Anzeigen der Größe der Datei mit geringer Dichte einer Datenbank-Momentaufnahme &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="fb5ab-274">View the Size of the Sparse File of a Database Snapshot &#40;Transact-SQL&#41;</span></span>](view-the-size-of-the-sparse-file-of-a-database-snapshot-transact-sql.md)  
  
-   [<span data-ttu-id="fb5ab-275">Wiederherstellen einer Datenbank zu einer Datenbank-Momentaufnahme</span><span class="sxs-lookup"><span data-stu-id="fb5ab-275">Revert a Database to a Database Snapshot</span></span>](revert-a-database-to-a-database-snapshot.md)  
  
-   [<span data-ttu-id="fb5ab-276">Löschen einer Datenbankmomentaufnahme &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="fb5ab-276">Drop a Database Snapshot &#40;Transact-SQL&#41;</span></span>](drop-a-database-snapshot-transact-sql.md)  
  
## <a name="see-also"></a><span data-ttu-id="fb5ab-277">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="fb5ab-277">See Also</span></span>  
 [<span data-ttu-id="fb5ab-278">Datenbankspiegelung und Datenbankmomentaufnahmen &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="fb5ab-278">Database Mirroring and Database Snapshots &#40;SQL Server&#41;</span></span>](database-snapshots-sql-server.md)  
  
  

---
title: SQL Server von Datendateien in Azure | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: supportability
ms.topic: conceptual
ms.assetid: 38ffd9c2-18a5-43d2-b674-e425addec4e4
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 21f960a50ed48ff2b146d96b73a1609d73b35c32
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87695682"
---
# <a name="sql-server-data-files-in-azure"></a><span data-ttu-id="54bd8-102">SQL Server-Datendateien in Azure</span><span class="sxs-lookup"><span data-stu-id="54bd8-102">SQL Server Data Files in Azure</span></span>
  <span data-ttu-id="54bd8-103">SQL Server Datendateien in Azure ermöglicht systemeigene Unterstützung für SQL Server Datenbankdateien, die als Azure-blobspeicher gespeichert sind</span><span class="sxs-lookup"><span data-stu-id="54bd8-103">SQL Server Data Files in Azure enables native support for SQL Server database files stored as Azure Blobs.</span></span> <span data-ttu-id="54bd8-104">Sie ermöglicht es Ihnen, eine Datenbank in SQL Server zu erstellen, die lokal oder auf einem virtuellen Computer in Azure ausgeführt wird, wobei ein dedizierter Speicherort für Ihre Daten in Azure BLOB Storage.</span><span class="sxs-lookup"><span data-stu-id="54bd8-104">It allows you to create a database in SQL Server running in on-premises or in a virtual machine in Azure with a dedicated storage location for your data in Azure Blob Storage.</span></span> <span data-ttu-id="54bd8-105">Diese Erweiterung vereinfacht insbesondere das Verschieben von Datenbanken zwischen Computern mithilfe von Trenn- und Anfügevorgängen.</span><span class="sxs-lookup"><span data-stu-id="54bd8-105">This enhancement especially simplifies to move databases between machines by using detach and attach operations.</span></span> <span data-ttu-id="54bd8-106">Darüber hinaus bietet Sie einen alternativen Speicherort für Ihre Datenbank-Sicherungsdateien, da Sie eine Wiederherstellung von oder auf Azure Storage ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="54bd8-106">In addition, it provides an alternative storage location for your database backup files by allowing you to restore from or to Azure Storage.</span></span> <span data-ttu-id="54bd8-107">Mit erweiterten Funktionen für das Virtualisieren und Verschieben von Daten sowie für Sicherheit und Verfügbarkeit unterstützt sie verschiedene Hybridlösungen und bietet zusätzlich kostengünstige, einfache Verwaltungsfunktionen für hohe Verfügbarkeit und flexible Skalierung.</span><span class="sxs-lookup"><span data-stu-id="54bd8-107">Therefore, it enables several hybrid solutions by providing several benefits for data virtualization, data movement, security and availability, and any easy low costs and maintenance for high-availability and elastic scaling.</span></span>  
  
 <span data-ttu-id="54bd8-108">In diesem Thema werden Konzepte und Überlegungen vorgestellt, die für das Speichern von SQL Server Datendateien in Azure Storage Dienst von zentraler Bedeutung sind</span><span class="sxs-lookup"><span data-stu-id="54bd8-108">This topic introduces concepts and considerations that are central to storing SQL Server data files in Azure Storage Service.</span></span>  
  
 <span data-ttu-id="54bd8-109">Eine praktische praktische Erfahrung bei der Verwendung dieses neuen Features finden Sie unter [Tutorial: SQL Server von Datendateien in Azure Storage Dienstanbieter](../tutorial-use-azure-blob-storage-service-with-sql-server-2016.md).</span><span class="sxs-lookup"><span data-stu-id="54bd8-109">For a practical hands-on experience on how to use this new feature, see [Tutorial: SQL Server Data Files in Azure Storage service](../tutorial-use-azure-blob-storage-service-with-sql-server-2016.md).</span></span>  
  
 <span data-ttu-id="54bd8-110">Das folgende Diagramm veranschaulicht, dass Sie mit dieser Erweiterung SQL Server Datenbankdateien als Azure-blobdateien in Azure Storage speichern können, unabhängig davon, wo sich der Server befindet.</span><span class="sxs-lookup"><span data-stu-id="54bd8-110">The following diagram demonstrates that this enhancement enables you to store SQL Server database files as Azure blobs in Azure Storage regardless of where your server resides.</span></span>  
  
 <span data-ttu-id="54bd8-111">![SQL Server Integration in Azure Storage](../../database-engine/media/sql-server-dbfiles-stored-as-blobs.gif "SQL Server Integration in Azure Storage")</span><span class="sxs-lookup"><span data-stu-id="54bd8-111">![SQL Server Integration with Azure Storage](../../database-engine/media/sql-server-dbfiles-stored-as-blobs.gif "SQL Server Integration with Azure Storage")</span></span>  
  
## <a name="benefits-of-using-sql-server-data-files-in-azure"></a><span data-ttu-id="54bd8-112">Vorteile der Verwendung von SQL Server-Datendateien in Azure</span><span class="sxs-lookup"><span data-stu-id="54bd8-112">Benefits of using SQL Server Data Files in Azure</span></span>  
  
-   <span data-ttu-id="54bd8-113">**Vorteil – Einfache und schnelle Migration:** Diese Funktion vereinfacht den Migrationsprozess, indem jeweils eine Datenbank zwischen Computern in lokalen Umgebungen sowie zwischen lokalen und Cloudumgebungen verschoben wird, ohne dass Änderungen an der Anwendung vorgenommen werden müssen.</span><span class="sxs-lookup"><span data-stu-id="54bd8-113">**Easy and fast migration benefits:** This feature simplifies the migration process by moving one database at a time between machines in on-premises as well as between on-premises and cloud environments without any application changes.</span></span> <span data-ttu-id="54bd8-114">Auf diese Weise wird eine inkrementelle Migration unterstützt, während Ihre vorhandene lokale Infrastruktur unverändert beibehalten wird.</span><span class="sxs-lookup"><span data-stu-id="54bd8-114">Therefore, it supports an incremental migration while maintaining your existing on-premises infrastructure in place.</span></span> <span data-ttu-id="54bd8-115">Darüber hinaus vereinfacht der Zugriff auf einen zentralen Datenspeicher die Anwendungslogik, wenn eine Anwendung in einer lokalen Umgebung an mehreren Stellen ausgeführt werden muss.</span><span class="sxs-lookup"><span data-stu-id="54bd8-115">In addition, having access to a centralized data storage simplifies the application logic when an application needs to run in multiple locations in an on-premises environment.</span></span> <span data-ttu-id="54bd8-116">Es kann vorkommen, dass Sie schnell Rechenzentren an geografisch verteilten Standorten einrichten müssen, in denen Daten aus vielen verschiedenen Quellen gesammelt werden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-116">In some cases, you may need to rapidly setup computer centers in geographically dispersed locations, which gather data from many different sources.</span></span> <span data-ttu-id="54bd8-117">Wenn Sie diese neue Erweiterung verwenden und keine Daten von einem Speicherort zu einem anderen verschieben, können Sie zahlreiche Datenbanken als Azure-BLOB speichern und dann Transact-SQL-Skripts ausführen, um Datenbanken auf den lokalen Computern oder virtuellen Computern zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="54bd8-117">By using this new enhancement, instead of moving data from one location to another, you can store many databases as Azure blobs, and then run Transact-SQL scripts to create databases on the local machines or virtual machines.</span></span>  
  
-   <span data-ttu-id="54bd8-118">**Kosten-und unbegrenzte Speicher Vorteile:** Diese Funktion ermöglicht es Ihnen, unbegrenzten Offsite-Speicher in Azure zu nutzen, während gleichzeitig lokale computeressourcen genutzt werden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-118">**Cost and limitless storage benefits:** This feature enables you to have limitless off-site storage in Azure while leveraging on-premises compute resources.</span></span> <span data-ttu-id="54bd8-119">Wenn Sie Azure als Speicherort verwenden, können Sie sich problemlos auf die Anwendungslogik konzentrieren, ohne den Aufwand der Hardware Verwaltung zu erhöhen.</span><span class="sxs-lookup"><span data-stu-id="54bd8-119">When you use Azure as a storage location, you can easily focus on the application logic without the overhead of hardware management.</span></span> <span data-ttu-id="54bd8-120">Wenn ein lokaler Serverknoten ausfällt, können Sie einen neuen Knoten einrichten, ohne Daten zu verschieben.</span><span class="sxs-lookup"><span data-stu-id="54bd8-120">If you lose a computation node on-premises, you can set up a new one without any data movement.</span></span>  
  
-   <span data-ttu-id="54bd8-121">**Vorteile der Hochverfügbarkeit und der Notfall Wiederherstellung:** Wenn Sie SQL Server Datendateien in Azure verwenden, können Sie die Lösungen für Hochverfügbarkeit und Notfall Wiederherstellung vereinfachen.</span><span class="sxs-lookup"><span data-stu-id="54bd8-121">**High availability and disaster recovery benefits:** Using SQL Server Data Files in Azure feature might simplify the high availability and disaster recovery solutions.</span></span> <span data-ttu-id="54bd8-122">Wenn beispielsweise ein virtueller Computer in Azure oder eine Instanz von SQL Server abstürzt, können Sie die Datenbanken auf einem neuen Computer neu erstellen, indem Sie einfach Links zu Azure-BLOB-Instanzen erneut einrichten.</span><span class="sxs-lookup"><span data-stu-id="54bd8-122">For example, if a virtual machine in Azure or an instance of SQL Server crashes, you can re-create your databases in a new machine by just re-establishing links to Azure Blobs.</span></span>  
  
-   <span data-ttu-id="54bd8-123">**Vorteil – Sicherheit:** Durch diese neue Erweiterung können Serverinstanzen von Speicherinstanzen getrennt behandelt werden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-123">**Security benefits:** This new enhancement allows you to separate a compute instance from a storage instance.</span></span> <span data-ttu-id="54bd8-124">Beispielsweise können Sie über eine vollständig verschlüsselte Datenbank verfügen, deren Entschlüsselung ausschließlich auf einer Serverinstanz und nicht auf einer Speicherinstanz stattfindet.</span><span class="sxs-lookup"><span data-stu-id="54bd8-124">You can have a fully encrypted database with decryption only occurring on compute instance but not in a storage instance.</span></span> <span data-ttu-id="54bd8-125">Dies bedeutet, dass Sie mit der neuen Erweiterung alle Daten in einer öffentlichen Cloud unter Verwendung von TDE-Zertifikaten (Transparent Data Encryption, transparente Datenverschlüsselung) verschlüsseln können, die physisch von den Daten getrennt sind.</span><span class="sxs-lookup"><span data-stu-id="54bd8-125">In other words, using this new enhancement, you can encrypt all data in public cloud using Transparent Data Encryption (TDE)  certificates, which are physically separated from the data.</span></span> <span data-ttu-id="54bd8-126">Die TDE-Schlüssel können in der Masterdatenbank gespeichert werden, die auf einem physisch sicheren lokalen Computer an Ihrem Standort gespeichert und gesichert wird.</span><span class="sxs-lookup"><span data-stu-id="54bd8-126">The TDE keys can be stored in the master database, which is stored locally in your physically secure on-premises machine and backed up locally.</span></span> <span data-ttu-id="54bd8-127">Sie können diese lokalen Schlüssel verwenden, um die Daten zu verschlüsseln, die sich in Azure Storage befinden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-127">You can use these local keys to encrypt the data, which resides in Azure Storage.</span></span> <span data-ttu-id="54bd8-128">Falls Ihre Anmeldeinformationen für das Cloudspeicherkonto ausgespäht werden, sind die Daten trotzdem sicher, da die TDE-Zertifikate immer lokal gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-128">If your cloud storage account credentials are stolen, your data still stays secure as the TDE certificates always reside in on-premises.</span></span>  
  
## <a name="concepts-and-requirements"></a><span data-ttu-id="54bd8-129">Konzepte und Anforderungen</span><span class="sxs-lookup"><span data-stu-id="54bd8-129">Concepts and Requirements</span></span>  
  
### <a name="azure-storage-concepts"></a><span data-ttu-id="54bd8-130">Azure-Speicherkonzepte</span><span class="sxs-lookup"><span data-stu-id="54bd8-130">Azure Storage Concepts</span></span>  
 <span data-ttu-id="54bd8-131">Bei Verwendung von SQL Server-Datendateien in Azure müssen Sie ein Speicherkonto und einen Container in Azure erstellen.</span><span class="sxs-lookup"><span data-stu-id="54bd8-131">When using SQL Server Data Files in Azure feature, you need to create a storage account and a container in Azure.</span></span> <span data-ttu-id="54bd8-132">Anschließend müssen Sie SQL Server-Anmeldeinformationen erstellen, die Informationen zur Containerrichtlinie sowie eine SAS (Shared Access Signature, Signatur für gemeinsamen Zugriff) enthalten, die für den Zugriff auf den Container erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="54bd8-132">Then, you need to create a SQL Server credential, which includes information on the policy of the container as well as a shared access signature that is necessary to access the container.</span></span>  
  
 <span data-ttu-id="54bd8-133">In Azure stellt ein Speicherkonto die höchste Ebene des Namespace für den Zugriff auf BLOB dar.</span><span class="sxs-lookup"><span data-stu-id="54bd8-133">In Azure, a storage account represents the highest level of the namespace for accessing Blobs.</span></span> <span data-ttu-id="54bd8-134">Ein Speicherkonto kann eine unbegrenzte Anzahl von Containern enthalten, solange deren Gesamtgröße 500 TB nicht überschreitet.</span><span class="sxs-lookup"><span data-stu-id="54bd8-134">A storage account can contain an unlimited number of containers, as long as their total size is under 500 TB.</span></span> <span data-ttu-id="54bd8-135">Aktuelle Informationen zu Speichergrößenbeschränkungen finden Sie unter [Azure-Abonnement und Dienstbeschränkungen, Kontingente und Einschränkungen](https://azure.microsoft.com/documentation/articles/azure-subscription-service-limits/).</span><span class="sxs-lookup"><span data-stu-id="54bd8-135">For the latest information on storage limits, see [Azure Subscription and Service Limits, Quotas, and Constraints](https://azure.microsoft.com/documentation/articles/azure-subscription-service-limits/).</span></span> <span data-ttu-id="54bd8-136">Ein Container stellt eine Gruppierung eines BLOB-Satzes bereit.</span><span class="sxs-lookup"><span data-stu-id="54bd8-136">A container provides a grouping of a set of Blobs.</span></span> <span data-ttu-id="54bd8-137">Alle BLOBs müssen sich in einem Container befinden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-137">All Blobs must be in a container.</span></span> <span data-ttu-id="54bd8-138">Ein Konto kann eine unbegrenzte Anzahl von Containern enthalten.</span><span class="sxs-lookup"><span data-stu-id="54bd8-138">An account can contain an unlimited number of containers.</span></span> <span data-ttu-id="54bd8-139">Analog dazu kann in einem Container auch eine unbegrenzte Anzahl von BLOBs gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-139">Similarly, a container can store an unlimited number of Blobs as well.</span></span> <span data-ttu-id="54bd8-140">Es gibt zwei Arten von BLOBs, die im Azure-Speicher gespeichert werden können: Blockblobs und Seitenblobs.</span><span class="sxs-lookup"><span data-stu-id="54bd8-140">There are two types of blobs that can be stored in Azure Storage: block and page blobs.</span></span> <span data-ttu-id="54bd8-141">Für die neue Funktion werden Seitenblobs von bis zu 1 TB verwendet, die effizienter sind, wenn Bytebereiche in einer Datei häufig geändert werden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-141">This new feature uses Page blobs, which can be up to 1TB in size, and are more efficient when ranges of bytes in a file are modified frequently.</span></span> <span data-ttu-id="54bd8-142">Sie können mit folgendem URL-Format auf BLOBs zugreifen: `http://storageaccount.blob.core.windows.net/<container>/<blob>`.</span><span class="sxs-lookup"><span data-stu-id="54bd8-142">You can access Blobs using the following URL format: `http://storageaccount.blob.core.windows.net/<container>/<blob>`.</span></span>  
  
### <a name="azure-billing-considerations"></a><span data-ttu-id="54bd8-143">Überlegungen zur Abrechnung in Azure</span><span class="sxs-lookup"><span data-stu-id="54bd8-143">Azure Billing Considerations</span></span>  
 <span data-ttu-id="54bd8-144">Die Schätzung der für die Nutzung der Azure-Dienste anfallenden Kosten ist ein wichtiger Aspekt des Entscheidungs- und Planungsprozesses.</span><span class="sxs-lookup"><span data-stu-id="54bd8-144">Estimating the cost of using Azure Services is an important matter in the decision making and planning process.</span></span> <span data-ttu-id="54bd8-145">Wenn Sie SQL Server-Datendateien im Azure-Speicher speichern, fallen Kosten für die Speicherung und Transaktionen an.</span><span class="sxs-lookup"><span data-stu-id="54bd8-145">When storing SQL Server data files in Azure Storage, you need to pay costs associated with storage and transactions.</span></span> <span data-ttu-id="54bd8-146">Zusätzlich erfordert die Implementierung von SQL Server-Datendateien im Azure-Speicher alle 45 bis 60 Sekunden eine implizite Erneuerung der BLOB-Leasedauer.</span><span class="sxs-lookup"><span data-stu-id="54bd8-146">In addition, the implementation of SQL Server Data Files in Azure Storage feature requires a renewal of Blob lease every 45 to 60 seconds implicitly.</span></span> <span data-ttu-id="54bd8-147">Auf diese Weise entstehen ebenfalls Transaktionskosten pro Datenbankdatei, z. B. MDF- oder LDF-Datei.</span><span class="sxs-lookup"><span data-stu-id="54bd8-147">This also results in transaction costs per database file, such as .mdf or .ldf.</span></span> <span data-ttu-id="54bd8-148">Nach unserer Einschätzung würden sich die Kosten für das Erneuern der Leasedauer für zwei Datenbankdateien (MDF und LDF) gemäß dem aktuellen Preismodell auf ca. 2 US-Cent pro Monat belaufen.</span><span class="sxs-lookup"><span data-stu-id="54bd8-148">Based on our estimations, the cost of renewing leases for two database files (.mdf and .ldf) would be about 2 cents per month according to the current pricing model.</span></span> <span data-ttu-id="54bd8-149">Die Informationen auf der [Azure-Preisseite](https://azure.microsoft.com/pricing/) sollen helfen, die monatlichen Kosten einzuschätzen, die mit der Nutzung des Azure-Speichers und der virtuellen Azure-Computer verbunden sind.</span><span class="sxs-lookup"><span data-stu-id="54bd8-149">We recommend that you use the information on the [Azure Pricing](https://azure.microsoft.com/pricing/) page to help estimate the monthly costs associated with the use of Azure Storage and Azure Virtual Machines.</span></span>  
  
### <a name="sql-server-concepts"></a><span data-ttu-id="54bd8-150">Konzepte von SQL Server</span><span class="sxs-lookup"><span data-stu-id="54bd8-150">SQL Server Concepts</span></span>  
 <span data-ttu-id="54bd8-151">Die folgenden Voraussetzungen müssen zur Verwendung der neuen Erweiterung erfüllt sein:</span><span class="sxs-lookup"><span data-stu-id="54bd8-151">When using this new enhancement, you are required to do the followings:</span></span>  
  
-   <span data-ttu-id="54bd8-152">Sie erstellen eine Richtlinie für einen Container und generieren zusätzlich einen SAS-Schlüssel.</span><span class="sxs-lookup"><span data-stu-id="54bd8-152">You must create a policy on a container and also generate a shared access signature (SAS) key.</span></span>  
  
-   <span data-ttu-id="54bd8-153">Für jeden Container, der von einer Daten- oder Protokolldatei verwendet wird, erstellen Sie SQL Server-Anmeldeinformationen, deren Name mit dem Containerpfad übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="54bd8-153">For each container used by a data or a log file, you must create a SQL Server Credential whose name matches the container path.</span></span>  
  
-   <span data-ttu-id="54bd8-154">Die Informationen zum Azure-Speichercontainer, der zugehörige Richtlinienname und der SAS-Schlüssel müssen im Anmeldeinformationsspeicher von SQL Server gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-154">You must store the information regarding Azure Storage container, its associated policy name, and SAS key in the SQL Server credential store.</span></span>  
  
 <span data-ttu-id="54bd8-155">Im folgenden Beispiel wird davon ausgegangen, dass ein Azure Storage Container erstellt wurde und eine Richtlinie mit Lese-, Schreib-, Listen-und Rechte Erstellung erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="54bd8-155">The following example assumes that an Azure Storage container has been created, and a policy has been created with read, write, list, rights.</span></span> <span data-ttu-id="54bd8-156">Beim Erstellen einer Richtlinie für einen Container wird ein SAS-Schlüssel generiert, der gefahrlos unverschlüsselt im Arbeitsspeicher vorgehalten werden kann und von SQL Server für den Zugriff auf die BLOB-Dateien im Container benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="54bd8-156">Creating a policy on a container generates a SAS key which is safe to keep unencrypted in memory and needed by SQL Server to access the blob files in the container.</span></span> <span data-ttu-id="54bd8-157">Ersetzen Sie in den folgenden Codeausschnitt `'your SAS key'` mit einem Eintrag, der dem folgenden ähnelt: `'sr=c&si=<MYPOLICYNAME>&sig=<THESHAREDACCESSSIGNATURE>'`.</span><span class="sxs-lookup"><span data-stu-id="54bd8-157">In the following code snippet, replace `'your SAS key'` with an entry similar to the following: `'sr=c&si=<MYPOLICYNAME>&sig=<THESHAREDACCESSSIGNATURE>'`.</span></span> <span data-ttu-id="54bd8-158">Weitere Informationen finden Sie unter [Erstellen und Verwenden einer Shared Access Signature](https://msdn.microsoft.com/library/azure/jj721951.aspx)</span><span class="sxs-lookup"><span data-stu-id="54bd8-158">For more information, see [Create and Use a Shared Access Signature](https://msdn.microsoft.com/library/azure/jj721951.aspx)</span></span>  
  
```sql
-- Create a credential  
CREATE CREDENTIAL [https://testdb.blob.core.windows.net/data]  
WITH IDENTITY='SHARED ACCESS SIGNATURE',  
SECRET = 'your SAS key'  
  
-- Create database with data and log files in Azure container.  
CREATE DATABASE testdb   
ON  
( NAME = testdb_dat,  
    FILENAME = 'https://testdb.blob.core.windows.net/data/TestData.mdf' )  
 LOG ON  
( NAME = testdb_log,  
    FILENAME =  'https://testdb.blob.core.windows.net/data/TestLog.ldf')
```  
  
> [!IMPORTANT]
> <span data-ttu-id="54bd8-159">Wenn ein Container aktive Verweise auf Datendateien enthält, schlagen Versuche, die entsprechenden SQL Server-Anmeldeinformationen zu löschen, fehl.</span><span class="sxs-lookup"><span data-stu-id="54bd8-159">If there are any active references to data files in a container, attempts to delete the corresponding SQL Server credential fails.</span></span>  
  
### <a name="security"></a><span data-ttu-id="54bd8-160">Sicherheit</span><span class="sxs-lookup"><span data-stu-id="54bd8-160">Security</span></span>  
 <span data-ttu-id="54bd8-161">Die folgenden Sicherheitsüberlegungen und -anforderungen sollten beim Speichern von SQL Server-Datendateien im Azure-Speicher berücksichtigt werden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-161">The following are security considerations and requirements when storing SQL Server Data Files in Azure Storage.</span></span>  
  
-   <span data-ttu-id="54bd8-162">Beim Erstellen eines Containers für den Azure-BLOB-Speicherdienst sollten Sie den Zugriff auf „Privat“ festlegen.</span><span class="sxs-lookup"><span data-stu-id="54bd8-162">When creating a container for the Azure Blob storage service, we recommend that you set the access to private.</span></span> <span data-ttu-id="54bd8-163">Wenn Sie den Zugriff auf „Privat“ festlegen, können die Container- und BLOB-Daten nur vom Besitzer des Azure-Kontos gelesen werden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-163">When you set the access to private, container and blob data can be read by the Azure account owner only.</span></span>  
  
-   <span data-ttu-id="54bd8-164">Wenn Sie SQL Server-Datenbankdateien im Azure-Speicher speichern, müssen Sie eine SAS verwenden, d. h. einen URI, der eingeschränkte Rechte für den Zugriff auf Container, BLOBs, Warteschlangen und Tabellen gewährt.</span><span class="sxs-lookup"><span data-stu-id="54bd8-164">When storing SQL Server database files in Azure Storage, you need to use a shared access signature, a URI that grants restricted access rights to containers, blobs, queues, and tables.</span></span> <span data-ttu-id="54bd8-165">Durch die Verwendung einer SAS ermöglichen Sie SQL Server unter dem Speicherkonto den Zugriff auf Ressourcen, ohne Ihren Schlüssel für das Azure-Speicherkonto offen zu legen.</span><span class="sxs-lookup"><span data-stu-id="54bd8-165">By using a shared access signature, you can enable SQL Server to access resources in your storage account without sharing your Azure storage account key.</span></span>  
  
-   <span data-ttu-id="54bd8-166">Außerdem wird empfohlen, weiterhin die herkömmlichen Sicherheitsvorkehrungen für lokale Datenbanken zu treffen.</span><span class="sxs-lookup"><span data-stu-id="54bd8-166">In addition, we recommend that you continue implementing the traditional on-premises security practices for your databases.</span></span>  
  
### <a name="installation-prerequisites"></a><span data-ttu-id="54bd8-167">Voraussetzungen für die Installation</span><span class="sxs-lookup"><span data-stu-id="54bd8-167">Installation Prerequisites</span></span>  
 <span data-ttu-id="54bd8-168">Die folgenden Installations Voraussetzungen sind erforderlich, wenn SQL Server Datendateien in azuree gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-168">The followings are installation prerequisites when storing SQL Server Data Files in Azuree.</span></span>  
  
-   <span data-ttu-id="54bd8-169">**SQL Server in einer lokalen Umgebung:** Diese Funktion ist in SQL Server 2014 enthalten.</span><span class="sxs-lookup"><span data-stu-id="54bd8-169">**SQL Server on-premises:** SQL Server 2014 version includes this feature.</span></span> <span data-ttu-id="54bd8-170">Informationen zum Herunterladen von SQL Server 2014 finden Sie unter [SQL Server 2014](https://www.microsoft.com/sqlserver/sql-server-2014.aspx).</span><span class="sxs-lookup"><span data-stu-id="54bd8-170">To learn how to download SQL Server 2014, see [SQL Server 2014](https://www.microsoft.com/sqlserver/sql-server-2014.aspx).</span></span>  
  
-   <span data-ttu-id="54bd8-171">SQL Server auf einem virtuellen Computer in Azure: Wenn Sie SQL Server auf einem virtuellen Computer in Microsoft Azure installieren, installieren Sie SQL Server 2014, oder aktualisieren Sie Ihre vorhandene Instanz.</span><span class="sxs-lookup"><span data-stu-id="54bd8-171">SQL Server running in an Azure virtual machine: If you are installing SQL Server on an Azure Virtual Machine, install SQL Server 2014, or update your existing instance.</span></span> <span data-ttu-id="54bd8-172">Auf ähnliche Weise können Sie auch einen neuen virtuellen Computer in Azure erstellen, indem Sie SQL Server Platt Form Image 2014 verwenden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-172">Similarly, you can also create a new virtual machine in Azure using SQL Server 2014 platform image.</span></span> <span data-ttu-id="54bd8-173">Informationen zum Herunterladen von SQL Server 2014 finden Sie unter [SQL Server 2014](https://www.microsoft.com/sqlserver/sql-server-2014.aspx).</span><span class="sxs-lookup"><span data-stu-id="54bd8-173">To learn how to download SQL Server 2014, see [SQL Server 2014](https://www.microsoft.com/sqlserver/sql-server-2014.aspx).</span></span>  
  
###  <a name="limitations"></a><a name="bkmk_Limitations"></a> <span data-ttu-id="54bd8-174">Einschränkungen</span><span class="sxs-lookup"><span data-stu-id="54bd8-174">Limitations</span></span>  
  
-   <span data-ttu-id="54bd8-175">In der aktuellen Version dieser Funktion wird das Speichern von `FileStream` Daten in Azure Storage nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="54bd8-175">In the current release of this feature, storing `FileStream` data in Azure Storage is not supported.</span></span> <span data-ttu-id="54bd8-176">Sie können `Filestream` Daten in einer Azure Storage integrierten lokalen Datenbank speichern, aber Sie können FILESTREAM-Daten nicht zwischen Computern mithilfe Azure Storage verschieben.</span><span class="sxs-lookup"><span data-stu-id="54bd8-176">You can store `Filestream` data in an Azure Storage integrated local database but you cannot move Filestream data between machines using Azure Storage.</span></span> <span data-ttu-id="54bd8-177">Bei `FileStream`-Daten wird empfohlen, die herkömmlichen Verfahren zu verwenden, die bisher zum Verschieben von Dateien (MDF, LDF) in Verbindung mit Filestream-Daten zwischen verschiedenen Computern eingesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-177">For `FileStream` data, we recommend that you continue using the traditional techniques to move the files (.mdf, .ldf) associated with Filestream between different machines.</span></span>  
  
-   <span data-ttu-id="54bd8-178">Bei Verwendung der neuen Erweiterung kann derzeit nur eine SQL Server-Instanz (nicht mehrere) auf dieselben Datenbankdateien im Azure-Speicher zugreifen.</span><span class="sxs-lookup"><span data-stu-id="54bd8-178">Currently, this new enhancement does not support more than one SQL Server instance accessing the same database files in Azure Storage at the same time.</span></span> <span data-ttu-id="54bd8-179">Wenn ServerA mit einer aktiven Datenbankdatei online ist und ServerB, der auch über eine Datenbank verfügt, die auf dieselbe Datendatei verweist, versehentlich gestartet wird, kann die Datenbank des zweiten Servers nicht gestartet werden. Es wird der Fehlercode „**5120 Die physische Datei „%.\*ls“ kann nicht geöffnet werden.“ angezeigt. Betriebssystemfehler %d: „%ls“** .</span><span class="sxs-lookup"><span data-stu-id="54bd8-179">If ServerA is online with an active database file and if ServerB is accidentally started, and it also has a database which points to the same data file, the second server will fail to start the database with an error code **5120 Unable to open the physical file "%.\*ls". Operating system error %d: "%ls"**.</span></span>  
  
-   <span data-ttu-id="54bd8-180">Im Azure-Speicher können ausschließlich MDF-, LDF- und NDF-Dateien mithilfe des Features „SQL Server-Datendateien in Azure“ gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-180">Only .mdf, .ldf, and .ndf files can be stored in Azure Storage by using the SQL Server Data Files in Azure feature.</span></span>  
  
-   <span data-ttu-id="54bd8-181">Wenn Sie das Feature für SQL Server-Datendateien in Azure nutzen, wird die Georeplikation für Ihr Speicherkonto nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="54bd8-181">When using the SQL Server Data Files in Azure feature, geo-replication for your storage account is not supported.</span></span> <span data-ttu-id="54bd8-182">Wenn für ein Speicherkonto eine Georeplikation ausgeführt wird und ein Geo-Failover auftritt, kann die Datenbank beschädigt werden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-182">If a storage account is geo-replicated and a geo-failover happened, database corruption could occur.</span></span>  
  
-   <span data-ttu-id="54bd8-183">Jedes BLOB kann eine maximale Größe von 1 TB aufweisen.</span><span class="sxs-lookup"><span data-stu-id="54bd8-183">Each Blob can be up to maximum 1 TB in size.</span></span> <span data-ttu-id="54bd8-184">Auf diese Weise wird für die Datenbankdaten- und Protokolldateien, die im Azure-Speicher gespeichert werden können, eine Obergrenze festgelegt.</span><span class="sxs-lookup"><span data-stu-id="54bd8-184">This creates an upper limit on individual database data and log files that can be stored in Azure Storage.</span></span>  
  
-   <span data-ttu-id="54bd8-185">Es ist nicht möglich, In-Memory OLTP-Daten mithilfe des Features „SQL Server-Datendateien in Azure“ in einem Azure-BLOB zu speichern.</span><span class="sxs-lookup"><span data-stu-id="54bd8-185">It is not possible to store In-Memory OLTP data in Azure Blob using the SQL Server Data Files in Azure Storage feature.</span></span> <span data-ttu-id="54bd8-186">Dies liegt daran, dass in-Memory-OLTP eine Abhängigkeit von aufweist `FileStream` und in der aktuellen Version dieses Features das Speichern von `FileStream` Daten in Azure Storage nicht unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="54bd8-186">This is because In-Memory OLTP has a dependency on `FileStream` and, in the current release of this feature, storing `FileStream` data in Azure Storage is not supported.</span></span>  
  
-   <span data-ttu-id="54bd8-187">Wenn Sie SQL Server Datendateien in Azure verwenden, führt SQL Server alle URL-oder Datei Pfad Vergleiche mithilfe der in der-Datenbank festgelegten Sortierung aus `master` .</span><span class="sxs-lookup"><span data-stu-id="54bd8-187">When using SQL Server Data Files in Azure feature, SQL Server performs all URL or file path comparisons using the Collation set in the `master` database.</span></span>  
  
-   <span data-ttu-id="54bd8-188">`AlwaysOn Availability Groups` werden unterstützt, solange der primären Datenbank keine neuen Datenbankdateien hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-188">`AlwaysOn Availability Groups` are supported as long as you do not add new database files to the primary database.</span></span> <span data-ttu-id="54bd8-189">Wenn für einen Datenbankvorgang in der primären Datenbank eine neue Datei erstellt werden muss, deaktivieren Sie zuerst AlwaysOn-Verfügbarkeitsgruppen im sekundären Knoten.</span><span class="sxs-lookup"><span data-stu-id="54bd8-189">If a database operation requires a new file to be created in the primary database, first disable AlwaysOn Availability Groups in the secondary node.</span></span> <span data-ttu-id="54bd8-190">Führen Sie anschließend den Datenbankvorgang in der primären Datenbank aus, und sichern Sie die Datenbank im primären Knoten.</span><span class="sxs-lookup"><span data-stu-id="54bd8-190">Then, perform the database operation on the primary database and backup the database in the primary node.</span></span> <span data-ttu-id="54bd8-191">Stellen Sie anschließend die Datenbank auf dem sekundären Knoten wieder her, und aktivieren Sie die AlwaysOn-Verfügbarkeitsgruppen im sekundären Knoten.</span><span class="sxs-lookup"><span data-stu-id="54bd8-191">Next, restore the database to the secondary node, and enable AlwaysOn Availability Groups in the secondary node.</span></span> <span data-ttu-id="54bd8-192">Beachten Sie, dass AlwaysOn-Failoverclusterinstanzen nicht unterstützt werden, wenn Sie das Feature SQL Server Datendateien in Azure verwenden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-192">Note that AlwaysOn Failover Cluster Instances is not supported when using the SQL Server Data Files in Azure feature.</span></span>  
  
-   <span data-ttu-id="54bd8-193">Während des normalen Betriebs verwendet SQL Server temporäre Leasedauern, um BLOBs für den Speicher zu reservieren, wobei jede BLOB-Leasedauer alle 45 bis 60 Sekunden erneuert wird.</span><span class="sxs-lookup"><span data-stu-id="54bd8-193">During normal operation, SQL Server uses temporary leases to reserve Blobs for storage with a renewal of each Blob lease every 45 to 60 seconds.</span></span> <span data-ttu-id="54bd8-194">Wenn ein Server abstürzt und eine andere SQL Server-Instanz gestartet wird, die für die Verwendung derselben BLOBs konfiguriert ist, wartet die neue Instanz bis zu 60 Sekunden, dass die vorhandene Leasedauer für das BLOB abläuft.</span><span class="sxs-lookup"><span data-stu-id="54bd8-194">If a server crashes and another instance of SQL Server configured to use the same blobs is started, the new instance will wait up to 60 seconds for the existing lease on the Blob to expire.</span></span> <span data-ttu-id="54bd8-195">Wenn Sie die Datenbank an eine andere Instanz anfügen möchten und nicht 60 Sekunden bis zum Ablauf der Leasedauer warten können, können Sie die BLOB-Leasedauer explizit unterbrechen, um Fehler in Anfügevorgängen zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-195">If you want to attach the database to another instance and you cannot wait for the lease to expire within 60 seconds, you can explicitly break the lease on the Blob to avoid any failures in attach operations.</span></span>  
  
## <a name="tools-and-programming-reference-support"></a><span data-ttu-id="54bd8-196">Unterstützung von Tools und Programmierreferenzen</span><span class="sxs-lookup"><span data-stu-id="54bd8-196">Tools and programming reference support</span></span>  
 <span data-ttu-id="54bd8-197">In diesem Abschnitt werden die Tools und Referenzbibliotheken für die Programmierung beschrieben, die beim Speichern von SQL Server-Datendateien im Azure-Speicher verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="54bd8-197">This section describes which tools and programming reference libraries can be used when storing SQL Server data files in Azure Storage.</span></span>  
  
### <a name="powershell-support"></a><span data-ttu-id="54bd8-198">PowerShell-Unterstützung</span><span class="sxs-lookup"><span data-stu-id="54bd8-198">PowerShell support</span></span>  
 <span data-ttu-id="54bd8-199">In SQL Server 2014 können Sie PowerShell-Cmdlets verwenden, um SQL Server Datendateien in Azure BLOB Storage Dienst zu speichern, indem Sie anstelle eines Dateipfads auf einen BLOB Storage URL-Pfad verweisen.</span><span class="sxs-lookup"><span data-stu-id="54bd8-199">In SQL Server 2014, you can use PowerShell cmdlets to store SQL Server data files in Azure Blob Storage service by referencing a Blob Storage URL path instead of a file path.</span></span> <span data-ttu-id="54bd8-200">Sie können mit folgendem URL-Format auf BLOBs zugreifen: `: http://storageaccount.blob.core.windows.net/<container>/<blob>`.</span><span class="sxs-lookup"><span data-stu-id="54bd8-200">You can access Blobs using the following URL format`: http://storageaccount.blob.core.windows.net/<container>/<blob>` .</span></span>  
  
### <a name="sql-server-object-and-performance-counters-support"></a><span data-ttu-id="54bd8-201">Unterstützung von SQL Server-Objekten und -Leistungsindikatoren</span><span class="sxs-lookup"><span data-stu-id="54bd8-201">SQL Server Object and performance counters support</span></span>  
 <span data-ttu-id="54bd8-202">In SQL Server 2014 wurde ein neues SQL Server-Objekt eingeführt, das mit SQL Server-Datendateien im Azure-Speicher verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="54bd8-202">Starting with SQL Server 2014, a new SQL Server object has been added to be used with SQL Server Data Files in Azure Storage feature.</span></span> <span data-ttu-id="54bd8-203">Das neue SQL Server-Objekt wird als [SQL Server, HTTP_STORAGE_OBJECT](../performance-monitor/sql-server-http-storage-object.md) aufgerufen und kann vom Systemmonitor verwendet werden, um Aktivitäten bei der Ausführung von SQL Server mit Azure Storage zu überwachen.</span><span class="sxs-lookup"><span data-stu-id="54bd8-203">The new SQL Server object is called as [SQL Server, HTTP_STORAGE_OBJECT](../performance-monitor/sql-server-http-storage-object.md) and it can be used by System Monitor to monitor activity when running SQL Server with Azure Storage.</span></span>  
  
### <a name="sql-server-management-studio-support"></a><span data-ttu-id="54bd8-204">Unterstützung von SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="54bd8-204">SQL Server Management Studio support</span></span>  
 <span data-ttu-id="54bd8-205">SQL Server Management Studio unterstützt die Verwendung der Funktion in mehreren Dialogfeldern.</span><span class="sxs-lookup"><span data-stu-id="54bd8-205">SQL Server Management Studio allows you to use this feature via several dialog windows.</span></span> <span data-ttu-id="54bd8-206">Beispielsweise können Sie den URL-Pfad des Speichercontainers, wie `https://teststorageaccnt.blob.core.windows.net/testcontainer/`, als **Pfad** in mehreren Dialogfeldern eingeben, z.B. **Neue Datenbank**, **Datenbank anfügen** und **Datenbank wiederherstellen**.</span><span class="sxs-lookup"><span data-stu-id="54bd8-206">For example, you can type the URL path of the storage container, such as `https://teststorageaccnt.blob.core.windows.net/testcontainer/` as a **Path** in several dialog windows, such as **New Database**, **Attach Database**, and **Restore Database**.</span></span> <span data-ttu-id="54bd8-207">Weitere Informationen finden Sie unter [Tutorial: SQL Server von Datendateien in Azure Storage Dienst](../tutorial-use-azure-blob-storage-service-with-sql-server-2016.md).</span><span class="sxs-lookup"><span data-stu-id="54bd8-207">For more information, see [Tutorial: SQL Server Data Files in Azure Storage service](../tutorial-use-azure-blob-storage-service-with-sql-server-2016.md).</span></span>  
  
### <a name="sql-server-management-objects-support"></a><span data-ttu-id="54bd8-208">Unterstützung von SQL Server Management Objects</span><span class="sxs-lookup"><span data-stu-id="54bd8-208">SQL Server Management Objects support</span></span>  
 <span data-ttu-id="54bd8-209">Bei Verwendung von SQL Server-Datendateien in Azure werden alle SQL Server Management Objects (SMO) unterstützt.</span><span class="sxs-lookup"><span data-stu-id="54bd8-209">When using the SQL Server Data Files in Azure feature, all SQL Server Management Objects (SMO) are supported.</span></span> <span data-ttu-id="54bd8-210">Wenn ein SMO-Objekt einen Dateipfad erfordert, verwenden Sie das BLOB-URL-Format anstelle eines lokalen Dateipfads, beispielsweise `https://teststorageaccnt.blob.core.windows.net/testcontainer/`.</span><span class="sxs-lookup"><span data-stu-id="54bd8-210">If an SMO object requires a file path, use the BLOB URL format instead of a local file path, such as `https://teststorageaccnt.blob.core.windows.net/testcontainer/`.</span></span> <span data-ttu-id="54bd8-211">Weitere Informationen zu SQL Server Management Objects (SMO) finden Sie unter [SQL Server Management Objects &#40;SMO&#41;-Programmierungshandbuch](../server-management-objects-smo/sql-server-management-objects-smo-programming-guide.md) in der SQL Server-Onlinedokumentation.</span><span class="sxs-lookup"><span data-stu-id="54bd8-211">For more information about SQL Server Management Objects (SMO), see [SQL Server Management Objects &#40;SMO&#41; Programming Guide](../server-management-objects-smo/sql-server-management-objects-smo-programming-guide.md) in SQL Server Books Online.</span></span>  
  
### <a name="transact-sql-support"></a><span data-ttu-id="54bd8-212">Unterstützung von Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="54bd8-212">Transact-SQL support</span></span>  
 <span data-ttu-id="54bd8-213">Durch die neue Funktion wurde folgende Änderung in der -Oberfläche eingeführt:</span><span class="sxs-lookup"><span data-stu-id="54bd8-213">This new feature has introduced the following change in the Transact-SQL surface area:</span></span>  
  
-   <span data-ttu-id="54bd8-214">Die neue **int** -Spalte **credential_id**in der **sys.master_files** -Systemsicht.</span><span class="sxs-lookup"><span data-stu-id="54bd8-214">A new **int** column, **credential_id**, in the **sys.master_files** system view.</span></span> <span data-ttu-id="54bd8-215">Die **credential_id** -Spalte ermöglicht die Rückverweisung von Azure-Speicher-fähigen Datendateien auf sys.credentials, um die zugehörigen Anmeldeinformationen zu identifizieren.</span><span class="sxs-lookup"><span data-stu-id="54bd8-215">The **credential_id** column is used to enable Azure Storage enabled data files to be cross-referenced back to sys.credentials for the credentials created for them.</span></span> <span data-ttu-id="54bd8-216">Sie können die Spalte zur Problembehandlung verwenden, beispielsweise, wenn Anmeldeinformationen nicht gelöscht werden können, weil sie von einer Datenbankdatei verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-216">You can use it for troubleshooting, such as a credential cannot be deleted when there is a database file which uses it.</span></span>  
  
##  <a name="troubleshooting-for-sql-server-data-files-in-azure"></a><a name="bkmk_Troubleshooting"></a><span data-ttu-id="54bd8-217">Problembehandlung für SQL Server-Datendateien in Azure</span><span class="sxs-lookup"><span data-stu-id="54bd8-217">Troubleshooting for SQL Server Data Files in Azure</span></span>  
 <span data-ttu-id="54bd8-218">Um Fehler aufgrund von nicht unterstützten Funktionen oder Einschränkungen zu vermeiden, sollten Sie sich zunächst unter [Einschränkungen](sql-server-data-files-in-microsoft-azure.md#bkmk_Limitations)informieren.</span><span class="sxs-lookup"><span data-stu-id="54bd8-218">To avoid errors due to unsupported features or limitations, first review [Limitations](sql-server-data-files-in-microsoft-azure.md#bkmk_Limitations).</span></span>  
  
 <span data-ttu-id="54bd8-219">In der folgenden Liste sind Fehler aufgeführt, die bei Verwendung von SQL Server-Datendateien mit dem Azure-Speicher auftreten können.</span><span class="sxs-lookup"><span data-stu-id="54bd8-219">The list of errors that you might get when using the SQL Server Data Files in Azure Storage feature are as follows.</span></span>  
  
 <span data-ttu-id="54bd8-220">**Authentifizierungsfehler**</span><span class="sxs-lookup"><span data-stu-id="54bd8-220">**Authentication errors**</span></span>  
  
-   <span data-ttu-id="54bd8-221">*Die %.\*ls-Anmeldeinformationen können nicht gelöscht werden, weil sie von einer aktiven Datenbankdatei verwendet werden.*  </span><span class="sxs-lookup"><span data-stu-id="54bd8-221">*Cannot drop the credential '%.\*ls' because it is used by an active database file.* </span></span>  
    <span data-ttu-id="54bd8-222">Lösung: Dieser Fehler kann angezeigt werden, wenn Sie versuchen, Anmeldeinformationen zu löschen, die noch von einer aktiven Datenbankdatei im Azure-Speicher verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-222">Resolution: You may see this error when you try to drop a credential that is still being used by an active database file in Azure Storage.</span></span> <span data-ttu-id="54bd8-223">Um die Anmeldeinformationen zu löschen, müssen Sie zuerst das zugeordnete BLOB löschen, das diese Datenbankdatei enthält.</span><span class="sxs-lookup"><span data-stu-id="54bd8-223">To drop the credential, first you must delete the associated blob that has this database file.</span></span> <span data-ttu-id="54bd8-224">Um ein BLOB zu löschen, das über eine aktive Leasedauer verfügt, müssen Sie zunächst die Leasedauer unterbrechen.</span><span class="sxs-lookup"><span data-stu-id="54bd8-224">To delete a blob that has an active lease, you must first break the lease.</span></span>  
  
-   <span data-ttu-id="54bd8-225">*Für den Container wurde nicht ordnungsgemäß eine SAS (Shared Access Signature) erstellt.*  </span><span class="sxs-lookup"><span data-stu-id="54bd8-225">*Shared Access Signature has not been created on the container correctly.* </span></span>  
     <span data-ttu-id="54bd8-226">Lösung: Stellen Sie sicher, dass eine SAS ordnungsgemäß für den Container erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="54bd8-226">Resolution: Make sure that you have created a Shared Access Signature on the container correctly.</span></span> <span data-ttu-id="54bd8-227">Lesen Sie die Anweisungen in Lektion 2 in [Tutorial: SQL Server Data files in Azure Storage Service](../tutorial-use-azure-blob-storage-service-with-sql-server-2016.md)(in Lektion 2).</span><span class="sxs-lookup"><span data-stu-id="54bd8-227">Review the instructions given in Lesson 2 in [Tutorial: SQL Server Data Files in Azure Storage service](../tutorial-use-azure-blob-storage-service-with-sql-server-2016.md).</span></span>  
  
-   <span data-ttu-id="54bd8-228">*SQL Server-Anmeldeinformationen wurden nicht ordnungsgemäß erstellt.*  </span><span class="sxs-lookup"><span data-stu-id="54bd8-228">*SQL Server credential has not been not created correctly.* </span></span>  
    <span data-ttu-id="54bd8-229">Lösung: Vergewissern Sie sich, dass Sie für das Feld **Identität** die Option „Shared Access Signature“ verwendet und ordnungsgemäß einen geheimen Schlüssel erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="54bd8-229">Resolution: Make sure that you have used 'Shared Access Signature' for the **Identity** field and created a secret correctly.</span></span> <span data-ttu-id="54bd8-230">Lesen Sie die Anweisungen in Lektion 3 in [Tutorial: SQL Server Data files in Azure Storage Service](../tutorial-use-azure-blob-storage-service-with-sql-server-2016.md).</span><span class="sxs-lookup"><span data-stu-id="54bd8-230">Review the instructions given in Lesson 3 in [Tutorial: SQL Server Data Files in Azure Storage service](../tutorial-use-azure-blob-storage-service-with-sql-server-2016.md).</span></span>  
  
 <span data-ttu-id="54bd8-231">**Fehler bei BLOB-Leasedauer:**</span><span class="sxs-lookup"><span data-stu-id="54bd8-231">**Lease blob errors:**</span></span>  
  
-   <span data-ttu-id="54bd8-232">Fehler beim Starten von SQL Server, nachdem eine andere Instanz, die dieselben BLOB-Dateien verwendet, abgestürzt ist.</span><span class="sxs-lookup"><span data-stu-id="54bd8-232">Error when trying to start SQL Server after another instance using the same blob files has crashed.</span></span> <span data-ttu-id="54bd8-233">Lösung: Während des normalen Betriebs verwendet SQL Server temporäre Leasedauern, um BLOBs für den Speicher zu reservieren, wobei jede BLOB-Leasedauer alle 45 bis 60 Sekunden erneuert wird.</span><span class="sxs-lookup"><span data-stu-id="54bd8-233">Resolution: During normal operation, SQL Server uses temporary leases to reserve Blobs for storage with a renewal of each Blob lease every 45 to 60 seconds.</span></span> <span data-ttu-id="54bd8-234">Wenn ein Server abstürzt und eine andere SQL Server-Instanz gestartet wird, die für die Verwendung derselben BLOBs konfiguriert ist, wartet die neue Instanz bis zu 60 Sekunden, dass die vorhandene Leasedauer für das BLOB abläuft.</span><span class="sxs-lookup"><span data-stu-id="54bd8-234">If a server crashes and another instance of SQL Server configured to use the same blobs is started, the new instance will wait up to 60 seconds for the existing lease on the Blob to expire.</span></span> <span data-ttu-id="54bd8-235">Wenn Sie die Datenbank an eine andere Instanz anfügen möchten und nicht 60 Sekunden bis zum Ablauf der Leasedauer warten können, können Sie die BLOB-Leasedauer explizit unterbrechen, um Fehler in Anfügevorgängen zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="54bd8-235">If you want to attach the database to another instance and you cannot wait for the lease to expire within 60 seconds, you can explicitly break the lease on the Blob to avoid any failures in attach operations.</span></span>  
  
 <span data-ttu-id="54bd8-236">**Datenbankfehler**</span><span class="sxs-lookup"><span data-stu-id="54bd8-236">**Database errors**</span></span>  
  
1.  <span data-ttu-id="54bd8-237">*Fehler beim Erstellen einer Datenbank* </span><span class="sxs-lookup"><span data-stu-id="54bd8-237">*Errors when creating a database* </span></span>  
    <span data-ttu-id="54bd8-238">Lösung: Überprüfen Sie die Anweisungen in Lektion 4 in [Tutorial: SQL Server Data files in Azure Storage Service](../tutorial-use-azure-blob-storage-service-with-sql-server-2016.md).</span><span class="sxs-lookup"><span data-stu-id="54bd8-238">Resolution: Review the instructions given in Lesson 4 in [Tutorial: SQL Server Data Files in Azure Storage service](../tutorial-use-azure-blob-storage-service-with-sql-server-2016.md).</span></span>  
  
2.  <span data-ttu-id="54bd8-239">*Fehler beim Ausführen der ALTER-Anweisung* </span><span class="sxs-lookup"><span data-stu-id="54bd8-239">*Errors when running the Alter statement* </span></span>  
    <span data-ttu-id="54bd8-240">Lösung: Stellen Sie sicher, dass die ALTER DATABASE-Anweisung ausgeführt wird, während die Datenbank online ist.</span><span class="sxs-lookup"><span data-stu-id="54bd8-240">Resolution: Make sure to execute the Alter Database statement when the database is online.</span></span> <span data-ttu-id="54bd8-241">Wenn Sie die Datendateien in den Azure-Speicher kopieren, erstellen Sie immer ein Seitenblob und kein Blockblob.</span><span class="sxs-lookup"><span data-stu-id="54bd8-241">When copying the data files to Azure Storage, always create a page blob not a block blob.</span></span> <span data-ttu-id="54bd8-242">Andernfalls erzeugt ALTER DATABASE einen Fehler.</span><span class="sxs-lookup"><span data-stu-id="54bd8-242">Otherwise, ALTER Database will fail.</span></span> <span data-ttu-id="54bd8-243">Lesen Sie die Anweisungen in Lektion 7 in [Tutorial: SQL Server Data files in Azure Storage Service](../tutorial-use-azure-blob-storage-service-with-sql-server-2016.md)(in Lektion 7).</span><span class="sxs-lookup"><span data-stu-id="54bd8-243">Review the instructions given in Lesson 7 in [Tutorial: SQL Server Data Files in Azure Storage service](../tutorial-use-azure-blob-storage-service-with-sql-server-2016.md).</span></span>  
  
3.  <span data-ttu-id="54bd8-244">*Fehlercode 5120 die physische Datei "%" kann nicht geöffnet werden. \* ls ". Betriebssystem Fehler% d: "% ls"* </span><span class="sxs-lookup"><span data-stu-id="54bd8-244">*Error code 5120 Unable to open the physical file "%.\*ls". Operating system error %d: "%ls"* </span></span>  
    <span data-ttu-id="54bd8-245">Lösung: Bei Verwendung der neuen Erweiterung kann derzeit nur eine SQL Server-Instanz (nicht mehrere) auf dieselben Datenbankdateien im Azure-Speicher zugreifen.</span><span class="sxs-lookup"><span data-stu-id="54bd8-245">Resolution: Currently, this new enhancement does not support more than one SQL Server instance accessing the same database files in Azure Storage at the same time.</span></span> <span data-ttu-id="54bd8-246">Wenn ServerA mit einer aktiven Datenbankdatei online ist und ServerB, der auch über eine Datenbank verfügt, die auf dieselbe Datendatei verweist, versehentlich gestartet wird, kann die Datenbank des zweiten Servers nicht gestartet werden. Es wird der Fehlercode „*5120 Die physische Datei „%.\*ls“ kann nicht geöffnet werden.“ angezeigt. Betriebssystemfehler %d: „%ls“* .</span><span class="sxs-lookup"><span data-stu-id="54bd8-246">If ServerA is online with an active database file and if ServerB is accidentally started, and it also has a database which points to the same data file, the second server will fail to start the database with an error *code 5120 Unable to open the physical file "%.\*ls". Operating system error %d: "%ls"*.</span></span>  
  
     <span data-ttu-id="54bd8-247">Um dieses Problem zu beheben, stellen Sie zuerst fest, ob „ServerA“ auf die Datenbankdatei im Azure-Speicher zugreifen muss oder nicht.</span><span class="sxs-lookup"><span data-stu-id="54bd8-247">To resolve this issue, first determine if you need ServerA to access the database file in Azure Storage or not.</span></span> <span data-ttu-id="54bd8-248">Wenn nicht, entfernen Sie einfach jegliche Verbindungen zwischen „ServerA“ und den Datenbankdateien im Azure-Speicher.</span><span class="sxs-lookup"><span data-stu-id="54bd8-248">If not, simply remove any connection between ServerA and the database files in Azure Storage.</span></span> <span data-ttu-id="54bd8-249">Gehen Sie dazu folgendermaßen vor:</span><span class="sxs-lookup"><span data-stu-id="54bd8-249">To do this, follow these steps:</span></span>  
  
    1.  <span data-ttu-id="54bd8-250">Legen Sie den Dateipfad von Server A mit der ALTER DATABASE-Anweisung auf einen lokalen Ordner fest.</span><span class="sxs-lookup"><span data-stu-id="54bd8-250">Set the file path of Server A to a local folder by using the ALTER Database statement.</span></span>  
  
    2.  <span data-ttu-id="54bd8-251">Schalten Sie die Datenbank auf Server A offline.</span><span class="sxs-lookup"><span data-stu-id="54bd8-251">Set the database offline in Server A.</span></span>  
  
    3.  <span data-ttu-id="54bd8-252">Kopieren Sie dann die Datenbankdateien aus Azure Storage im lokalen Ordner auf Server A. Dadurch wird sichergestellt, dass „ServerA“ noch lokal eine Kopie der Datenbank hat.</span><span class="sxs-lookup"><span data-stu-id="54bd8-252">Then, copy database files from Azure Storage to the local folder in Server A. This ensures that ServerA still has a copy of the database locally.</span></span>  
  
    4.  <span data-ttu-id="54bd8-253">Schalten Sie die Datenbank online.</span><span class="sxs-lookup"><span data-stu-id="54bd8-253">Set the database online.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="54bd8-254">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="54bd8-254">See Also</span></span>  
 [<span data-ttu-id="54bd8-255">Tutorial: SQL Server-Datendateien im Azure Storage-Dienst</span><span class="sxs-lookup"><span data-stu-id="54bd8-255">Tutorial: SQL Server Data Files in Azure Storage service</span></span>](../tutorial-use-azure-blob-storage-service-with-sql-server-2016.md)  

---
title: Verwenden von „IMultipleResults“ zur Verarbeitung mehrerer Resultsets | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- multiple rowsets
- rowsets [OLE DB], multiple
- IMultipleResults interface
- multiple-rowset results
ms.assetid: 754d3f30-7d94-4b67-8dac-baf2699ce9c6
author: rothja
ms.author: jroth
ms.openlocfilehash: c7acac7e6ce75189e522b503707e101c0a13c345
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87724565"
---
# <a name="using-imultipleresults-to-process-multiple-result-sets"></a><span data-ttu-id="86765-102">Verwenden von 'IMultipleResults' zur Verarbeitung mehrerer Resultsets</span><span class="sxs-lookup"><span data-stu-id="86765-102">Using IMultipleResults to Process Multiple Result Sets</span></span>
  <span data-ttu-id="86765-103">Consumer verwenden die **IMultipleResults** -Schnittstelle zum Verarbeiten von Ergebnissen, die von der [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Befehlsausführung des Native Client OLE DB Anbieters zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="86765-103">Consumers use the **IMultipleResults** interface to process results returned by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider command execution.</span></span> <span data-ttu-id="86765-104">Wenn der [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter einen Befehl zur Ausführung übermittelt, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] führt die Anweisungen aus und gibt alle Ergebnisse zurück.</span><span class="sxs-lookup"><span data-stu-id="86765-104">When the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider submits a command for execution, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] executes the statements and returns any results.</span></span>  
  
 <span data-ttu-id="86765-105">Ein Client muss alle Ergebnisse der Befehlsausführung verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="86765-105">A client must process all results from command execution.</span></span> <span data-ttu-id="86765-106">Da die [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Befehlsausführung des Native Client OLE DB-Anbieters mehrere Rowsetobjekte als Ergebnisse generieren kann, verwenden Sie die **IMultipleResults** -Schnittstelle, um sicherzustellen, dass das Abrufen von Anwendungsdaten den vom Client initiierten Roundtrip abschließt.</span><span class="sxs-lookup"><span data-stu-id="86765-106">Because the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider command execution can generate multiple-rowset objects as results, use the **IMultipleResults** interface to ensure that application data retrieval completes the client-initiated round trip.</span></span>  
  
 <span data-ttu-id="86765-107">Die folgende [!INCLUDE[tsql](../../includes/tsql-md.md)]-Anweisung generiert mehrere Rowsets, von denen einige Zeilendaten aus der Tabelle **OrderDetails** und einige Ergebnisse der COMPUTE BY-Klausel enthalten:</span><span class="sxs-lookup"><span data-stu-id="86765-107">The following [!INCLUDE[tsql](../../includes/tsql-md.md)] statement generates multiple rowsets, some containing row data from the **OrderDetails** table and some containing results of the COMPUTE BY clause:</span></span>  
  
```  
SELECT OrderID, FullPrice = (UnitPrice * Quantity), Discount,  
    Discounted = UnitPrice * (1 - Discount) * Quantity  
FROM OrderDetails  
ORDER BY OrderID  
COMPUTE  
    SUM(UnitPrice * Quantity), SUM(UnitPrice * (1 - Discount) * Quantity)  
    BY OrderID  
```  
  
 <span data-ttu-id="86765-108">Wenn ein Consumer einen Befehl ausführt, der diesen Text enthält, und ein Rowset als Schnittstelle für die zurückgegebenen Ergebnisse anfordert, wird nur der erste Satz Zeilen zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="86765-108">If a consumer executes a command containing this text and requests a rowset as the returned results interface, only the first set of rows is returned.</span></span> <span data-ttu-id="86765-109">Der Consumer kann alle Zeilen im zurückgegebenen Rowset verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="86765-109">The consumer may process all rows in the rowset returned.</span></span> <span data-ttu-id="86765-110">Wenn die DBPROP_MULTIPLECONNECTIONS-Datenquellen Eigenschaft jedoch auf VARIANT_FALSE festgelegt ist und Mars für die Verbindung nicht aktiviert ist, können keine weiteren Befehle für das Sitzungs Objekt ausgeführt werden (der [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter erstellt keine weitere Verbindung), bis der Befehl abgebrochen wird.</span><span class="sxs-lookup"><span data-stu-id="86765-110">But, if the DBPROP_MULTIPLECONNECTIONS data source property is set to VARIANT_FALSE, and MARS is not enabled on the connection, no other commands can be executed on the session object (the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider will not create another connection) until the command is canceled.</span></span> <span data-ttu-id="86765-111">Wenn Mars für die Verbindung nicht aktiviert ist, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] gibt der Native Client OLE DB-Anbieter einen DB_E_OBJECTOPEN Fehler zurück, wenn DBPROP_MULTIPLECONNECTIONS VARIANT_FALSE ist, und gibt E_FAIL zurück, wenn eine aktive Transaktion vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="86765-111">If MARS is not enabled on the connection, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns a DB_E_OBJECTOPEN error if DBPROP_MULTIPLECONNECTIONS is VARIANT_FALSE and returns E_FAIL if there is an active transaction.</span></span>  
  
 <span data-ttu-id="86765-112">Der [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter gibt DB_E_OBJECTOPEN auch bei Verwendung von gestreuten Ausgabeparametern zurück, und die Anwendung hat nicht alle zurückgegebenen Ausgabeparameter Werte verarbeitet, bevor **IMultipleResults:: GetResults** aufgerufen wird, um das nächste Resultset abzurufen.</span><span class="sxs-lookup"><span data-stu-id="86765-112">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider will also return DB_E_OBJECTOPEN when using streamed output parameters and the application has not consumed all the returned output parameter values before calling **IMultipleResults::GetResults** to get the next result set.</span></span> <span data-ttu-id="86765-113">Wenn Mars nicht aktiviert ist und die Verbindung mit dem Ausführen eines Befehls, der kein Rowset erzeugt, oder eines Rowsets, das kein Server Cursor ist, ausgelastet ist und die DBPROP_MULTIPLECONNECTIONS Datenquellen Eigenschaft auf VARIANT_TRUE festgelegt ist, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] erstellt der Native Client-OLE DB Anbieter zusätzliche Verbindungen zur Unterstützung gleichzeitiger Befehls Objekte, es sei denn, eine Transaktion ist aktiv. in diesem Fall wird ein Fehler zurückgegeben</span><span class="sxs-lookup"><span data-stu-id="86765-113">If MARS is not enabled and the connection is busy running a command that does not produce a rowset or that produces a rowset that is not a server cursor, and if the DBPROP_MULTIPLECONNECTIONS data source property is set to VARIANT_TRUE, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider creates additional connections to support concurrent command objects, unless a transaction is active, in which case it returns an error.</span></span> <span data-ttu-id="86765-114">Transaktionen und Sperren werden von [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] auf Verbindungsbasis verwaltet.</span><span class="sxs-lookup"><span data-stu-id="86765-114">Transactions and locking are managed by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] on a per connection basis.</span></span> <span data-ttu-id="86765-115">Wenn eine zweite Verbindung hergestellt wird, nutzt der Befehl auf den anderen Verbindungen Sperren nicht gemeinsam.</span><span class="sxs-lookup"><span data-stu-id="86765-115">If a second connection is generated, the command on the separate connections does not share locks.</span></span> <span data-ttu-id="86765-116">Es muss darauf geachtet werden, dass ein Befehl einen anderen nicht blockiert, indem er Zeilen gesperrt hält, die von einem anderen Befehl angefordert werden.</span><span class="sxs-lookup"><span data-stu-id="86765-116">Care must be taken to ensure that one command does not block another by holding locks on rows requested by the other command.</span></span> <span data-ttu-id="86765-117">Wenn MARS aktiviert ist, können mehrere Befehle für die Verbindungen aktiv sein, und bei der Verwendung expliziter Transaktionen nutzen die Befehle alle eine gemeinsame Transaktion.</span><span class="sxs-lookup"><span data-stu-id="86765-117">If MARS is enabled, multiple commands can be active on the connections and if explicit transactions are being used, the commands all share a common transaction.</span></span>  
  
 <span data-ttu-id="86765-118">Der Consumer kann den Befehl abbrechen, indem er [ISSAbort::Abort](../native-client-ole-db-interfaces/issabort-abort-ole-db.md) verwendet oder alle Verweise auf das Befehlsobjekt und das abgeleitete Rowset freigibt.</span><span class="sxs-lookup"><span data-stu-id="86765-118">The consumer can cancel the command either by using [ISSAbort::Abort](../native-client-ole-db-interfaces/issabort-abort-ole-db.md) or by releasing all references held on the command object and the derived rowset.</span></span>  
  
 <span data-ttu-id="86765-119">Die Verwendung von **IMultipleResults** in allen Instanzen ermöglicht es, alle Rowsets durch Befehlsausführung zu erstellen, und gestattet es Consumern zu ermitteln, wann die Befehlsausführung abgebrochen und ein Sitzungsobjekt zur Verwendung durch andere Befehle freigegeben werden sollte.</span><span class="sxs-lookup"><span data-stu-id="86765-119">Using **IMultipleResults** in all instances allows the consumer to get all rowsets generated by command execution and allows consumers to appropriately determine when to cancel command execution and free a session object for use by other commands.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="86765-120">Wenn Sie [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-Cursor verwenden, erstellt die Befehlsausführung den Cursor.</span><span class="sxs-lookup"><span data-stu-id="86765-120">When you use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cursors, command execution creates the cursor.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="86765-121">gibt den Erfolg oder Fehler der Cursorerstellung zurück. Der Roundtrip zur Instanz von [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ist damit nach der Rückkehr der Befehlsausführung abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="86765-121">returns success or failure on the cursor creation; therefore, the round trip to the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is complete upon the return from command execution.</span></span> <span data-ttu-id="86765-122">Jeder Aufruf von **GetNextRows** wird dann zum Roundtrip.</span><span class="sxs-lookup"><span data-stu-id="86765-122">Each **GetNextRows** call then becomes a round trip.</span></span> <span data-ttu-id="86765-123">Auf diese Weise können mehrere Befehlsobjekte vorhanden sein, und jedes verarbeitet ein Rowset, das das Ergebnis eines Abrufs vom Servercursor ist.</span><span class="sxs-lookup"><span data-stu-id="86765-123">In this way, multiple active command objects can exist, each processing a rowset that is the result of a fetch from the server cursor.</span></span> <span data-ttu-id="86765-124">Weitere Informationen finden Sie unter [Rowsets und SQL Server-Cursor](../native-client-ole-db-rowsets/rowsets-and-sql-server-cursors.md).</span><span class="sxs-lookup"><span data-stu-id="86765-124">For more information, see [Rowsets and SQL Server Cursors](../native-client-ole-db-rowsets/rowsets-and-sql-server-cursors.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="86765-125">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="86765-125">See Also</span></span>  
 [<span data-ttu-id="86765-126">Befehle</span><span class="sxs-lookup"><span data-stu-id="86765-126">Commands</span></span>](commands.md)  
  
  

---
title: Direkte Ausführung | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- ODBC applications, statements
- direct execution [ODBC]
- SQLExecDirect function
- statements [ODBC], direct execution
ms.assetid: fa36e1af-ed98-4abc-97c1-c4cc5d227b29
author: rothja
ms.author: jroth
ms.openlocfilehash: 29153f3e4e9265e87feb0e23ba9ae97118691e95
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87608613"
---
# <a name="direct-execution"></a><span data-ttu-id="bd87a-102">Direkte Ausführung</span><span class="sxs-lookup"><span data-stu-id="bd87a-102">Direct Execution</span></span>
  <span data-ttu-id="bd87a-103">Die direkte Ausführung ist die grundlegendste Art und Weise, um eine Anweisung auszuführen.</span><span class="sxs-lookup"><span data-stu-id="bd87a-103">Direct execution is the most basic way to execute a statement.</span></span> <span data-ttu-id="bd87a-104">Eine Anwendung erstellt eine Zeichenfolge, [!INCLUDE[tsql](../../../includes/tsql-md.md)] die eine-Anweisung enthält, und sendet Sie mithilfe der **SQLExecDirect** -Funktion zur Ausführung.</span><span class="sxs-lookup"><span data-stu-id="bd87a-104">An application builds a character string containing a [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement and submits it for execution using the **SQLExecDirect** function.</span></span> <span data-ttu-id="bd87a-105">Wenn die Anweisung beim Server eingeht, kompiliert [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] sie zu einem Ausführungsplan, der unmittelbar ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="bd87a-105">When the statement reaches the server, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] compiles it into an execution plan and then immediately runs the execution plan.</span></span>  
  
 <span data-ttu-id="bd87a-106">Die direkte Ausführung wird im Allgemeinen von Anwendungen verwendet, die Anweisungen zur Laufzeit erstellen und ausführen. Es ist zugleich die effektivste Methode, Anweisungen, die nur einmal ausgeführt werden, auszuführen.</span><span class="sxs-lookup"><span data-stu-id="bd87a-106">Direct execution is commonly used by applications that build and execute statements at run time and is the most efficient method for statements that will be executed a single time.</span></span> <span data-ttu-id="bd87a-107">Bei vielen Datenbanken muss jedoch die SQL-Anweisung bei jeder Ausführung analysiert und kompiliert werden, sodass ein zusätzlicher Aufwand entsteht, wenn die Anweisung mehrmals ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="bd87a-107">Its drawback with many databases is that the SQL statement must be parsed and compiled each time it is executed, which adds overhead if the statement is executed multiple times.</span></span>  
  
 <span data-ttu-id="bd87a-108">In [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] wurde die Leistung bei der direkten Ausführung von häufig ausgeführten Anweisungen in Mehrbenutzerumgebungen wesentlich verbessert. Durch den Einsatz von SQLExecDirect mit Parametermarkierungen für häufig ausgeführte SQL-Anweisungen wird zudem beinahe die gleiche Effizienz wie bei der vorbereiteten Ausführung erzielt.</span><span class="sxs-lookup"><span data-stu-id="bd87a-108">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] significantly improves the performance of direct execution of commonly executed statements in multiuser environments and using SQLExecDirect with parameter markers for commonly executed SQL statements can approach the efficiency of prepared execution.</span></span>  
  
 <span data-ttu-id="bd87a-109">Wenn eine Verbindung mit einer Instanz von besteht [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] verwendet der Native Client ODBC-Treiber [sp_executesql](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql) , um die SQL-Anweisung oder den Batch zu übertragen, die in **SQLExecDirect**angegeben ist</span><span class="sxs-lookup"><span data-stu-id="bd87a-109">When connected to an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver uses [sp_executesql](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql) to transmit the SQL statement or batch specified on **SQLExecDirect**.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="bd87a-110">verfügt über Logik, um schnell festzustellen, ob eine SQL-Anweisung oder ein Batch, der mit **sp_executesql** ausgeführt wird, mit der Anweisung oder dem Batch übereinstimmt, die einen Ausführungsplan generiert hat</span><span class="sxs-lookup"><span data-stu-id="bd87a-110">has logic to quickly determine if an SQL statement or batch executed with **sp_executesql** matches the statement or batch that generated an execution plan that already exists in memory.</span></span> <span data-ttu-id="bd87a-111">Wenn eine Übereinstimmung gefunden wird, nutzt [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] den vorhandenen Plan, anstatt einen neuen Plan zu kompilieren.</span><span class="sxs-lookup"><span data-stu-id="bd87a-111">If a match is made, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] simply reuses the existing plan rather than compile a new plan.</span></span> <span data-ttu-id="bd87a-112">Dies bedeutet, dass häufig ausgeführte SQL-Anweisungen, die mit **SQLExecDirect** in einem System mit vielen Benutzern ausgeführt werden, von vielen der Vorteile der Plan Wiederverwendung profitieren, die nur für gespeicherte Prozeduren in früheren Versionen von verfügbar waren [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="bd87a-112">This means that commonly executed SQL statements executed with **SQLExecDirect** in a system with many users will benefit from many of the plan-reuse benefits that were only available to stored procedures in earlier versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="bd87a-113">Die Vorteile der erneuten Nutzung von Ausführungsplänen können jedoch nur umgesetzt werden, wenn mehrere Benutzer die gleiche SQL-Anweisungen oder den gleichen Batch ausführen.</span><span class="sxs-lookup"><span data-stu-id="bd87a-113">This benefit of reusing execution plans only works when several users are executing the same SQL statement or batch.</span></span> <span data-ttu-id="bd87a-114">Befolgen Sie diese Codierungskonventionen, um die Wahrscheinlichkeit zu erhöhen, dass die SQL-Anweisungen, die von unterschiedlichen Clients ausgeführt werden, sich soweit ähneln, dass die Ausführungspläne wiederverwendet werden können:</span><span class="sxs-lookup"><span data-stu-id="bd87a-114">Follow these coding conventions to increase the probability that the SQL statements executed by different clients are similar enough to be able to reuse execution plans:</span></span>  
  
-   <span data-ttu-id="bd87a-115">Schließen Sie keine Datenkonstanten in die SQL-Anweisungen ein, verwenden Sie stattdessen an Programmvariablen gebundene Parametermarkierungen.</span><span class="sxs-lookup"><span data-stu-id="bd87a-115">Do not include data constants in the SQL statements; instead use parameter markers bound to program variables.</span></span> <span data-ttu-id="bd87a-116">Weitere Informationen finden Sie unter [Verwenden von Anweisungs Parametern](../using-statement-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="bd87a-116">For more information, see [Using Statement Parameters](../using-statement-parameters.md).</span></span>  
  
-   <span data-ttu-id="bd87a-117">Verwenden Sie vollqualifizierte Objektnamen.</span><span class="sxs-lookup"><span data-stu-id="bd87a-117">Use fully qualified object names.</span></span> <span data-ttu-id="bd87a-118">Ausführungspläne werden nicht wiederverwendet, wenn Objektnamen nicht qualifiziert sind.</span><span class="sxs-lookup"><span data-stu-id="bd87a-118">Execution plans are not reused if object names are not qualified.</span></span>  
  
-   <span data-ttu-id="bd87a-119">Sorgen Sie dafür, dass Anwendungsverbindungen sofern möglich einen gemeinsamen Satz an Verbindungs- und Anweisungsoptionen verwenden.</span><span class="sxs-lookup"><span data-stu-id="bd87a-119">Have application connections as possible use a common set of connection and statement options.</span></span> <span data-ttu-id="bd87a-120">Ausführungspläne, die für eine Verbindung mit einem Optionssatz (z. B. ANSI_NULLS) generiert werden, werden nicht für Verbindungen mit einem anderen Optionssatz wiederverwendet.</span><span class="sxs-lookup"><span data-stu-id="bd87a-120">Execution plans generated for a connection with one set of options (such as ANSI_NULLS) are not reused for a connection having another set of options.</span></span> <span data-ttu-id="bd87a-121">Der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC-Treiber und der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter haben die gleichen Standardeinstellungen für diese Optionen.</span><span class="sxs-lookup"><span data-stu-id="bd87a-121">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider both have the same default settings for these options.</span></span>  
  
 <span data-ttu-id="bd87a-122">Wenn alle-Anweisungen, die mit **SQLExecDirect** ausgeführt werden, mit diesen Konventionen codiert werden, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] kann Ausführungspläne wieder verwenden, wenn die Gelegenheit eintritt.</span><span class="sxs-lookup"><span data-stu-id="bd87a-122">If all statements executed with **SQLExecDirect** are coded using these conventions, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can reuse execution plans when the opportunity arises.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bd87a-123">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="bd87a-123">See Also</span></span>  
 [<span data-ttu-id="bd87a-124">Ausführen von Anweisungen &#40;ODBC-&#41;</span><span class="sxs-lookup"><span data-stu-id="bd87a-124">Executing Statements &#40;ODBC&#41;</span></span>](executing-statements-odbc.md)  
  
  

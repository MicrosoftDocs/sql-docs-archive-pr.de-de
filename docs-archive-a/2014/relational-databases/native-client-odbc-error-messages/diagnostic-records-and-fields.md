---
title: Diagnosedaten Sätze und Felder | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- header records [ODBC]
- SQL Server Native Client ODBC driver, errors
- messages [ODBC], diagnostic records
- ODBC error handling, diagnostic records
- SQLGetDiagField function
- diagnostic records [ODBC]
- errors [ODBC], diagnostic records
- fields [ODBC]
- status information [ODBC]
ms.assetid: 4949530c-62d1-4f1a-b592-144244444ce0
author: rothja
ms.author: jroth
ms.openlocfilehash: 4fe52b211eb6d5a0e4d875264609d036702b2b0b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87722782"
---
# <a name="diagnostic-records-and-fields"></a><span data-ttu-id="864f0-102">Diagnosedatensätze und -felder</span><span class="sxs-lookup"><span data-stu-id="864f0-102">Diagnostic Records and Fields</span></span>
  <span data-ttu-id="864f0-103">Diagnosedatensätze sind ODBC-Umgebungs-, Verbindungs-, Anweisungs- oder Deskriptorhandles zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="864f0-103">Diagnostic records are associated with ODBC environment, connection, statement, or descriptor handles.</span></span> <span data-ttu-id="864f0-104">Wenn eine ODBC-Funktion einen anderen Rückgabecode als SQL_SUCCESS oder SQL_INVALID_HANDLE auslöst, verfügt das von der Funktion aufgerufene Handle über zugeordnete Diagnosedatensätze mit Informations- oder Fehlermeldungen.</span><span class="sxs-lookup"><span data-stu-id="864f0-104">When any ODBC function raises a return code other than SQL_SUCCESS or SQL_INVALID_HANDLE, the handle called by the function has associated diagnostic records that contain informational or error messages.</span></span> <span data-ttu-id="864f0-105">Diese Datensätze werden so lange beibehalten, bis eine andere Funktion mit diesem Handle aufgerufen wird. Anschließend werden sie verworfen.</span><span class="sxs-lookup"><span data-stu-id="864f0-105">These records are retained until another function is called using that handle, at which time they are discarded.</span></span> <span data-ttu-id="864f0-106">Die Zahl der Diagnosedatensätze, die einem Handle zugeordnet sein können, ist unbegrenzt.</span><span class="sxs-lookup"><span data-stu-id="864f0-106">There is no limit to the number of diagnostic records that can be associated with a handle at any one time.</span></span>  
  
 <span data-ttu-id="864f0-107">Es gibt zwei Arten von Diagnosedatensätzen: Header und Status.</span><span class="sxs-lookup"><span data-stu-id="864f0-107">There are two types of diagnostic records: header and status.</span></span> <span data-ttu-id="864f0-108">Der Headerdatensatz ist Datensatz 0; wenn es Statusdatensätze gibt, sind dies die Datensätze 1 und höher.</span><span class="sxs-lookup"><span data-stu-id="864f0-108">The header record is record 0; when there are status records, they are records 1 and later.</span></span> <span data-ttu-id="864f0-109">Diagnosedatensätze enthalten andere Felder für den Headerdatensatz und die Statusdatensätze.</span><span class="sxs-lookup"><span data-stu-id="864f0-109">Diagnostic records contain different fields for the header record and the status records.</span></span> <span data-ttu-id="864f0-110">ODBC-Komponenten können auch eigene Diagnosedatensatzfelder definieren.</span><span class="sxs-lookup"><span data-stu-id="864f0-110">ODBC components can also define their own diagnostic record fields.</span></span>  
  
 <span data-ttu-id="864f0-111">Felder im Headerdatensatz enthalten allgemeine Informationen über die Ausführung einer Funktion, einschließlich Rückgabecode, Zeilenanzahl, Anzahl der Statusdatensätze und Typ der ausgeführten Anweisung.</span><span class="sxs-lookup"><span data-stu-id="864f0-111">Fields in the header record contain general information about a function's execution, including the return code, row count, number of status records, and type of statement executed.</span></span> <span data-ttu-id="864f0-112">Der Headerdatensatz wird immer erstellt, es sei denn, eine ODBC-Funktion gibt SQL_INVALID_HANDLE zurück.</span><span class="sxs-lookup"><span data-stu-id="864f0-112">The header record is always created unless an ODBC function returns SQL_INVALID_HANDLE.</span></span> <span data-ttu-id="864f0-113">Eine komplette Liste der Felder im Header Daten Satz finden Sie unter [SQLGetDiagField](../native-client-odbc-api/sqlgetdiagfield.md).</span><span class="sxs-lookup"><span data-stu-id="864f0-113">For a complete list of fields in the header record, see [SQLGetDiagField](../native-client-odbc-api/sqlgetdiagfield.md).</span></span>  
  
 <span data-ttu-id="864f0-114">Felder in den Statusdatensätzen enthalten Informationen über bestimmte Fehler oder Warnungen, die vom ODBC-Treiber-Manager, vom Treiber oder von der Datenquelle zurückgegeben werden, einschließlich SQLSTATE, systemeigener Fehlernummer, Diagnosemeldung, Spaltennummer und Zeilennummer.</span><span class="sxs-lookup"><span data-stu-id="864f0-114">Fields in the status records contain information about specific errors or warnings returned by the ODBC Driver Manager, driver, or data source, including the SQLSTATE, native error number, diagnostic message, column number, and row number.</span></span> <span data-ttu-id="864f0-115">Statusdatensätze werden nur erstellt, wenn die Funktion SQL_ERROR, SQL_SUCCESS_WITH_INFO, SQL_NO_DATA, SQL_NEED_DATA oder SQL_STILL_EXECUTING zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="864f0-115">Status records are created only if the function returns SQL_ERROR, SQL_SUCCESS_WITH_INFO, SQL_NO_DATA, SQL_NEED_DATA, or SQL_STILL_EXECUTING.</span></span> <span data-ttu-id="864f0-116">Eine umfassende Liste der Felder in den Statusdaten Sätzen finden Sie unter **SQLGetDiagField**.</span><span class="sxs-lookup"><span data-stu-id="864f0-116">For a complete list of fields in the status records, see **SQLGetDiagField**.</span></span>  
  
 <span data-ttu-id="864f0-117">**SQLGetDiagRec** Ruft einen einzelnen Diagnosedaten Satz zusammen mit den Feldern "ODBC SQLSTATE", "Native Error Number" und "Diagnostic-Message" ab.</span><span class="sxs-lookup"><span data-stu-id="864f0-117">**SQLGetDiagRec** retrieves a single diagnostic record along with its ODBC SQLSTATE, native error number, and diagnostic-message fields.</span></span> <span data-ttu-id="864f0-118">Diese Funktion ähnelt dem ODBC 2. _x_**SQLError** -Funktion.</span><span class="sxs-lookup"><span data-stu-id="864f0-118">This functionality is similar to the ODBC 2._x_**SQLError** function.</span></span> <span data-ttu-id="864f0-119">Die einfachste Fehler Behandlungs Funktion in ODBC 3. *x* dient zum wiederholten Aufrufen von **SQLGetDiagRec** , beginnend mit dem auf 1 festgelegten Parameter " *RecNumber* " und dem erhöhen der *RecNumber* um 1, bis **SQLGetDiagRec** SQL_NO_DATA zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="864f0-119">The simplest error-handling function in ODBC 3.*x* is to repeatedly call **SQLGetDiagRec** starting with the *RecNumber* parameter set to 1 and incrementing *RecNumber* by 1 until **SQLGetDiagRec** returns SQL_NO_DATA.</span></span> <span data-ttu-id="864f0-120">Dies entspricht einem ODBC 2. *x* -Anwendung, die **SQLError** aufrufen, bis SQL_NO_DATA_FOUND zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="864f0-120">This is equivalent to an ODBC 2.*x* application calling **SQLError** until it returns SQL_NO_DATA_FOUND.</span></span>  
  
 <span data-ttu-id="864f0-121">ODBC 3. *x* unterstützt wesentlich mehr Diagnoseinformationen als ODBC 2. *x*.</span><span class="sxs-lookup"><span data-stu-id="864f0-121">ODBC 3.*x* supports much more diagnostic information than ODBC 2.*x*.</span></span> <span data-ttu-id="864f0-122">Diese Informationen werden in weiteren Feldern in Diagnosedaten Sätzen gespeichert, die mit **SQLGetDiagField**abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="864f0-122">This information is stored in additional fields in diagnostic records retrieved by using **SQLGetDiagField**.</span></span>  
  
 <span data-ttu-id="864f0-123">Der [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client-ODBC-Treiber verfügt über Treiber spezifische Diagnose Felder, die mit **SQLGetDiagField**abgerufen werden können.</span><span class="sxs-lookup"><span data-stu-id="864f0-123">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver has driver-specific diagnostic fields that can be retrieved with **SQLGetDiagField**.</span></span> <span data-ttu-id="864f0-124">Bezeichnungen für diese treiberspezifischen Felder werden in sqlncli.h definiert.</span><span class="sxs-lookup"><span data-stu-id="864f0-124">Labels for these driver-specific fields are defined in sqlncli.h.</span></span> <span data-ttu-id="864f0-125">Mit diesen Bezeichnungen rufen Sie den [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-Status, den Schweregrad, den Servernamen, den Prozedurnamen und die jedem Diagnosedatensatz zugeordnete Zeilennummer ab.</span><span class="sxs-lookup"><span data-stu-id="864f0-125">Use these labels to retrieve the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] state, severity level, server name, procedure name, and line number associated with each diagnostic record.</span></span> <span data-ttu-id="864f0-126">Sqlncli. h enthält außerdem Definitionen der Codes, die der Treiber zum Identifizieren von Transact-SQL-Anweisungen verwendet, wenn eine Anwendung **SQLGetDiagField** aufruft, wobei *DiagIdentifier* auf SQL_DIAG_DYNAMIC_FUNCTION_CODE festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="864f0-126">Also, sqlncli.h contains definitions of the codes the driver uses to identify Transact-SQL statements if an application calls **SQLGetDiagField** with *DiagIdentifier* set to SQL_DIAG_DYNAMIC_FUNCTION_CODE.</span></span>  
  
 <span data-ttu-id="864f0-127">**SQLGetDiagField** wird vom ODBC-Treiber-Manager mithilfe von Fehlerinformationen verarbeitet, die er vom zugrunde liegenden Treiber zwischenspeichert.</span><span class="sxs-lookup"><span data-stu-id="864f0-127">**SQLGetDiagField** is processed by the ODBC Driver Manager using error information it caches from the underlying driver.</span></span> <span data-ttu-id="864f0-128">Der ODBC-Treiber-Manager speichert Treiber spezifische Diagnose Felder erst zwischen, wenn eine erfolgreiche Verbindung hergestellt wurde.</span><span class="sxs-lookup"><span data-stu-id="864f0-128">The ODBC Driver Manager does not cache driver-specific diagnostic fields until after a successful connection has been made.</span></span> <span data-ttu-id="864f0-129">**SQLGetDiagField** gibt SQL_ERROR zurück, wenn es aufgerufen wird, um Treiber spezifische Diagnose Felder zu erhalten, bevor eine erfolgreiche Verbindung hergestellt wurde.</span><span class="sxs-lookup"><span data-stu-id="864f0-129">**SQLGetDiagField** returns SQL_ERROR if it is called to get driver-specific diagnostic fields before a successful connection has been completed.</span></span> <span data-ttu-id="864f0-130">Wenn eine ODBC-Verbindungsfunktion SQL_SUCCESS_WITH_INFO zurückgibt, sind noch keine treiberspezifischen Diagnosefelder für die Verbindungsfunktion verfügbar.</span><span class="sxs-lookup"><span data-stu-id="864f0-130">If an ODBC connect function returns SQL_SUCCESS_WITH_INFO, the driver-specific diagnostic fields for the connect function are not yet available.</span></span> <span data-ttu-id="864f0-131">Sie können **SQLGetDiagField** für Treiber spezifische Diagnose Felder erst aufrufen, nachdem Sie einen weiteren ODBC-Funktionsaufruf nach der Connect-Funktion durchgeführt haben.</span><span class="sxs-lookup"><span data-stu-id="864f0-131">You can start calling **SQLGetDiagField** for driver-specific diagnostic fields only after you have made another ODBC function call after the connect function.</span></span>  
  
 <span data-ttu-id="864f0-132">Die meisten Fehler, die vom [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client-ODBC-Treiber gemeldet werden, können nur mit den von **SQLGetDiagRec**zurückgegebenen Informationen diagnostiziert werden.</span><span class="sxs-lookup"><span data-stu-id="864f0-132">Most errors reported by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver can be effectively diagnosed using only the information returned by **SQLGetDiagRec**.</span></span> <span data-ttu-id="864f0-133">In einigen Fällen sind jedoch die von den treiberspezifischen Diagnosefeldern zurückgegebenen Informationen für die Fehlerdiagnose wichtig.</span><span class="sxs-lookup"><span data-stu-id="864f0-133">In some cases, however, the information returned by the driver-specific diagnostic fields is important in diagnosing an error.</span></span> <span data-ttu-id="864f0-134">Beim Codieren eines ODBC-Fehler Handlers für Anwendungen, die den [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client-ODBC-Treiber verwenden, empfiehlt es sich, auch **SQLGetDiagField** zu verwenden, um mindestens die SQL_DIAG_SS_MSGSTATE-und SQL_DIAG_SS_SEVERITY treiberspezifischen Felder abzurufen.</span><span class="sxs-lookup"><span data-stu-id="864f0-134">When coding an ODBC error handler for applications using the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver, it is a good idea to also use **SQLGetDiagField** to retrieve at least the SQL_DIAG_SS_MSGSTATE and SQL_DIAG_SS_SEVERITY driver-specific fields.</span></span> <span data-ttu-id="864f0-135">Wenn ein bestimmter Fehler an mehreren Orten im [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-Code ausgelöst werden kann, erkennt der Microsoft Software Service anhand von SQL_DIAG_SS_MSGSTATE, wo genau ein Fehler ausgelöst wurde, was mitunter für die Problemdiagnose hilfreich ist.</span><span class="sxs-lookup"><span data-stu-id="864f0-135">If a particular error can be raised at several locations in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] code, SQL_DIAG_SS_MSGSTATE indicates to a Microsoft support engineer specifically where an error was raised, which sometimes aids in diagnosing a problem.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="864f0-136">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="864f0-136">See Also</span></span>  
 [<span data-ttu-id="864f0-137">Behandlung von Fehlern und Meldungen</span><span class="sxs-lookup"><span data-stu-id="864f0-137">Handling Errors and Messages</span></span>](handling-errors-and-messages.md)  
  
  

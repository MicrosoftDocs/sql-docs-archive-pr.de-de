---
title: IBCPSession::BCPInit (OLE DB) | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
api_name:
- IBCPSession::BCPInit (OLE DB)
topic_type:
- apiref
helpviewer_keywords:
- BCPInit method
ms.assetid: 583096d7-da34-49be-87fd-31210aac81aa
author: rothja
ms.author: jroth
ms.openlocfilehash: 25a01c71811de9d47ce01714402460bb53d4c70e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87698138"
---
# <a name="ibcpsessionbcpinit-ole-db"></a><span data-ttu-id="5cb26-102">IBCPSession::BCPInit (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="5cb26-102">IBCPSession::BCPInit (OLE DB)</span></span>
  <span data-ttu-id="5cb26-103">Initialisiert die Massenkopierstruktur, führt einige Fehlerprüfungen durch, überprüft die korrekte Angabe der Daten- und Formatdateinamen und öffnet dann diese Dateien.</span><span class="sxs-lookup"><span data-stu-id="5cb26-103">Initializes the bulk copy structure, performs some error checking, verifies that the data and format file names are correct, and then opens them.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="5cb26-104">Syntax</span><span class="sxs-lookup"><span data-stu-id="5cb26-104">Syntax</span></span>  
  
```  
  
HRESULT BCPInit(   
const wchar_t *pwszTable,  
const wchar_t *pwszDataFile,  
const wchar_t *pwszErrorFile,  
inteDirection);  
```  
  
## <a name="remarks"></a><span data-ttu-id="5cb26-105">Bemerkungen</span><span class="sxs-lookup"><span data-stu-id="5cb26-105">Remarks</span></span>  
 <span data-ttu-id="5cb26-106">Die **BCPInit** -Methode sollte vor jeder anderen Massenkopiermethode aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="5cb26-106">The **BCPInit** method should be called before any other bulk-copy method.</span></span> <span data-ttu-id="5cb26-107">Die **BCPInit**-Methode führt die erforderlichen Initialisierungen für einen Massenkopiervorgang von Daten zwischen der Workstation und [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] durch.</span><span class="sxs-lookup"><span data-stu-id="5cb26-107">The **BCPInit** method performs the necessary initializations for a bulk copy of data between the workstation and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="5cb26-108">Die **BCPInit** -Methode untersucht die Struktur der Quell- oder Zieltabelle der Datenbank, nicht jedoch die Datendatei.</span><span class="sxs-lookup"><span data-stu-id="5cb26-108">The **BCPInit** method examines the structure of the database source or target table, not the data file.</span></span> <span data-ttu-id="5cb26-109">Sie gibt basierend auf den einzelnen Spalten in der Datenbanktabelle, der Sicht oder dem SELECT-Resultset Datenformatwerte für die Datendatei an.</span><span class="sxs-lookup"><span data-stu-id="5cb26-109">It specifies data format values for the data file based on each column in the database table, view, or SELECT result set.</span></span> <span data-ttu-id="5cb26-110">Diese Spezifikation enthält unter anderem den Datentyp jeder Spalte, das Vorhandensein bzw. Nichtvorhandensein eines Längen- oder NULL-Wertindikators und von Bytezeichenfolgen des Abschlusszeichens der Daten, sowie die Breite von Datentypen fester Länge.</span><span class="sxs-lookup"><span data-stu-id="5cb26-110">This specification includes the data type of each column, the presence or absence of a length or null indicator and terminator byte strings in the data, and the width of fixed-length data types.</span></span> <span data-ttu-id="5cb26-111">Die **BCPInit** -Methode legt diese Werte fest wie folgt:</span><span class="sxs-lookup"><span data-stu-id="5cb26-111">The **BCPInit** method sets these values as follows:</span></span>  
  
-   <span data-ttu-id="5cb26-112">Der angegebene Datentyp entspricht dem Datentyp der Spalte in der Datenbanktabelle, der Sicht oder dem SELECT-Resultset.</span><span class="sxs-lookup"><span data-stu-id="5cb26-112">The data type specified is the data type of the column in the database table, view, or SELECT result set.</span></span> <span data-ttu-id="5cb26-113">Der Datentyp wird von den in der [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client-Headerdatei (sqlncli.h) angegebenen systemeigenen Datentypen von [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="5cb26-113">The data type is enumerated by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] native data types specified in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client header file (sqlncli.h).</span></span> <span data-ttu-id="5cb26-114">Ihre Werte weisen das Muster BCP_TYPE_XXX auf.</span><span class="sxs-lookup"><span data-stu-id="5cb26-114">Their values are in the pattern of BCP_TYPE_XXX.</span></span> <span data-ttu-id="5cb26-115">Die Daten werden in computereigenem Format dargestellt,</span><span class="sxs-lookup"><span data-stu-id="5cb26-115">The data is represented in its computer form.</span></span> <span data-ttu-id="5cb26-116">d. h. Daten aus einer Spalte vom integer-Datentyp werden in einer Sequenz aus vier Byte dargestellt, die, abhängig von dem Computer, auf dem die Datendatei erstellt wurden, das Format Big-Endian oder Little-Endian aufweisen.</span><span class="sxs-lookup"><span data-stu-id="5cb26-116">That is, data from a column of integer data type is represented by a four-byte sequence that is big-or little-endian based on the computer that created the data file.</span></span>  
  
-   <span data-ttu-id="5cb26-117">Wenn ein Datenbankdatentyp eine feste Länge hat, haben auch die Daten der Datendatei eine feste Länge.</span><span class="sxs-lookup"><span data-stu-id="5cb26-117">If a database data type is fixed in length, the data file data is also fixed in length.</span></span> <span data-ttu-id="5cb26-118">Beim Verarbeiten der Daten durch Massenkopiermethoden (beispielsweise [IBCPSession::BCPExec](ibcpsession-bcpexec-ole-db.md)) werden die Datenzeilen analysiert. Dabei wird erwartet, dass die Länge der Daten in der Datendatei identisch ist mit der in der Datenbanktabelle, Sicht oder SELECT-Spaltenliste angegebenen Länge der Daten.</span><span class="sxs-lookup"><span data-stu-id="5cb26-118">Bulk-copy methods that process data (for example, [IBCPSession::BCPExec](ibcpsession-bcpexec-ole-db.md)) parse data rows expecting the length of the data in the data file to be identical to the length of the data specified in the database table, view, or SELECT column list.</span></span> <span data-ttu-id="5cb26-119">So müssen beispielsweise Daten für eine als `char(13)` definierte Datenbankspalte in jeder Zeile der Datei 13 Zeichen belegen.</span><span class="sxs-lookup"><span data-stu-id="5cb26-119">For example, data for a database column defined as `char(13)` must be represented by 13 characters for each row of data in the file.</span></span> <span data-ttu-id="5cb26-120">Für Daten mit fester Länge kann ein NULL-Indikator verwendet werden, wenn die Datenbankspalte NULL-Werte zulässt.</span><span class="sxs-lookup"><span data-stu-id="5cb26-120">Fixed-length data can be prefixed with a null indicator if the database column allows null values.</span></span>  
  
-   <span data-ttu-id="5cb26-121">Zum Kopieren von Daten in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] muss die Datendatei für jede Spalte der Datenbanktabelle Daten aufweisen.</span><span class="sxs-lookup"><span data-stu-id="5cb26-121">When copying data to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the data file must have data for each column in the database table.</span></span> <span data-ttu-id="5cb26-122">Beim Kopieren von Daten aus [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] werden Daten von allen Spalten der Datenbanktabelle, der Sicht oder des SELECT-Resultsets in die Datendatei kopiert.</span><span class="sxs-lookup"><span data-stu-id="5cb26-122">When copying data from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], data from all columns in the database table, view, or SELECT result set are copied to the data file.</span></span>  
  
-   <span data-ttu-id="5cb26-123">Beim Kopieren von Daten in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] muss die Ordnungsposition einer Spalte in der Datendatei der Ordnungsposition der Spalte in der Datenbanktabelle genau entsprechen.</span><span class="sxs-lookup"><span data-stu-id="5cb26-123">When copying data to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the ordinal position of a column in the data file must be identical to the ordinal position of the column in the database table.</span></span> <span data-ttu-id="5cb26-124">Beim Kopieren von Daten aus [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] platziert die **BCPExec**-Methode Daten auf der Grundlage der Ordnungsposition der Spalte in der Datenbanktabelle.</span><span class="sxs-lookup"><span data-stu-id="5cb26-124">When copying data from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the **BCPExec** method places data based on the ordinal position of the column in the database table.</span></span>  
  
-   <span data-ttu-id="5cb26-125">Für Datenbank-Datentypen variabler Länge (beispielsweise `varbinary(22)`) und Datenbankspalten, die NULL-Werte zulassen, wird den Daten in der Datendatei ein Längen-/NULL-Indikator als Präfix hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="5cb26-125">If a database data type is variable in length (for example, `varbinary(22)`) or if a database column can contain null values, data in the data file is prefixed by a length/null indicator.</span></span> <span data-ttu-id="5cb26-126">Die Breite des Indikators ändert sich auf der Grundlage des Datentyps und der Version der Massenkopierfunktion.</span><span class="sxs-lookup"><span data-stu-id="5cb26-126">The width of the indicator varies based on the data type and version of bulk copy.</span></span> <span data-ttu-id="5cb26-127">Die BCP_OPTION_FILEFMT-Option der [IBCPSession::BCPControl](ibcpsession-bcpcontrol-ole-db.md)-Methode gewährleistet die Kompatibilität zwischen früheren Datendateien für Massenkopiervorgänge und Servern, auf denen höhere Versionen von [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ausgeführt werden, indem sie signalisiert, wenn die Breite der Indikatoren in den Daten kleiner ist als erwartet.</span><span class="sxs-lookup"><span data-stu-id="5cb26-127">The [IBCPSession::BCPControl](ibcpsession-bcpcontrol-ole-db.md) method option BCP_OPTION_FILEFMT provides compatibility between earlier bulk-copy data files and servers running later versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] by indicating when the width of indicators in the data is narrower than expected.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5cb26-128">Verwenden Sie zum Ändern der für eine Datendatei angegebenen Datenformatwerte die Methoden [IBCPSession::BCPColumns](ibcpsession-bcpcolumns-ole-db.md) und [IBCPSession::BCPColFmt](ibcpsession-bcpcolfmt-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="5cb26-128">To change the data format values specified for a data file, use the [IBCPSession::BCPColumns](ibcpsession-bcpcolumns-ole-db.md) and [IBCPSession::BCPColFmt](ibcpsession-bcpcolfmt-ole-db.md) methods.</span></span>  
  
 <span data-ttu-id="5cb26-129">Mithilfe der Datenbankoption **select into/bulkcopy** können Massenkopiervorgänge in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] für Tabellen optimiert werden, die keinen Index enthalten.</span><span class="sxs-lookup"><span data-stu-id="5cb26-129">Bulk copies to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] can be optimized for tables that do not contain indexes by setting the database option **select into/bulkcopy**.</span></span>  
  
## <a name="arguments"></a><span data-ttu-id="5cb26-130">Argumente</span><span class="sxs-lookup"><span data-stu-id="5cb26-130">Arguments</span></span>  
 <span data-ttu-id="5cb26-131">*pwszTable*[in]</span><span class="sxs-lookup"><span data-stu-id="5cb26-131">*pwszTable*[in]</span></span>  
 <span data-ttu-id="5cb26-132">Name der Datenbanktabelle, in die bzw. aus der kopiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="5cb26-132">The name of the database table to be copied into or out of.</span></span> <span data-ttu-id="5cb26-133">Der Name kann den Namen der Datenbank oder den Namen des Besitzers enthalten.</span><span class="sxs-lookup"><span data-stu-id="5cb26-133">The name can include the database name or the owner name.</span></span> <span data-ttu-id="5cb26-134">Beispiel: "pubs.username.titles", "pubs..titles", "username.titles".</span><span class="sxs-lookup"><span data-stu-id="5cb26-134">For example, "pubs.username.titles", "pubs..titles", "username.titles".</span></span>  
  
 <span data-ttu-id="5cb26-135">Wenn für das eDirection-Argument BCP_DIRECTION_OUT festgelegt ist, kann das pwszTable-Argument den Namen einer Datenbanksicht annehmen.</span><span class="sxs-lookup"><span data-stu-id="5cb26-135">If the eDirection argument is set to BCP_DIRECTION_OUT, the pwszTable argument can be the name of a database view.</span></span>  
  
 <span data-ttu-id="5cb26-136">Wird für das **eDirection** -Argument BCP_DIRECTION_OUT festgelegt und mithilfe der **BCPControl** -Methode eine SELECT-Anweisung angegeben, bevor die BCPExec-Methode aufgerufen wird, muss für das *pwszTable* -Argument NULL festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="5cb26-136">If the eDirection argument is set to BCP_DIRECTION_OUT and a SELECT statement is specified using the **BCPControl** method before the **BCPExec** method is called, the *pwszTable* argument must be set to NULL.</span></span>  
  
 <span data-ttu-id="5cb26-137">*pwszDataFile*[in]</span><span class="sxs-lookup"><span data-stu-id="5cb26-137">*pwszDataFile*[in]</span></span>  
 <span data-ttu-id="5cb26-138">Name der Benutzerdatei, in die bzw. aus der kopiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="5cb26-138">The name of the user file to be copied into or out of.</span></span>  
  
 <span data-ttu-id="5cb26-139">*pwszErrorFile*[in]</span><span class="sxs-lookup"><span data-stu-id="5cb26-139">*pwszErrorFile*[in]</span></span>  
 <span data-ttu-id="5cb26-140">Der Name der Fehlerdatei, in die Statusmeldungen, Fehlermeldungen und Kopien von Zeilen geschrieben werden sollen, die nicht von einer Benutzerdatei in eine Tabelle kopiert werden konnten.</span><span class="sxs-lookup"><span data-stu-id="5cb26-140">The name of the error file to be filled with progress messages, error messages, and copies of any rows that could not be copied from a user file to a table.</span></span> <span data-ttu-id="5cb26-141">Wenn für das *pwszErrorFile* -Argument NULL festgelegt wird, wird keine Fehlerdatei verwendet.</span><span class="sxs-lookup"><span data-stu-id="5cb26-141">If the *pwszErrorFile* argument is set to NULL, no error file is used.</span></span>  
  
 <span data-ttu-id="5cb26-142">*eDirection*[in]</span><span class="sxs-lookup"><span data-stu-id="5cb26-142">*eDirection*[in]</span></span>  
 <span data-ttu-id="5cb26-143">Die Richtung des Kopiervorgangs, entweder BCP_DIRECTION_IN oder BCP_DIRECTION_OUT.</span><span class="sxs-lookup"><span data-stu-id="5cb26-143">The direction of the copy operation, either BCP_DIRECTION_IN or BCP_DIRECTION _OUT.</span></span> <span data-ttu-id="5cb26-144">BCP_DIRECTION_IN steht für eine Kopie von einer Benutzerdatei in eine Datenbanktabelle; BCP_DIRECTION_OUT steht für eine Kopie von einer Datenbanktabelle in eine Benutzerdatei.</span><span class="sxs-lookup"><span data-stu-id="5cb26-144">BCP_DIRECTION _IN indicates a copy from a user file to a database table; BCP_DIRECTION _OUT indicates a copy from a database table to a user file.</span></span>  
  
## <a name="return-code-values"></a><span data-ttu-id="5cb26-145">Rückgabecodewerte</span><span class="sxs-lookup"><span data-stu-id="5cb26-145">Return Code Values</span></span>  
 <span data-ttu-id="5cb26-146">S_OK</span><span class="sxs-lookup"><span data-stu-id="5cb26-146">S_OK</span></span>  
 <span data-ttu-id="5cb26-147">Die Methode wurde erfolgreich ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="5cb26-147">The method succeeded.</span></span>  
  
 <span data-ttu-id="5cb26-148">E_FAIL</span><span class="sxs-lookup"><span data-stu-id="5cb26-148">E_FAIL</span></span>  
 <span data-ttu-id="5cb26-149">Ein Anbieter spezifischer Fehler ist aufgetreten. Ausführliche Informationen erhalten Sie über die [ISQLServerErrorInfo](../../database-engine/dev-guide/isqlservererrorinfo-ole-db.md) -Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="5cb26-149">A provider specific error occurred' for detailed information, use the [ISQLServerErrorInfo](../../database-engine/dev-guide/isqlservererrorinfo-ole-db.md) interface.</span></span>  
  
 <span data-ttu-id="5cb26-150">E_OUTOFMEMORY</span><span class="sxs-lookup"><span data-stu-id="5cb26-150">E_OUTOFMEMORY</span></span>  
 <span data-ttu-id="5cb26-151">Fehler aufgrund nicht genügenden Arbeitsspeichers</span><span class="sxs-lookup"><span data-stu-id="5cb26-151">Out-of-memory error.</span></span>  
  
 <span data-ttu-id="5cb26-152">E_INVALIDARG</span><span class="sxs-lookup"><span data-stu-id="5cb26-152">E_INVALIDARG</span></span>  
 <span data-ttu-id="5cb26-153">Mindestens eines der Argumente wurde nicht ordnungsgemäß angegeben.</span><span class="sxs-lookup"><span data-stu-id="5cb26-153">One or more of the arguments was not correctly specified.</span></span> <span data-ttu-id="5cb26-154">Zum Beispiel wurde ein ungültiger Dateiname angegeben.</span><span class="sxs-lookup"><span data-stu-id="5cb26-154">For example, an invalid file name was given.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5cb26-155">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="5cb26-155">See Also</span></span>  
 <span data-ttu-id="5cb26-156">[IBCPSession &#40;OLE DB&#41;](ibcpsession-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="5cb26-156">[IBCPSession &#40;OLE DB&#41;](ibcpsession-ole-db.md) </span></span>  
 [<span data-ttu-id="5cb26-157">Durchführen von Massenkopiervorgängen</span><span class="sxs-lookup"><span data-stu-id="5cb26-157">Performing Bulk Copy Operations</span></span>](../native-client/features/performing-bulk-copy-operations.md)  
  
  

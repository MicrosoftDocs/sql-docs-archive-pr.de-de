---
title: SQLRowCount | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLRowCount function
ms.assetid: 967ed3d4-3d31-4485-ac92-027076ebc829
author: rothja
ms.author: jroth
ms.openlocfilehash: 410023d960bad6dde1060a509cc1bf46f67d77cc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87622057"
---
# <a name="sqlrowcount"></a><span data-ttu-id="d641a-102">SQLRowCount</span><span class="sxs-lookup"><span data-stu-id="d641a-102">SQLRowCount</span></span>
  <span data-ttu-id="d641a-103">Wenn Arrays von Parameterwerten für die Ausführung der Anweisung gebunden werden, `SQLRowCount` gibt SQL_ERROR zurück, wenn eine Zeile mit Parameterwerten in der Anweisungs Ausführung eine Fehlerbedingung generiert.</span><span class="sxs-lookup"><span data-stu-id="d641a-103">When arrays of parameter values are bound for statement execution, `SQLRowCount` returns SQL_ERROR if any row of parameter values generates an error condition in statement execution.</span></span> <span data-ttu-id="d641a-104">Kein Wert wird durch das *RowCountPtr* -Argument der Funktion zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="d641a-104">No value is returned through the *RowCountPtr* argument of the function.</span></span>  
  
 <span data-ttu-id="d641a-105">Die Anwendung nutzt das SQL_ATTR_PARAMS_PROCESSED_PTR-Anweisungsattribut, um die Anzahl der vor Auftreten des Fehlers verarbeiteten Parameter zu erfassen.</span><span class="sxs-lookup"><span data-stu-id="d641a-105">The application can take advantage of the SQL_ATTR_PARAMS_PROCESSED_PTR statement attribute to capture the number of parameters processed prior to the error occurring.</span></span>  
  
 <span data-ttu-id="d641a-106">Darüber hinaus kann die Anwendung ein Array von Statuswerten verwenden, die mithilfe des SQL_ATTR_PARAM_STATUS_PTR-Anweisungsattributs gebunden sind, um die Arrayoffsets der ungültigen Parameterzeilen zu erfassen.</span><span class="sxs-lookup"><span data-stu-id="d641a-106">Further, the application can use an array of status values, bound by using the SQL_ATTR_PARAM_STATUS_PTR statement attribute, to capture the array offsets of offending parameter rows.</span></span> <span data-ttu-id="d641a-107">Die Anwendung kann das Statusarray durchsuchen, um die tatsächliche Anzahl verarbeiteter Zeilen zu bestimmen.</span><span class="sxs-lookup"><span data-stu-id="d641a-107">The application can traverse the status array to determine the actual number of rows processed.</span></span>  
  
 <span data-ttu-id="d641a-108">Wenn eine [!INCLUDE[tsql](../../includes/tsql-md.md)] INSERT-, Update-, DELETE-oder MERGE-Anweisung mit einer OUTPUT-Klausel ausgeführt wird, gibt SQLRowCount nicht die Anzahl der betroffenen Zeilen zurück, bis alle Zeilen im Resultset, das von der OUTPUT-Klausel generiert wurde, genutzt wurden.</span><span class="sxs-lookup"><span data-stu-id="d641a-108">When a [!INCLUDE[tsql](../../includes/tsql-md.md)] INSERT, UPDATE, DELETE, or MERGE statement with an OUTPUT clause is executed, SQLRowCount will not return the count of rows affected until all the rows in the result set generated by the OUTPUT clause have been consumed.</span></span> <span data-ttu-id="d641a-109">Um diese Zeilen zu sverarbeiten, rufen Sie SQLFetch oder SQLFetchScroll auf.</span><span class="sxs-lookup"><span data-stu-id="d641a-109">To sconsume these rows, you call SQLFetch or SQLFetchScroll.</span></span> <span data-ttu-id="d641a-110">SQLResultCols gibt-1 zurück, bis alle Ergebniszeilen verarbeitet wurden.</span><span class="sxs-lookup"><span data-stu-id="d641a-110">SQLResultCols will return -1 until all result rows have been consumed.</span></span> <span data-ttu-id="d641a-111">Nachdem SQLFetch oder SQLFetchScroll SQL_NO_DATA zurückgegeben hat, muss die Anwendung SQLRowCount aufrufen, um die Anzahl der betroffenen Zeilen zu bestimmen, bevor SQLMoreResults aufgerufen wird, um zum nächsten Ergebnis zu gelangen.</span><span class="sxs-lookup"><span data-stu-id="d641a-111">After SQLFetch or SQLFetchScroll returns SQL_NO_DATA, the application must call SQLRowCount to determine the number of rows affected before calling SQLMoreResults to move to the next result.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d641a-112">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="d641a-112">See Also</span></span>  
 <span data-ttu-id="d641a-113">[SQLRowCount-Funktion](https://go.microsoft.com/fwlink/?LinkId=59367) </span><span class="sxs-lookup"><span data-stu-id="d641a-113">[SQLRowCount Function](https://go.microsoft.com/fwlink/?LinkId=59367) </span></span>  
 [<span data-ttu-id="d641a-114">ODBC API Implementation Details</span><span class="sxs-lookup"><span data-stu-id="d641a-114">ODBC API Implementation Details</span></span>](odbc-api-implementation-details.md)  
  
  

---
title: Bindung und Datenübertragung von Tabellenwert Parametern und Spaltenwerten | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), binding and data transfer
ms.assetid: 0a2ea462-d613-42b6-870f-c7fa086a6b42
author: rothja
ms.author: jroth
ms.openlocfilehash: 2e9e30e22a69b2d500990cc1481506b4edbda99b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87620860"
---
# <a name="binding-and-data-transfer-of-table-valued-parameters-and-column-values"></a><span data-ttu-id="11a45-102">Bindung und Datenübertragung von Tabellenwertparametern und Spaltenwerten</span><span class="sxs-lookup"><span data-stu-id="11a45-102">Binding and Data Transfer of Table-Valued Parameters and Column Values</span></span>
  <span data-ttu-id="11a45-103">Tabellenwertparameter müssen ebenso wie andere Parameter gebunden werden, bevor sie an den Server übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="11a45-103">Table-valued parameters, like other parameters, must be bound before they are passed to the server.</span></span> <span data-ttu-id="11a45-104">Die Anwendung bindet Tabellenwert Parameter auf dieselbe Weise, wie Sie andere Parameter bindet: mithilfe von SQLBindParameter oder gleichwertigen Aufrufen von SQLSetDescField oder SQLSetDescRec.</span><span class="sxs-lookup"><span data-stu-id="11a45-104">The application binds table-valued parameters the same way it binds other parameters: by using SQLBindParameter or equivalent calls to SQLSetDescField or SQLSetDescRec.</span></span> <span data-ttu-id="11a45-105">Tabellenwertparameter haben den Serverdatentyp SQL_SS_TABLE.</span><span class="sxs-lookup"><span data-stu-id="11a45-105">The server data type for a table-valued parameter is SQL_SS_TABLE.</span></span> <span data-ttu-id="11a45-106">Der C-Typ kann entweder als SQL_C_DEFAULT oder SQL_C_BINARY angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="11a45-106">The C type can be specified either as SQL_C_DEFAULT or SQL_C_BINARY.</span></span>  
  
 <span data-ttu-id="11a45-107">In [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] oder höher werden nur Eingabe-Tabellenwertparameter unterstützt.</span><span class="sxs-lookup"><span data-stu-id="11a45-107">In [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] or later, only input table-valued parameters are supported.</span></span> <span data-ttu-id="11a45-108">Daher resultiert jeder Versuch, SQL_DESC_PARAMETER_TYPE auf einen anderen Wert als SQL_PARAM_INPUT festzulegen, in der Rückgabe von SQL_ERROR mit SQLSTATE = HY105 und der Meldung "Der Parametertyp ist ungültig".</span><span class="sxs-lookup"><span data-stu-id="11a45-108">Therefore, any attempt to set SQL_DESC_PARAMETER_TYPE to a value other than SQL_PARAM_INPUT will return SQL_ERROR with SQLSTATE = HY105 and the message "Invalid parameter type".</span></span>  
  
 <span data-ttu-id="11a45-109">Gesamten Tabellenwertparameter-Spalten können mit dem Attribut SQL_CA_SS_COL_HAS_DEFAULT_VALUE Standardwerte zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="11a45-109">Entire table-valued parameter columns can be assigned default values by using the attribute SQL_CA_SS_COL_HAS_DEFAULT_VALUE.</span></span> <span data-ttu-id="11a45-110">Einzelnen Tabellenwert Parameter-Spaltenwerten können allerdings keine Standardwerte zugewiesen werden, indem SQL_DEFAULT_PARAM in *StrLen_or_IndPtr* mit SQLBindParameter verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="11a45-110">Individual table-valued parameter column values, however, cannot be assigned default values by using SQL_DEFAULT_PARAM in *StrLen_or_IndPtr* with SQLBindParameter.</span></span> <span data-ttu-id="11a45-111">Tabellenwert Parameter als Ganzes können nicht mithilfe von SQL_DEFAULT_PARAM in *StrLen_or_IndPtr* mit SQLBindParameter auf einen Standardwert festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="11a45-111">Table-valued parameters as a whole cannot be set to a default value by using SQL_DEFAULT_PARAM in *StrLen_or_IndPtr* with SQLBindParameter.</span></span> <span data-ttu-id="11a45-112">Wenn diese Regeln nicht befolgt werden, wird von SQLExecute oder SQLExecDirect SQL_ERROR zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="11a45-112">If these rules are not followed, SQLExecute or SQLExecDirect will return SQL_ERROR.</span></span> <span data-ttu-id="11a45-113">Es wird ein Diagnosedaten Satz mit SQLSTATE = 07s01 und der Meldung "Ungültige Verwendung des Standard Parameters für den Parameter \<p> " generiert, wobei \<p> die Ordinalzahl des TVP in der Abfrage Anweisung ist.</span><span class="sxs-lookup"><span data-stu-id="11a45-113">A diagnostic record will be generated with SQLSTATE=07S01 and the message "Invalid use of default parameter for parameter \<p>", where \<p> is the ordinal of the TVP in the query statement.</span></span>  
  
 <span data-ttu-id="11a45-114">Nachdem die Anwendung den Tabellenwertparameter gebunden hat, muss sie jede einzelne Tabellenwertparameter-Spalte binden.</span><span class="sxs-lookup"><span data-stu-id="11a45-114">After binding the table-valued parameter, the application must then bind each table-valued parameter column.</span></span> <span data-ttu-id="11a45-115">Hierzu ruft die Anwendung zuerst SQLSetStmtAttr auf, um SQL_SOPT_SS_PARAM_FOCUS auf die Ordnungszahl eines Tabellenwert Parameters festzulegen.</span><span class="sxs-lookup"><span data-stu-id="11a45-115">To do this, the application first calls SQLSetStmtAttr to set SQL_SOPT_SS_PARAM_FOCUS to the ordinal of a table-valued parameter.</span></span> <span data-ttu-id="11a45-116">Anschließend bindet die Anwendung die Spalten des Tabellenwert Parameters durch Aufrufe der folgenden Routinen: SQLBindParameter, SQLSetDescRec und SQLSetDescField.</span><span class="sxs-lookup"><span data-stu-id="11a45-116">Then the application binds the columns of the table-valued parameter by calls to the following routines: SQLBindParameter, SQLSetDescRec, and SQLSetDescField.</span></span> <span data-ttu-id="11a45-117">Wenn Sie SQL_SOPT_SS_PARAM_FOCUS auf 0 festlegen, werden die üblichen Auswirkungen von SQLBindParameter, SQLSetDescRec und SQLSetDescField beim Betrieb auf reguläre Parameter der obersten Ebene wieder hergestellt.</span><span class="sxs-lookup"><span data-stu-id="11a45-117">Setting SQL_SOPT_SS_PARAM_FOCUS to 0 restores the usual effect of SQLBindParameter, SQLSetDescRec, and SQLSetDescField in operating on regular top-level parameters.</span></span>  
  
 <span data-ttu-id="11a45-118">Für den Tabellenwertparameter an sich werden keine Daten gesendet oder empfangen, die Daten werden für die einzelnen Spalten, aus denen er sich zusammensetzt, gesendet und empfangen.</span><span class="sxs-lookup"><span data-stu-id="11a45-118">No actual data is sent or received for the table-valued parameter itself, but data is sent and received for each of its constituent columns.</span></span> <span data-ttu-id="11a45-119">Da der Tabellenwert Parameter eine Pseudo Spalte ist, werden die Parameter für SQLBindParameter verwendet, um auf andere Attribute als andere Datentypen zu verweisen, wie im folgenden dargestellt:</span><span class="sxs-lookup"><span data-stu-id="11a45-119">Because the table-valued parameter is a pseudo column, the parameters for SQLBindParameter are used to refer to different attributes than other data types, as follows:</span></span>  
  
|<span data-ttu-id="11a45-120">Parameter</span><span class="sxs-lookup"><span data-stu-id="11a45-120">Parameter</span></span>|<span data-ttu-id="11a45-121">Verknüpftes Attribut für nicht-Tabellenwert Parameter-Typen, einschließlich Spalten</span><span class="sxs-lookup"><span data-stu-id="11a45-121">Related attribute for non-table-valued parameter types, including columns</span></span>|<span data-ttu-id="11a45-122">Verknüpftes Attribut für Tabellenwertparameter</span><span class="sxs-lookup"><span data-stu-id="11a45-122">Related attribute for table-valued parameters</span></span>|  
|---------------|--------------------------------------------------------------------------------|----------------------------------------------------|  
|<span data-ttu-id="11a45-123">*InputOutputType*</span><span class="sxs-lookup"><span data-stu-id="11a45-123">*InputOutputType*</span></span>|<span data-ttu-id="11a45-124">SQL_DESC_PARAMETER_TYPE in IPD</span><span class="sxs-lookup"><span data-stu-id="11a45-124">SQL_DESC_PARAMETER_TYPE in IPD.</span></span><br /><br /> <span data-ttu-id="11a45-125">Für Tabellenwertparameter-Spalten muss diese Angabe der Angabe für den Tabellenwertparameter selbst entsprechen.</span><span class="sxs-lookup"><span data-stu-id="11a45-125">For table-valued parameter columns, this must be the same as the setting for the table-valued parameter itself.</span></span>|<span data-ttu-id="11a45-126">SQL_DESC_PARAMETER_TYPE in IPD</span><span class="sxs-lookup"><span data-stu-id="11a45-126">SQL_DESC_PARAMETER_TYPE in IPD.</span></span><br /><br /> <span data-ttu-id="11a45-127">Hier muss SQL_PARAM_INPUT angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="11a45-127">This must be SQL_PARAM_INPUT.</span></span>|  
|<span data-ttu-id="11a45-128">*ValueType*</span><span class="sxs-lookup"><span data-stu-id="11a45-128">*ValueType*</span></span>|<span data-ttu-id="11a45-129">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in APD</span><span class="sxs-lookup"><span data-stu-id="11a45-129">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in APD.</span></span>|<span data-ttu-id="11a45-130">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in APD</span><span class="sxs-lookup"><span data-stu-id="11a45-130">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in APD.</span></span><br /><br /> <span data-ttu-id="11a45-131">Hier muss SQL_C_DEFAULT oder SQL_C_BINARY angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="11a45-131">This must be SQL_C_DEFAULT or SQL_C_BINARY.</span></span>|  
|<span data-ttu-id="11a45-132">*ParameterType*</span><span class="sxs-lookup"><span data-stu-id="11a45-132">*ParameterType*</span></span>|<span data-ttu-id="11a45-133">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in IPD</span><span class="sxs-lookup"><span data-stu-id="11a45-133">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in IPD.</span></span>|<span data-ttu-id="11a45-134">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in IPD</span><span class="sxs-lookup"><span data-stu-id="11a45-134">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in IPD.</span></span><br /><br /> <span data-ttu-id="11a45-135">Hier muss SQL_SS_TABLE angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="11a45-135">This must be SQL_SS_TABLE.</span></span>|  
|<span data-ttu-id="11a45-136">*ColumnSize*</span><span class="sxs-lookup"><span data-stu-id="11a45-136">*ColumnSize*</span></span>|<span data-ttu-id="11a45-137">SQL_DESC_LENGTH oder SQL_DESC_PRECISION in IPD</span><span class="sxs-lookup"><span data-stu-id="11a45-137">SQL_DESC_LENGTH or SQL_DESC_PRECISION in IPD.</span></span><br /><br /> <span data-ttu-id="11a45-138">Dies hängt vom Wert von *ParameterType*ab.</span><span class="sxs-lookup"><span data-stu-id="11a45-138">This depends on the value of *ParameterType*.</span></span>|<span data-ttu-id="11a45-139">SQL_DESC_ARRAY_SIZE</span><span class="sxs-lookup"><span data-stu-id="11a45-139">SQL_DESC_ARRAY_SIZE</span></span><br /><br /> <span data-ttu-id="11a45-140">Kann auch mit SQL_ATTR_PARAM_SET_SIZE festgelegt werden, wenn der Parameterfokus auf den Tabellenwertparameter festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="11a45-140">Can also be set using SQL_ATTR_PARAM_SET_SIZE when the parameter focus is set to the table-valued parameter.</span></span><br /><br /> <span data-ttu-id="11a45-141">Bei einem Tabellenwertparameter ist dies die Anzahl von Zeilen in den Tabellenwertparameter-Spaltenpuffern.</span><span class="sxs-lookup"><span data-stu-id="11a45-141">For a table-valued parameter, this is the number of rows in the table-valued parameter column buffers.</span></span>|  
|<span data-ttu-id="11a45-142">*DecimalDigits*</span><span class="sxs-lookup"><span data-stu-id="11a45-142">*DecimalDigits*</span></span>|<span data-ttu-id="11a45-143">SQL_DESC_PRECISION oder SQL_DESC_SCALE in IPD</span><span class="sxs-lookup"><span data-stu-id="11a45-143">SQL_DESC_PRECISION or SQL_DESC_SCALE in IPD.</span></span>|<span data-ttu-id="11a45-144">Nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="11a45-144">Unused.</span></span> <span data-ttu-id="11a45-145">Diese Angabe muss 0 sein.</span><span class="sxs-lookup"><span data-stu-id="11a45-145">This must be 0.</span></span><br /><br /> <span data-ttu-id="11a45-146">Wenn dieser Parameter nicht 0 ist, gibt SQLBindParameter SQL_ERROR zurück, und es wird ein Diagnosedaten Satz mit SQLSTATE = HY104 und der Meldung "ungültige Genauigkeit oder Dezimalstellen" generiert.</span><span class="sxs-lookup"><span data-stu-id="11a45-146">If this parameter is not 0, SQLBindParameter will return SQL_ERROR, and a diagnostic record will be generated with SQLSTATE= HY104 and the message "Invalid precision or scale".</span></span>|  
|<span data-ttu-id="11a45-147">*ParameterValuePtr*</span><span class="sxs-lookup"><span data-stu-id="11a45-147">*ParameterValuePtr*</span></span>|<span data-ttu-id="11a45-148">SQL_DESC_DATA_PTR in APD</span><span class="sxs-lookup"><span data-stu-id="11a45-148">SQL_DESC_DATA_PTR in APD.</span></span>|<span data-ttu-id="11a45-149">SQL_CA_SS_TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="11a45-149">SQL_CA_SS_TYPE_NAME.</span></span><br /><br /> <span data-ttu-id="11a45-150">Dies ist ein optionales Attribut für gespeicherte Prozeduren, und NULL kann angegeben werden, wenn es nicht erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="11a45-150">This is optional for stored procedure calls, and NULL can be specified if it is not required.</span></span> <span data-ttu-id="11a45-151">Es muss für SQL-Anweisungen angegeben werden, die keine Prozeduraufrufe sind.</span><span class="sxs-lookup"><span data-stu-id="11a45-151">It must be specified for SQL statements that are not procedure calls.</span></span><br /><br /> <span data-ttu-id="11a45-152">Dieser Parameter dient als eindeutiger Wert, anhand dessen die Anwendung den betreffenden Tabellenwertparameter bei Verwendung einer variablen Zeilenbindung identifizieren kann.</span><span class="sxs-lookup"><span data-stu-id="11a45-152">This parameter also serves as a unique value that the application can use to identify this table-valued parameter when variable row binding is used.</span></span> <span data-ttu-id="11a45-153">Weitere Informationen finden Sie im Abschnitt "Variable Tabellenwertparameter-Zeilenbindung" weiter unten in diesem Thema.</span><span class="sxs-lookup"><span data-stu-id="11a45-153">For more information, see the "Variable Table-Valued Parameter Row Binding" section, later in this topic.</span></span><br /><br /> <span data-ttu-id="11a45-154">Wenn ein Tabellenwert Parameter-Typname für einen SQLBindParameter-Befehl angegeben wird, muss er auch in Anwendungen, die als ANSI-Anwendungen erstellt wurden, als Unicode-Wert angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="11a45-154">When a table-valued parameter type name is specified on a call to SQLBindParameter, it must be specified as a Unicode value, even in applications that are built as ANSI applications.</span></span> <span data-ttu-id="11a45-155">Der für den Parameter *StrLen_or_IndPtr* verwendete Wert muss entweder SQL_NTS oder die Zeichen folgen Länge des Namens multipliziert mit sizeof (WChar) sein.</span><span class="sxs-lookup"><span data-stu-id="11a45-155">The value used for the parameter *StrLen_or_IndPtr* should be either SQL_NTS or the string length of the name multiplied by sizeof(WCHAR).</span></span>|  
|<span data-ttu-id="11a45-156">*Pufferlänge*</span><span class="sxs-lookup"><span data-stu-id="11a45-156">*BufferLength*</span></span>|<span data-ttu-id="11a45-157">SQL_DESC_OCTET_LENGTH in APD</span><span class="sxs-lookup"><span data-stu-id="11a45-157">SQL_DESC_OCTET_LENGTH in APD.</span></span>|<span data-ttu-id="11a45-158">Die Länge des Typnamens des Tabellenwertparameters in Byte</span><span class="sxs-lookup"><span data-stu-id="11a45-158">The length of the table-valued parameter type name in bytes.</span></span><br /><br /> <span data-ttu-id="11a45-159">Kann SQL_NTS sein, wenn der Typname NULL-termininiert ist, oder 0, wenn der Typname des Tabellenwertparameters nicht erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="11a45-159">This can be SQL_NTS if the type name is null terminated, or 0 if the table-valued parameter type name is not required.</span></span>|  
|<span data-ttu-id="11a45-160">*StrLen_or_IndPtr*</span><span class="sxs-lookup"><span data-stu-id="11a45-160">*StrLen_or_IndPtr*</span></span>|<span data-ttu-id="11a45-161">SQL_DESC_OCTET_LENGTH_PTR in APD</span><span class="sxs-lookup"><span data-stu-id="11a45-161">SQL_DESC_OCTET_LENGTH_PTR in APD.</span></span>|<span data-ttu-id="11a45-162">SQL_DESC_OCTET_LENGTH_PTR in APD</span><span class="sxs-lookup"><span data-stu-id="11a45-162">SQL_DESC_OCTET_LENGTH_PTR in APD.</span></span><br /><br /> <span data-ttu-id="11a45-163">Für Tabellenwertparameter wird hier die Zeilenanzahl statt die Datenlänge angegeben.</span><span class="sxs-lookup"><span data-stu-id="11a45-163">For table-valued parameters, this is a row count rather than a data length.</span></span>|  
  
 <span data-ttu-id="11a45-164">Zwei Datenübertragungsmodi werden für Tabellenwertparameter unterstützt: feste Zeilenbindung und variable Zeilenbindung.</span><span class="sxs-lookup"><span data-stu-id="11a45-164">Two data transfer modes are supported for table-valued parameters: fixed row binding and variable row binding.</span></span>  
  
## <a name="fixed-table-valued-parameter-row-binding"></a><span data-ttu-id="11a45-165">Feste Tabellenwertparameter-Zeilenbindung</span><span class="sxs-lookup"><span data-stu-id="11a45-165">Fixed Table-Valued Parameter Row Binding</span></span>  
 <span data-ttu-id="11a45-166">Bei der festen Zeilenbindung ordnet die Anwendung Puffer (oder Pufferarrays) zu, die groß genug sind, um alle Eingabespaltenwerte aufnehmen zu können.</span><span class="sxs-lookup"><span data-stu-id="11a45-166">For fixed row binding, an application allocates buffers (or buffer arrays) large enough for all possible input column values.</span></span> <span data-ttu-id="11a45-167">Die Anwendung führt Folgendes aus:</span><span class="sxs-lookup"><span data-stu-id="11a45-167">The application does the following:</span></span>  
  
1.  <span data-ttu-id="11a45-168">Bindet alle Parameter mithilfe von SQLBindParameter-, SQLSetDescRec-oder SQLSetDescField-aufrufen.</span><span class="sxs-lookup"><span data-stu-id="11a45-168">Binds all parameters by using SQLBindParameter, SQLSetDescRec, or SQLSetDescField calls.</span></span>  
  
    1.  <span data-ttu-id="11a45-169">Sie legt SQL_DESC_ARRAY_SIZE auf die maximale Anzahl von Zeilen fest, die für jeden Tabellenwertparameter übertragen werden können.</span><span class="sxs-lookup"><span data-stu-id="11a45-169">Sets SQL_DESC_ARRAY_SIZE to the maximum number of rows that can be transferred for each table-valued parameter.</span></span> <span data-ttu-id="11a45-170">Dies kann im SQLBindParameter-Befehl durchgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="11a45-170">This can be done in the SQLBindParameter call.</span></span>  
  
2.  <span data-ttu-id="11a45-171">Ruft SQLSetStmtAttr auf, um SQL_SOPT_SS_PARAM_FOCUS auf die Ordnungszahl der einzelnen Tabellenwert Parameter festzulegen.</span><span class="sxs-lookup"><span data-stu-id="11a45-171">Calls SQLSetStmtAttr to set SQL_SOPT_SS_PARAM_FOCUS to the ordinal of each table-valued parameter.</span></span>  
  
    1.  <span data-ttu-id="11a45-172">Für jeden Tabellenwert Parameter bindet Tabellenwert Parameter-Spalten mithilfe von SQLBindParameter-, SQLSetDescRec-oder SQLSetDescField-aufrufen.</span><span class="sxs-lookup"><span data-stu-id="11a45-172">For each table-valued parameter, binds table-valued parameter columns by using SQLBindParameter, SQLSetDescRec, or SQLSetDescField calls.</span></span>  
  
    2.  <span data-ttu-id="11a45-173">Für jede Tabellenwert Parameter-Spalte, die über Standardwerte verfügen soll, wird SQLSetDescField aufgerufen, um SQL_CA_SS_COL_HAS_DEFAULT_VALUE auf 1 festzulegen.</span><span class="sxs-lookup"><span data-stu-id="11a45-173">For each table-valued parameter column that is to have default values, calls SQLSetDescField to set SQL_CA_SS_COL_HAS_DEFAULT_VALUE to 1.</span></span>  
  
3.  <span data-ttu-id="11a45-174">Ruft SQLSetStmtAttr auf, um SQL_SOPT_SS_PARAM_FOCUS auf 0 festzulegen.</span><span class="sxs-lookup"><span data-stu-id="11a45-174">Calls SQLSetStmtAttr to set SQL_SOPT_SS_PARAM_FOCUS to 0.</span></span> <span data-ttu-id="11a45-175">Dies muss erfolgen, bevor SQLExecute oder SQLExecDirect aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="11a45-175">This must be done before SQLExecute or SQLExecDirect is called.</span></span> <span data-ttu-id="11a45-176">Andernfalls wird SQL_ERROR zurückgegeben, und es wird ein Diagnosedatensatz mit SQLSTATE=HY024 und der Meldung "Ungültiger Attributwert, SQL_SOPT_SS_PARAM_FOCUS (muss zur Laufzeit Null sein)" generiert.</span><span class="sxs-lookup"><span data-stu-id="11a45-176">Otherwise, SQL_ERROR is be returned and a diagnostic record is generated with SQLSTATE=HY024 and the message "Invalid attribute value, SQL_SOPT_SS_PARAM_FOCUS (must be zero at execution time)".</span></span>  
  
4.  <span data-ttu-id="11a45-177">Legt *StrLen_or_IndPtr* oder SQL_DESC_OCTET_LENGTH_PTR auf SQL_DEFAULT_PARAM für einen Tabellenwert Parameter ohne Zeilen oder die Anzahl der Zeilen fest, die beim nächsten Aufrufen von SQLExecute oder SQLExecDirect übertragen werden sollen, wenn der Tabellenwert Parameter über Zeilen verfügt.</span><span class="sxs-lookup"><span data-stu-id="11a45-177">Sets *StrLen_or_IndPtr* or SQL_DESC_OCTET_LENGTH_PTR to SQL_DEFAULT_PARAM for a table-valued parameter with no rows, or the number of rows to be transferred on the next call of SQLExecute or SQLExecDirect if the table-valued parameter has rows.</span></span> <span data-ttu-id="11a45-178">*StrLen_or_IndPtr* oder SQL_DESC_OCTET_LENGTH_PTR kann nicht auf "SQL_NULL_DATA" für einen Tabellenwert Parameter festgelegt werden, da Tabellenwert Parameter nicht auf NULL festgelegt werden können (obwohl Tabellenwert Parameter-Spalten möglicherweise NULL-Werte zulassen).</span><span class="sxs-lookup"><span data-stu-id="11a45-178">*StrLen_or_IndPtr* or SQL_DESC_OCTET_LENGTH_PTR cannot be set to SQL_NULL_DATA for a table-valued parameter as table-valued parameters are not nullable (though table-valued parameter constituent columns may be nullable).</span></span> <span data-ttu-id="11a45-179">Wenn dieser Wert auf einen ungültigen Wert festgelegt ist, gibt SQLExecute oder SQLExecDirect SQL_ERROR zurück, und es wird ein Diagnosedaten Satz mit SQLSTATE = HY090 und der Meldung "ungültige Zeichen folgen-oder Pufferlänge für Parameter \<p> " generiert, wobei p für die Parameter Nummer steht.</span><span class="sxs-lookup"><span data-stu-id="11a45-179">If this is set to an invalid value, SQLExecute or SQLExecDirect returns SQL_ERROR, and a diagnostic record is generated with SQLSTATE=HY090 and the message "Invalid string or buffer length for parameter \<p>", where p is the parameter number.</span></span>  
  
5.  <span data-ttu-id="11a45-180">Ruft SQLExecute oder SQLExecDirect auf.</span><span class="sxs-lookup"><span data-stu-id="11a45-180">Calls SQLExecute or SQLExecDirect.</span></span>  
  
 <span data-ttu-id="11a45-181">Die Spaltenwerte der Eingabe-Tabellenwert Parameter können in Teilen übergeben werden, wenn *StrLen_or_IndPtr* für die Spalte auf SQL_LEN_DATA_AT_EXEC (*length*) oder SQL_DATA_AT_EXEC festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="11a45-181">Input table-valued parameter column values can be passed in pieces if *StrLen_or_IndPtr* is set to SQL_LEN_DATA_AT_EXEC(*length*) or SQL_DATA_AT_EXEC for the column.</span></span> <span data-ttu-id="11a45-182">Dies gleicht der Übergabe einzelner Werte bei Verwendung von Parameterarrays.</span><span class="sxs-lookup"><span data-stu-id="11a45-182">This is similar to passing values in pieces when arrays of parameters are used.</span></span> <span data-ttu-id="11a45-183">Wie bei allen Data-at-Execution-Parametern gibt SQLParamData nicht an, für welche Zeile des Arrays der Treiber Daten anfordert. Dies muss von der Anwendung übernommen werden.</span><span class="sxs-lookup"><span data-stu-id="11a45-183">As with all data-at-execution parameters, SQLParamData does not indicate which row of the array the driver is requesting data for; the application must take care of this.</span></span> <span data-ttu-id="11a45-184">Die Anwendung kann keine Annahmen über die Reihenfolge treffen, in der der Treiber Werte anfordert.</span><span class="sxs-lookup"><span data-stu-id="11a45-184">The application cannot make any assumptions about the order in which the driver will request values.</span></span>  
  
## <a name="variable-table-valued-parameter-row-binding"></a><span data-ttu-id="11a45-185">Variable Tabellenwertparameter-Zeilenbindung</span><span class="sxs-lookup"><span data-stu-id="11a45-185">Variable Table-Valued Parameter Row Binding</span></span>  
 <span data-ttu-id="11a45-186">Bei einer variablen Zeilenbildung werden die Zeilen zur Laufzeit in Batches übertragen, und die Anwendung übergibt die Zeilen bei Bedarf dem Treiber.</span><span class="sxs-lookup"><span data-stu-id="11a45-186">For variable row binding, rows are transferred in batches at execution time and the application passes rows to the driver on demand.</span></span> <span data-ttu-id="11a45-187">Dies ähnelt der Übergabe einzelner Werte für Data-at-Execution-Parameter zur Laufzeit.</span><span class="sxs-lookup"><span data-stu-id="11a45-187">This is similar to data-at-execution for individual parameter values.</span></span> <span data-ttu-id="11a45-188">Bei einer variablen Zeilenbindung geht die Anwendung wie folgt vor:</span><span class="sxs-lookup"><span data-stu-id="11a45-188">For variable row binding, the application does the following:</span></span>  
  
1.  <span data-ttu-id="11a45-189">Sie bindet Parameter und Tabellenwertparameter-Spalten wie in den Schritten 1 bis 3 im vorigen Abschnitt mit dem Titel "Feste Tabellenwertparameter-Zeilenbindung" beschrieben.</span><span class="sxs-lookup"><span data-stu-id="11a45-189">Binds parameters and table-valued parameter columns as described in steps 1 to 3 of the previous section, "Fixed Table-Valued Parameter Row Binding".</span></span>  
  
2.  <span data-ttu-id="11a45-190">Legt *StrLen_or_IndPtr* oder SQL_DESC_OCTET_LENGTH_PTR für Tabellenwert Parameter fest, die zur Ausführungszeit an SQL_DATA_AT_EXEC übermittelt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="11a45-190">Sets *StrLen_or_IndPtr* or SQL_DESC_OCTET_LENGTH_PTR for any table-valued parameters that are to be passed at execution time to SQL_DATA_AT_EXEC.</span></span> <span data-ttu-id="11a45-191">Wenn keiner dieser beiden Zeiger festgelegt wird, wird der Parameter wie im vorherigen Abschnitt beschrieben verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="11a45-191">If neither is set, the parameter will be processed as described in the previous section.</span></span>  
  
3.  <span data-ttu-id="11a45-192">Ruft SQLExecute oder SQLExecDirect auf.</span><span class="sxs-lookup"><span data-stu-id="11a45-192">Calls SQLExecute or SQLExecDirect.</span></span> <span data-ttu-id="11a45-193">Dieser Aufruf gibt SQL_NEED_DATA zurück, falls SQL_PARAM_INPUT- oder SQL_PARAM_INPUT_OUTPUT-Parameter als Data-at-Execution-Parameter behandelt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="11a45-193">This will return SQL_NEED_DATA if there are any SQL_PARAM_INPUT or SQL_PARAM_INPUT_OUTPUT parameters to be handled as data-at-execution parameters.</span></span> <span data-ttu-id="11a45-194">In diesem Fall geht die Anwendung wie folgt vor:</span><span class="sxs-lookup"><span data-stu-id="11a45-194">In this case, the application does the following:</span></span>  
  
    -   <span data-ttu-id="11a45-195">Ruft SQLParamData auf.</span><span class="sxs-lookup"><span data-stu-id="11a45-195">Calls SQLParamData.</span></span> <span data-ttu-id="11a45-196">Dadurch wird der *ParameterValuePtr* -Wert für einen Data-at-Execution-Parameter und der Rückgabecode SQL_NEED_DATA zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="11a45-196">This returns the *ParameterValuePtr* value for a data-at-execution parameter and a return code of SQL_NEED_DATA.</span></span> <span data-ttu-id="11a45-197">Wenn alle Parameterdaten an den Treiber übergeben wurden, gibt SQLParamData SQL_SUCCESS, SQL_SUCCESS_WITH_INFO oder SQL_ERROR zurück.</span><span class="sxs-lookup"><span data-stu-id="11a45-197">When all parameter data has been passed to the driver, SQLParamData returns SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, or SQL_ERROR.</span></span> <span data-ttu-id="11a45-198">Bei Data-at-Execution-Parametern kann *ParameterValuePtr*, das dem Deskriptorfeld SQL_DESC_DATA_PTR entspricht, als Token angesehen werden, um einen Parameter eindeutig zu identifizieren, für den ein Wert erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="11a45-198">For data-at-execution parameters, *ParameterValuePtr*, which is the same as the descriptor field SQL_DESC_DATA_PTR, can be regarded as a token to uniquely identify a parameter for which a value is required.</span></span> <span data-ttu-id="11a45-199">Dieses "Token" wird beim Binden von der Anwendung an den Treiber übergeben und während der Ausführung dann wieder an die Anwendung übergeben.</span><span class="sxs-lookup"><span data-stu-id="11a45-199">This "token" is passed from the application to the driver at bind time, then passed back to the application at execution time.</span></span>  
  
4.  <span data-ttu-id="11a45-200">Um Tabellenwert Parameter-Zeilendaten für NULL-Tabellenwert Parameter zu senden, ruft eine Anwendung SQLPutData auf, wenn der Tabellenwert Parameter keine Zeilen enthält, und *StrLen_Or_Ind* auf SQL_DEFAULT_PARAM festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="11a45-200">To send table-valued parameter row data for null table-valued parameters, if the table-valued parameter has no rows, an application calls SQLPutData with *StrLen_or_Ind* set to SQL_DEFAULT_PARAM.</span></span>  
  
     <span data-ttu-id="11a45-201">Bei Tabellenwertparametern, die nicht NULL sind, geht die Anwendung wie folgt vor:</span><span class="sxs-lookup"><span data-stu-id="11a45-201">For non-NULL TVPs, an application:</span></span>  
  
    -   <span data-ttu-id="11a45-202">Legt *Str_Len_or_Ind* für alle Tabellenwert Parameter-Spalten auf entsprechende Werte fest und füllt Datenpuffer für Tabellenwert Parameter-Spalten auf, bei denen es sich nicht um Data-at-Execution-Parameter handelt.</span><span class="sxs-lookup"><span data-stu-id="11a45-202">Sets *Str_Len_or_Ind* for all the table-valued parameter columns to appropriate values, and populates data buffers for table-valued parameter columns that are not to be data-at-execution parameters.</span></span> <span data-ttu-id="11a45-203">Tabellenwertparameter-Spalten können Daten zur Laufzeit auf ähnliche Weise übergeben werden wie dem Treiber gewöhnliche Parameter schrittweise übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="11a45-203">You can use data-at-execution for table-valued parameter columns in a similar way to that in which ordinary parameters can be passed to the driver in pieces.</span></span>  
  
    -   <span data-ttu-id="11a45-204">Ruft SQLPutData auf, wobei *Str_Len_or_Ind* auf die Anzahl der an den Server zu sendenden Zeilen festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="11a45-204">Calls SQLPutData with *Str_Len_or_Ind* set to the number of rows to be sent to the server.</span></span> <span data-ttu-id="11a45-205">Werte, die nicht im Bereich von 0 bis SQL_DESC_ARRAY_SIZE oder SQL_DEFAULT_PARAM liegen, sind ungültig und bewirken die Rückgabe von SQLSTATE HY090 und der Meldung "Ungültige Zeichenfolgen- oder Pufferlänge".</span><span class="sxs-lookup"><span data-stu-id="11a45-205">Any value outside the range 0 to SQL_DESC_ARRAY_SIZE or SQL_DEFAULT_PARAM is an error, and will return SQLSTATE HY090, with the message "Invalid string or buffer length".</span></span> <span data-ttu-id="11a45-206">Mit 0 wird angegeben, dass alle Zeilen übermittelt wurden und dass keine weiteren Daten für einen Tabellenwertparameter vorliegen (wie im zweiten Aufzählungspunkt dieser Auflistung beschrieben).</span><span class="sxs-lookup"><span data-stu-id="11a45-206">0 indicates that all rows have been sent and there is no more data for a table-valued parameter (as noted in the second bullet item in this list).</span></span> <span data-ttu-id="11a45-207">SQL_DEFAULT_PARAM kann nur verwendet werden, wenn der Treiber zum ersten Mal Daten für einen Tabellenwertparameter anfordert (wie im ersten Aufzählungspunkt dieser Auflistung beschrieben).</span><span class="sxs-lookup"><span data-stu-id="11a45-207">SQL_DEFAULT_PARAM can only be used the first time the driver requests data for a table-valued parameter (as described in the first bullet item in this list).</span></span>  
  
5.  <span data-ttu-id="11a45-208">Wenn alle Zeilen gesendet wurden, wird SQLPutData für den Tabellenwert Parameter mit einem *Str_Len_or_Ind* Wert von 0 aufgerufen. Anschließend wird mit Schritt 3a weiter oben fortgefahren.</span><span class="sxs-lookup"><span data-stu-id="11a45-208">When all rows have been sent, calls SQLPutData for the table-valued parameter with a *Str_Len_or_Ind* value of 0, then proceeds to step 3a above.</span></span>  
  
6.  <span data-ttu-id="11a45-209">Ruft SQLParamData erneut auf.</span><span class="sxs-lookup"><span data-stu-id="11a45-209">Calls SQLParamData again.</span></span> <span data-ttu-id="11a45-210">Wenn unter den Tabellenwert Parameter-Spalten Data-at-Execution-Parameter vorhanden sind, werden diese durch den Wert *ValuePtrPtr* identifiziert, der von SQLParamData zurückgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="11a45-210">If there are any data-at-execution parameters among the table-valued parameter columns, these will be identified by the value *ValuePtrPtr* returned by SQLParamData.</span></span> <span data-ttu-id="11a45-211">Wenn alle Spaltenwerte verfügbar sind, gibt SQLParamData den *ParameterValuePtr* -Wert für den Tabellenwert Parameter zurück, und die Anwendung wird erneut gestartet.</span><span class="sxs-lookup"><span data-stu-id="11a45-211">When all column values are available, SQLParamData will again return the *ParameterValuePtr* value for the table-valued parameter, and the application begins again.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="11a45-212">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="11a45-212">See Also</span></span>  
 [<span data-ttu-id="11a45-213">Tabellenwert Parameter &#40;ODBC-&#41;</span><span class="sxs-lookup"><span data-stu-id="11a45-213">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  

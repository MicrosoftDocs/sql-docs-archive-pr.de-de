---
title: Tabellenwert Parameter-Deskriptorfelder | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), descriptor fields
ms.assetid: 4e009eff-c156-4d63-abcf-082ddd304de2
author: rothja
ms.author: jroth
ms.openlocfilehash: 5365229aed0bc46315a7e6db5448bee6963b23fc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87698145"
---
# <a name="table-valued-parameter-descriptor-fields"></a><span data-ttu-id="e400e-102">Deskriptorfelder für Tabellenwertparameter</span><span class="sxs-lookup"><span data-stu-id="e400e-102">Table-Valued Parameter Descriptor Fields</span></span>
  <span data-ttu-id="e400e-103">Die Unterstützung für Tabellenwertparameter bietet neue, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-spezifische Felder in ODBC-Anwendungsparameterdeskriptoren (Application Parameter Descriptor, APD) und Implementierungsparameterdeskriptoren (Implementation Parameter Descriptor, IPD).</span><span class="sxs-lookup"><span data-stu-id="e400e-103">Support for table-valued parameters includes new [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-specific fields in ODBC application parameter descriptors (APDs) and implementation parameter descriptors (IPDs).</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="e400e-104">Bemerkungen</span><span class="sxs-lookup"><span data-stu-id="e400e-104">Remarks</span></span>  
  
|<span data-ttu-id="e400e-105">Name</span><span class="sxs-lookup"><span data-stu-id="e400e-105">Name</span></span>|<span data-ttu-id="e400e-106">Standort</span><span class="sxs-lookup"><span data-stu-id="e400e-106">Location</span></span>|<span data-ttu-id="e400e-107">type</span><span class="sxs-lookup"><span data-stu-id="e400e-107">Type</span></span>|<span data-ttu-id="e400e-108">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="e400e-108">Description</span></span>|  
|----------|--------------|----------|-----------------|  
|<span data-ttu-id="e400e-109">SQL_CA_SS_TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="e400e-109">SQL_CA_SS_TYPE_NAME</span></span>|<span data-ttu-id="e400e-110">IPD</span><span class="sxs-lookup"><span data-stu-id="e400e-110">IPD</span></span>|<span data-ttu-id="e400e-111">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="e400e-111">SQLTCHAR\*</span></span>|<span data-ttu-id="e400e-112">Der Servertypname des Tabellenwertparameters.</span><span class="sxs-lookup"><span data-stu-id="e400e-112">The server type name of the table-valued parameter.</span></span><br /><br /> <span data-ttu-id="e400e-113">Wenn ein Tabellenwert Parameter-Typname für einen SQLBindParameter-Befehl angegeben wird, muss er immer als Unicode-Wert angegeben werden, auch in Anwendungen, die als ANSI-Anwendungen erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="e400e-113">When a table-valued parameter type name is specified on a call to SQLBindParameter, it must always be specified as a Unicode value, even in applications that are built as ANSI applications.</span></span> <span data-ttu-id="e400e-114">Der für den Parameter *StrLen_or_IndPtr* verwendete Wert muss entweder SQL_NTS oder die Zeichen folgen Länge des Namens multipliziert mit sizeof (WChar) sein.</span><span class="sxs-lookup"><span data-stu-id="e400e-114">The value used for the parameter *StrLen_or_IndPtr* should be either SQL_NTS or the string length of the name multiplied by sizeof(WCHAR).</span></span><br /><br /> <span data-ttu-id="e400e-115">Wenn ein Tabellenwert Parameter-Typname über SQLSetDescField angegeben wird, kann er mit einem Literalwert angegeben werden, der der Art und Weise entspricht, in der die Anwendung erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="e400e-115">When a table-valued parameter type name is specified via SQLSetDescField, it can be specified by using a literal that conforms to the way the application is built.</span></span> <span data-ttu-id="e400e-116">Der ODBC-Treiber-Manager führt die eventuell erforderliche Unicode-Konvertierung aus.</span><span class="sxs-lookup"><span data-stu-id="e400e-116">The ODBC Driver Manager will perform any required Unicode conversion.</span></span>|  
|<span data-ttu-id="e400e-117">SQL_CA_SS_TYPE_CATALOG_NAME (schreibgeschützt)</span><span class="sxs-lookup"><span data-stu-id="e400e-117">SQL_CA_SS_TYPE_CATALOG_NAME (read only)</span></span>|<span data-ttu-id="e400e-118">IPD</span><span class="sxs-lookup"><span data-stu-id="e400e-118">IPD</span></span>|<span data-ttu-id="e400e-119">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="e400e-119">SQLTCHAR\*</span></span>|<span data-ttu-id="e400e-120">Der Katalog, in dem der Typ definiert ist.</span><span class="sxs-lookup"><span data-stu-id="e400e-120">The catalog where the type is defined.</span></span>|  
|<span data-ttu-id="e400e-121">SQL_CA_SS_TYPE_SCHEMA_NAME</span><span class="sxs-lookup"><span data-stu-id="e400e-121">SQL_CA_SS_TYPE_SCHEMA_NAME</span></span>|<span data-ttu-id="e400e-122">IPD</span><span class="sxs-lookup"><span data-stu-id="e400e-122">IPD</span></span>|<span data-ttu-id="e400e-123">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="e400e-123">SQLTCHAR\*</span></span>|<span data-ttu-id="e400e-124">Das Schema, in dem der Typ definiert ist.</span><span class="sxs-lookup"><span data-stu-id="e400e-124">The schema where the type is defined.</span></span>|  
  
 <span data-ttu-id="e400e-125">Anwendungen dürfen für Tabellenwertparameter SQL_CA_SS_TYPE_CATALOG_NAME nicht festlegen.</span><span class="sxs-lookup"><span data-stu-id="e400e-125">Applications must not set SQL_CA_SS_TYPE_CATALOG_NAME for table-valued parameters.</span></span> <span data-ttu-id="e400e-126">Andernfalls werden ein SQL_ERROR und ein Diagnosedatensatz mit SQLSTATE = HY091 und der Meldung "Ungültiger Deskriptorfeldbezeichner" zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="e400e-126">Doing so will return a SQL_ERROR and log a diagnostic record with SQLSTATE = HY091 and the message "Invalid descriptor field identifier".</span></span>  
  
 <span data-ttu-id="e400e-127">Die folgenden Anweisungsattribute und Deskriptorheaderfelder gelten für Tabellenwertparameter, wenn der Parameterfokus auf einen Tabellenwertparameter festgelegt ist:</span><span class="sxs-lookup"><span data-stu-id="e400e-127">The following statement attributes and descriptor header fields apply to table-valued parameters when the parameter focus is set to a table-valued parameter:</span></span>  
  
|<span data-ttu-id="e400e-128">Name</span><span class="sxs-lookup"><span data-stu-id="e400e-128">Name</span></span>|<span data-ttu-id="e400e-129">Standort</span><span class="sxs-lookup"><span data-stu-id="e400e-129">Location</span></span>|<span data-ttu-id="e400e-130">type</span><span class="sxs-lookup"><span data-stu-id="e400e-130">Type</span></span>|<span data-ttu-id="e400e-131">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="e400e-131">Description</span></span>|  
|----------|--------------|----------|-----------------|  
|<span data-ttu-id="e400e-132">SQL_ATTR_PARAMSET_SIZE</span><span class="sxs-lookup"><span data-stu-id="e400e-132">SQL_ATTR_PARAMSET_SIZE</span></span><br /><br /> <span data-ttu-id="e400e-133">(Dies entspricht SQL_DESC_ARRAY_SIZE im APD.)</span><span class="sxs-lookup"><span data-stu-id="e400e-133">(This is equivalent to SQL_DESC_ARRAY_SIZE in the APD.)</span></span>|<span data-ttu-id="e400e-134">APD</span><span class="sxs-lookup"><span data-stu-id="e400e-134">APD</span></span>|<span data-ttu-id="e400e-135">SQLUINTEGER</span><span class="sxs-lookup"><span data-stu-id="e400e-135">SQLUINTEGER</span></span>|<span data-ttu-id="e400e-136">Die Arraygröße der Pufferarrays für einen Tabellenwertparameter.</span><span class="sxs-lookup"><span data-stu-id="e400e-136">The array size of the buffer arrays for a table-valued parameter.</span></span> <span data-ttu-id="e400e-137">Dies entspricht der maximalen Anzahl an Zeilen, die die Puffer enthalten können, oder der Größe der Puffer in Zeilen ausgedrückt. Der Wert des Tabellenwertparameters selbst kann darüber- oder darunterliegen.</span><span class="sxs-lookup"><span data-stu-id="e400e-137">This is the maximum number of rows the buffers will accommodate or the size of the buffers in rows; the table-valued parameter value itself might have more or fewer rows than the buffers can hold.</span></span> <span data-ttu-id="e400e-138">Der Standardwert ist 1.</span><span class="sxs-lookup"><span data-stu-id="e400e-138">Default is 1.</span></span> <span data-ttu-id="e400e-139">**Hinweis:**  Wenn SQL_SOPT_SS_PARAM_FOCUS auf den Standardwert 0 festgelegt ist, verweist SQL_ATTR_PARAMSET_SIZE auf die-Anweisung und gibt die Anzahl der Parametersätze an.</span><span class="sxs-lookup"><span data-stu-id="e400e-139">**Note:**  If SQL_SOPT_SS_PARAM_FOCUS is set to its default value of 0, SQL_ATTR_PARAMSET_SIZE refers to the statement and specifies the number of parameter sets.</span></span> <span data-ttu-id="e400e-140">Wenn SQL_SOPT_SS_PARAM_FOCUS auf die Ordnungszahl eines Tabellenwertparameters festgelegt ist, verweist das Attribut auf den Tabellenwertparameter und gibt die Anzahl der Zeilen pro Parameterset des Tabellenwertparameters an.</span><span class="sxs-lookup"><span data-stu-id="e400e-140">If SQL_SOPT_SS_PARAM_FOCUS is set to the ordinal of a table-valued parameter, it refers to the table-valued parameter and specifies the number of rows per parameter set for the table-valued parameter.</span></span>|  
|<span data-ttu-id="e400e-141">SQL_ATTR_PARAM _BIND_TYPE</span><span class="sxs-lookup"><span data-stu-id="e400e-141">SQL_ATTR_PARAM _BIND_TYPE</span></span>|<span data-ttu-id="e400e-142">APD</span><span class="sxs-lookup"><span data-stu-id="e400e-142">APD</span></span>|<span data-ttu-id="e400e-143">SQLINTEGER</span><span class="sxs-lookup"><span data-stu-id="e400e-143">SQLINTEGER</span></span>|<span data-ttu-id="e400e-144">Der Standard ist SQL_PARAM_BIND_BY_COLUMN.</span><span class="sxs-lookup"><span data-stu-id="e400e-144">The default is SQL_PARAM_BIND_BY_COLUMN.</span></span><br /><br /> <span data-ttu-id="e400e-145">Zum Auswählen der zeilenbezogenen Bindung wird dieses Feld auf die Länge der Struktur oder die Instanz eines Puffers festgelegt, der an einen Satz von Tabellenwert-Parameterzeilen gebunden wird.</span><span class="sxs-lookup"><span data-stu-id="e400e-145">To select row-wise binding, this field is set to the length of the structure or an instance of a buffer that will be bound to a set of table-valued parameter rows.</span></span> <span data-ttu-id="e400e-146">Die Längenangabe muss Platz für alle gebundenen Spalten und möglicherweise vorhandene Auffüllzeichen der Struktur bzw. des Puffers vorsehen.</span><span class="sxs-lookup"><span data-stu-id="e400e-146">This length must include space for all of the bound columns and any padding of the structure or buffer.</span></span> <span data-ttu-id="e400e-147">Auf diese Weise wird sichergestellt, dass bei einer um eine angegebene Länge inkrementierten Adresse einer gebundenen Spalte das Ergebnis auf den Anfang derselben Spalte in der nächsten Zeile zeigt.</span><span class="sxs-lookup"><span data-stu-id="e400e-147">This ensures that when the address of a bound column is incremented with the specified length, the result will point to the beginning of the same column in the next row.</span></span> <span data-ttu-id="e400e-148">Wenn Sie den `sizeof`-Operator in ANSI C verwenden, wird dieses Verhalten garantiert.</span><span class="sxs-lookup"><span data-stu-id="e400e-148">When using the `sizeof` operator in ANSI C, this behavior is guaranteed.</span></span>|  
|<span data-ttu-id="e400e-149">SQL_ATTR_PARAM_BIND_OFFSET_PTR</span><span class="sxs-lookup"><span data-stu-id="e400e-149">SQL_ATTR_PARAM_BIND_OFFSET_PTR</span></span>|<span data-ttu-id="e400e-150">APD</span><span class="sxs-lookup"><span data-stu-id="e400e-150">APD</span></span>|<span data-ttu-id="e400e-151">SQLINTEGER\*</span><span class="sxs-lookup"><span data-stu-id="e400e-151">SQLINTEGER\*</span></span>|<span data-ttu-id="e400e-152">Der Standardwert ist ein NULL-Zeiger.</span><span class="sxs-lookup"><span data-stu-id="e400e-152">The default is a null pointer.</span></span><br /><br /> <span data-ttu-id="e400e-153">Wenn dieses Feld nicht NULL ist, hebt der Treiber den Verweis auf den Zeiger auf, fügt den verweislosen Wert jedem der zurückgestellten Felder im Deskriptordatensatz (SQL_DESC_DATA_PTR, SQL_DESC_INDICATOR_PTR und SQL_DESC_OCTET_LENGTH_PTR) hinzu und verwendet die neuen Zeigerwerte, um auf die Datenwerte zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="e400e-153">If this field is non-null, the driver dereferences the pointer, adds the dereferenced value to each of the deferred fields in the descriptor record (SQL_DESC_DATA_PTR, SQL_DESC_INDICATOR_PTR, and SQL_DESC_OCTET_LENGTH_PTR), and uses the new pointer values to access data values.</span></span>|  
  
 <span data-ttu-id="e400e-154">Diese Felder sind nur mit Tabellenwertparametern gültig und werden für andere Datentypen ignoriert.</span><span class="sxs-lookup"><span data-stu-id="e400e-154">These fields are only valid with table-valued parameters, and are ignored for other data types.</span></span>  
  
 <span data-ttu-id="e400e-155">SQL_CA_SS_TYPE_NAME ist für Aufrufe von gespeicherten Prozeduren optional.</span><span class="sxs-lookup"><span data-stu-id="e400e-155">SQL_CA_SS_TYPE_NAME is optional for stored procedure calls.</span></span> <span data-ttu-id="e400e-156">SQL_CA_SS_TYPE_NAME muss für SQL-Anweisungen angegeben werden, die keine Prozeduraufrufe sind, damit der Server den Typ des Tabellenwertparameters ermitteln kann.</span><span class="sxs-lookup"><span data-stu-id="e400e-156">It must be specified for SQL statements that are not procedure calls to enable the server to determine the type of the table-valued parameter.</span></span>  
  
 <span data-ttu-id="e400e-157">Wenn der Name des Typs erforderlich ist und der Tabellentyp des Tabellenwertparameters in einem anderen Schema definiert ist als die gespeicherte Prozedur, muss SQL_CA_SS_TYPE_SCHEMA_NAME im Implementierungsparameterdeskriptor (Implementation Parameter Descriptor, IPD) angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="e400e-157">If the type name is reqired and the table type for the table-valued parameter is defined in a different schema than the stored procedure, SQL_CA_SS_TYPE_SCHEMA_NAME must be specified in the implementation parameter descriptor (IPD).</span></span> <span data-ttu-id="e400e-158">Andernfalls ist der Server nicht in der Lage, den Typ des Tabellenwertparameters zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="e400e-158">If not, the server will not be able to determine the type of the table-valued parameter.</span></span> <span data-ttu-id="e400e-159">Dies führt zu einem Fehler, wenn Sie SQLExecute oder SQLExecDirect aufgerufen haben.</span><span class="sxs-lookup"><span data-stu-id="e400e-159">This will result in an error when you call SQLExecute or SQLExecDirect.</span></span> <span data-ttu-id="e400e-160">Der Fehler ist SQLSTATE = 07006 und enthält die Meldung "Attributverletzung beschränkter Datentypen".</span><span class="sxs-lookup"><span data-stu-id="e400e-160">The error will have SQLSTATE= 07006 and the message "Restricted data type attribute violation".</span></span>  
  
 <span data-ttu-id="e400e-161">Tabellenwert-Parameterspalten können entweder zeilenweise oder spaltenweise Bindungen verwenden.</span><span class="sxs-lookup"><span data-stu-id="e400e-161">Table-valued parameter columns can use either row-wise or column-wise binding.</span></span> <span data-ttu-id="e400e-162">Der Standard ist die spaltenweise Bindung.</span><span class="sxs-lookup"><span data-stu-id="e400e-162">The default is column-wise binding.</span></span> <span data-ttu-id="e400e-163">Die Zeilenweise Bindung kann angegeben werden, indem SQL_ATTR_PARAM_BIND_TYPE und SQL_ATTR_ PARAM_BIND_OFFSET_PTR festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="e400e-163">Row-wise binding can be specified by setting SQL_ATTR_PARAM_BIND_TYPE and SQL_ATTR_ PARAM_BIND_OFFSET_PTR.</span></span> <span data-ttu-id="e400e-164">Dies entspricht der zeilenweisen Bindung von Spalten und Parametern.</span><span class="sxs-lookup"><span data-stu-id="e400e-164">This is analogous to row-wise binding of columns and parameters.</span></span>  
  
 <span data-ttu-id="e400e-165">SQL_CA_SS_TYPE_CATALOG_NAME und SQL_CA_SS_TYPE_SCHEMA_NAME können auch verwendet werden, um den Katalog und das Schema abzurufen, die mit Parametern des CLR-benutzerdefinierten Typs verbunden sind.</span><span class="sxs-lookup"><span data-stu-id="e400e-165">SQL_CA_SS_TYPE_CATALOG_NAME and SQL_CA_SS_TYPE_SCHEMA_NAME can also be used to retrieve the catalog and schema associated with CLR user-defined type parameters.</span></span> <span data-ttu-id="e400e-166">Dabei handelt es sich um Alternativen zu den vorhandenen typspezifischen Katalogschemaattributen für diese Typen.</span><span class="sxs-lookup"><span data-stu-id="e400e-166">These are alternatives to the existing type specific catalog schema attributes for these types.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e400e-167">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="e400e-167">See Also</span></span>  
 [<span data-ttu-id="e400e-168">Tabellenwert Parameter &#40;ODBC-&#41;</span><span class="sxs-lookup"><span data-stu-id="e400e-168">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  

---
title: Datenbank-Engine-Skripterstellung
ms.custom: seo-lt-2019
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
helpviewer_keywords:
- scripts [SQL Server], PowerShell
- scripts [SQL Server]
- scripting [SQL Server Database Engine]
- scripting [SQL Server Database Engine], PowerShell
ms.assetid: 9978a884-59a2-4e7f-a82a-335149f3a261
author: rothja
ms.author: jroth
ms.openlocfilehash: 79dca27e2aa5f2c0bc473534e0a8b204345b3993
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87607626"
---
# <a name="database-engine-scripting"></a><span data-ttu-id="a5ec2-102">Datenbank-Engine-Skripterstellung</span><span class="sxs-lookup"><span data-stu-id="a5ec2-102">Database Engine Scripting</span></span>
  <span data-ttu-id="a5ec2-103">[!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] unterstützt die [!INCLUDE[msCoName](../../includes/msconame-md.md)] -PowerShell-Skriptumgebung zum Verwalten der Instanzen von [!INCLUDE[ssDE](../../includes/ssde-md.md)] und der Objekte in den Instanzen.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-103">The [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] supports the [!INCLUDE[msCoName](../../includes/msconame-md.md)] PowerShell scripting environment to manage instances of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] and the objects in the instances.</span></span> <span data-ttu-id="a5ec2-104">Sie können zudem [!INCLUDE[ssDE](../../includes/ssde-md.md)] -Abfragen mit [!INCLUDE[tsql](../../includes/tsql-md.md)] und XQuery in Umgebungen erstellen und ausführen, die mit Skriptumgebungen vergleichbar sind.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-104">You can also build and run [!INCLUDE[ssDE](../../includes/ssde-md.md)] queries that contain [!INCLUDE[tsql](../../includes/tsql-md.md)] and XQuery in environments very similar to scripting environments.</span></span>  
  
## <a name="sql-server-powershell"></a><span data-ttu-id="a5ec2-105">SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="a5ec2-105">SQL Server PowerShell</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a5ec2-106">enthält zwei [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -PowerShell-Snap-Ins, die Folgendes implementieren:</span><span class="sxs-lookup"><span data-stu-id="a5ec2-106">includes two [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell snap-ins that implement:</span></span>  
  
-   <span data-ttu-id="a5ec2-107">Einen [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -PowerShell-Anbieter, der die Hierarchien von [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Verwaltungsobjektmodellen als PowerShell-Pfade verfügbar macht, die den Dateisystempfaden ähneln.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-107">A [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell provider that exposes the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] management object model hierarchies as PowerShell paths that are similar to file system paths.</span></span> <span data-ttu-id="a5ec2-108">Sie können mithilfe der Klassen des [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Verwaltungsobjektmodells die Objekte verwalten, die an jedem Knoten des Pfads dargestellt werden.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-108">You can use the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] management object model classes to manage the objects represented at each node of the path.</span></span>  
  
-   <span data-ttu-id="a5ec2-109">Einen Satz von [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Cmdlets, die [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Befehle implementieren.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-109">A set of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cmdlets that implement [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] commands.</span></span> <span data-ttu-id="a5ec2-110">Eines der Cmdlets ist **Invoke-Sqlcmd**.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-110">One of the cmdlets is **Invoke-Sqlcmd**.</span></span> <span data-ttu-id="a5ec2-111">Dies wird zum Ausführen von [!INCLUDE[ssDE](../../includes/ssde-md.md)] Abfrage Skripts verwendet, die mit dem `sqlcmd` Hilfsprogramm ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-111">This is used to run [!INCLUDE[ssDE](../../includes/ssde-md.md)] Query scripts to be run with the `sqlcmd` utility.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a5ec2-112">stellt diese Funktionen zum Ausführen von PowerShell bereit:</span><span class="sxs-lookup"><span data-stu-id="a5ec2-112">provides these features for running PowerShell:</span></span>  
  
-   <span data-ttu-id="a5ec2-113">Das **sqlps** -PowerShell-Modul, das in eine PowerShell-Sitzung importiert werden kann; das Modul lädt dann die [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Snap-Ins. Sie können PowerShell-Befehle interaktiv ad hoc ausführen.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-113">The **sqlps** PowerShell module that can be imported to a PowerShell session, the module then loads the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] snap-ins. You can interactively run ad hoc PowerShell commands.</span></span> <span data-ttu-id="a5ec2-114">Sie können Skriptdateien mit einem Befehl wie .\MyFolder\MyScript.ps1 ausführen.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-114">You can run script files using a command such as .\MyFolder\MyScript.ps1.</span></span>  
  
-   <span data-ttu-id="a5ec2-115">PowerShell-Skriptdateien können als Eingabe in die PowerShell-Auftragsschritte des [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Agents verwendet werden, mit denen die Skripts entweder in Zeitabständen nach einem Zeitplan oder als Reaktion auf Systemereignisse ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-115">PowerShell script files can be used as input to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent PowerShell job steps that run the scripts either at scheduled intervals or in response to system events.</span></span>  
  
-   <span data-ttu-id="a5ec2-116">Das **sqlps** -Hilfsprogramm, das PowerShell startet und das [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Modul importiert.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-116">The **sqlps** utility that starts PowerShell and imports the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] module.</span></span> <span data-ttu-id="a5ec2-117">Sie können dann alle vom Modul unterstützten Aktionen ausführen.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-117">You can then perform all actions supported by the module.</span></span> <span data-ttu-id="a5ec2-118">Sie können das **sqlps** -Hilfsprogramm an einer Eingabeaufforderung starten oder indem Sie mit der rechten Maustaste auf die Knoten in der Struktur des Objekt-Explorers von [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Management Studio klicken und **PowerShell starten**auswählen.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-118">You can start the **sqlps** utility either in a command prompt or by right-clicking on the nodes in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Management Studio Object Explorer tree and selecting **Start PowerShell**.</span></span>  
  
## <a name="database-engine-queries"></a><span data-ttu-id="a5ec2-119">Datenbank-Engine-Abfragen</span><span class="sxs-lookup"><span data-stu-id="a5ec2-119">Database Engine Queries</span></span>  
 [!INCLUDE[ssDE](../../includes/ssde-md.md)] <span data-ttu-id="a5ec2-120">-Abfrageskripts enthalten drei Typen von Elementen:</span><span class="sxs-lookup"><span data-stu-id="a5ec2-120">query scripts contain three types of elements:</span></span>  
  
-   [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="a5ec2-121">-Sprachanweisungen</span><span class="sxs-lookup"><span data-stu-id="a5ec2-121">language statements.</span></span>  
  
-   <span data-ttu-id="a5ec2-122">XQuery-Sprachanweisungen</span><span class="sxs-lookup"><span data-stu-id="a5ec2-122">XQuery language statements</span></span>  
  
-   <span data-ttu-id="a5ec2-123">Befehle und Variablen aus dem- `sqlcmd` Hilfsprogramm.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-123">Commands and variables from the `sqlcmd` utility.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a5ec2-124">stellt drei Umgebungen zum Erstellen und Ausführen von [!INCLUDE[ssDE](../../includes/ssde-md.md)] -Abfragen:</span><span class="sxs-lookup"><span data-stu-id="a5ec2-124">provides three environments for building and running [!INCLUDE[ssDE](../../includes/ssde-md.md)] queries:</span></span>  
  
-   <span data-ttu-id="a5ec2-125">Sie können [!INCLUDE[ssDE](../../includes/ssde-md.md)] -Abfragen im [!INCLUDE[ssDE](../../includes/ssde-md.md)] -Abfrage-Editor in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]interaktiv ausführen und debuggen.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-125">You can interactively run and debug [!INCLUDE[ssDE](../../includes/ssde-md.md)] queries in the [!INCLUDE[ssDE](../../includes/ssde-md.md)] Query Editor in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="a5ec2-126">Sie können eine Reihe von Anweisungen in einer Sitzung codieren und debuggen und anschließend alle Anweisungen in einer Skriptdatei speichern.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-126">You can code and debug several statements in one session, then save all of the statements in a single script file.</span></span>  
  
-   <span data-ttu-id="a5ec2-127">Mit dem Eingabeaufforderungs `sqlcmd` -Hilfsprogramm können Sie Abfragen interaktiv ausführen [!INCLUDE[ssDE](../../includes/ssde-md.md)] und vorhandene [!INCLUDE[ssDE](../../includes/ssde-md.md)] Abfrage Skriptdateien ausführen.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-127">The `sqlcmd` command prompt utility lets you interactively run [!INCLUDE[ssDE](../../includes/ssde-md.md)] queries, and also run existing [!INCLUDE[ssDE](../../includes/ssde-md.md)] query script files.</span></span>  
  
 [!INCLUDE[ssDE](../../includes/ssde-md.md)] <span data-ttu-id="a5ec2-128">-Abfrageskriptdateien werden i. d. R. mit dem [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] -Abfrage-Editor in [!INCLUDE[ssDE](../../includes/ssde-md.md)] interaktiv codiert.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-128">query script files are typically coded interactively in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] by using the [!INCLUDE[ssDE](../../includes/ssde-md.md)] Query Editor.</span></span> <span data-ttu-id="a5ec2-129">Die Datei kann später in einer dieser Umgebungen geöffnet werden:</span><span class="sxs-lookup"><span data-stu-id="a5ec2-129">The file can later be opened in one of these environments:</span></span>  
  
-   <span data-ttu-id="a5ec2-130">Verwenden Sie das [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]-Menü **Datei**/**Öffnen**, um die Datei in einem neuen [!INCLUDE[ssDE](../../includes/ssde-md.md)]-Abfrage-Editorfenster zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-130">Use the [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] **File**/**Open** menu to open the file in a new [!INCLUDE[ssDE](../../includes/ssde-md.md)] Query Editor window.</span></span>  
  
-   <span data-ttu-id="a5ec2-131">Verwenden Sie den Parameter **-i**_input_file_ , um die Datei mit dem `sqlcmd` Hilfsprogramm auszuführen.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-131">Use the **-i**_input_file_ parameter to run the file with the `sqlcmd` utility.</span></span>  
  
-   <span data-ttu-id="a5ec2-132">Verwenden Sie den **-QueryFromFile** -Parameter, um die Datei mit dem **Invoke-Sqlcmd** -Cmdlet in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -PowerShell-Skripts auszuführen.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-132">Use the **-QueryFromFile** parameter to run the file with the **Invoke-Sqlcmd** cmdlet in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell scripts.</span></span>  
  
-   <span data-ttu-id="a5ec2-133">Führen Sie die Skripts mit den [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Auftragsschritten des [!INCLUDE[tsql](../../includes/tsql-md.md)] -Agents entweder in Zeitabständen nach einem Zeitplan oder als Reaktion auf Systemereignisse aus.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-133">Use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent [!INCLUDE[tsql](../../includes/tsql-md.md)] job steps to run the scripts either at scheduled intervals or in response to system events.</span></span>  
  
 <span data-ttu-id="a5ec2-134">Außerdem können Sie mithilfe des Assistenten zum Generieren von Skripts in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[tsql](../../includes/tsql-md.md)] -Skripts generieren.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-134">In addition, you can use the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Generate Script Wizard to generate [!INCLUDE[tsql](../../includes/tsql-md.md)] scripts.</span></span> <span data-ttu-id="a5ec2-135">Sie können mit der rechten Maustaste im [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] -Objekt-Explorer auf Objekte klicken und anschließend das Menüelement **Skript generieren** auswählen.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-135">You can right-click objects in the [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] Object Explorer, then select the **Generate Script** menu item.</span></span> <span data-ttu-id="a5ec2-136">Mit**Skript generieren** wird der Assistent gestartet, der Sie durch den Vorgang der Skripterstellung führt.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-136">**Generate Script** launches the wizard, which guides you through the process of creating a script.</span></span>  
  
## <a name="database-engine-scripting-tasks"></a><span data-ttu-id="a5ec2-137">Tasks der Datenbank-Engine-Skripterstellung</span><span class="sxs-lookup"><span data-stu-id="a5ec2-137">Database Engine Scripting Tasks</span></span>  
  
|<span data-ttu-id="a5ec2-138">Taskbeschreibung</span><span class="sxs-lookup"><span data-stu-id="a5ec2-138">Task Description</span></span>|<span data-ttu-id="a5ec2-139">Thema</span><span class="sxs-lookup"><span data-stu-id="a5ec2-139">Topic</span></span>|  
|----------------------|-----------|  
|<span data-ttu-id="a5ec2-140">Beschreibt, wie die Code- und Text-Editoren in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] zum interaktiven Entwickeln, Debuggen und Ausführen von [!INCLUDE[tsql](../../includes/tsql-md.md)] -Skripts verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-140">Describes how to use the code and text editors in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] to interactively develop, debug, and run [!INCLUDE[tsql](../../includes/tsql-md.md)] scripts</span></span>|[<span data-ttu-id="a5ec2-141">Abfrage- und Text-Editoren &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="a5ec2-141">Query and Text Editors &#40;SQL Server Management Studio&#41;</span></span>](../scripting/query-and-text-editors-sql-server-management-studio.md)|  
|<span data-ttu-id="a5ec2-142">Beschreibt, wie das Hilfsprogramm `sqlcmd` zum Ausführen von [!INCLUDE[tsql](../../includes/tsql-md.md)]-Skripts über die Eingabeaufforderung verwendet wird, einschließlich der Möglichkeit zum interaktiven Entwickeln von Skripts.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-142">Describes how to use the `sqlcmd` utility to run [!INCLUDE[tsql](../../includes/tsql-md.md)] scripts from the command prompt, including the ability to interactively develop scripts.</span></span>|[<span data-ttu-id="a5ec2-143">Themen zur Vorgehensweise für sqlcmd</span><span class="sxs-lookup"><span data-stu-id="a5ec2-143">sqlcmd How-to Topics</span></span>](../../database-engine/sqlcmd-how-to-topics.md)|  
|<span data-ttu-id="a5ec2-144">Beschreibt, wie die SQL Server-Komponenten in eine Windows PowerShell 2.0-Umgebung integriert und anschließend PowerShell-Skripts für die Verwaltung von SQL Server-Instanzen und -Objekten erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-144">Describes how to integrate the SQL Server components into a Windows PowerShell 2.0 environment and then build PowerShell scripts for managing SQL Server instances and objects.</span></span>|[<span data-ttu-id="a5ec2-145">SQL Server-PowerShell</span><span class="sxs-lookup"><span data-stu-id="a5ec2-145">SQL Server PowerShell</span></span>](../../powershell/sql-server-powershell.md)|  
|<span data-ttu-id="a5ec2-146">Beschreibt, wie mit dem **Assistenten zum Generieren und Veröffentlichen von Skripts**[!INCLUDE[tsql](../../includes/tsql-md.md)] -Skripts erstellt werden, mit denen Objekte aus einer Datenbank erneut erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="a5ec2-146">Describes how to use the **Generate and Publish Scripts** wizard to create [!INCLUDE[tsql](../../includes/tsql-md.md)] scripts that recreate one or more of the objects from a database.</span></span>|[<span data-ttu-id="a5ec2-147">Erstellen von Skripts &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="a5ec2-147">Generate Scripts &#40;SQL Server Management Studio&#41;</span></span>](generate-scripts-sql-server-management-studio.md)|  
  
## <a name="see-also"></a><span data-ttu-id="a5ec2-148">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="a5ec2-148">See Also</span></span>  
 <span data-ttu-id="a5ec2-149">[sqlcmd (Hilfsprogramm)](../../tools/sqlcmd-utility.md) </span><span class="sxs-lookup"><span data-stu-id="a5ec2-149">[sqlcmd Utility](../../tools/sqlcmd-utility.md) </span></span>  
 [<span data-ttu-id="a5ec2-150">Tutorial: Schreiben von Transact-SQL-Anweisungen</span><span class="sxs-lookup"><span data-stu-id="a5ec2-150">Tutorial: Writing Transact-SQL Statements</span></span>](../../t-sql/tutorial-writing-transact-sql-statements.md)  
  
  

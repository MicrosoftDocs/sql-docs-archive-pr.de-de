---
title: Konzepte für Replikationsverwaltungsobjekte (RMO) | Microsoft-Dokumentation
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: reference
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- replication [SQL Server], RMO
- programming interfaces [SQL Server replication]
- replication [SQL Server], how-to topics
- RMO [SQL Server]
- Replication Management Objects
- programming [SQL Server replication], RMO
ms.assetid: 37476d50-fb47-49e3-9504-3b163ac381d8
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 0dc41416e0fb585db376c6b72f28f7c30cfff052
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87617919"
---
# <a name="replication-management-objects-concepts"></a><span data-ttu-id="75490-102">Replication Management Objects Concepts</span><span class="sxs-lookup"><span data-stu-id="75490-102">Replication Management Objects Concepts</span></span>
  <span data-ttu-id="75490-103">Bei Replikationsverwaltungsobjekten (RMO) handelt es sich um eine verwaltete Codeassembly, die Replikationsfunktionen für [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] kapselt.</span><span class="sxs-lookup"><span data-stu-id="75490-103">Replication Management Objects (RMO) is a managed code assembly that encapsulates replication functionalities for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="75490-104">RMO wird durch den <xref:Microsoft.SqlServer.Replication>-Namespace implementiert.</span><span class="sxs-lookup"><span data-stu-id="75490-104">RMO is implemented by the <xref:Microsoft.SqlServer.Replication> namespace.</span></span>  
  
 <span data-ttu-id="75490-105">In den folgenden Abschnitten wird beschrieben, wie Sie RMO für die programmgesteuerte Kontrolle von Replikationsaufgaben verwenden können:</span><span class="sxs-lookup"><span data-stu-id="75490-105">The topics in the following sections describe how you can use RMO to programmatically control replication tasks:</span></span>  
  
 [<span data-ttu-id="75490-106">Verteilung konfigurieren</span><span class="sxs-lookup"><span data-stu-id="75490-106">Configure Distribution</span></span>](../configure-distribution.md)  
 <span data-ttu-id="75490-107">Die Themen in diesem Abschnitt veranschaulichen, wie RMO zum Konfigurieren von Veröffentlichung und Verteilung verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="75490-107">Topics in this section show how to use RMO to configure publishing and distribution.</span></span>  
  
 [<span data-ttu-id="75490-108">Erstellen einer Veröffentlichung</span><span class="sxs-lookup"><span data-stu-id="75490-108">Create a Publication</span></span>](../publish/create-a-publication.md)  
 <span data-ttu-id="75490-109">Die Themen in diesem Abschnitt demonstrieren, wie mit RMO Veröffentlichungen und Artikel erstellt, gelöscht und geändert werden.</span><span class="sxs-lookup"><span data-stu-id="75490-109">Topics in this section show how to use RMO to create, delete, and modify publications and articles.</span></span>  
  
 [<span data-ttu-id="75490-110">Abonnieren von Veröffentlichungen</span><span class="sxs-lookup"><span data-stu-id="75490-110">Subscribe to Publications</span></span>](../subscribe-to-publications.md)  
 <span data-ttu-id="75490-111">Die Themen in diesem Abschnitt beschreiben, wie mit RMO Abonnements erstellt, gelöscht und geändert werden.</span><span class="sxs-lookup"><span data-stu-id="75490-111">Topics in this section show how to use RMO to create, delete, and modify subscriptions.</span></span>  
  
 [<span data-ttu-id="75490-112">Sichern einer Replikationstopologie</span><span class="sxs-lookup"><span data-stu-id="75490-112">Secure a Replication Topology</span></span>](../security/view-and-modify-replication-security-settings.md)  
 <span data-ttu-id="75490-113">Die Themen in diesem Abschnitt erläutern, wie mit RMO Sicherheitseinstellungen angezeigt und geändert werden.</span><span class="sxs-lookup"><span data-stu-id="75490-113">Topics in this section show how to use RMO to view and modify security settings.</span></span>  
  
 [<span data-ttu-id="75490-114">Synchronisieren von Abonnements &#40;Replikation&#41;</span><span class="sxs-lookup"><span data-stu-id="75490-114">Synchronize Subscriptions &#40;Replication&#41;</span></span>](../synchronize-data.md)  
 <span data-ttu-id="75490-115">Die Themen in diesem Abschnitt veranschaulichen, wie Abonnements synchronisiert werden.</span><span class="sxs-lookup"><span data-stu-id="75490-115">Topics in this section show how to synchronize subscriptions.</span></span>  
  
 [<span data-ttu-id="75490-116">Überwachen der Replikation</span><span class="sxs-lookup"><span data-stu-id="75490-116">Monitoring Replication</span></span>](../monitoring-replication.md)  
 <span data-ttu-id="75490-117">Die Themen in diesem Abschnitt beschreiben, wie eine Replikationstopologie programmgesteuert überwacht wird.</span><span class="sxs-lookup"><span data-stu-id="75490-117">Topics in this section show how to programmatically monitor a replication topology.</span></span>  
  
## <a name="introduction-to-rmo-programming"></a><span data-ttu-id="75490-118">Einführung in die RMO-Programmierung</span><span class="sxs-lookup"><span data-stu-id="75490-118">Introduction to RMO Programming</span></span>  
 <span data-ttu-id="75490-119">RMO wurde zum Programmieren aller Aspekte der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-Replikation entwickelt.</span><span class="sxs-lookup"><span data-stu-id="75490-119">RMO is designed for programming all aspects of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] replication.</span></span> <span data-ttu-id="75490-120">Der RMO-Namespace lautet <xref:Microsoft.SqlServer.Replication>. Er wird durch die Microsoft.SqlServer.Rmo.dll, eine [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework-Assembly, implementiert.</span><span class="sxs-lookup"><span data-stu-id="75490-120">The RMO namespace is <xref:Microsoft.SqlServer.Replication>, and it is implemented by the Microsoft.SqlServer.Rmo.dll, which is a [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework assembly.</span></span> <span data-ttu-id="75490-121">Die Microsoft.SqlServer.Replication.dll-Assembly, die ebenfalls zum <xref:Microsoft.SqlServer.Replication>-Namespace gehört, implementiert eine verwaltete Codeschnittstelle zum Programmieren der verschiedenen Replikations-Agents (Momentaufnahme-Agent, Verteilungs-Agent und Merge-Agent).</span><span class="sxs-lookup"><span data-stu-id="75490-121">The Microsoft.SqlServer.Replication.dll assembly, which also belongs to the <xref:Microsoft.SqlServer.Replication> namespace, implements a managed code interface for programming the various replication agents (Snapshot Agent, Distribution Agent, and Merge Agent).</span></span> <span data-ttu-id="75490-122">Der Zugriff auf die entsprechenden Klassen kann in RMO erfolgen, um Abonnements zu synchronisieren.</span><span class="sxs-lookup"><span data-stu-id="75490-122">Its classes can be accessed from RMO to synchronize subscriptions.</span></span> <span data-ttu-id="75490-123">Klassen im <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport>-Namespace, die durch die Microsoft.SqlServer.Replication.BusinessLogicSupport.dll-Assembly implementiert werden, dienen zum Erstellen benutzerdefinierter Geschäftslogik für die Mergereplikation.</span><span class="sxs-lookup"><span data-stu-id="75490-123">Classes in the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> namespace, implemented by the Microsoft.SqlServer.Replication.BusinessLogicSupport.dll assembly, are used to create custom business logic for merge replication.</span></span> <span data-ttu-id="75490-124">Diese Assembly ist von RMO unabhängig.</span><span class="sxs-lookup"><span data-stu-id="75490-124">This assembly is independent from RMO.</span></span>  
  
## <a name="deploying-applications-based-on-rmo"></a><span data-ttu-id="75490-125">Bereitstellen von Anwendungen auf Grundlage von RMO</span><span class="sxs-lookup"><span data-stu-id="75490-125">Deploying Applications Based on RMO</span></span>  
 <span data-ttu-id="75490-126">RMO hängt von den Replikationskomponenten und den Clientverbindungskomponenten ab, die in allen Versionen von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] mit Ausnahme von SQL Server Compact enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="75490-126">RMO depends on the replication components and client connectivity components that are included with all versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] except SQL Server Compact.</span></span> <span data-ttu-id="75490-127">Zum Bereitstellen einer Anwendung auf Grundlage von RMO müssen Sie eine Version von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], die Replikationskomponenten und Clientverbindungskomponenten enthält, auf dem Computer installieren, auf dem die Anwendung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="75490-127">To deploy an application based on RMO, you must install a version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that includes replication components and client connectivity components on the computer on which the application will run.</span></span>  
  
## <a name="getting-started-with-rmo"></a><span data-ttu-id="75490-128">Erste Schritte mit RMO</span><span class="sxs-lookup"><span data-stu-id="75490-128">Getting Started with RMO</span></span>  
 <span data-ttu-id="75490-129">In diesem Abschnitt wird beschrieben, wie ein einfaches RMO-Projekt mit [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Studio gestartet wird.</span><span class="sxs-lookup"><span data-stu-id="75490-129">This section describes how to start a simple RMO project using [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Studio.</span></span>  
  
#### <a name="to-create-a-new-microsoft-visual-c-project"></a><span data-ttu-id="75490-130">So erstellen Sie ein neues Microsoft Visual C#-Projekt</span><span class="sxs-lookup"><span data-stu-id="75490-130">To create a new Microsoft Visual C# project</span></span>  
  
1.  <span data-ttu-id="75490-131">Starten Sie Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="75490-131">Start Visual Studio.</span></span>  
  
2.  <span data-ttu-id="75490-132">Klicken Sie im Menü **Datei** auf **Neues Projekt**.</span><span class="sxs-lookup"><span data-stu-id="75490-132">On the **File** menu, click **NewProject.**</span></span> <span data-ttu-id="75490-133">Das Dialogfeld **Neues Projekt** wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="75490-133">The **New Project** dialog box appears.</span></span>  
  
3.  <span data-ttu-id="75490-134">Wählen Sie im Dialogfeld **Projekttypen** den Typ **Visual C#-Projekte** aus.</span><span class="sxs-lookup"><span data-stu-id="75490-134">In the **Project Types** dialog box, select **Visual C# Projects**.</span></span> <span data-ttu-id="75490-135">Wählen Sie im Bereich **Vorlagen** die Option **Windows-Anwendung** aus.</span><span class="sxs-lookup"><span data-stu-id="75490-135">In the **Templates** pane, select **Windows Application**.</span></span>  
  
4.  <span data-ttu-id="75490-136">(Optional) Geben Sie im Feld **Name** einen Namen für die neue Anwendung ein.</span><span class="sxs-lookup"><span data-stu-id="75490-136">(Optional) In **Name**, type the name of the new application.</span></span>  
  
5.  <span data-ttu-id="75490-137">Klicken Sie auf **OK**, um die Visual C# Windows-Vorlage zu laden.</span><span class="sxs-lookup"><span data-stu-id="75490-137">Click **OK** to load the Visual C# Windows template.</span></span>  
  
6.  <span data-ttu-id="75490-138">Wählen Sie im Menü **Projekt** die Option **Verweis hinzufügen** aus.</span><span class="sxs-lookup"><span data-stu-id="75490-138">On the **Project** menu, select **Add Reference** item.</span></span> <span data-ttu-id="75490-139">Das Dialogfeld **Verweis hinzufügen** wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="75490-139">The **Add Reference** dialog box appears.</span></span>  
  
7.  <span data-ttu-id="75490-140">Wählen Sie die folgenden Assemblys aus der Liste auf der Registerkarte **.NET** aus, und klicken Sie anschließend auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="75490-140">Select the following assemblies from the list on the **.NET** tab, and then click **OK**.</span></span>  
  
    -   <span data-ttu-id="75490-141">Microsoft.SqlServer.Replication .NET Programming Interface</span><span class="sxs-lookup"><span data-stu-id="75490-141">Microsoft.SqlServer.Replication .NET Programming Interface</span></span>  
  
    -   <span data-ttu-id="75490-142">Microsoft.SqlServer.ConnectionInfo</span><span class="sxs-lookup"><span data-stu-id="75490-142">Microsoft.SqlServer.ConnectionInfo</span></span>  
  
    -   <span data-ttu-id="75490-143">Replication Agent Library</span><span class="sxs-lookup"><span data-stu-id="75490-143">Replication Agent Library</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="75490-144">Mit gedrückter STRG-Taste können Sie mehrere Dateien gleichzeitig auswählen.</span><span class="sxs-lookup"><span data-stu-id="75490-144">Use the CTRL key to select more than one file.</span></span>  
  
8.  <span data-ttu-id="75490-145">(Optional) Wiederholen Sie Schritt 6.</span><span class="sxs-lookup"><span data-stu-id="75490-145">(Optional) Repeat step 6.</span></span> <span data-ttu-id="75490-146">Klicken Sie auf die Registerkarte **Durchsuchen**, navigieren Sie zu [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]-COM, wählen Sie Microsoft.SqlServer.Replication.BusinessLogicSupport.dll aus, und klicken Sie anschließend auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="75490-146">Click the **Browse** tab, navigate to [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, select Microsoft.SqlServer.Replication.BusinessLogicSupport.dll, and then click **OK**.</span></span>  
  
9. <span data-ttu-id="75490-147">Klicken Sie im Menü **Ansicht** auf **Code**.</span><span class="sxs-lookup"><span data-stu-id="75490-147">On the **View** menu, click **Code**.</span></span>  
  
10. <span data-ttu-id="75490-148">Geben Sie im Code vor der Namespace-Anweisung die folgenden `using`-Anweisungen ein, um die Typen in den RMO-Namespaces zu qualifizieren:</span><span class="sxs-lookup"><span data-stu-id="75490-148">In the code, before the namespace statement, type the following `using` statements to qualify the types in the RMO namespaces:</span></span>  
  
    ```  
    // These namespaces are required.  
    using Microsoft.SqlServer.Replication;  
    using Microsoft.SqlServer.Management.Common;  
    // This namespace is only used when creating custom business  
    // logic for merge replication.  
    using Microsoft.SqlServer.Replication.BusinessLogicSupport;   
    ```  
  
#### <a name="to-create-a-new-microsoft-visual-basic-net-project"></a><span data-ttu-id="75490-149">So erstellen Sie ein neues Microsoft Visual Basic .NET-Projekt</span><span class="sxs-lookup"><span data-stu-id="75490-149">To create a new Microsoft Visual Basic .NET project</span></span>  
  
1.  <span data-ttu-id="75490-150">Starten Sie Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="75490-150">Start Visual Studio.</span></span>  
  
2.  <span data-ttu-id="75490-151">Wählen Sie im Menü **Datei** die Option **Neues Projekt** aus.</span><span class="sxs-lookup"><span data-stu-id="75490-151">On the **File** menu, select **New Project**.</span></span> <span data-ttu-id="75490-152">Das Dialogfeld **Neues Projekt** wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="75490-152">The **New Project** dialog box appears.</span></span>  
  
3.  <span data-ttu-id="75490-153">Wählen Sie im Projekttypenbereich **Visual Basic** aus.</span><span class="sxs-lookup"><span data-stu-id="75490-153">In the Project Types pane, select **Visual Basic**.</span></span> <span data-ttu-id="75490-154">Wählen Sie im Vorlagenbereich die Option **Windows-Anwendung** aus.</span><span class="sxs-lookup"><span data-stu-id="75490-154">In the Templates pane, select **Windows Application**.</span></span>  
  
4.  <span data-ttu-id="75490-155">(Optional) Geben Sie im Feld **Name** einen Namen für die neue Anwendung ein.</span><span class="sxs-lookup"><span data-stu-id="75490-155">(Optional) In the **Name** box, type the name of the new application.</span></span>  
  
5.  <span data-ttu-id="75490-156">Klicken Sie auf **OK**, um die Visual Basic Windows-Vorlage zu laden.</span><span class="sxs-lookup"><span data-stu-id="75490-156">Click **OK** to load the Visual Basic Windows template.</span></span>  
  
6.  <span data-ttu-id="75490-157">Wählen Sie im Menü **Projekt** die Option **Verweis hinzufügen** aus.</span><span class="sxs-lookup"><span data-stu-id="75490-157">On the **Project** menu, select **Add Reference**.</span></span> <span data-ttu-id="75490-158">Das Dialogfeld **Verweis hinzufügen** wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="75490-158">The **Add Reference** dialog box appears.</span></span>  
  
7.  <span data-ttu-id="75490-159">Wählen Sie die folgenden Assemblys aus der Liste auf der Registerkarte **.NET** aus, und klicken Sie anschließend auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="75490-159">Select the following assemblies from the list on the **.NET** tab, and then click **OK**.</span></span>  
  
    -   <span data-ttu-id="75490-160">Microsoft.SqlServer.Replication .NET Programming Interface</span><span class="sxs-lookup"><span data-stu-id="75490-160">Microsoft.SqlServer.Replication .NET Programming Interface</span></span>  
  
    -   <span data-ttu-id="75490-161">Microsoft.SqlServer.ConnectionInfo</span><span class="sxs-lookup"><span data-stu-id="75490-161">Microsoft.SqlServer.ConnectionInfo</span></span>  
  
    -   <span data-ttu-id="75490-162">Replication Agent Library</span><span class="sxs-lookup"><span data-stu-id="75490-162">Replication Agent Library</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="75490-163">Mit gedrückter STRG-Taste können Sie mehrere Dateien gleichzeitig auswählen.</span><span class="sxs-lookup"><span data-stu-id="75490-163">Use the CTRL key to select more than one file.</span></span>  
  
8.  <span data-ttu-id="75490-164">(Optional) Wiederholen Sie Schritt 6.</span><span class="sxs-lookup"><span data-stu-id="75490-164">(Optional) Repeat step 6.</span></span> <span data-ttu-id="75490-165">Klicken Sie auf die Registerkarte **Durchsuchen**, navigieren Sie zu [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]-COM, wählen Sie Microsoft.SqlServer.Replication.BusinessLogicSupport.dll aus, und klicken Sie anschließend auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="75490-165">Click the **Browse** tab, navigate to [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, select Microsoft.SqlServer.Replication.BusinessLogicSupport.dll, and then click **OK**.</span></span>  
  
9. <span data-ttu-id="75490-166">Klicken Sie im Menü **Ansicht** auf **Code**.</span><span class="sxs-lookup"><span data-stu-id="75490-166">On the **View** menu, click **Code**.</span></span>  
  
10. <span data-ttu-id="75490-167">Geben Sie im Code vor möglichen Deklarationen die folgenden `Imports`-Anweisungen ein, um die Typen in den RMO-Namespaces zu qualifizieren.</span><span class="sxs-lookup"><span data-stu-id="75490-167">In the code, before any declarations, type the following `Imports` statements to qualify the types in the RMO namespaces.</span></span>  
  
    ```  
    ' These namespaces are required.  
    Imports Microsoft.SqlServer.Replication  
    Imports Microsoft.SqlServer.Management.Common  
    ' This namespace is only used when creating custom business  
    ' logic for merge replication.  
    Imports Microsoft.SqlServer.Replication.BusinessLogicSupport   
    ```  
  
## <a name="connecting-to-a-replication-server"></a><span data-ttu-id="75490-168">Verbinden mit einem Replikationsserver</span><span class="sxs-lookup"><span data-stu-id="75490-168">Connecting to a Replication Server</span></span>  
 <span data-ttu-id="75490-169">Bei RMO-Programmierobjekten ist es erforderlich, dass eine Verbindung zu einer Instanz von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] mithilfe einer Instanz der <xref:Microsoft.SqlServer.Management.Common.ServerConnection>-Klasse erfolgt.</span><span class="sxs-lookup"><span data-stu-id="75490-169">RMO programming objects require that a connection to an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is made by using an instance of the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span> <span data-ttu-id="75490-170">Diese Verbindung mit dem Server erfolgt unabhängig von einem RMO-Programmierobjekt.</span><span class="sxs-lookup"><span data-stu-id="75490-170">This connection to the server is made independently of any RMO programming objects.</span></span> <span data-ttu-id="75490-171">Sie wird anschließend entweder während der Erstellung der Instanz oder durch die Zuweisung zur <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>-Eigenschaft des Objekts an das RMO-Objekt übergeben.</span><span class="sxs-lookup"><span data-stu-id="75490-171">It is then passed to the RMO object either during instance creation or by assignment to the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property of the object.</span></span> <span data-ttu-id="75490-172">Dadurch können ein RMO-Programmierobjekt und die Instanzen des Verbindungsobjekts getrennt erstellt und verwaltet werden. Zudem kann ein einzelnes Verbindungsobjekt mit mehreren RMO-Programmierobjekten verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="75490-172">In this manner, an RMO programming object and the connection object instances can be created and managed separately, and a single connection object can be reused with multiple RMO programming objects.</span></span> <span data-ttu-id="75490-173">Für Verbindungen mit einem Replikationsserver gelten die folgenden Regeln:</span><span class="sxs-lookup"><span data-stu-id="75490-173">The following rules apply for connections to a replication server:</span></span>  
  
-   <span data-ttu-id="75490-174">Alle Eigenschaften für die Verbindung werden für ein angegebenes <xref:Microsoft.SqlServer.Management.Common.ServerConnection>-Objekt definiert.</span><span class="sxs-lookup"><span data-stu-id="75490-174">All properties for the connection are defined for a given <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object.</span></span>  
  
-   <span data-ttu-id="75490-175">Eine Verbindung zu jeder Instanz von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] muss über ein eigenes <xref:Microsoft.SqlServer.Management.Common.ServerConnection>-Objekt verfügen.</span><span class="sxs-lookup"><span data-stu-id="75490-175">A connection to each instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] must have its own <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object.</span></span>  
  
-   <span data-ttu-id="75490-176">Das <xref:Microsoft.SqlServer.Management.Common.ServerConnection>-Objekt ist der <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>-Eigenschaft des RMO-Programmierobjekts zugewiesen, das auf dem Server erstellt oder auf das über den Server zugegriffen wird.</span><span class="sxs-lookup"><span data-stu-id="75490-176">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object is assigned to the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property of the RMO programming object being created or accessed on the server.</span></span>  
  
-   <span data-ttu-id="75490-177">Mit der <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Connect%2A>-Methode wird die Verbindung mit dem Server geöffnet.</span><span class="sxs-lookup"><span data-stu-id="75490-177">The <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Connect%2A> method opens the connection to the server.</span></span> <span data-ttu-id="75490-178">Diese Methode muss aufgerufen werden, bevor Methoden aufgerufen werden, die auf den Server zugreifen, oder bevor RMO-Programmierobjekte aufgerufen werden, die diese Verbindung verwenden.</span><span class="sxs-lookup"><span data-stu-id="75490-178">This method must be called before calling any methods that access the server on any RMO programming objects using the connection.</span></span>  
  
-   <span data-ttu-id="75490-179">Da sowohl RMO- als auch [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-Verwaltungsobjekte (SMO) die <xref:Microsoft.SqlServer.Management.Common.ServerConnection>-Klasse für Verbindungen zu [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] verwenden, können RMO- und SMO-Objekte die gleiche Verbindung verwenden.</span><span class="sxs-lookup"><span data-stu-id="75490-179">Because RMO and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Management Objects (SMO) both use the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class for connections to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the same connection can be used by both RMO and SMO objects.</span></span> <span data-ttu-id="75490-180">Weitere Informationen finden Sie unter [Hinzufügen von Funktionen zu einer Instanz von SQL Server](../../server-management-objects-smo/create-program/connecting-to-an-instance-of-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="75490-180">For more information, see [Connecting to an Instance of SQL Server](../../server-management-objects-smo/create-program/connecting-to-an-instance-of-sql-server.md).</span></span>  
  
-   <span data-ttu-id="75490-181">Sämtliche Authentifizierungsinformationen, die zur Herstellung der Verbindung und zur erfolgreichen Anmeldung beim Server erforderlich sind, sind im <xref:Microsoft.SqlServer.Management.Common.ServerConnection>-Objekt angegeben.</span><span class="sxs-lookup"><span data-stu-id="75490-181">All authentication information to make the connection and successfully log on to the server is supplied in the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object.</span></span>  
  
-   <span data-ttu-id="75490-182">Die Windows-Authentifizierung ist als Standard vorgegeben.</span><span class="sxs-lookup"><span data-stu-id="75490-182">Windows Authentication is the default.</span></span> <span data-ttu-id="75490-183">Um die [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-Authentifizierung verwenden zu können, muss <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.LoginSecure%2A> auf `false` festgelegt sein, und <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Login%2A> und <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Password%2A> müssen auf eine gültige [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-Anmeldung und ein gültiges Kennwort festgelegt sein.</span><span class="sxs-lookup"><span data-stu-id="75490-183">To use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication, <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.LoginSecure%2A> must be set to `false` and <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Login%2A> and <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Password%2A> must be set to a valid [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] logon and password.</span></span> <span data-ttu-id="75490-184">Anmeldeinformationen müssen stets sicher aufbewahrt und behandelt werden. Nach Möglichkeit sollte die Eingabe zur Laufzeit erfolgen.</span><span class="sxs-lookup"><span data-stu-id="75490-184">Security credentials must always be stored and handled securely, and supplied at run-time whenever possible.</span></span>  
  
-   <span data-ttu-id="75490-185">Für Multithreadanwendungen sollte in jedem Thread ein separates <xref:Microsoft.SqlServer.Management.Common.ServerConnection>-Objekt verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="75490-185">For multithreaded applications, a separate <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object should be used in each thread.</span></span>  
  
 <span data-ttu-id="75490-186">Rufen Sie die <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Disconnect%2A>-Methode für das <xref:Microsoft.SqlServer.Management.Common.ServerConnection>-Objekt auf, um aktive, von RMO-Objekten verwendete Serververbindungen zu schließen.</span><span class="sxs-lookup"><span data-stu-id="75490-186">Call the <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Disconnect%2A> method on the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object to close active server connections used by RMO objects.</span></span>  
  
## <a name="setting-rmo-properties"></a><span data-ttu-id="75490-187">Festlegen von RMO-Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="75490-187">Setting RMO Properties</span></span>  
 <span data-ttu-id="75490-188">Die Eigenschaften von RMO-Programmierobjekten stellen die Eigenschaften dieser Replikationsobjekte auf dem Server dar.</span><span class="sxs-lookup"><span data-stu-id="75490-188">The properties of RMO programming objects represent the properties of these replication objects at the server.</span></span> <span data-ttu-id="75490-189">Wenn Sie neue Replikationsobjekte auf dem Server erstellen, werden diese Objekte mithilfe von RMO-Eigenschaften definiert.</span><span class="sxs-lookup"><span data-stu-id="75490-189">When creating new replication objects at the server, RMO properties are used to define these objects.</span></span> <span data-ttu-id="75490-190">Für vorhandene Objekte stellen die RMO-Eigenschaften die Eigenschaften des vorhandenen Objekts dar, die nur für nicht schreibgeschützte oder festlegbare Eigenschaften geändert werden können.</span><span class="sxs-lookup"><span data-stu-id="75490-190">For existing objects, the RMO properties represent the existing object's properties, which can be modified only for properties that are writable or settable.</span></span> <span data-ttu-id="75490-191">Eigenschaften können für neue Objekte oder vorhandene Objekte festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="75490-191">Properties can be set on new objects or existing objects.</span></span>  
  
### <a name="setting-properties-for-new-replication-objects"></a><span data-ttu-id="75490-192">Festlegen von Eigenschaften für neue Replikationsobjekte</span><span class="sxs-lookup"><span data-stu-id="75490-192">Setting Properties for New Replication Objects</span></span>  
 <span data-ttu-id="75490-193">Beim Erstellen eines neuen Replikationsobjekts auf dem Server müssen Sie alle erforderlichen Eigenschaften angeben, bevor die `Create`-Methode des Objekts aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="75490-193">When creating a new replication object at the server, you must specify all required properties before calling the `Create` method of the object.</span></span> <span data-ttu-id="75490-194">Weitere Informationen zum Festlegen von Eigenschaften für ein neues Replikationsobjekt finden Sie unter [Konfigurieren der Veröffentlichung und der Verteilung](../configure-publishing-and-distribution.md).</span><span class="sxs-lookup"><span data-stu-id="75490-194">For more information about setting properties for a new replication object, see [Configure Publishing and Distribution](../configure-publishing-and-distribution.md).</span></span>  
  
### <a name="setting-properties-for-existing-replication-objects"></a><span data-ttu-id="75490-195">Festlegen von Eigenschaften für vorhandene Replikationsobjekte</span><span class="sxs-lookup"><span data-stu-id="75490-195">Setting Properties for Existing Replication Objects</span></span>  
 <span data-ttu-id="75490-196">Für auf dem Server vorhandene Replikationsobjekte unterstützt RMO abhängig vom Objekt die Fähigkeit, einige oder alle Eigenschaften zu ändern.</span><span class="sxs-lookup"><span data-stu-id="75490-196">For replication objects that exist at the server, depending on the object, RMO might support the ability to change some or all of its properties.</span></span> <span data-ttu-id="75490-197">Nur nicht schreibgeschützte oder festlegbare Eigenschaften können geändert werden.</span><span class="sxs-lookup"><span data-stu-id="75490-197">Only writable or settable properties can be changed.</span></span> <span data-ttu-id="75490-198">Bevor Eigenschaften geändert werden können, muss entweder die `Load`-Methode oder die <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A>-Methode aufgerufen werden, um die aktuellen Eigenschaften vom Server abzurufen.</span><span class="sxs-lookup"><span data-stu-id="75490-198">Before properties can be changed, either the `Load` or the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method must be called to get the current properties from the server.</span></span> <span data-ttu-id="75490-199">Durch Aufrufen dieser Methoden wird angegeben, dass ein vorhandenes Objekt geändert wird.</span><span class="sxs-lookup"><span data-stu-id="75490-199">Calling these methods indicates that an existing object is being modified.</span></span>  
  
 <span data-ttu-id="75490-200">Beim Ändern der Objekteigenschaften führt RMO standardmäßig einen Commit für diese Änderungen auf dem Server auf Grundlage des verwendeten Ausführungsmodus von <xref:Microsoft.SqlServer.Management.Common.ServerConnection> aus.</span><span class="sxs-lookup"><span data-stu-id="75490-200">By default, when changing object properties, RMO commits these changes to the server based on the execution mode of the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> being used.</span></span> <span data-ttu-id="75490-201">Mit der <xref:Microsoft.SqlServer.Replication.ReplicationObject.IsExistingObject%2A>-Methode können Sie überprüfen, ob ein Objekt auf dem Server vorhanden ist, bevor Sie versuchen, die entsprechenden Eigenschaften abzurufen oder zu ändern.</span><span class="sxs-lookup"><span data-stu-id="75490-201">The <xref:Microsoft.SqlServer.Replication.ReplicationObject.IsExistingObject%2A> method can be used to verify that an object exists at the server before attempting to retrieve or change its properties.</span></span> <span data-ttu-id="75490-202">Informationen zum Ändern der Eigenschaften eines Replikationsobjekts finden Sie unter [Anzeigen und Ändern der Verteiler- und Verlegereigenschaften](../view-and-modify-distributor-and-publisher-properties.md).</span><span class="sxs-lookup"><span data-stu-id="75490-202">For more information about changing the properties of a replication object, see [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="75490-203">Wenn mehrere RMO-Clients oder mehrere Instanzen eines RMO-Programmierobjekts auf das gleiche Replikationsobjekt auf dem Server zugreifen, kann die `Refresh`-Methode des RMO-Objekts aufgerufen werden, um Eigenschaften basierend auf dem aktuellen Status des Objekts auf dem Server zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="75490-203">When multiple RMO clients or multiple instances of an RMO programming object are accessing the same replication object at the server, the `Refresh` method of the RMO object can be called to update the properties based on the current state of the object at the server.</span></span>  
  
### <a name="caching-property-changes"></a><span data-ttu-id="75490-204">Zwischenspeichern von Eigenschaftsänderungen</span><span class="sxs-lookup"><span data-stu-id="75490-204">Caching Property Changes</span></span>  
 <span data-ttu-id="75490-205">Wenn die <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes>-Eigenschaft auf <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes.CaptureSql> festgelegt ist, werden alle von RMO generierten [!INCLUDE[tsql](../../../includes/tsql-md.md)]-Anweisungen erfasst, sodass sie manuell mit einer der Ausführungsmethoden in einem einzelnen Batch ausgeführt werden können.</span><span class="sxs-lookup"><span data-stu-id="75490-205">When the <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes> property is set to <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes.CaptureSql> all [!INCLUDE[tsql](../../../includes/tsql-md.md)] statements generated by RMO are captured so that they can be executed manually in a single batch by using one of the execution methods.</span></span> <span data-ttu-id="75490-206">Mit RMO können Sie Eigenschaftsänderungen zwischenspeichern und mit der <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A>-Methode des Objekts einen Commit für alle Änderungen gleichzeitig in einem einzelnen Batch durchführen.</span><span class="sxs-lookup"><span data-stu-id="75490-206">RMO lets you cache property changes and commit them together in a single batch by using the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method of the object.</span></span> <span data-ttu-id="75490-207">Um Eigenschaftsänderungen zwischenzuspeichern, muss die <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A>-Eigenschaft des Objekts auf `true` festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="75490-207">To cache property changes, the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> property of the object must be set to `true`.</span></span> <span data-ttu-id="75490-208">Beim Zwischenspeichern von Eigenschaftsänderungen in RMO wird der Zeitpunkt, wann Änderungen an den Server gesendet werden, nach wie vor vom <xref:Microsoft.SqlServer.Management.Common.ServerConnection>-Objekt gesteuert.</span><span class="sxs-lookup"><span data-stu-id="75490-208">When caching property changes in RMO, the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object still controls when changes are sent to the server.</span></span> <span data-ttu-id="75490-209">Weitere Informationen zum Zwischenspeichern von Eigenschaftsänderungen eines Replikationsobjekts finden Sie unter [Anzeigen und Ändern der Verteiler- und Verlegereigenschaften](../view-and-modify-distributor-and-publisher-properties.md).</span><span class="sxs-lookup"><span data-stu-id="75490-209">For more information about caching property changes for a replication object, see [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="75490-210">Obwohl die <xref:Microsoft.SqlServer.Management.Common.ServerConnection>-Klasse das Deklarieren von expliziten Transaktionen beim Festlegen von Eigenschaften unterstützt, können diese Transaktionen interne Replikationstransaktionen beeinträchtigen und zu unerwarteten Ergebnissen führen und sollten daher nicht mit RMO verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="75490-210">Although the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class supports declaring explicit transactions when setting properties, such transactions may interfere with internal replication transactions, can produce unanticipated results, and should not be used with RMO.</span></span>  
  
## <a name="example"></a><span data-ttu-id="75490-211">Beispiel</span><span class="sxs-lookup"><span data-stu-id="75490-211">Example</span></span>  
 <span data-ttu-id="75490-212">In diesem Beispiel wird das Zwischenspeichern der Eigenschaftsänderungen veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="75490-212">This example demonstrates the caching of property changes.</span></span> <span data-ttu-id="75490-213">Änderungen an den Attributen einer Transaktionsveröffentlichung werden zwischengespeichert, bis sie explizit an den Server gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="75490-213">Changes made to the attributes of a transactional publication are cached until they are explicitly sent to the server.</span></span>  
  
 [!code-csharp[HowTo#rmo_ChangeTranPub_cached](../../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_ChangeTranPub_cached)]  
  
## <a name="see-also"></a><span data-ttu-id="75490-214">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="75490-214">See Also</span></span>  
 <span data-ttu-id="75490-215">[Replication System Stored Procedures Concepts](replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="75490-215">[Replication System Stored Procedures Concepts](replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="75490-216">Konzepte für die Replikationsprogrammierung</span><span class="sxs-lookup"><span data-stu-id="75490-216">Replication Programming Concepts</span></span>](replication-programming-concepts.md)  
  
  

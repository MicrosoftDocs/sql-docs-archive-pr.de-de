---
title: Replizieren von Identitätsspalten | Microsoft-Dokumentation
ms.custom: ''
ms.date: 10/04/2016
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- identities [SQL Server replication]
- identity values [SQL Server replication]
- merge replication [SQL Server replication], identity range management
- publishing [SQL Server replication], identity columns
- transactional replication, identity range management
- identity columns [SQL Server], replication
ms.assetid: eb2f23a8-7ec2-48af-9361-0e3cb87ebaf7
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c899d902e403e9f7cdbdfd1a83cde110e627ab11
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87609801"
---
# <a name="replicate-identity-columns"></a><span data-ttu-id="83830-102">Replizieren von Identitätsspalten</span><span class="sxs-lookup"><span data-stu-id="83830-102">Replicate Identity Columns</span></span>
  <span data-ttu-id="83830-103">Wenn Sie einer Spalte eine IDENTITY-Eigenschaft zuweisen, generiert [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] für neue Zeilen, die in die Tabelle, die die Identitätsspalte enthält, eingefügt werden, automatisch sequenzielle Zahlwerte.</span><span class="sxs-lookup"><span data-stu-id="83830-103">When you assign an IDENTITY property to a column, [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] automatically generates sequential numbers for new rows inserted in the table containing the identity column.</span></span> <span data-ttu-id="83830-104">Weitere Informationen finden Sie unter [IDENTITY &#40;Eigenschaft&#41; &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-table-transact-sql-identity-property).</span><span class="sxs-lookup"><span data-stu-id="83830-104">For more information, see [IDENTITY &#40;Property&#41; &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-table-transact-sql-identity-property).</span></span> <span data-ttu-id="83830-105">Da Identitätsspalten als Teil des Primärschlüssels aufgenommen werden können, ist es wichtig, dass die Identitätsspalten keine doppelten Werte enthalten.</span><span class="sxs-lookup"><span data-stu-id="83830-105">Because identity columns might be included as a part of the primary key, it is important to avoid duplicate values in the identity columns.</span></span> <span data-ttu-id="83830-106">Wenn Identitätsspalten in einer Replikationstopologie verwendet werden sollen, die an mehreren Knoten Updates besitzt, muss jeder Knoten in der Replikationstopologie einen anderen Bereich von Identitätswerten verwenden, damit es nicht zu Dopplungen kommt.</span><span class="sxs-lookup"><span data-stu-id="83830-106">To use identity columns in a replication topology that has updates at more than one node, each node in the replication topology must use a different range of identity values, so that duplicates do not occur.</span></span>  
  
 <span data-ttu-id="83830-107">Beispielsweise kann dem Verleger der Bereich 1-100 zugewiesen werden, dem Abonnent A der Bereich 101-200 und dem Abonnent B der Bereich 201-300.</span><span class="sxs-lookup"><span data-stu-id="83830-107">For example, the Publisher could be assigned the range 1-100, Subscriber A the range 101-200, and Subscriber B the range 201-300.</span></span> <span data-ttu-id="83830-108">Wenn beim Verleger eine Zeile eingefügt wird und der Identitätswert beispielsweise 65 beträgt, wird der Wert für jeden Abonnenten repliziert.</span><span class="sxs-lookup"><span data-stu-id="83830-108">If a row is inserted at the Publisher and the identity value is, for example, 65, that value is replicated to each Subscriber.</span></span> <span data-ttu-id="83830-109">Beim Einfügen der Daten auf den einzelnen Abonnenten erhöht die Replikation jedoch nicht den Identitätsspaltenwert in der Abonnententabelle um 1, sondern es wird der Literalwert 65 eingefügt.</span><span class="sxs-lookup"><span data-stu-id="83830-109">When replication inserts data at each Subscriber, it does not increment the identity column value in the Subscriber table; instead, the literal value 65 is inserted.</span></span> <span data-ttu-id="83830-110">Eine inkrementelle Erhöhung des Identitätsspaltenwerts erfolgt nur bei Benutzereinfügungen, nicht jedoch bei Einfügungen durch einen Replikations-Agent.</span><span class="sxs-lookup"><span data-stu-id="83830-110">Only user inserts, but not replication agent inserts cause the identity column value to be incremented.</span></span>  
  
 <span data-ttu-id="83830-111">Die Replikation behandelt die Identitätsspalten in allen Veröffentlichungs- und Abonnementtypen und ermöglicht es Ihnen so, die Spalten entweder selbst manuell zu verwalten oder die Spalten automatisch durch die Replikation verwalten zu lassen.</span><span class="sxs-lookup"><span data-stu-id="83830-111">Replication handles identity columns across all publication and subscription types, allowing you to manage the columns manually or have replication manage them automatically.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="83830-112">Das Hinzufügen einer Identitätsspalte zu einer veröffentlichten Tabelle wird nicht unterstützt, da ein solcher Vorgang zu Nichtkonvergenz führen kann, wenn die Spalte auf den Abonnenten repliziert wird.</span><span class="sxs-lookup"><span data-stu-id="83830-112">Adding an identity column to a published table is not supported, because it can result in non-convergence when the column is replicated to the Subscriber.</span></span> <span data-ttu-id="83830-113">Die Werte in der Identitätsspalte auf dem Verleger richten sich nach der Ordnung, in der die Zeilen für die betreffende Tabelle physisch gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="83830-113">The values in the identity column at the Publisher depend on the order in which the rows for the affected table are physically stored.</span></span> <span data-ttu-id="83830-114">Es ist möglich, dass die Zeilen auf dem Abonnenten anders gespeichert sind, sodass der Wert für die Identitätsspalte für dieselben Zeilen unterschiedlich sein kann.</span><span class="sxs-lookup"><span data-stu-id="83830-114">The rows might be stored differently at the Subscriber; therefore the value for the identity column can be different for the same rows.</span></span>  
  
## <a name="specifying-an-identity-range-management-option"></a><span data-ttu-id="83830-115">Angeben der Optionen für die Identitätsbereichsverwaltung</span><span class="sxs-lookup"><span data-stu-id="83830-115">Specifying an Identity Range Management Option</span></span>  
 <span data-ttu-id="83830-116">Die Replikation bietet die folgenden drei Optionen für die Identitätsbereichsverwaltung:</span><span class="sxs-lookup"><span data-stu-id="83830-116">Replication offers three identity range management options:</span></span>  
  
-   <span data-ttu-id="83830-117">Automatisch.</span><span class="sxs-lookup"><span data-stu-id="83830-117">Automatic.</span></span> <span data-ttu-id="83830-118">Diese Option ist bei Mergereplikationen und Transaktionsreplikationen mit Update auf den Abonnenten zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="83830-118">Used for merge replication and transactional replication with updates at the Subscriber.</span></span> <span data-ttu-id="83830-119">Geben Sie die Größenbereiche für den Verleger und die Abonnenten an. Die Replikation übernimmt dann automatisch die Zuweisung der neuen Bereiche.</span><span class="sxs-lookup"><span data-stu-id="83830-119">Specify size ranges for the Publisher and Subscribers, and replication automatically manages the assignment of new ranges.</span></span> <span data-ttu-id="83830-120">Die Replikation aktiviert die Option NOT FOR REPLICATION für die Identitätsspalte auf dem Abonnenten, sodass nur Benutzereinfügungen zu einer inkrementellen Erhöhung des Werts auf dem Abonnenten führen.</span><span class="sxs-lookup"><span data-stu-id="83830-120">Replication sets the NOT FOR REPLICATION option on the identity column at the Subscriber, so that only user inserts cause the value to be incremented at the Subscriber.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="83830-121">Die Abonnenten müssen mit dem Verleger synchronisiert werden, um die neuen Bereiche zu empfangen.</span><span class="sxs-lookup"><span data-stu-id="83830-121">Subscribers must synchronize with the Publisher to receive new ranges.</span></span> <span data-ttu-id="83830-122">Da den Abonnenten die Identitätsbereiche automatisch zugewiesen werden, ist es für alle Abonnenten möglich, sämtliche Identitätsbereiche auszuschöpfen, wenn wiederholt neue Bereiche angefordert werden.</span><span class="sxs-lookup"><span data-stu-id="83830-122">Because Subscribers are assigned identity ranges automatically, it is possible for any Subscriber to exhaust the entire supply of identity ranges if it repeatedly requests new ranges.</span></span>  
  
-   <span data-ttu-id="83830-123">Manuell</span><span class="sxs-lookup"><span data-stu-id="83830-123">Manual.</span></span> <span data-ttu-id="83830-124">Diese Option ist bei Momentaufnahme- und Transaktionsreplikationen ohne Updates auf dem Abonnenten, bei Peer-zu-Peer-Transaktionsreplikationen und in den Fällen zu verwenden, in denen Ihre Anwendung die Identitätsbereiche programmgesteuert kontrollieren muss.</span><span class="sxs-lookup"><span data-stu-id="83830-124">Used for snapshot and transactional replication without updates at the Subscriber, peer-to-peer transactional replication, or if your application must control identity ranges programmatically.</span></span> <span data-ttu-id="83830-125">Wenn Sie die manuelle Verwaltung angeben, müssen Sie sicherstellen, dass dem Verleger und den einzelnen Abonnenten Bereiche zugewiesen werden und dass neue Bereiche zugeordnet werden, sofern die anfänglichen Bereiche verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="83830-125">If you specify manual management, you must ensure that ranges are assigned to the Publisher and each Subscriber and that new ranges are assigned if the initial ranges are used.</span></span> <span data-ttu-id="83830-126">Die Replikation aktiviert die Option NOT FOR REPLICATION für die Identitätsspalte auf dem Abonnenten.</span><span class="sxs-lookup"><span data-stu-id="83830-126">Replication sets the NOT FOR REPLICATION option on the identity column at the Subscriber.</span></span>  
  
-   <span data-ttu-id="83830-127">Keine.</span><span class="sxs-lookup"><span data-stu-id="83830-127">None.</span></span> <span data-ttu-id="83830-128">Diese Option sollte nur für die Rückwärtskompatibilität mit früheren [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] -Versionen verwendet werden. Bei Transaktionsveröffentlichungen ist die Option nur über die gespeicherte Prozedur verfügbar.</span><span class="sxs-lookup"><span data-stu-id="83830-128">This option is recommended only for backwards compatibility with earlier versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and is available only from the stored procedure interface for transactional publications.</span></span>  
  
 <span data-ttu-id="83830-129">Informationen zum Angeben einer Option für die Identitätsbereichsverwaltung finden Sie unter [Verwalten von Identitätsspalten](manage-identity-columns.md).</span><span class="sxs-lookup"><span data-stu-id="83830-129">To specify an identity range management option, see [Manage Identity Columns](manage-identity-columns.md).</span></span>  
  
## <a name="assigning-identity-ranges"></a><span data-ttu-id="83830-130">Zuweisen von Identitätsbereichen</span><span class="sxs-lookup"><span data-stu-id="83830-130">Assigning Identity Ranges</span></span>  
 <span data-ttu-id="83830-131">Bei der Mergereplikation und der Transaktionsreplikation kommen zum Zuweisen von Bereichen unterschiedliche Methoden zum Einsatz. Diese Methoden werden im Folgenden näher beschrieben.</span><span class="sxs-lookup"><span data-stu-id="83830-131">Merge replication and transactional replication use different methods for assigning ranges; these methods are described in this section.</span></span>  
  
 <span data-ttu-id="83830-132">Beim Replizieren von Identitätsspalten sind die folgenden beiden Bereichstypen zu berücksichtigen: Bereiche, die dem Verleger und den Abonnenten zugewiesen werden, und der Bereich des Datentyps in der Spalte.</span><span class="sxs-lookup"><span data-stu-id="83830-132">There are two types of ranges to take into account when replicating identity columns: the ranges assigned to the Publisher and Subscribers, and the range of the data type in the column.</span></span> <span data-ttu-id="83830-133">Die folgende Tabelle enthält eine Übersicht über die für die Datentypen verfügbaren Bereiche, die in der Regel in Identitätsspalten verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="83830-133">The following table shows the ranges available for the data types typically used in identity columns.</span></span> <span data-ttu-id="83830-134">Der Bereich wird in allen Knoten in einer Topologie verwendet.</span><span class="sxs-lookup"><span data-stu-id="83830-134">The range is used across all nodes in a topology.</span></span> <span data-ttu-id="83830-135">Wenn Sie z. b `smallint` . ab 1 mit einem Inkrement von 1 verwenden, ist die maximale Anzahl von Einfügungen für den Verleger und alle Abonnenten 32.767.</span><span class="sxs-lookup"><span data-stu-id="83830-135">For example, if you use `smallint` starting at 1 with an increment of 1, the maximum number of inserts is 32,767 for the Publisher and all Subscribers.</span></span> <span data-ttu-id="83830-136">Die tatsächliche Anzahl der Einfügungen hängt davon ab, ob es in den verwendeten Werten Lücken gibt und ob ein Schwellenwert verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="83830-136">The actual number of inserts depends on whether there are gaps in the values used and whether a threshold value is used.</span></span> <span data-ttu-id="83830-137">Weitere Informationen zu Schwellenwerten finden Sie in den folgenden Abschnitten: "Mergereplikation" und "Transaktionsreplikation mit Abonnements mit verzögertem Update über eine Warteschlange".</span><span class="sxs-lookup"><span data-stu-id="83830-137">For more information about thresholds, see the following sections "Merge Replication" and "Transactional Replication with Queued Updating Subscriptions".</span></span>  
  
 <span data-ttu-id="83830-138">Wenn der Verleger nach einer Einfügung seinen Identitätsbereich ausgeschöpft hat, kann er automatisch einen neuen Bereich zuweisen, wenn die Einfügung von einem Mitglied mit der festen **db_owner** -Datenbankrolle ausgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="83830-138">If the Publisher exhausts its identity range after an insert, it can automatically assign a new range if the insert was performed by a member of the **db_owner** fixed database role.</span></span> <span data-ttu-id="83830-139">Wenn die Einfügung von einem Benutzer mit einer anderen Rolle ausgeführt wird, muss der Protokolllese-Agent, der Merge-Agent oder ein Benutzer, der Mitglied der **db_owner**-Rolle ist, [sp_adjustpublisheridentityrange &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adjustpublisheridentityrange-transact-sql) ausführen.</span><span class="sxs-lookup"><span data-stu-id="83830-139">If the insert was performed by a user not in that role, the Log Reader Agent, Merge Agent, or a user who is a member of the **db_owner** role must run [sp_adjustpublisheridentityrange &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adjustpublisheridentityrange-transact-sql).</span></span> <span data-ttu-id="83830-140">Bei Transaktionsveröffentlichungen muss der Protokolllese-Agent ausgeführt werden, damit automatisch ein neuer Bereich zugeordnet wird (der Agent wird standardmäßig ununterbrochen ausgeführt).</span><span class="sxs-lookup"><span data-stu-id="83830-140">For transactional publications, the Log Reader Agent must be running to automatically allocate a new range (the default is for the agent to run continuously).</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="83830-141">Während einer umfangreichen Batcheinfügung wird der Replikationstrigger nur einmal und nicht für jede eingefügte Zeile ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="83830-141">During a large batch insert the replication trigger is fired only once, not for each row of the insert.</span></span> <span data-ttu-id="83830-142">Dies kann zu einem Fehler bei der INSERT-Anweisung führen, wenn ein Identitätsbereich während einer umfangreichen Einfügung, z. B. einer `INSERT INTO`-Anweisung, ausgeschöpft ist.</span><span class="sxs-lookup"><span data-stu-id="83830-142">This can lead to a failure of the insert statement if an identity range is exhausted during an large insert, such as an `INSERT INTO` statement.</span></span>  
  
|<span data-ttu-id="83830-143">Datentyp</span><span class="sxs-lookup"><span data-stu-id="83830-143">Data type</span></span>|<span data-ttu-id="83830-144">Range</span><span class="sxs-lookup"><span data-stu-id="83830-144">Range</span></span>|  
|---------------|-----------|  
|`tinyint`|<span data-ttu-id="83830-145">Keine Unterstützung bei automatischer Verwaltung</span><span class="sxs-lookup"><span data-stu-id="83830-145">Not supported for automatic management</span></span>|  
|`smallint`|<span data-ttu-id="83830-146">-2^15 (-32,768) bis 2^15-1 (32,767)</span><span class="sxs-lookup"><span data-stu-id="83830-146">-2^15 (-32,768) to 2^15-1 (32,767)</span></span>|  
|`int`|<span data-ttu-id="83830-147">-2^31 (-2.147.483.648) bis 2^31-1 (2.147.483.647)</span><span class="sxs-lookup"><span data-stu-id="83830-147">-2^31 (-2,147,483,648) to 2^31-1 (2,147,483,647)</span></span>|  
|`bigint`|<span data-ttu-id="83830-148">-2^63 (-9.223.372.036.854.775.808) bis 2^63-1 (9.223.372.036.854.775.807)</span><span class="sxs-lookup"><span data-stu-id="83830-148">-2^63 (-9,223,372,036,854,775,808) to 2^63-1 (9,223,372,036,854,775,807)</span></span>|  
|<span data-ttu-id="83830-149">`decimal` und `numeric`</span><span class="sxs-lookup"><span data-stu-id="83830-149">`decimal` and `numeric`</span></span>|<span data-ttu-id="83830-150">-10^38+1 bis 10^38-1</span><span class="sxs-lookup"><span data-stu-id="83830-150">-10^38+1 through 10^38-1</span></span>|  
  
> [!NOTE]  
>  <span data-ttu-id="83830-151">Weitere Informationen zu einer automatisch inkrementierten Zahl, die in mehreren Tabellen verwendet oder aus Anwendungen aufgerufen werden kann, ohne dass auf eine Tabelle verwiesen wird, finden Sie unter [Sequenznummern](../../sequence-numbers/sequence-numbers.md).</span><span class="sxs-lookup"><span data-stu-id="83830-151">To create an automatically incrementing number that can be used in multiple tables or that can be called from applications without referencing any table, see [Sequence Numbers](../../sequence-numbers/sequence-numbers.md).</span></span>  
  
### <a name="merge-replication"></a><span data-ttu-id="83830-152">Mergereplikation</span><span class="sxs-lookup"><span data-stu-id="83830-152">Merge Replication</span></span>  
 <span data-ttu-id="83830-153">Identitätsbereiche werden vom Verleger verwaltet und vom Merge-Agent an die Abonnenten weitergegeben (in einer Wiederveröffentlichungshierarchie werden die Bereiche vom Stammverleger und den Neuverlegern verwaltet).</span><span class="sxs-lookup"><span data-stu-id="83830-153">Identity ranges are managed by the Publisher and propagated to Subscribers by the Merge Agent (in a republishing hierarchy, ranges are managed by the root Publisher and the republishers).</span></span> <span data-ttu-id="83830-154">Die Identitätswerte werden auf dem Verleger aus einem Pool zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="83830-154">The identity values are assigned from a pool at the Publisher.</span></span> <span data-ttu-id="83830-155">Wenn Sie einen Artikel mit einer Identitätsspalte einer Veröffentlichung im Assistenten für neue Veröffentlichung oder mithilfe von [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) hinzufügen, können Sie Werte für die folgenden Parameter angeben:</span><span class="sxs-lookup"><span data-stu-id="83830-155">When you add an article with an identity column to a publication in the New Publication Wizard or by using [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql), you specify values for:</span></span>  
  
-   <span data-ttu-id="83830-156">Mit dem \*\* \@ identity_range\*\* -Parameter wird die Größe des Identitäts Bereichs gesteuert, der dem Verleger und den Abonnenten mit Client Abonnements anfänglich zugeordnet wird.</span><span class="sxs-lookup"><span data-stu-id="83830-156">The **\@identity_range** parameter, which controls the identity range size initially allocated both to the Publisher and to Subscribers with client subscriptions.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="83830-157">Bei Abonnenten, die frühere Versionen von ausführen [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , steuert dieser Parameter (anstelle des Parameters \*\* \@ pub_identity_range\*\* ) auch die Größe des Identitäts Bereichs bei wieder Veröffentlichungs Abonnenten.</span><span class="sxs-lookup"><span data-stu-id="83830-157">For Subscribers running previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], this parameter (rather than the **\@pub_identity_range** parameter) also controls the identity range size at republishing Subscribers.</span></span>  
  
-   <span data-ttu-id="83830-158">Der \*\* \@ pub_identity_range\*\* -Parameter, der die Größe des Identitäts Bereichs für die Wiederveröffentlichung steuert, die den Abonnenten mit Server Abonnements zugeordnet ist (erforderlich für die Wiederveröffentlichung von Daten).</span><span class="sxs-lookup"><span data-stu-id="83830-158">The **\@pub_identity_range** parameter, which controls the identity range size for republishing allocated to Subscribers with server subscriptions (required for republishing data).</span></span> <span data-ttu-id="83830-159">Alle Abonnenten mit Serverabonnenten erhalten einen Bereich zur Wiederveröffentlichung, auch wenn sie gar keine Daten erneut veröffentlichen.</span><span class="sxs-lookup"><span data-stu-id="83830-159">All Subscribers with server subscriptions receive a range for republishing, even if they don't actually republish data.</span></span>  
  
-   <span data-ttu-id="83830-160">Der \*\* \@ Schwellenwert\*\* Parameter, der verwendet wird, um zu bestimmen, wann ein neuer Identitäts Bereich für ein Abonnement von [!INCLUDE[ssEW](../../../includes/ssew-md.md)] oder eine frühere Version von erforderlich ist [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="83830-160">The **\@threshold** parameter, which is used to determine when a new range of identities is required for a subscription to [!INCLUDE[ssEW](../../../includes/ssew-md.md)] or a previous version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="83830-161">Sie können z. b. 10000 für \*\* \@ identity_range\*\* und 500000 für \*\* \@ pub_identity_range\*\*angeben.</span><span class="sxs-lookup"><span data-stu-id="83830-161">For example, you could specify 10000 for **\@identity_range** and 500000 for **\@pub_identity_range**.</span></span> <span data-ttu-id="83830-162">Dem Verleger und allen Abonnenten, die [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] oder eine höhere Version ausführen, einschließlich des Abonnenten mit dem Serverabonnement, wird der Primärbereich 10.000 zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="83830-162">The Publisher and all Subscribers running [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or a later version, including the Subscriber with the server subscription, are assigned a primary range of 10000.</span></span> <span data-ttu-id="83830-163">Dem Abonnenten mit dem Server Abonnement wird auch ein primärer Bereich von 500000 zugewiesen, der von Abonnenten verwendet werden kann, die eine Synchronisierung mit dem wieder Veröffentlichungs Abonnenten Durchführung (Außerdem müssen Sie \*\* \@ identity_range**, \*\* \@ pub_identity_range**und \*\* \@ Schwellenwert\*\* für die Artikel in der Veröffentlichung auf dem wieder Veröffentlichungs Abonnenten angeben).</span><span class="sxs-lookup"><span data-stu-id="83830-163">The Subscriber with the server subscription is also assigned a primary range of 500000, which can be used by Subscribers that synchronize with the republishing Subscriber (you must also specify **\@identity_range**, **\@pub_identity_range**, and **\@threshold** for the articles in the publication at the republishing Subscriber).</span></span>  
  
 <span data-ttu-id="83830-164">Jeder Abonnent, auf dem [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] oder eine höhere Version ausgeführt wird, erhält darüber hinaus einen sekundären Identitätsbereich.</span><span class="sxs-lookup"><span data-stu-id="83830-164">Each Subscriber running [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or a later version also receives a secondary identity range.</span></span> <span data-ttu-id="83830-165">Der sekundäre Bereich entspricht in seiner Größe der Größe des Primärbereichs. Wenn der Primärbereich ausgeschöpft ist, wird der sekundäre Bereich verwendet, und der Merge-Agent weist dem Abonnenten einen neuen Bereich zu.</span><span class="sxs-lookup"><span data-stu-id="83830-165">The secondary range is equal in size to the primary range; when the primary range is exhausted, the secondary range is used, and the Merge Agent assigns a new range to the Subscriber.</span></span> <span data-ttu-id="83830-166">Der neue Bereich wird zum sekundären Bereich, und der Prozess wird fortgesetzt.</span><span class="sxs-lookup"><span data-stu-id="83830-166">The new range becomes the secondary range, and the process continues as the Subscriber uses identity values.</span></span>  
  
  
### <a name="transactional-replication-with-queued-updating-subscriptions"></a><span data-ttu-id="83830-167">Transaktionsreplikation mit Abonnements mit verzögertem Update über eine Warteschlange</span><span class="sxs-lookup"><span data-stu-id="83830-167">Transactional Replication with Queued Updating Subscriptions</span></span>  
 <span data-ttu-id="83830-168">Die Identitätsbereiche werden vom Verteilungs-Agent auf dem Verteiler verwaltet und an die Abonnenten weitergegeben.</span><span class="sxs-lookup"><span data-stu-id="83830-168">Identity ranges are managed by the Distributor and propagated to Subscribers by the Distribution Agent.</span></span> <span data-ttu-id="83830-169">Die Identitätswerte werden auf dem Verteiler aus einem Pool zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="83830-169">The identity values are assigned from a pool at the Distributor.</span></span> <span data-ttu-id="83830-170">Die Größe des Pools richtet sich nach der Größe des Datentyps und des für die Identitätsspalte verwendeten Inkrements.</span><span class="sxs-lookup"><span data-stu-id="83830-170">The pool size is based on the size of the data type and the increment used for the identity column.</span></span> <span data-ttu-id="83830-171">Wenn Sie einen Artikel mit einer Identitätsspalte einer Veröffentlichung im Assistenten für neue Veröffentlichung oder mithilfe von [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql) hinzufügen, können Sie Werte für die folgenden Parameter angeben:</span><span class="sxs-lookup"><span data-stu-id="83830-171">When you add an article with an identity column to a publication in the New Publication Wizard or by using [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql), you specify values for:</span></span>  
  
-   <span data-ttu-id="83830-172">Der \*\* \@ identity_range\*\* -Parameter, der die Größe des Identitäts Bereichs steuert, der anfänglich allen Abonnenten zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="83830-172">The **\@identity_range** parameter, which controls the identity range size initially allocated to all Subscribers.</span></span>  
  
-   <span data-ttu-id="83830-173">Der \*\* \@ pub_identity_range\*\* -Parameter, der die dem Verleger zugeordnete Identitäts Bereichs Größe steuert.</span><span class="sxs-lookup"><span data-stu-id="83830-173">The **\@pub_identity_range** parameter, which controls the identity range size allocated to the Publisher.</span></span>  
  
-   <span data-ttu-id="83830-174">Der \*\* \@ Schwellenwert\*\* Parameter, der verwendet wird, um zu bestimmen, wann ein neuer Identitäts Bereich für ein Abonnement erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="83830-174">The **\@threshold** parameter, which is used to determine when a new range of identities is required for a subscription.</span></span>  
  
 <span data-ttu-id="83830-175">Sie können z. b. 10000 für \*\* \@ pub_identity_range**, 1000 für \*\* \@ identity_range** (unter der Annahme, dass weniger Updates auf dem Abonnenten auftreten) und 80 Prozent für den \*\* \@ Schwellenwert\*\*angeben.</span><span class="sxs-lookup"><span data-stu-id="83830-175">For example, you could specify 10000 for **\@pub_identity_range**, 1000 for **\@identity_range** (assuming fewer updates at the Subscriber), and 80 percent for **\@threshold**.</span></span> <span data-ttu-id="83830-176">Nach 800 Einfügungen auf einem Abonnenten (80 Prozent von 1.000) wird einem Abonnenten ein neuer Bereich zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="83830-176">After 800 inserts at a Subscriber (80 percent of 1000), a Subscriber is assigned a new range.</span></span> <span data-ttu-id="83830-177">Nach 8.000 Einfügungen auf dem Verleger wird dem Verleger ein neuer Bereich zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="83830-177">After 8000 inserts at the Publisher, the Publisher is assigned a new range.</span></span> <span data-ttu-id="83830-178">Beim Zuweisen eines neuen Bereichs ergibt sich jedoch eine Lücke in den Identitätsbereichswerten in der Tabelle.</span><span class="sxs-lookup"><span data-stu-id="83830-178">When a new range is assigned, there will be a gap in the identity range values in the table.</span></span> <span data-ttu-id="83830-179">Durch Angabe eines höheren Schwellenwerts fallen diese Lücken zwar kleiner aus, das System ist dann aber auch weniger fehlertolerant, d. h., wenn der Verteilungs-Agent aus irgendeinem Grund nicht ausgeführt werden kann, gehen einem Abonnenten möglicherweise schneller die Identitäten aus.</span><span class="sxs-lookup"><span data-stu-id="83830-179">Specifying a higher threshold results in smaller gaps, but the system is less fault-tolerant: if the Distribution Agent cannot run for some reason, a Subscriber could more easily run out of identities.</span></span>  
  
## <a name="assigning-ranges-for-manual-identity-range-management"></a><span data-ttu-id="83830-180">Zuweisen von Bereichen für die manuelle Identitätsbereichsverwaltung</span><span class="sxs-lookup"><span data-stu-id="83830-180">Assigning ranges for manual identity range management</span></span>  
 <span data-ttu-id="83830-181">Wenn Sie die manuelle Identitätsbereichsverwaltung angeben, müssen Sie sicherstellen, dass der Verleger und alle Abonnenten verschiedene Identitätsbereiche verwenden.</span><span class="sxs-lookup"><span data-stu-id="83830-181">If you specify manual identity range management, you must ensure that the Publisher and each Subscriber use different identity ranges.</span></span> <span data-ttu-id="83830-182">Stellen Sie sich z. B. eine Tabelle auf dem Verleger mit einer als `IDENTITY(1,1)`definierten Identitätsspalte vor: Die Identitätsspalte beginnt mit 1 und erhöht sich bei jeder neu eingefügten Zeile um 1.</span><span class="sxs-lookup"><span data-stu-id="83830-182">For example, consider a table at the Publisher with an identity column defined as `IDENTITY(1,1)`: the identity column starts at 1 and is incremented by 1 each time a row is inserted.</span></span> <span data-ttu-id="83830-183">Wenn die Tabelle auf dem Verleger 5.000 Zeilen besitzt und Sie für den weiteren Entwicklungsverlauf der Anwendung eine gewisse Vergrößerung der Tabelle erwarten, könnte der Verleger den Bereich 1-10.000 verwenden.</span><span class="sxs-lookup"><span data-stu-id="83830-183">If the table at the Publisher has 5,000 rows, and you expect some growth in the table over the life of the application, the Publisher could use the range 1-10,000.</span></span> <span data-ttu-id="83830-184">Bei Vorhandensein zweier Abonnenten könnte der Abonnent A den Bereich 10.001 bis 20.000 und der Abonnent B den Bereich 20.001 bis 30.000 verwenden.</span><span class="sxs-lookup"><span data-stu-id="83830-184">Given two Subscribers, Subscriber A could use 10,001-20,000, and Subscriber B could use 20,001-30,000.</span></span>  
  
 <span data-ttu-id="83830-185">Nachdem ein Abonnent mit einer Momentaufnahme oder auf andere Weise initialisiert wurde, führen Sie DBCC CHECKIDENT aus, um dem Abonnenten einen Anfangspunkt für dessen Identitätsbereich zuzuweisen.</span><span class="sxs-lookup"><span data-stu-id="83830-185">After a Subscriber is initialized with a snapshot or through another means, execute DBCC CHECKIDENT to assign the Subscriber a starting point for its identity range.</span></span> <span data-ttu-id="83830-186">Auf Abonnent A würden Sie dazu z. B. `DBCC CHECKIDENT('<TableName>','reseed',10001)`ausführen.</span><span class="sxs-lookup"><span data-stu-id="83830-186">For example, at Subscriber A, you would execute `DBCC CHECKIDENT('<TableName>','reseed',10001)`.</span></span> <span data-ttu-id="83830-187">Auf Abonnent B ist dann `CHECKIDENT('<TableName>','reseed',20001)`auszuführen.</span><span class="sxs-lookup"><span data-stu-id="83830-187">At Subscriber B, you would execute `CHECKIDENT('<TableName>','reseed',20001)`.</span></span>  
  
 <span data-ttu-id="83830-188">Zum Zuweisen neuer Bereiche zum Verleger bzw. zu den Abonnenten führen Sie DBCC CHECKIDENT aus, und geben Sie einen neuen Wert als Ausgangswert für die Tabelle an.</span><span class="sxs-lookup"><span data-stu-id="83830-188">To assign new ranges to the Publisher or Subscribers, execute DBCC CHECKIDENT and specify a new value to reseed the table.</span></span> <span data-ttu-id="83830-189">Auf irgendeine Weise müssen Sie auch bestimmen, wann ein neuer Bereich zugewiesen werden muss.</span><span class="sxs-lookup"><span data-stu-id="83830-189">You should have some way to determine when a new range must be assigned.</span></span> <span data-ttu-id="83830-190">So könnte Ihre Anwendung z. B. einen Mechanismus besitzen, der erkennt, wann ein Knoten seinen Bereich fast ausgeschöpft hat, und mithilfe von DBCC CHECKIDENT einen neuen Bereich zuweisen.</span><span class="sxs-lookup"><span data-stu-id="83830-190">For example, your application could have a mechanism that detects when a node is about to use up its range and assign a new range using DBCC CHECKIDENT.</span></span> <span data-ttu-id="83830-191">Sie können auch eine CHECK-Einschränkung hinzufügen, um sicherzustellen, dass keine Zeile hinzugefügt wird, wenn dies zum Verwenden eines außerhalb des Bereichs liegenden Identitätswerts führen würde.</span><span class="sxs-lookup"><span data-stu-id="83830-191">You can also add a check constraint to ensure that a row cannot be added if it would cause an out of range identity value to be used.</span></span>  
  
## <a name="handling-identity-ranges-after-a-database-restore"></a><span data-ttu-id="83830-192">Umgang mit Identitätsbereichen nach einer Datenbankwiederherstellung</span><span class="sxs-lookup"><span data-stu-id="83830-192">Handling Identity Ranges after a Database Restore</span></span>  
 <span data-ttu-id="83830-193">Wenn Sie die automatische Identitätsbereichsverwaltung verwenden und ein Abonnent aus einer Sicherung wiederhergestellt wird, fordert dieser Abonnent automatisch einen neuen Bereich von Identitätswerten an.</span><span class="sxs-lookup"><span data-stu-id="83830-193">If you are using automatic identity range management, when a Subscriber is restored from a backup, it automatically requests a new range of identity values.</span></span> <span data-ttu-id="83830-194">Wenn ein Verleger aus einer Sicherung wiederhergestellt wird, müssen Sie selbst sicherstellen, dass dem Verleger ein entsprechender Bereich zugewiesen wird.</span><span class="sxs-lookup"><span data-stu-id="83830-194">If a Publisher is restored from a backup, you must ensure that the Publisher is assigned an appropriate range.</span></span> <span data-ttu-id="83830-195">Für die Mergereplikation weisen Sie einen neuen Bereich mit [sp_restoremergeidentityrange &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-restoremergeidentityrange-transact-sql) zu.</span><span class="sxs-lookup"><span data-stu-id="83830-195">For merge replication, assign a new range using [sp_restoremergeidentityrange &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-restoremergeidentityrange-transact-sql).</span></span> <span data-ttu-id="83830-196">Bei Transaktionsreplikationen müssen Sie den höchsten Wert bestimmen, der verwendet wurde, und dann den Anfangspunkt für neue Bereiche festlegen.</span><span class="sxs-lookup"><span data-stu-id="83830-196">For transactional replication, determine the highest value that has been used and then set the starting point for new ranges.</span></span> <span data-ttu-id="83830-197">Gehen Sie nach dem Wiederherstellen der Veröffentlichungsdatenbank wie folgt vor:</span><span class="sxs-lookup"><span data-stu-id="83830-197">Use the following procedure after the publication database has been restored:</span></span>  
  
1.  <span data-ttu-id="83830-198">Beenden Sie alle Aktivitäten auf allen Abonnenten.</span><span class="sxs-lookup"><span data-stu-id="83830-198">Stop all activity on all Subscribers.</span></span>  
  
2.  <span data-ttu-id="83830-199">Gehen Sie für jede veröffentlichte Tabelle, die eine Identitätsspalte enthält, wie folgt vor:</span><span class="sxs-lookup"><span data-stu-id="83830-199">For each published table that includes an identity column:</span></span>  
  
    1.  <span data-ttu-id="83830-200">Führen Sie in der Abonnementdatenbank auf jedem Abonnenten `IDENT_CURRENT('<TableName>')`aus.</span><span class="sxs-lookup"><span data-stu-id="83830-200">In the subscription database at each Subscriber, execute `IDENT_CURRENT('<TableName>')`.</span></span>  
  
    2.  <span data-ttu-id="83830-201">Notieren Sie sich den höchsten Wert, den Sie bei den Abonnenten gefunden haben.</span><span class="sxs-lookup"><span data-stu-id="83830-201">Record the highest value found across all Subscribers.</span></span>  
  
    3.  <span data-ttu-id="83830-202">Führen Sie in der Veröffentlichungsdatenbank auf dem Verleger `DBCC CHECKIDENT(<TableName>','reseed',<HighestValueFound+1>`) aus.</span><span class="sxs-lookup"><span data-stu-id="83830-202">In the publication database at the Publisher, execute `DBCC CHECKIDENT(<TableName>','reseed',<HighestValueFound+1>`).</span></span>  
  
    4.  <span data-ttu-id="83830-203">Führen Sie in der Veröffentlichungsdatenbank auf dem Verleger `sp_adjustpublisheridentityrange <PublicationName>, <TableName>`aus.</span><span class="sxs-lookup"><span data-stu-id="83830-203">In the publication database at the Publisher, execute `sp_adjustpublisheridentityrange <PublicationName>, <TableName>`.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="83830-204">Wenn für den Wert in der Identitätsspalte festgelegt wurde, dass er verringert statt vergrößert werden soll, notieren Sie sich den niedrigsten gefundenen Wert, und legen Sie diesen Wert dann als neuen Ausgangswert fest.</span><span class="sxs-lookup"><span data-stu-id="83830-204">If the value in the identity column is set to decrement rather than increment, record the lowest value found, and then reseed with that value.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="83830-205">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="83830-205">See Also</span></span>  
 <span data-ttu-id="83830-206">[BACKUP &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="83830-206">[BACKUP &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-transact-sql) </span></span>  
 <span data-ttu-id="83830-207">[DBCC CHECKIDENT &#40;Transact-SQL&#41;](/sql/t-sql/database-console-commands/dbcc-checkident-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="83830-207">[DBCC CHECKIDENT &#40;Transact-SQL&#41;](/sql/t-sql/database-console-commands/dbcc-checkident-transact-sql) </span></span>  
 <span data-ttu-id="83830-208">[IDENT_CURRENT &#40;Transact-SQL&#41;](/sql/t-sql/functions/ident-current-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="83830-208">[IDENT_CURRENT &#40;Transact-SQL&#41;](/sql/t-sql/functions/ident-current-transact-sql) </span></span>  
 <span data-ttu-id="83830-209">[IDENTITY &#40;Eigenschaft&#41; &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-table-transact-sql-identity-property) </span><span class="sxs-lookup"><span data-stu-id="83830-209">[IDENTITY &#40;Property&#41; &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-table-transact-sql-identity-property) </span></span>  
 [<span data-ttu-id="83830-210">sp_adjustpublisheridentityrange &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="83830-210">sp_adjustpublisheridentityrange &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-adjustpublisheridentityrange-transact-sql)  
  
  

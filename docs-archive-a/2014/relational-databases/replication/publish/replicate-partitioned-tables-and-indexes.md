---
title: Replizieren partitionierter Tabellen und Indizes | Microsoft-Dokumentation
ms.custom: ''
ms.date: 09/10/2015
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- partitioned indexes [SQL Server], replicating
- partitioned tables [SQL Server], replicating
- replication [SQL Server], partitioned tables
- publishing [SQL Server replication], partitioned tables
- transactional replication, partitioned tables
ms.assetid: c9fa81b1-6c81-4c11-927b-fab16301a8f5
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 616707bfb11b48b170fc8f0e8872076d2cd09d1c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87609800"
---
# <a name="replicate-partitioned-tables-and-indexes"></a><span data-ttu-id="ea3c5-102">Replizieren partitionierter Tabellen und Indizes</span><span class="sxs-lookup"><span data-stu-id="ea3c5-102">Replicate Partitioned Tables and Indexes</span></span>
  <span data-ttu-id="ea3c5-103">Durch die Partitionierung können große Tabellen oder Indizes einfacher verwaltet werden, da Sie Teilmengen von Daten schnell und effizient verwalten und darauf zugreifen können und gleichzeitig die Integrität einer Datensammlung erhalten können.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-103">Partitioning makes large tables or indexes more manageable because partitioning enables you to manage and access subsets of data quickly and efficiently, and maintain the integrity of a data collection at the same time.</span></span> <span data-ttu-id="ea3c5-104">Weitere Informationen finden Sie unter [partitionierte Tabellen und Indizes](../../partitions/partitioned-tables-and-indexes.md).</span><span class="sxs-lookup"><span data-stu-id="ea3c5-104">For more information, see [Partitioned Tables and Indexes](../../partitions/partitioned-tables-and-indexes.md).</span></span> <span data-ttu-id="ea3c5-105">Die Replikation unterstützt die Partitionierung durch Bereitstellung einer Gruppe von Eigenschaften, die angeben, wie partitionierte Tabellen und Indizes behandelt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-105">Replication supports partitioning by providing a set of properties that specify how partitioned tables and indexes should be treated.</span></span>  
  
## <a name="article-properties-for-transactional-and-merge-replication"></a><span data-ttu-id="ea3c5-106">Artikeleigenschaften für die Transaktions- und Mergereplikation</span><span class="sxs-lookup"><span data-stu-id="ea3c5-106">Article Properties for Transactional and Merge Replication</span></span>  
 <span data-ttu-id="ea3c5-107">In der folgenden Tabelle sind die Objekte aufgelistet, die zum Partitionieren von Daten verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-107">The following table lists the objects that are used to partition data.</span></span>  
  
|<span data-ttu-id="ea3c5-108">Object</span><span class="sxs-lookup"><span data-stu-id="ea3c5-108">Object</span></span>|<span data-ttu-id="ea3c5-109">Erstellt mit</span><span class="sxs-lookup"><span data-stu-id="ea3c5-109">Created by using</span></span>|  
|------------|----------------------|  
|<span data-ttu-id="ea3c5-110">Partitionierte Tabelle oder partitionierter Index</span><span class="sxs-lookup"><span data-stu-id="ea3c5-110">Partitioned table or index</span></span>|<span data-ttu-id="ea3c5-111">CREATE TABLE oder CREATE INDEX</span><span class="sxs-lookup"><span data-stu-id="ea3c5-111">CREATE TABLE or CREATE INDEX</span></span>|  
|<span data-ttu-id="ea3c5-112">Partitionsfunktion</span><span class="sxs-lookup"><span data-stu-id="ea3c5-112">Partition function</span></span>|<span data-ttu-id="ea3c5-113">CREATE PARTITION FUNCTION</span><span class="sxs-lookup"><span data-stu-id="ea3c5-113">CREATE PARTITION FUNCTION</span></span>|  
|<span data-ttu-id="ea3c5-114">Partitionsschema</span><span class="sxs-lookup"><span data-stu-id="ea3c5-114">Partition scheme</span></span>|<span data-ttu-id="ea3c5-115">CREATE PARTITION SCHEME</span><span class="sxs-lookup"><span data-stu-id="ea3c5-115">CREATE PARTITION SCHEME</span></span>|  
  
 <span data-ttu-id="ea3c5-116">Die erste Gruppe von Eigenschaften, die mit der Partitionierung in Zusammenhang stehen, sind Artikelschemaoptionen, die bestimmen, ob Partitionierungsobjekte auf den Abonnenten kopiert werden sollen.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-116">The first set of properties related to partitioning are the article schema options that determine whether partitioning objects should be copied to the Subscriber.</span></span> <span data-ttu-id="ea3c5-117">Diese Schemaoptionen können folgendermaßen festgelegt werden:</span><span class="sxs-lookup"><span data-stu-id="ea3c5-117">These schema options can be set in the following ways:</span></span>  
  
-   <span data-ttu-id="ea3c5-118">Auf der Seite **Artikeleigenschaften** des Assistenten für neue Veröffentlichungen oder im Dialogfeld Veröffentlichungseigenschaften.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-118">In the **Article Properties** page of the New Publication Wizard or the Publication Properties dialog box.</span></span> <span data-ttu-id="ea3c5-119">Um die in der vorherigen Tabelle aufgeführten Objekte zu kopieren, geben Sie `true` den Wert für die Eigenschaften **Tabellen Partitionierungs Schemas kopieren** und **Index Partitionierungs Schemas**kopieren an.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-119">To copy the objects listed in the previous table, specify a value of `true` for the properties **Copy table partitioning schemes** and **Copy index partitioning schemes**.</span></span> <span data-ttu-id="ea3c5-120">Informationen zum Zugriff auf die Seite **Artikeleigenschaften** finden Sie unter [Anzeigen und Ändern von Veröffentlichungseigenschaften](view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="ea3c5-120">For information about how to access the **Article Properties** page, see [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span></span>  
  
-   <span data-ttu-id="ea3c5-121">Mithilfe des Parameters *schema_option* einer der folgenden gespeicherten Prozeduren:</span><span class="sxs-lookup"><span data-stu-id="ea3c5-121">By using the *schema_option* parameter of one of the following stored procedures:</span></span>  
  
    -   <span data-ttu-id="ea3c5-122">[sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql) oder [sp_changearticle](/sql/relational-databases/system-stored-procedures/sp-changearticle-transact-sql) für die Transaktionsreplikation</span><span class="sxs-lookup"><span data-stu-id="ea3c5-122">[sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql) or [sp_changearticle](/sql/relational-databases/system-stored-procedures/sp-changearticle-transact-sql) for transactional replication</span></span>  
  
    -   <span data-ttu-id="ea3c5-123">[sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) oder [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql) für die Mergereplikation</span><span class="sxs-lookup"><span data-stu-id="ea3c5-123">[sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) or [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql) for merge replication</span></span>  
  
     <span data-ttu-id="ea3c5-124">Geben Sie die entsprechenden Schemaoptionswerte an, um die in der obigen Tabelle aufgelisteten Objekte zu kopieren.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-124">To copy the objects listed in the previous table, specify the appropriate schema option values.</span></span> <span data-ttu-id="ea3c5-125">Informationen zum Angeben von Schemaoptionen finden Sie unter [Specify Schema Options](specify-schema-options.md).</span><span class="sxs-lookup"><span data-stu-id="ea3c5-125">For information about how to specify schema options, see [Specify Schema Options](specify-schema-options.md).</span></span>  
  
 <span data-ttu-id="ea3c5-126">Durch die Replikation werden Objekte während der Erstsynchronisierung auf den Abonnenten kopiert.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-126">Replication copies objects to the Subscriber during the initial synchronization.</span></span> <span data-ttu-id="ea3c5-127">Wenn im Partitionsschema andere Dateigruppen als die PRIMARY-Dateigruppe verwendet werden, müssen diese vor der Erstinitialisierung auf dem Abonnenten vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-127">If the partition scheme uses filegroups other than the PRIMARY filegroup, those filegroups must exist on the Subscriber before the initial synchronization.</span></span>  
  
 <span data-ttu-id="ea3c5-128">Nachdem der Abonnent initialisiert wurde, werden Datenänderungen an den Abonnenten weitergegeben und auf die entsprechenden Partitionen übertragen.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-128">After the Subscriber is initialized, data changes are propagated to the Subscriber and applied to the appropriate partitions.</span></span> <span data-ttu-id="ea3c5-129">Änderungen am Partitionsschema werden jedoch nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-129">However, changes to the partition scheme are not supported.</span></span> <span data-ttu-id="ea3c5-130">Bei Transaktions- und Mergereplikationen wird die Replikation der folgenden Befehle nicht unterstützt: ALTER PARTITION FUNCTION, ALTER PARTITION SCHEME bzw. die Anweisung REBUILD WITH PARTITION von ALTER INDEX</span><span class="sxs-lookup"><span data-stu-id="ea3c5-130">Transactional and merge replication do not support replicating the following commands: ALTER PARTITION FUNCTION, ALTER PARTITION SCHEME, or the REBUILD WITH PARTITION statement of ALTER INDEX.</span></span>  <span data-ttu-id="ea3c5-131">Die ihnen zugeordneten Änderungen werden nicht automatisch auf den Abonnenten repliziert.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-131">The changes associated with them will not be automatically replicated to the Subscriber.</span></span> <span data-ttu-id="ea3c5-132">Es liegt in der Zuständigkeit des Benutzers, ähnliche Änderungen manuell für den Abonnenten vorzunehmen.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-132">It is the responsibility of the user to make similar changes manually at the Subscriber.</span></span>  
  
## <a name="replication-support-for-partition-switching"></a><span data-ttu-id="ea3c5-133">Replikationsunterstützung für Partitionswechsel</span><span class="sxs-lookup"><span data-stu-id="ea3c5-133">Replication Support for Partition Switching</span></span>  
 <span data-ttu-id="ea3c5-134">Ein wesentlicher Vorteil der Tabellenpartitionierung besteht in der Fähigkeit, Teilmengen von Daten rasch und effizient zwischen Partitionen zu verschieben.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-134">One of the key benefits of table partitioning is the ability to quickly and efficiently move subsets of data between partitions.</span></span> <span data-ttu-id="ea3c5-135">Daten werden mit dem Befehl SWITCH PARTITION verschoben.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-135">Data is moved by using the SWITCH PARTITION command.</span></span> <span data-ttu-id="ea3c5-136">Wenn eine Tabelle für die Replikation aktiviert wurde, werden SWITCH PARTITION-Vorgänge aus folgenden Gründen standardmäßig blockiert:</span><span class="sxs-lookup"><span data-stu-id="ea3c5-136">By default, when a table is enabled for replication, SWITCH PARTITION operations are blocked for the following reasons:</span></span>  
  
-   <span data-ttu-id="ea3c5-137">Wenn Daten in eine oder aus einer Tabelle verschoben werden, die auf dem Verleger, aber nicht auf dem Abonnenten vorhanden sind, können die Daten von Verleger und Abonnenten inkonsistent werden.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-137">If data is moved into or out of a table that exists at the Publisher but does not exist at the Subscriber, the Publisher and Subscriber could become inconsistent with one another.</span></span> <span data-ttu-id="ea3c5-138">Dieses Problem tritt i. d. R. auf, wenn Daten in eine oder aus einer Stagingtabelle verschoben werden.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-138">This problem typically occurs when data is moved into or out of a staging table.</span></span>  
  
-   <span data-ttu-id="ea3c5-139">Wenn der Abonnent über eine andere Definition für die partitionierte Tabelle verfügt als der Verleger, dann schlägt der Verteilungs-Agent fehl, wenn er Änderungen auf dem Abonnenten anzuwenden versucht.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-139">If the Subscriber has a different definition for the partitioned table than the Publisher, the Distribution Agent will fail when it tries to apply changes at the Subscriber.</span></span>  
  
 <span data-ttu-id="ea3c5-140">Trotz dieser potenziellen Probleme können Partitionswechsel für Transaktionsreplikationen aktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-140">Despite these potential issues, partition switching can be enabled for transactional replication.</span></span> <span data-ttu-id="ea3c5-141">Bevor Sie Partitionswechsel aktivieren, müssen Sie sicherstellen, dass alle an einem Partitionswechsel beteiligten Tabellen sowohl auf dem Verleger als auch auf dem Abonnenten vorhanden sind und dass die Tabellen- und Partitionsdefinitionen auf dem Verleger und dem Abonnenten identisch sind.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-141">Before you enable partition switching, make sure that all tables that are involved in partition switching exist at the Publisher and Subscriber, and make sure that the table and partition definitions are the same.</span></span>  
  
 <span data-ttu-id="ea3c5-142">Wenn Partitionen bei den Verlegern und Abonnenten über das gleiche Partitionsschema verfügen, können Sie *allow_partition_switch* zusammen mit *replication_partition_switch* aktivieren, wodurch nur die "partition switch"-Anweisung für den Abonnenten repliziert wird.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-142">When partitions have the exact same partition scheme at the publishers and subscribers you can turn on *allow_partition_switch* along with *replication_partition_switch* which will only replicate the partition switch statement to the subscriber.</span></span> <span data-ttu-id="ea3c5-143">Sie können auch *allow_partition_switch* aktivieren, ohne die DDL zu replizieren.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-143">You can also turn on *allow_partition_switch* without replicating the DDL.</span></span> <span data-ttu-id="ea3c5-144">Dies ist hilfreich, wenn Sie alte Monate aus der Partition auslagern möchten und die replizierte Partition jedoch für ein weiteres Jahr für Sicherungszwecke auf dem Abonnenten aufbewahren möchten.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-144">This is useful in the case where you want to roll old months out of the partition but keep the replicated partition in place for another year for backup purposes at the subscriber.</span></span>  
  
 <span data-ttu-id="ea3c5-145">Wenn Sie über die aktuelle Version Partitionswechsel für SQL Server 2008 R2 aktivieren, benötigen Sie möglicherweise schon in naher Zukunft auch Teilungs- und Mergevorgänge.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-145">If you enable partition switching on SQL Server 2008 R2 through the current version, you might also need split and merge operations in near future.</span></span> <span data-ttu-id="ea3c5-146">Stellen Sie vor dem Ausführen von Teilungs- oder Mergevorgängen in replizierten Tabellen sicher, dass für die fragliche Partition keine replizierten Befehle ausstehen.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-146">Before executing a split or merge operation on a replicated table ensure that the partition in question does not have any pending replicated commands.</span></span> <span data-ttu-id="ea3c5-147">Sie sollten außerdem sicherstellen, dass für die Partition während der Teilungs- und Mergevorgänge keine DML-Vorgänge ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-147">You should also ensure that no DML operations are executed on the partition during the split and merge operations.</span></span> <span data-ttu-id="ea3c5-148">Wenn Transaktionen vorhanden sind, die nicht vom Protokollleser verarbeitet wurden, oder DML-Vorgänge für eine Partition einer replizierten Tabelle ausgeführt werden, während ein Teilungs- oder Mergevorgang stattfindet (an dem die gleiche Partition beteiligt ist), kann das zu einem Verarbeitungsfehler beim Protokolllese-Agent führen.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-148">If there are transactions which the log reader has not processed, or if DML operations are performed on a partition of a replicated table while a split or merge operation is executed (involving the same partition), it could lead to a processing error with log reader agent.</span></span> <span data-ttu-id="ea3c5-149">Um den Fehler zu beheben, ist möglicherweise eine erneute Initialisierung des Abonnements erforderlich.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-149">In order to correct the error, it might require a re-initialization of the subscription.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="ea3c5-150">Sie sollten keinen Partitionswechsel für Peer-zu-Peer-Veröffentlichungen aktivieren, da die ausgeblendete Spalte dazu verwendet wird, um Konflikte zu erkennen und aufzulösen.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-150">You should not enable partition switching for Peer-to-Peer publications, due to the hidden column which is used to detect and resolve conflict.</span></span>  
  
### <a name="enabling-partition-switching"></a><span data-ttu-id="ea3c5-151">Aktivieren des Partitionswechsels</span><span class="sxs-lookup"><span data-stu-id="ea3c5-151">Enabling Partition Switching</span></span>  
 <span data-ttu-id="ea3c5-152">Die folgenden Eigenschaften von Transaktionsveröffentlichungen ermöglichen es den Benutzern, das Verhalten von Partitionswechseln in einer replizierten Umgebung zu steuern:</span><span class="sxs-lookup"><span data-stu-id="ea3c5-152">The following properties for transactional publications enable users to control the behavior of partition switching in a replicated environment:</span></span>  
  
-   <span data-ttu-id="ea3c5-153">\*\* \@ \*\*Wenn Sie auf festgelegt `true` haben, kann Switch Partition für die Veröffentlichungs Datenbank ausgeführt werden. allow_partition_switch</span><span class="sxs-lookup"><span data-stu-id="ea3c5-153">**\@allow_partition_switch**, when set to `true`, SWITCH PARTITION can be executed against the publication database.</span></span>  
  
-   <span data-ttu-id="ea3c5-154">\*\* \@ replicate_partition_switch\*\* bestimmt, ob die Switch Partition DDL-Anweisung auf Abonnenten repliziert werden soll.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-154">**\@replicate_partition_switch** determines whether the SWITCH PARTITION DDL statement should be replicated to Subscribers.</span></span> <span data-ttu-id="ea3c5-155">Diese Option ist nur gültig, wenn \*\* \@ allow_partition_switch\*\* auf festgelegt ist `true` .</span><span class="sxs-lookup"><span data-stu-id="ea3c5-155">This option is valid only when **\@allow_partition_switch** is set to `true`.</span></span>  
  
 <span data-ttu-id="ea3c5-156">Sie können diese Eigenschaften beim Erstellen der Veröffentlichung mit [sp_addpublication](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) oder nach der Erstellung der Veröffentlichung mit [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql) festlegen.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-156">You can set these properties by using [sp_addpublication](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) when the publication is created, or by using [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql) after the publication is created.</span></span> <span data-ttu-id="ea3c5-157">Wie bereits erwähnt, unterstützen Mergereplikationen keine Partitionswechsel.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-157">As noted earlier, merge replication does not support partition switching.</span></span> <span data-ttu-id="ea3c5-158">Entfernen Sie die Tabelle aus der Datenbank, um SWITCH PARTITION für eine Tabelle auszuführen, die für Mergereplikationen aktiviert wurde.</span><span class="sxs-lookup"><span data-stu-id="ea3c5-158">To execute SWITCH PARTITION on a table that is enabled for merge replication, remove the table from the publication.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ea3c5-159">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="ea3c5-159">See Also</span></span>  
 [<span data-ttu-id="ea3c5-160">Veröffentlichen von Daten und Datenbankobjekten</span><span class="sxs-lookup"><span data-stu-id="ea3c5-160">Publish Data and Database Objects</span></span>](publish-data-and-database-objects.md)  
  
  

---
title: Verwalten von Partitionen für eine Mergeveröffentlichung mit parametrisierten Filtern | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- partitions [SQL Server replication]
- merge replication partitions [SQL Server replication], SQL Server Management Studio
- parameterized filters [SQL Server replication], partition management
ms.assetid: fb5566fe-58c5-48f7-8464-814ea78e6221
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 983b02865c0564919259f896bf09d8bdb0cd969f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87608536"
---
# <a name="manage-partitions-for-a-merge-publication-with-parameterized-filters"></a><span data-ttu-id="99992-102">Verwalten von Partitionen für eine Mergeveröffentlichung mit parametrisierten Filtern</span><span class="sxs-lookup"><span data-stu-id="99992-102">Manage Partitions for a Merge Publication with Parameterized Filters</span></span>
  <span data-ttu-id="99992-103">In diesem Thema wird beschrieben, wie Partitionen für eine Mergeveröffentlichung mit parametrisierten Filtern in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] mit [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)]oder Replikationsverwaltungsobjekten (RMO) verwaltet werden.</span><span class="sxs-lookup"><span data-stu-id="99992-103">This topic describes how to manage partitions for a merge publication with parameterized filters in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="99992-104">Mithilfe parametrisierter Zeilenfilter können nicht überlappende Partitionen generiert werden.</span><span class="sxs-lookup"><span data-stu-id="99992-104">Parameterized row filters can be used to generate nonoverlapping partitions.</span></span> <span data-ttu-id="99992-105">Diese Partitionen können eingeschränkt werden, sodass nur ein Abonnement eine bestimmte Partition erhält.</span><span class="sxs-lookup"><span data-stu-id="99992-105">These partitions can be restricted so that only one subscription receives a given partition.</span></span> <span data-ttu-id="99992-106">In solchen Fällen führt eine große Anzahl von Abonnenten zu einer großen Anzahl von Partitionen, was wiederum eine gleiche Anzahl von partitionierten Momentaufnahmen erforderlich macht.</span><span class="sxs-lookup"><span data-stu-id="99992-106">In these cases, a large number of subscribers will result in a large number of partitions, which in turn requires an equal number of partitioned snapshots.</span></span> <span data-ttu-id="99992-107">Weitere Informationen zu parametrisierten Zeilenfiltern finden Sie unter [Parametrisierte Zeilenfilter](../merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="99992-107">For more information, see [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
 <span data-ttu-id="99992-108">**In diesem Thema**</span><span class="sxs-lookup"><span data-stu-id="99992-108">**In This Topic**</span></span>  
  
-   <span data-ttu-id="99992-109">**Vorbereitungen:**</span><span class="sxs-lookup"><span data-stu-id="99992-109">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="99992-110">Empfehlungen</span><span class="sxs-lookup"><span data-stu-id="99992-110">Recommendations</span></span>](#Recommendations)  
  
-   <span data-ttu-id="99992-111">**So verwalten Sie Partitionen für eine Mergeveröffentlichung mit parametrisierten Filtern mit:**</span><span class="sxs-lookup"><span data-stu-id="99992-111">**To manage partitions for a merge publication with parameterized filters, using:**</span></span>  
  
     [<span data-ttu-id="99992-112">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="99992-112">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="99992-113">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="99992-113">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="99992-114">Replikationsverwaltungsobjekte (RMO)</span><span class="sxs-lookup"><span data-stu-id="99992-114">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="99992-115">Vorbereitungen</span><span class="sxs-lookup"><span data-stu-id="99992-115">Before You Begin</span></span>  
  
###  <a name="recommendations"></a><a name="Recommendations"></a> <span data-ttu-id="99992-116">Empfehlungen</span><span class="sxs-lookup"><span data-stu-id="99992-116">Recommendations</span></span>  
  
-   <span data-ttu-id="99992-117">Wenn Sie, wie empfohlen, ein Skript für eine Replikationstopologie erstellen, enthalten die Veröffentlichungsskripts die Aufrufe der gespeicherten Prozedur zum Erstellen von Datenpartitionen.</span><span class="sxs-lookup"><span data-stu-id="99992-117">If you script a replication topology, which is recommended, publication scripts contain the stored procedure calls to create data partitions.</span></span> <span data-ttu-id="99992-118">Die Skripts stellen einen Verweis für die erstellten Partitionen bereit und ermöglichen das erneute Erstellen von Partitionen, falls dies erforderlich wird.</span><span class="sxs-lookup"><span data-stu-id="99992-118">The script provides a reference for the partitions created and a way in which to re-create one or more partitions if necessary.</span></span> <span data-ttu-id="99992-119">Weitere Informationen finden Sie unter [Scripting Replication](../scripting-replication.md).</span><span class="sxs-lookup"><span data-stu-id="99992-119">For more information, see [Scripting Replication](../scripting-replication.md).</span></span>  
  
-   <span data-ttu-id="99992-120">Wenn eine Veröffentlichung parametrisierte Filter aufweist, die Abonnements mit nicht überlappenden Partitionen ergeben, und ein bestimmtes Abonnement verloren gegangen ist und neu erstellt werden muss, müssen Sie wie folgt vorgehen: Entfernen Sie die Partition, die abonniert wurde, erstellen Sie das Abonnement neu, und erstellen Sie dann die Partition neu.</span><span class="sxs-lookup"><span data-stu-id="99992-120">When a publication has parameterized filters that yield subscriptions with nonoverlapping partitions, and if a particular subscription is lost and needs to be re-created, you must do the following: remove the partition that was subscribed to, re-create the subscription, and then re-create the partition.</span></span> <span data-ttu-id="99992-121">Weitere Informationen zu parametrisierten Zeilenfiltern finden Sie unter [Parametrisierte Zeilenfilter](../merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="99992-121">For more information, see [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span></span> <span data-ttu-id="99992-122">Durch Replikation werden Erstellungsskripts für vorhandene Abonnentenpartitionen generiert, wenn ein Erstellungsskript für eine Veröffentlichung generiert wird.</span><span class="sxs-lookup"><span data-stu-id="99992-122">Replication generates creation scripts for existing Subscriber partitions when a publication creation script is generated.</span></span> <span data-ttu-id="99992-123">Weitere Informationen finden Sie unter [Scripting Replication](../scripting-replication.md).</span><span class="sxs-lookup"><span data-stu-id="99992-123">For more information, see [Scripting Replication](../scripting-replication.md).</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="99992-124">Verwenden von SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="99992-124">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="99992-125">Zum Verwalten von Partitionen steht Ihnen die Seite **Datenpartitionen** des Dialogfelds **Veröffentlichungseigenschaften – \<Publication>** zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="99992-125">Manage partitions on the **Data Partitions** page of the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="99992-126">Weitere Informationen zum Zugreifen auf dieses Dialogfeld finden Sie unter [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="99992-126">For more information about accessing this dialog box, see [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span></span> <span data-ttu-id="99992-127">Auf dieser Seite können Sie Partitionen erstellen und löschen, Abonnenten ermöglichen, die Momentaufnahmegenerierung und -bereitstellung zu initialisieren, Momentaufnahmen für eine oder mehrere Partitionen generieren und einen Cleanup von Momentaufnahmen ausführen.</span><span class="sxs-lookup"><span data-stu-id="99992-127">On this page you can: create and delete partitions; allow Subscribers to initiate snapshot generation and delivery; generate snapshots for one or more partitions; and clean up snapshots.</span></span>  
  
#### <a name="to-create-a-partition"></a><span data-ttu-id="99992-128">So erstellen Sie eine Partition</span><span class="sxs-lookup"><span data-stu-id="99992-128">To create a partition</span></span>  
  
1.  <span data-ttu-id="99992-129">Klicken Sie auf der Seite **Datenpartitionen** des Dialogfelds **Veröffentlichungseigenschaften – \<Publication>** auf **Hinzufügen**.</span><span class="sxs-lookup"><span data-stu-id="99992-129">On the **Data Partitions** page of the **Publication Properties - \<Publication>** dialog box, click **Add**.</span></span>  
  
2.  <span data-ttu-id="99992-130">Geben Sie im Dialogfeld **Datenpartition hinzufügen** einen Wert für den **HOST_NAME()** - und/oder **SUSER_SNAME()** -Parameter für die Partition ein, die Sie erstellen möchten.</span><span class="sxs-lookup"><span data-stu-id="99992-130">In the **Add Data Partition** dialog box, enter a value for the **HOST_NAME()** and/or **SUSER_SNAME()** value associated with the partition you want to create.</span></span>  
  
3.  <span data-ttu-id="99992-131">Optional können Sie einen Zeitplan für das Aktualisieren von Momentaufnahmen angeben:</span><span class="sxs-lookup"><span data-stu-id="99992-131">Optionally specify a schedule for refreshing snapshots:</span></span>  
  
    1.  <span data-ttu-id="99992-132">Aktivieren Sie die Option **Ausführung des Momentaufnahme-Agents für diese Partition zu folgenden Zeitpunkten planen**.</span><span class="sxs-lookup"><span data-stu-id="99992-132">Select **Schedule the Snapshot Agent for this partition to run at the following time(s)**</span></span>  
  
    2.  <span data-ttu-id="99992-133">Akzeptieren Sie den Standardzeitplan für die Aktualisierung von Momentaufnahmen, oder klicken Sie auf **Ändern** , um einen anderen Zeitplan anzugeben.</span><span class="sxs-lookup"><span data-stu-id="99992-133">Accept the default schedule for refreshing snapshots, or click **Change** to specify a different schedule.</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-delete-a-partition"></a><span data-ttu-id="99992-134">So löschen Sie eine Partition</span><span class="sxs-lookup"><span data-stu-id="99992-134">To delete a partition</span></span>  
  
1.  <span data-ttu-id="99992-135">Wählen Sie in der Tabelle auf der Seite **Datenpartitionen** die gewünschte Partition aus.</span><span class="sxs-lookup"><span data-stu-id="99992-135">On the **Data Partitions** page, select a partition in the grid.</span></span>  
  
2.  <span data-ttu-id="99992-136">Klicken Sie auf **Löschen**.</span><span class="sxs-lookup"><span data-stu-id="99992-136">Click **Delete**.</span></span>  
  
#### <a name="to-allow-subscribers-to-initiate-snapshot-generation-and-delivery"></a><span data-ttu-id="99992-137">So lassen Sie zu, dass Abonnenten die Momentaufnahmegenerierung und -übermittlung starten</span><span class="sxs-lookup"><span data-stu-id="99992-137">To allow Subscribers to initiate snapshot generation and delivery</span></span>  
  
1.  <span data-ttu-id="99992-138">Aktivieren Sie auf der Seite **Datenpartitionen** die Option **Bei Bedarf automatisch eine Partition definieren und eine Momentaufnahme generieren, wenn ein neuer Abonnent zu synchronisieren versucht**.</span><span class="sxs-lookup"><span data-stu-id="99992-138">On the **Data Partitions** page, select **Automatically define a partition and generate a snapshot if needed when a new Subscriber tries to synchronize**.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-generate-a-snapshot-for-a-partition"></a><span data-ttu-id="99992-139">So generieren Sie eine Momentaufnahme für eine Partition</span><span class="sxs-lookup"><span data-stu-id="99992-139">To generate a snapshot for a partition</span></span>  
  
1.  <span data-ttu-id="99992-140">Wählen Sie in der Tabelle auf der Seite **Datenpartitionen** die gewünschte Partition aus.</span><span class="sxs-lookup"><span data-stu-id="99992-140">On the **Data Partitions** page, select a partition in the grid.</span></span>  
  
2.  <span data-ttu-id="99992-141">Klicken Sie auf **Die ausgewählten Momentaufnahmen jetzt generieren**.</span><span class="sxs-lookup"><span data-stu-id="99992-141">Click **Generate the selected snapshots now**.</span></span>  
  
#### <a name="to-clean-up-a-snapshot-for-a-partition"></a><span data-ttu-id="99992-142">So führen Sie einen Cleanup einer Momentaufnahme für eine Partition aus</span><span class="sxs-lookup"><span data-stu-id="99992-142">To clean up a snapshot for a partition</span></span>  
  
1.  <span data-ttu-id="99992-143">Wählen Sie in der Tabelle auf der Seite **Datenpartitionen** die gewünschte Partition aus.</span><span class="sxs-lookup"><span data-stu-id="99992-143">On the **Data Partitions** page, select a partition in the grid.</span></span>  
  
2.  <span data-ttu-id="99992-144">Klicken Sie auf **Cleanup der vorhandenen Momentaufnahmen ausführen**.</span><span class="sxs-lookup"><span data-stu-id="99992-144">Click **Clean up the existing snapshots**.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="99992-145">Verwenden von Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="99992-145">Using Transact-SQL</span></span>  
 <span data-ttu-id="99992-146">Sie können die vorhandenen Partitionen mithilfe gespeicherter Replikationsprozeduren programmgesteuert aufzählen, um eine Veröffentlichung mit parametrisierten Filtern besser verwalten zu können.</span><span class="sxs-lookup"><span data-stu-id="99992-146">To better manage a publication with parameterized filters, you can programmatically enumerate the existing partitions using replication stored procedures.</span></span> <span data-ttu-id="99992-147">Zudem können Sie Partitionen erstellen und vorhandene Partitionen löschen.</span><span class="sxs-lookup"><span data-stu-id="99992-147">You can also create and delete existing partitions.</span></span> <span data-ttu-id="99992-148">Die folgenden Informationen zu vorhandenen Partitionen können abgerufen werden:</span><span class="sxs-lookup"><span data-stu-id="99992-148">The following information on existing partitions can be obtained:</span></span>  
  
-   <span data-ttu-id="99992-149">Filterung einer Partition (mit [SUSER_SNAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/suser-sname-transact-sql) oder [HOST_NAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/host-name-transact-sql)).</span><span class="sxs-lookup"><span data-stu-id="99992-149">How a partition is filtered (using [SUSER_SNAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/suser-sname-transact-sql) or [HOST_NAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/host-name-transact-sql)).</span></span>  
  
-   <span data-ttu-id="99992-150">Der Name des Auftrags, der eine partitionierte Momentaufnahme generiert.</span><span class="sxs-lookup"><span data-stu-id="99992-150">The name of the job that generates a partitioned snapshot.</span></span>  
  
-   <span data-ttu-id="99992-151">Das Datum der letzten Ausführung eines Auftrags für eine partitionierte Momentaufnahme.</span><span class="sxs-lookup"><span data-stu-id="99992-151">The last time that a partitioned snapshot job ran.</span></span>  
  
 <span data-ttu-id="99992-152">Während der zweite Teil der zweiteiligen Momentaufnahme bedarfsgerecht generiert werden kann, wenn ein neues Abonnement initialisiert wird, können Sie mithilfe der nachfolgenden Anweisungen die Generierung dieser Momentaufnahme steuern und die Momentaufnahme im Voraus zu einem beliebigen Zeitpunkt erstellen.</span><span class="sxs-lookup"><span data-stu-id="99992-152">While the second part of the two-part snapshot can be generated on-demand when a new subscription is initialized, the procedures below enable you to control how this snapshot is generated and to pre-generate this snapshot when it is most convenient.</span></span> <span data-ttu-id="99992-153">Weitere Informationen finden Sie unter [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="99992-153">For more information, see [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span></span>  
  
#### <a name="to-view-information-on-existing-partitions"></a><span data-ttu-id="99992-154">So zeigen Sie Informationen zu vorhandenen Partitionen an</span><span class="sxs-lookup"><span data-stu-id="99992-154">To view information on existing partitions</span></span>  
  
1.  <span data-ttu-id="99992-155">Führen Sie auf dem Verleger für die Veröffentlichungsdatenbank [sp_helpmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergepartition-transact-sql) aus.</span><span class="sxs-lookup"><span data-stu-id="99992-155">At the Publisher on the publication database, execute [sp_helpmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergepartition-transact-sql).</span></span> <span data-ttu-id="99992-156">Geben Sie den Namen der Veröffentlichung für die \*\* \@ Veröffentlichung\*\*an.</span><span class="sxs-lookup"><span data-stu-id="99992-156">Specify the name of the publication for **\@publication**.</span></span> <span data-ttu-id="99992-157">Optionale Geben Sie \*\* \@ SUSER_SNAME\*\* oder \*\* \@ HOST_NAME\*\* an, damit nur Informationen basierend auf einem einzelnen Filter Kriterium zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="99992-157">(Optional) Specify **\@suser_sname** or **\@host_name** to return only information based on a single filtering criterion.</span></span>  
  
#### <a name="to-define-a-new-partition-and-generate-a-new-partitioned-snapshot"></a><span data-ttu-id="99992-158">So können Sie eine neue Partition definieren und eine neue partitionierte Momentaufnahme generieren</span><span class="sxs-lookup"><span data-stu-id="99992-158">To define a new partition and generate a new partitioned snapshot</span></span>  
  
1.  <span data-ttu-id="99992-159">Führen Sie auf dem Verleger für die Veröffentlichungsdatenbank [sp_addmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepartition-transact-sql) aus.</span><span class="sxs-lookup"><span data-stu-id="99992-159">At the Publisher on the publication database, execute [sp_addmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepartition-transact-sql).</span></span> <span data-ttu-id="99992-160">Geben Sie den Namen der Veröffentlichung für die \*\* \@ Veröffentlichung\*\*und den parametrisierten Wert an, der die Partition für eine der folgenden Definitionen definiert:</span><span class="sxs-lookup"><span data-stu-id="99992-160">Specify the name of the publication for **\@publication**, and the parameterized value that defines the partition for one of the following:</span></span>  
  
    -   <span data-ttu-id="99992-161">\*\* \@ SUSER_SNAME\*\* : Wenn der parametrisierte Filter durch den von [SUSER_SNAME &#40;Transact-SQL-&#41;](/sql/t-sql/functions/suser-sname-transact-sql)zurückgegebenen Wert definiert wird.</span><span class="sxs-lookup"><span data-stu-id="99992-161">**\@suser_sname** - when the parameterized filter is defined by the value returned by [SUSER_SNAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/suser-sname-transact-sql).</span></span>  
  
    -   <span data-ttu-id="99992-162">\*\* \@ HOST_NAME\*\* : Wenn der parametrisierte Filter durch den von [HOST_NAME &#40;Transact-SQL-&#41;](/sql/t-sql/functions/host-name-transact-sql)zurückgegebenen Wert definiert wird.</span><span class="sxs-lookup"><span data-stu-id="99992-162">**\@host_name** - when the parameterized filter is defined by the value returned by [HOST_NAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/host-name-transact-sql).</span></span>  
  
2.  <span data-ttu-id="99992-163">Erstellen und initialisieren Sie die parametrisierte Momentaufnahme für diese neue Partition.</span><span class="sxs-lookup"><span data-stu-id="99992-163">Create and initialize the parameterized snapshot for this new partition.</span></span> <span data-ttu-id="99992-164">Weitere Informationen finden Sie unter [Erstellen einer Momentaufnahme für eine Mergeveröffentlichung mit parametrisierten Filtern](../create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="99992-164">For more information, see [Create a Snapshot for a Merge Publication with Parameterized Filters](../create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span></span>  
  
#### <a name="to-delete-a-partition"></a><span data-ttu-id="99992-165">So löschen Sie eine Partition</span><span class="sxs-lookup"><span data-stu-id="99992-165">To delete a partition</span></span>  
  
1.  <span data-ttu-id="99992-166">Führen Sie auf dem Verleger für die Veröffentlichungsdatenbank [sp_dropmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-dropmergepartition-transact-sql) aus.</span><span class="sxs-lookup"><span data-stu-id="99992-166">At the Publisher on the publication database, execute [sp_dropmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-dropmergepartition-transact-sql).</span></span> <span data-ttu-id="99992-167">Geben Sie den Namen der Veröffentlichung für die \*\* \@ Veröffentlichung\*\* und den parametrisierten Wert an, der die Partition für eine der folgenden Definitionen definiert:</span><span class="sxs-lookup"><span data-stu-id="99992-167">Specify the name of the publication for **\@publication** and the parameterized value that defines the partition for one of the following:</span></span>  
  
    -   <span data-ttu-id="99992-168">\*\* \@ SUSER_SNAME\*\* : Wenn der parametrisierte Filter durch den von [SUSER_SNAME &#40;Transact-SQL-&#41;](/sql/t-sql/functions/suser-sname-transact-sql)zurückgegebenen Wert definiert wird.</span><span class="sxs-lookup"><span data-stu-id="99992-168">**\@suser_sname** - when the parameterized filter is defined by the value returned by [SUSER_SNAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/suser-sname-transact-sql).</span></span>  
  
    -   <span data-ttu-id="99992-169">\*\* \@ HOST_NAME\*\* : Wenn der parametrisierte Filter durch den von [HOST_NAME &#40;Transact-SQL-&#41;](/sql/t-sql/functions/host-name-transact-sql)zurückgegebenen Wert definiert wird.</span><span class="sxs-lookup"><span data-stu-id="99992-169">**\@host_name** - when the parameterized filter is defined by the value returned by [HOST_NAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/host-name-transact-sql).</span></span>  
  
     <span data-ttu-id="99992-170">Dadurch werden zudem der Momentaufnahmeauftrag und alle Momentaufnahmedateien für die Partition entfernt.</span><span class="sxs-lookup"><span data-stu-id="99992-170">This also removes the snapshot job and any snapshot files for the partition.</span></span>  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="99992-171">Verwenden von Replikationsverwaltungsobjekten (RMO)</span><span class="sxs-lookup"><span data-stu-id="99992-171">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="99992-172">Um eine Veröffentlichung mit parametrisierten Filtern besser verwalten zu können, können Sie programmgesteuert neue Abonnentenpartitionen erstellen, die vorhandenen Abonnentenpartitionen aufzählen und Abonnentenpartitionen mithilfe von Replikationsverwaltungsobjekten (RMO) entfernen.</span><span class="sxs-lookup"><span data-stu-id="99992-172">To better manage a publication with parameterized filters, you can programmatically create new Subscriber partitions, enumerate the existing Subscriber partitions, and delete Subscriber partitions by using Replication Management Objects (RMO).</span></span> <span data-ttu-id="99992-173">Informationen zum Erstellen von Abonnentenpartitionen finden Sie unter [Erstellen einer Momentaufnahme für eine Mergeveröffentlichung mit parametrisierten Filtern](../create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="99992-173">For information about how to create Subscriber partitions, see [Create a Snapshot for a Merge Publication with Parameterized Filters](../create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span></span> <span data-ttu-id="99992-174">Die folgenden Informationen zu vorhandenen Partitionen können abgerufen werden:</span><span class="sxs-lookup"><span data-stu-id="99992-174">The following information about existing partitions can be obtained:</span></span>  
  
-   <span data-ttu-id="99992-175">Der Wert und die Filterfunktion, auf dem bzw. der die Partition basiert.</span><span class="sxs-lookup"><span data-stu-id="99992-175">The value and filtering function upon which the partition is based.</span></span>  
  
-   <span data-ttu-id="99992-176">Der Name des Auftrags, der eine parametrisierte Momentaufnahme für den Abonnenten generiert.</span><span class="sxs-lookup"><span data-stu-id="99992-176">The name of the job that generates a parameterized snapshot for the Subscriber.</span></span>  
  
-   <span data-ttu-id="99992-177">Das Datum der letzten Ausführung eines Auftrags für eine parametrisierte Momentaufnahme.</span><span class="sxs-lookup"><span data-stu-id="99992-177">The last time that a parameterized snapshot job ran.</span></span>  
  
#### <a name="to-view-information-on-existing-partitions"></a><span data-ttu-id="99992-178">So zeigen Sie Informationen zu vorhandenen Partitionen an</span><span class="sxs-lookup"><span data-stu-id="99992-178">To view information on existing partitions</span></span>  
  
1.  <span data-ttu-id="99992-179">Erstellen Sie eine Verbindung mit dem Verleger, indem Sie die <xref:Microsoft.SqlServer.Management.Common.ServerConnection> -Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="99992-179">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="99992-180">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.MergePublication>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="99992-180">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class.</span></span> <span data-ttu-id="99992-181">Legen Sie die <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> -Eigenschaft und die <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> -Eigenschaft für die Veröffentlichung fest, und legen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> -Eigenschaft auf die in Schritt 1 erstellte <xref:Microsoft.SqlServer.Management.Common.ServerConnection> fest.</span><span class="sxs-lookup"><span data-stu-id="99992-181">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
3.  <span data-ttu-id="99992-182">Rufen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> -Methode auf, um die Eigenschaften des Objekts abzurufen.</span><span class="sxs-lookup"><span data-stu-id="99992-182">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="99992-183">Wenn diese Methode `false` zurückgibt, sind die Veröffentlichungseigenschaften in Schritt 2 falsch definiert, oder die Veröffentlichung ist nicht vorhanden.</span><span class="sxs-lookup"><span data-stu-id="99992-183">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>  
  
4.  <span data-ttu-id="99992-184">Rufen Sie die <xref:Microsoft.SqlServer.Replication.MergePublication.EnumMergePartitions%2A> -Methode auf, und übergeben Sie das Ergebnis an ein Array von <xref:Microsoft.SqlServer.Replication.MergePartition> -Objekten.</span><span class="sxs-lookup"><span data-stu-id="99992-184">Call the <xref:Microsoft.SqlServer.Replication.MergePublication.EnumMergePartitions%2A> method, and pass the result to an array of <xref:Microsoft.SqlServer.Replication.MergePartition> objects.</span></span>  
  
5.  <span data-ttu-id="99992-185">Rufen Sie für jedes <xref:Microsoft.SqlServer.Replication.MergePartition> -Objekt im Array alle gewünschten Eigenschaften ab.</span><span class="sxs-lookup"><span data-stu-id="99992-185">For each <xref:Microsoft.SqlServer.Replication.MergePartition> object in the array, get any properties of interest.</span></span>  
  
#### <a name="to-delete-existing-partitions"></a><span data-ttu-id="99992-186">So löschen Sie vorhandene Partitionen</span><span class="sxs-lookup"><span data-stu-id="99992-186">To delete existing partitions</span></span>  
  
1.  <span data-ttu-id="99992-187">Erstellen Sie eine Verbindung mit dem Verleger, indem Sie die <xref:Microsoft.SqlServer.Management.Common.ServerConnection> -Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="99992-187">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="99992-188">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.MergePublication>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="99992-188">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class.</span></span> <span data-ttu-id="99992-189">Legen Sie die <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> -Eigenschaft und die <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> -Eigenschaft für die Veröffentlichung fest, und legen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> -Eigenschaft auf die in Schritt 1 erstellte <xref:Microsoft.SqlServer.Management.Common.ServerConnection> fest.</span><span class="sxs-lookup"><span data-stu-id="99992-189">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
3.  <span data-ttu-id="99992-190">Rufen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> -Methode auf, um die Eigenschaften des Objekts abzurufen.</span><span class="sxs-lookup"><span data-stu-id="99992-190">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="99992-191">Wenn diese Methode `false` zurückgibt, sind die Veröffentlichungseigenschaften in Schritt 2 falsch definiert, oder die Veröffentlichung ist nicht vorhanden.</span><span class="sxs-lookup"><span data-stu-id="99992-191">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>  
  
4.  <span data-ttu-id="99992-192">Rufen Sie die <xref:Microsoft.SqlServer.Replication.MergePublication.EnumMergePartitions%2A> -Methode auf, und übergeben Sie das Ergebnis an ein Array von <xref:Microsoft.SqlServer.Replication.MergePartition> -Objekten.</span><span class="sxs-lookup"><span data-stu-id="99992-192">Call the <xref:Microsoft.SqlServer.Replication.MergePublication.EnumMergePartitions%2A> method, and pass the result to an array of <xref:Microsoft.SqlServer.Replication.MergePartition> objects.</span></span>  
  
5.  <span data-ttu-id="99992-193">Bestimmen Sie für jedes <xref:Microsoft.SqlServer.Replication.MergePartition> -Objekt im Array, ob die Partition gelöscht werden soll.</span><span class="sxs-lookup"><span data-stu-id="99992-193">For each <xref:Microsoft.SqlServer.Replication.MergePartition> object in the array, determine whether the partition should be deleted.</span></span> <span data-ttu-id="99992-194">Diese Entscheidung basiert normalerweise auf dem Wert der <xref:Microsoft.SqlServer.Replication.MergePartition.DynamicFilterLogin%2A> -Eigenschaft oder der <xref:Microsoft.SqlServer.Replication.MergePartition.DynamicFilterHostName%2A> -Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="99992-194">This decision is usually based on the value of the <xref:Microsoft.SqlServer.Replication.MergePartition.DynamicFilterLogin%2A> property or the <xref:Microsoft.SqlServer.Replication.MergePartition.DynamicFilterHostName%2A> property.</span></span>  
  
6.  <span data-ttu-id="99992-195">Rufen Sie die <xref:Microsoft.SqlServer.Replication.MergePublication.RemoveMergePartition%2A> -Methode für das <xref:Microsoft.SqlServer.Replication.MergePublication> -Objekt aus Schritt 2 auf.</span><span class="sxs-lookup"><span data-stu-id="99992-195">Call the <xref:Microsoft.SqlServer.Replication.MergePublication.RemoveMergePartition%2A> method on the <xref:Microsoft.SqlServer.Replication.MergePublication> object from step 2.</span></span> <span data-ttu-id="99992-196">Übergeben Sie das <xref:Microsoft.SqlServer.Replication.MergePartition> -Objekt aus Schritt 5.</span><span class="sxs-lookup"><span data-stu-id="99992-196">Pass the <xref:Microsoft.SqlServer.Replication.MergePartition> object from step 5.</span></span>  
  
7.  <span data-ttu-id="99992-197">Wiederholen Sie Schritt 6 für jede zu löschende Partition.</span><span class="sxs-lookup"><span data-stu-id="99992-197">Repeat step 6 for each partition that is deleted.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="99992-198">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="99992-198">See Also</span></span>  
 <span data-ttu-id="99992-199">[Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md) </span><span class="sxs-lookup"><span data-stu-id="99992-199">[Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md) </span></span>  
 [<span data-ttu-id="99992-200">Momentaufnahmen für Mergeveröffentlichungen mit parametrisierten Filtern</span><span class="sxs-lookup"><span data-stu-id="99992-200">Snapshots for Merge Publications with Parameterized Filters</span></span>](../snapshots-for-merge-publications-with-parameterized-filters.md)  
  
  

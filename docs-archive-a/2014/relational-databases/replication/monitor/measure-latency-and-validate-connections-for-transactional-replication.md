---
title: Messen der Latenzzeit und Überprüfen der Verbindungen bei Transaktionsreplikationen | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- Replication Monitor, performance
- tracer tokens [SQL Server replication]
- latency [SQL Server replication]
- transactional replication, tracer tokens
- monitoring performance [SQL Server replication], tracer tokens
ms.assetid: 4addd426-7523-4067-8d7d-ca6bae4c9e34
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 3ba1e5eddfdcffa5fbefdea323f110ba9d15ca8c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87615939"
---
# <a name="measure-latency-and-validate-connections-for-transactional-replication"></a><span data-ttu-id="3d308-102">Messen der Latenzzeit und Überprüfen der Verbindungen bei Transaktionsreplikationen</span><span class="sxs-lookup"><span data-stu-id="3d308-102">Measure Latency and Validate Connections for Transactional Replication</span></span>
  <span data-ttu-id="3d308-103">In diesem Thema wird beschrieben, wie die Latenzzeit gemessen wird und Verbindungen für Transaktionsreplikation in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] mit Replikationsmonitor, [!INCLUDE[tsql](../../../includes/tsql-md.md)]oder Replikationsverwaltungsobjekten (RMO) überprüft werden.</span><span class="sxs-lookup"><span data-stu-id="3d308-103">This topic describes how to measure latency and validate connections for transactional replication in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using Replication Monitor, [!INCLUDE[tsql](../../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="3d308-104">Die Transaktionsreplikation bietet die Überwachungstokenfunktion, die eine praktische Möglichkeit zum Messen der Latenzzeit bei Transaktionsreplikationstopologien und zur Überprüfung der Verbindungen zwischen dem Verleger, dem Verteiler und den Abonnenten darstellt.</span><span class="sxs-lookup"><span data-stu-id="3d308-104">Transactional replication provides the tracer token feature, which provides a convenient way to measure latency in transactional replication topologies and to validate the connections between the Publisher, Distributor and Subscribers.</span></span> <span data-ttu-id="3d308-105">Ein Token (eine geringe Mange an Daten) wird in das Transaktionsprotokoll der Veröffentlichungsdatenbank geschrieben, wie eine normale replizierte Transaktion gekennzeichnet und über das System gesendet. Auf diese Weise werden die folgenden Berechnungen ermöglicht:</span><span class="sxs-lookup"><span data-stu-id="3d308-105">A token (a small amount of data) is written to the transaction log of the publication database, marked as though it were a typical replicated transaction, and sent through the system, allowing a calculation of:</span></span>  
  
-   <span data-ttu-id="3d308-106">Wie viel Zeit zwischen dem Commit einer Transaktion auf dem Verleger und dem Einfügen des zugehörigen Befehls in die Verteilungsdatenbank auf dem Verteiler verstreicht.</span><span class="sxs-lookup"><span data-stu-id="3d308-106">How much time elapses between a transaction being committed at the Publisher and the corresponding command being inserted in the distribution database at the Distributor.</span></span>  
  
-   <span data-ttu-id="3d308-107">Wie viel Zeit zwischen dem Einfügen eines Befehls in die Verteilungsdatenbank und dem zugehörigen Commit einer Transaktion auf dem Abonnenten verstreicht.</span><span class="sxs-lookup"><span data-stu-id="3d308-107">How much time elapses between a command being inserted in the distribution database and the corresponding transaction being committed at a Subscriber.</span></span>  
  
 <span data-ttu-id="3d308-108">Mithilfe dieser Berechnungen können Sie verschiedene Fragen beantworten. Unter anderem diese:</span><span class="sxs-lookup"><span data-stu-id="3d308-108">From these calculations, you can answer a number of questions, including:</span></span>  
  
-   <span data-ttu-id="3d308-109">Welche Abonnenten benötigen am längsten, um eine Änderung vom Verleger zu empfangen?</span><span class="sxs-lookup"><span data-stu-id="3d308-109">Which Subscribers take the longest to receive a change from the Publisher?</span></span>  
  
-   <span data-ttu-id="3d308-110">Welcher der Abonnenten, die Überwachungstoken empfangen sollten, hat keine empfangen?</span><span class="sxs-lookup"><span data-stu-id="3d308-110">Of the Subscribers expected to receive the tracer token, which, if any, have not received it?</span></span>  
  
 <span data-ttu-id="3d308-111">**In diesem Thema**</span><span class="sxs-lookup"><span data-stu-id="3d308-111">**In This Topic**</span></span>  
  
-   <span data-ttu-id="3d308-112">**Vorbereitungen:**</span><span class="sxs-lookup"><span data-stu-id="3d308-112">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="3d308-113">Einschränkungen</span><span class="sxs-lookup"><span data-stu-id="3d308-113">Limitations and Restrictions</span></span>](#Restrictions)  
  
-   <span data-ttu-id="3d308-114">**So messen Sie die Latenzzeit und überprüfen die Verbindungen mit:**</span><span class="sxs-lookup"><span data-stu-id="3d308-114">**To measure latency and validate connections, using:**</span></span>  
  
     [<span data-ttu-id="3d308-115">SQL Server-Replikationsmonitor</span><span class="sxs-lookup"><span data-stu-id="3d308-115">SQL Server Replication Monitor</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="3d308-116">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="3d308-116">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="3d308-117">Replikationsverwaltungsobjekte (RMO)</span><span class="sxs-lookup"><span data-stu-id="3d308-117">Replication Management Objects</span></span>](#RMOProcedure)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="3d308-118">Vorbereitungen</span><span class="sxs-lookup"><span data-stu-id="3d308-118">Before You Begin</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="3d308-119">Einschränkungen</span><span class="sxs-lookup"><span data-stu-id="3d308-119">Limitations and Restrictions</span></span>  
 <span data-ttu-id="3d308-120">Überwachungstoken können sich auch als nützlich erweisen, wenn ein System in den Ruhezustand versetzt wird, da hierfür alle Aktivitäten beendet werden und überprüft wird, ob alle Knoten sämtliche ausstehenden Änderungen empfangen haben.</span><span class="sxs-lookup"><span data-stu-id="3d308-120">Tracer tokens can also be useful when quiescing a system, which involves stopping all activity and verifying that all nodes have received all outstanding changes.</span></span> <span data-ttu-id="3d308-121">Weitere Informationen finden Sie unter [Versetzen einer Replikationstopologie in einen inaktiven Status &#40;Replikationsprogrammierung mit Transact-SQL&#41;](../administration/quiesce-a-replication-topology-replication-transact-sql-programming.md).</span><span class="sxs-lookup"><span data-stu-id="3d308-121">For more information, see [Quiesce a Replication Topology &#40;Replication Transact-SQL Programming&#41;](../administration/quiesce-a-replication-topology-replication-transact-sql-programming.md).</span></span>  
  
 <span data-ttu-id="3d308-122">Zum Verwenden von Überwachungs Token müssen Sie bestimmte Versionen von verwenden [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="3d308-122">To use tracer tokens, you must use certain versions of [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]:</span></span>  
  
-   <span data-ttu-id="3d308-123">Der Verteiler muss oder höher sein [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="3d308-123">The Distributor must be [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or later.</span></span>  
  
-   <span data-ttu-id="3d308-124">Der Verleger muss [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] oder höher aufweisen, oder es muss sich um einen Oracle-Verleger handeln.</span><span class="sxs-lookup"><span data-stu-id="3d308-124">The Publisher must be [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or later or be an Oracle Publisher.</span></span>  
  
-   <span data-ttu-id="3d308-125">Bei Pushabonnements werden Überwachungstokenstatistiken vom Verleger, vom Verteiler und von den Abonnenten gesammelt, wenn der Abonnent [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 7,0 oder höher ist.</span><span class="sxs-lookup"><span data-stu-id="3d308-125">For push subscriptions, tracer token statistics are gathered from the Publisher, Distributor, and Subscribers if the Subscriber is [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 7.0 or later.</span></span>  
  
-   <span data-ttu-id="3d308-126">Im Fall von Pullabonnements werden Überwachungstokenstatistiken von Abonnenten gesammelt, sofern der Abonnent [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] oder höher aufweist.</span><span class="sxs-lookup"><span data-stu-id="3d308-126">For pull subscriptions, tracer token statistics are gathered from Subscribers only if the Subscriber is [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or later.</span></span> <span data-ttu-id="3d308-127">Wenn der Abonnent [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 7,0 oder ist [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] , werden Statistiken nur vom Verleger und vom Verteiler gesammelt.</span><span class="sxs-lookup"><span data-stu-id="3d308-127">If the Subscriber is [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 7.0 or [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)], statistics are gathered only from the Publisher and Distributor.</span></span>  
  
 <span data-ttu-id="3d308-128">Es gibt eine Vielzahl anderer Probleme und Einschränkungen, auf die geachtet werden muss:</span><span class="sxs-lookup"><span data-stu-id="3d308-128">There are also a number of other issues and restrictions to be aware of:</span></span>  
  
-   <span data-ttu-id="3d308-129">Abonnements müssen aktiv sein, um ein Überwachungstoken zu empfangen.</span><span class="sxs-lookup"><span data-stu-id="3d308-129">Subscriptions must be active to receive a tracer token.</span></span> <span data-ttu-id="3d308-130">Ein Abonnement ist aktiv, wenn es initialisiert wurde.</span><span class="sxs-lookup"><span data-stu-id="3d308-130">A subscription is active if it has been initialized.</span></span>  
  
-   <span data-ttu-id="3d308-131">Durch die erneute Initialisierung werden sämtliche ausstehenden Überwachungstoken für die relevanten Abonnements entfernt.</span><span class="sxs-lookup"><span data-stu-id="3d308-131">Reinitialization removes any pending tracer tokens for the relevant subscriptions.</span></span>  
  
-   <span data-ttu-id="3d308-132">Abonnenten empfangen nur Überwachungstoken, die nach ihrer Erstsynchronisierung erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="3d308-132">Subscribers only receive tracer tokens that were created after their initial synchronization.</span></span>  
  
-   <span data-ttu-id="3d308-133">Überwachungstoken werden nicht von Abonnenten weitergeleitet, die Wiederveröffentlichungen ausführen.</span><span class="sxs-lookup"><span data-stu-id="3d308-133">Tracer tokens are not forwarded by republishing Subscribers.</span></span>  
  
-   <span data-ttu-id="3d308-134">Der Replikationsmonitor kann den Namen der Veröffentlichungsinstanz von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] nach einem Failover zu einer sekundären Instanz nicht anpassen und zeigt weiterhin Replikationsinformationen unter dem Namen der ursprünglichen primären Instanz von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]an.</span><span class="sxs-lookup"><span data-stu-id="3d308-134">After failover to a secondary, Replication Monitor is unable to adjust the name of the publishing instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and will continue to display replication information under the name of the original primary instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="3d308-135">Nach einem Failover kann kein Überwachungstoken mit dem Replikationsmonitor eingegeben werden, ein mit [!INCLUDE[tsql](../../../includes/tsql-md.md)]auf dem neuen Verleger eingegebenes Überwachungstoken wird jedoch im Replikationsmonitor angezeigt.</span><span class="sxs-lookup"><span data-stu-id="3d308-135">After failover, a tracer token cannot be entered by using the Replication Monitor, however a tracer token entered on the new publisher by using [!INCLUDE[tsql](../../../includes/tsql-md.md)], is visible in Replication Monitor.</span></span>  
  
##  <a name="using-sql-server-replication-monitor"></a><a name="SSMSProcedure"></a><span data-ttu-id="3d308-136">Verwenden von SQL Server-Replikation Monitor</span><span class="sxs-lookup"><span data-stu-id="3d308-136">Using SQL Server Replication Monitor</span></span>  
 <span data-ttu-id="3d308-137">Informationen zum Starten des Replikationsmonitors finden Sie unter [Starten des Replikationsmonitors](start-the-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="3d308-137">For information about starting Replication Monitor, see [Start the Replication Monitor](start-the-replication-monitor.md).</span></span>  
  
#### <a name="to-insert-a-tracer-token-and-view-information-on-the-token"></a><span data-ttu-id="3d308-138">So fügen Sie ein Überwachungstoken ein und zeigen Informationen zum Token an</span><span class="sxs-lookup"><span data-stu-id="3d308-138">To insert a tracer token and view information on the token</span></span>  
  
1.  <span data-ttu-id="3d308-139">Erweitern Sie im linken Bereich eine Verlegergruppe, erweitern Sie einen Verleger, und klicken Sie dann auf eine Veröffentlichung.</span><span class="sxs-lookup"><span data-stu-id="3d308-139">Expand a Publisher group in the left pane, expand a Publisher, and then click a publication.</span></span>  
  
2.  <span data-ttu-id="3d308-140">Klicken Sie auf die Registerkarte **Überwachungstoken** .</span><span class="sxs-lookup"><span data-stu-id="3d308-140">Click the **Tracer Tokens** tab.</span></span>  
  
3.  <span data-ttu-id="3d308-141">Klicken Sie auf **Überwachung einfügen**.</span><span class="sxs-lookup"><span data-stu-id="3d308-141">Click **Insert Tracer**.</span></span>  
  
4.  <span data-ttu-id="3d308-142">In den folgenden Spalten sehen Sie die für das Überwachungstoken benötigte Zeit: **Verleger zu Verteiler**, **Verteiler zu Abonnent**, **Gesamtlatenzzeit**.</span><span class="sxs-lookup"><span data-stu-id="3d308-142">View elapsed time for the tracer token in the following columns: **Publisher to Distributor**, **Distributor to Subscriber**, **Total Latency**.</span></span> <span data-ttu-id="3d308-143">Der Wert **Pending** gibt an, dass das Token einen bestimmten Punkt nicht erreicht hat.</span><span class="sxs-lookup"><span data-stu-id="3d308-143">A value of **Pending** indicates that the token has not reached a given point.</span></span>  
  
#### <a name="to-view-information-on-a-tracer-token-inserted-previously"></a><span data-ttu-id="3d308-144">So zeigen Sie Informationen zu früher eingefügten Überwachungstoken an</span><span class="sxs-lookup"><span data-stu-id="3d308-144">To view information on a tracer token inserted previously</span></span>  
  
1.  <span data-ttu-id="3d308-145">Erweitern Sie im linken Bereich eine Verlegergruppe, erweitern Sie einen Verleger, und klicken Sie dann auf eine Veröffentlichung.</span><span class="sxs-lookup"><span data-stu-id="3d308-145">Expand a Publisher group in the left pane, expand a Publisher, and then click a publication.</span></span>  
  
2.  <span data-ttu-id="3d308-146">Klicken Sie auf die Registerkarte **Überwachungstoken** .</span><span class="sxs-lookup"><span data-stu-id="3d308-146">Click the **Tracer Tokens** tab.</span></span>  
  
3.  <span data-ttu-id="3d308-147">Wählen Sie in der Dropdownliste **Einfügungszeitpunkt** eine Zeit aus.</span><span class="sxs-lookup"><span data-stu-id="3d308-147">Select a time from the **Time inserted** drop-down list.</span></span>  
  
4.  <span data-ttu-id="3d308-148">In den folgenden Spalten sehen Sie die für das Überwachungstoken benötigte Zeit: **Verleger zu Verteiler**, **Verteiler zu Abonnent**, **Gesamtlatenzzeit**.</span><span class="sxs-lookup"><span data-stu-id="3d308-148">View elapsed time for the tracer token in the following columns: **Publisher to Distributor**, **Distributor to Subscriber**, **Total Latency**.</span></span> <span data-ttu-id="3d308-149">Der Wert **Pending** gibt an, dass das Token einen bestimmten Punkt nicht erreicht hat.</span><span class="sxs-lookup"><span data-stu-id="3d308-149">A value of **Pending** indicates that the token has not reached a given point.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3d308-150">Die Informationen von Überwachungstoken werden für denselben Zeitraum wie andere Vergangenheitsdaten beibehalten. Der Zeitraum wird durch die Aufbewahrungsdauer für den Verlauf der Verteilungsdatenbank festgelegt.</span><span class="sxs-lookup"><span data-stu-id="3d308-150">Tracer token information is retained for the same time period as other historical data, which is governed by the history retention period of the distribution database.</span></span> <span data-ttu-id="3d308-151">Weitere Informationen zum Ändern der Eigenschaften der Verteilungsdatenbank finden Sie unter [Anzeigen und Ändern der Verteiler- und Verlegereigenschaften](../view-and-modify-distributor-and-publisher-properties.md).</span><span class="sxs-lookup"><span data-stu-id="3d308-151">For information about changing distribution database properties, see [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="3d308-152">Verwenden von Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="3d308-152">Using Transact-SQL</span></span>  
  
#### <a name="to-post-a-tracer-token-to-a-transactional-publication"></a><span data-ttu-id="3d308-153">So stellen Sie ein Überwachungstoken für eine Transaktionsveröffentlichung bereit</span><span class="sxs-lookup"><span data-stu-id="3d308-153">To post a tracer token to a transactional publication</span></span>  
  
1.  <span data-ttu-id="3d308-154">(Optional) Führen Sie auf dem Verleger für die Veröffentlichungsdatenbank [sp_helppublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql) aus.</span><span class="sxs-lookup"><span data-stu-id="3d308-154">(Optional) At the Publisher on the publication database, execute [sp_helppublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span> <span data-ttu-id="3d308-155">Stellen Sie sicher, dass die Veröffentlichung vorhanden und der Status aktiv ist.</span><span class="sxs-lookup"><span data-stu-id="3d308-155">Verify that the publication exists and that the status is active.</span></span>  
  
2.  <span data-ttu-id="3d308-156">(Optional) Führen Sie auf dem Verleger für die Veröffentlichungsdatenbank [sp_helpsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpsubscription-transact-sql) aus.</span><span class="sxs-lookup"><span data-stu-id="3d308-156">(Optional) At the Publisher on the publication database, execute [sp_helpsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpsubscription-transact-sql).</span></span> <span data-ttu-id="3d308-157">Stellen Sie sicher, dass das Abonnement vorhanden und der Status aktiv ist.</span><span class="sxs-lookup"><span data-stu-id="3d308-157">Verify that the subscription exists and that the status is active.</span></span>  
  
3.  <span data-ttu-id="3d308-158">Führen Sie auf dem Verleger für die Veröffentlichungsdatenbank [sp_posttracertoken &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-posttracertoken-transact-sql) aus und geben Sie **@publication** an.</span><span class="sxs-lookup"><span data-stu-id="3d308-158">At the Publisher on the publication database, execute [sp_posttracertoken &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-posttracertoken-transact-sql), specifying **@publication**.</span></span> <span data-ttu-id="3d308-159">Notieren Sie den Wert des **@tracer_token_id** Output-Parameters.</span><span class="sxs-lookup"><span data-stu-id="3d308-159">Note the value of the **@tracer_token_id** output parameter.</span></span>  
  
#### <a name="to-determine-latency-and-validate-connections-for-a-transactional-publication"></a><span data-ttu-id="3d308-160">So können Sie die Latenzzeit bestimmen und die Verbindungen für eine Transaktionveröffentlichung überprüfen</span><span class="sxs-lookup"><span data-stu-id="3d308-160">To determine latency and validate connections for a transactional publication</span></span>  
  
1.  <span data-ttu-id="3d308-161">Stellen Sie mithilfe der vorherigen Prozedur ein Überwachungstoken für die Veröffentlichung bereit.</span><span class="sxs-lookup"><span data-stu-id="3d308-161">Post a tracer token to the publication using the previous procedure.</span></span>  
  
2.  <span data-ttu-id="3d308-162">Führen Sie auf dem Verleger für die Veröffentlichungsdatenbank [sp_helptracertokens &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helptracertokens-transact-sql)aus und geben Sie **@publication** an.</span><span class="sxs-lookup"><span data-stu-id="3d308-162">At the Publisher on the publication database, execute [sp_helptracertokens &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helptracertokens-transact-sql), specifying **@publication**.</span></span> <span data-ttu-id="3d308-163">Dadurch wird eine Liste aller für die Veröffentlichung bereitgestellten Überwachungstoken zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="3d308-163">This returns a list of all tracer tokens posted to the publication.</span></span> <span data-ttu-id="3d308-164">Beachten Sie die gewünschte **tracer_id** im Resultset.</span><span class="sxs-lookup"><span data-stu-id="3d308-164">Note the desired **tracer_id** in the result set.</span></span>  
  
3.  <span data-ttu-id="3d308-165">Führen Sie auf dem Verleger für die Veröffentlichungsdatenbank [sp_helptracertokenhistory &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helptracertokenhistory-transact-sql) aus, wobei Sie **@publication** und die Überwachungstoken-ID aus Schritt 2 für **@tracer_id** angeben.</span><span class="sxs-lookup"><span data-stu-id="3d308-165">At the Publisher on the publication database, execute [sp_helptracertokenhistory &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helptracertokenhistory-transact-sql), specifying **@publication** and the tracer token ID from step 2 for **@tracer_id**.</span></span> <span data-ttu-id="3d308-166">Dadurch werden Latenzzeitinformationen für das ausgewählte Überwachungstoken zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="3d308-166">This returns latency information for the selected tracer token.</span></span>  
  
#### <a name="to-remove-tracer-tokens"></a><span data-ttu-id="3d308-167">So entfernen Sie Überwachungstoken</span><span class="sxs-lookup"><span data-stu-id="3d308-167">To remove tracer tokens</span></span>  
  
1.  <span data-ttu-id="3d308-168">Führen Sie auf dem Verleger für die Veröffentlichungsdatenbank [sp_helptracertokens &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helptracertokens-transact-sql)aus und geben Sie **@publication** an.</span><span class="sxs-lookup"><span data-stu-id="3d308-168">At the Publisher on the publication database, execute [sp_helptracertokens &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helptracertokens-transact-sql), specifying **@publication**.</span></span> <span data-ttu-id="3d308-169">Dadurch wird eine Liste aller für die Veröffentlichung bereitgestellten Überwachungstoken zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="3d308-169">This returns a list of all tracer tokens posted to the publication.</span></span> <span data-ttu-id="3d308-170">Beachten Sie die **tracer_id** für das zu löschende Überwachungstoken im Resultset.</span><span class="sxs-lookup"><span data-stu-id="3d308-170">Note the **tracer_id** for the tracer token to delete in the result set.</span></span>  
  
2.  <span data-ttu-id="3d308-171">Führen Sie auf dem Verleger für die Veröffentlichungsdatenbank [sp_deletetracertokenhistory &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-deletetracertokenhistory-transact-sql) aus, wobei Sie **@publication** und die ID des zu löschenden Überwachungstokens aus Schritt 2 für **@tracer_id** angeben.</span><span class="sxs-lookup"><span data-stu-id="3d308-171">At the Publisher on the publication database, execute [sp_deletetracertokenhistory &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-deletetracertokenhistory-transact-sql), specifying **@publication** and the ID of the tracer to delete from step 2 for **@tracer_id**.</span></span>  
  
###  <a name="example-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="3d308-172">Beispiel (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="3d308-172">Example (Transact-SQL)</span></span>  
 <span data-ttu-id="3d308-173">In diesem Beispiel wird ein Überwachungstoken-Datensatz bereitgestellt, und dann werden mithilfe der zurückgegebenen ID des bereitgestellten Überwachungstokens Latenzinformationen angezeigt.</span><span class="sxs-lookup"><span data-stu-id="3d308-173">This example posts a tracer token record and uses the returned ID of the posted tracer token to view latency information.</span></span>  
  
 [!code-sql[HowTo#sp_tracertokens](../../../snippets/tsql/SQL15/replication/howto/tsql/createtracertokens.sql#sp_tracertokens)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="3d308-174">Verwenden von Replikationsverwaltungsobjekten (RMO)</span><span class="sxs-lookup"><span data-stu-id="3d308-174">Using Replication Management Objects (RMO)</span></span>  
  
#### <a name="to-post-a-tracer-token-to-a-transactional-publication"></a><span data-ttu-id="3d308-175">So stellen Sie ein Überwachungstoken für eine Transaktionsveröffentlichung bereit</span><span class="sxs-lookup"><span data-stu-id="3d308-175">To post a tracer token to a transactional publication</span></span>  
  
1.  <span data-ttu-id="3d308-176">Erstellen Sie eine Verbindung mit dem Verleger, indem Sie die <xref:Microsoft.SqlServer.Management.Common.ServerConnection> -Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="3d308-176">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="3d308-177">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.TransPublication>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="3d308-177">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPublication> class.</span></span>  
  
3.  <span data-ttu-id="3d308-178">Legen Sie die <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> -Eigenschaft und die <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> -Eigenschaft für die Veröffentlichung fest, und legen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> -Eigenschaft auf die in Schritt 1 erstellte Verbindung fest.</span><span class="sxs-lookup"><span data-stu-id="3d308-178">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>  
  
4.  <span data-ttu-id="3d308-179">Rufen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> -Methode auf, um die Eigenschaften des Objekts abzurufen.</span><span class="sxs-lookup"><span data-stu-id="3d308-179">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="3d308-180">Wenn diese Methode `false` zurückgibt, sind die Veröffentlichungseigenschaften in Schritt 3 falsch definiert, oder die Veröffentlichung ist nicht vorhanden.</span><span class="sxs-lookup"><span data-stu-id="3d308-180">If this method returns `false`, either the publication properties in step 3 were defined incorrectly or the publication does not exist.</span></span>  
  
5.  <span data-ttu-id="3d308-181">Rufen Sie die <xref:Microsoft.SqlServer.Replication.TransPublication.PostTracerToken%2A> -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="3d308-181">Call the <xref:Microsoft.SqlServer.Replication.TransPublication.PostTracerToken%2A> method.</span></span> <span data-ttu-id="3d308-182">Mit dieser Methode wird ein Überwachungstoken in das Transaktionsprotokoll der Veröffentlichung eingefügt.</span><span class="sxs-lookup"><span data-stu-id="3d308-182">This method inserts a tracer token into the publication's transaction log.</span></span>  
  
#### <a name="to-determine-latency-and-validate-connections-for-a-transactional-publication"></a><span data-ttu-id="3d308-183">So können Sie die Latenzzeit bestimmen und die Verbindungen für eine Transaktionveröffentlichung überprüfen</span><span class="sxs-lookup"><span data-stu-id="3d308-183">To determine latency and validate connections for a transactional publication</span></span>  
  
1.  <span data-ttu-id="3d308-184">Erstellen Sie eine Verbindung mit dem Verteiler, indem Sie die <xref:Microsoft.SqlServer.Management.Common.ServerConnection> -Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="3d308-184">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="3d308-185">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.PublicationMonitor>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="3d308-185">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span>  
  
3.  <span data-ttu-id="3d308-186">Legen Sie die Eigenschaften <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>und <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A> fest, und legen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> -Eigenschaft auf die in Schritt 1 erstellte Verbindung fest.</span><span class="sxs-lookup"><span data-stu-id="3d308-186">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A> properties, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>  
  
4.  <span data-ttu-id="3d308-187">Rufen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> -Methode auf, um die Eigenschaften des Objekts abzurufen.</span><span class="sxs-lookup"><span data-stu-id="3d308-187">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="3d308-188">Wenn diese Methode `false` zurückgibt, wurden entweder den in Schritt 3 genannten Eigenschaften der Klasse PublicationMonitor falsche Werte zugewiesen, oder die Veröffentlichung ist nicht vorhanden.</span><span class="sxs-lookup"><span data-stu-id="3d308-188">If this method returns `false`, either the publication monitor properties in step 3 were defined incorrectly or the publication does not exist.</span></span>  
  
5.  <span data-ttu-id="3d308-189">Rufen Sie die <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="3d308-189">Call the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> method.</span></span> <span data-ttu-id="3d308-190">Wandeln Sie das zurückgegebene <xref:System.Collections.ArrayList> -Objekt in ein Array von <xref:Microsoft.SqlServer.Replication.TracerToken> -Objekten um.</span><span class="sxs-lookup"><span data-stu-id="3d308-190">Cast the returned <xref:System.Collections.ArrayList> object to an array of <xref:Microsoft.SqlServer.Replication.TracerToken> objects.</span></span>  
  
6.  <span data-ttu-id="3d308-191">Rufen Sie die <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokenHistory%2A> -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="3d308-191">Call the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokenHistory%2A> method.</span></span> <span data-ttu-id="3d308-192">Übergeben Sie einen Wert <xref:Microsoft.SqlServer.Replication.TracerToken.TracerTokenId%2A> für ein Überwachungstoken aus Schritt 5.</span><span class="sxs-lookup"><span data-stu-id="3d308-192">Pass a value of <xref:Microsoft.SqlServer.Replication.TracerToken.TracerTokenId%2A> for a tracer token from step 5.</span></span> <span data-ttu-id="3d308-193">Dadurch werden Latenzzeitinformationen für das ausgewählte Überwachungstoken als <xref:System.Data.DataSet> -Objekt zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="3d308-193">This returns latency information for the selected tracer token as a <xref:System.Data.DataSet> object.</span></span> <span data-ttu-id="3d308-194">Wenn alle Informationen des Überwachungstokens zurückgegeben wurden, besteht die Verbindung zwischen dem Verleger und dem Verteiler sowie die Verbindung zwischen dem Verteiler und dem Abonnenten, und die Replikationstopologie ist funktionsfähig.</span><span class="sxs-lookup"><span data-stu-id="3d308-194">If all tracer token information is returned, the connection between the Publisher and Distributor and the connection between the Distributor and the Subscriber both exist and the replication topology is functioning.</span></span>  
  
#### <a name="to-remove-tracer-tokens"></a><span data-ttu-id="3d308-195">So entfernen Sie Überwachungstoken</span><span class="sxs-lookup"><span data-stu-id="3d308-195">To remove tracer tokens</span></span>  
  
1.  <span data-ttu-id="3d308-196">Erstellen Sie eine Verbindung mit dem Verteiler, indem Sie die <xref:Microsoft.SqlServer.Management.Common.ServerConnection> -Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="3d308-196">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="3d308-197">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.PublicationMonitor>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="3d308-197">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span>  
  
3.  <span data-ttu-id="3d308-198">Legen Sie die Eigenschaften <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>und <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A> fest, und legen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> -Eigenschaft auf die in Schritt 1 erstellte Verbindung fest.</span><span class="sxs-lookup"><span data-stu-id="3d308-198">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A> properties, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>  
  
4.  <span data-ttu-id="3d308-199">Rufen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> -Methode auf, um die Eigenschaften des Objekts abzurufen.</span><span class="sxs-lookup"><span data-stu-id="3d308-199">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="3d308-200">Wenn diese Methode `false` zurückgibt, wurden entweder den in Schritt 3 genannten Eigenschaften der Klasse PublicationMonitor falsche Werte zugewiesen, oder die Veröffentlichung ist nicht vorhanden.</span><span class="sxs-lookup"><span data-stu-id="3d308-200">If this method returns `false`, either the publication monitor properties in step 3 were defined incorrectly or the publication does not exist.</span></span>  
  
5.  <span data-ttu-id="3d308-201">Rufen Sie die <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="3d308-201">Call the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> method.</span></span> <span data-ttu-id="3d308-202">Wandeln Sie das zurückgegebene <xref:System.Collections.ArrayList> -Objekt in ein Array von <xref:Microsoft.SqlServer.Replication.TracerToken> -Objekten um.</span><span class="sxs-lookup"><span data-stu-id="3d308-202">Cast the returned <xref:System.Collections.ArrayList> object to an array of <xref:Microsoft.SqlServer.Replication.TracerToken> objects.</span></span>  
  
6.  <span data-ttu-id="3d308-203">Rufen Sie die <xref:Microsoft.SqlServer.Replication.PublicationMonitor.CleanUpTracerTokenHistory%2A> -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="3d308-203">Call the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.CleanUpTracerTokenHistory%2A> method.</span></span> <span data-ttu-id="3d308-204">Übergeben Sie einen der folgenden Werte:</span><span class="sxs-lookup"><span data-stu-id="3d308-204">Pass one of the following values:</span></span>  
  
    -   <span data-ttu-id="3d308-205"><xref:Microsoft.SqlServer.Replication.TracerToken.TracerTokenId%2A> für ein Überwachungstoken aus Schritt 5.</span><span class="sxs-lookup"><span data-stu-id="3d308-205">The <xref:Microsoft.SqlServer.Replication.TracerToken.TracerTokenId%2A> for a tracer token from step 5.</span></span> <span data-ttu-id="3d308-206">Dadurch werden die Informationen für ein ausgewähltes Token gelöscht.</span><span class="sxs-lookup"><span data-stu-id="3d308-206">This deletes information for a selected token.</span></span>  
  
    -   <span data-ttu-id="3d308-207">Ein <xref:System.DateTime>-Objekt.</span><span class="sxs-lookup"><span data-stu-id="3d308-207">A <xref:System.DateTime> object.</span></span> <span data-ttu-id="3d308-208">Dadurch werden die Informationen für alle Token gelöscht, die älter sind als das angegebene Datum und die angegebene Uhrzeit.</span><span class="sxs-lookup"><span data-stu-id="3d308-208">This deletes information for all tokens older than the specified date and time.</span></span>  
  
###  <a name="PShellExample"></a>  

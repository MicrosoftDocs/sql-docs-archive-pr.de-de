---
title: Programmgesteuertes Überwachen der Replikation | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- sp_replmonitorhelppublisher
- sp_replmonitorhelpmergesessiondetail
- monitoring performance [SQL Server replication], publication status
- sp_replmonitorhelpmergesession
- sp_replmonitorhelppublicationthresholds
- monitoring performance [SQL Server replication], subscription status
- monitoring performance [SQL Server replication], Transact-SQL programming
- sp_replmonitorsubscriptionpendingcmds
- sp_replmonitorchangepublicationthreshold
- transactional replication, monitoring
- sp_replmonitorhelppublication
- sp_replmonitorhelpsubscription
- monitoring performance [SQL Server replication], thresholds and warnings
- merge replication monitoring [SQL Server replication]
- snapshot replication [SQL Server], monitoring
ms.assetid: e8bf8850-8da5-4a4f-a399-64232b4e476d
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: e11f73bf9538fb5ba84f4575631489ef852802c1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87725518"
---
# <a name="programmatically-monitor-replication"></a><span data-ttu-id="d584d-102">Programmgesteuertes Überwachen der Replikation</span><span class="sxs-lookup"><span data-stu-id="d584d-102">Programmatically Monitor Replication</span></span>
  <span data-ttu-id="d584d-103">Der Replikationsmonitor ist ein grafisches Tool, mit dem Sie eine Replikationstopologie überwachen können.</span><span class="sxs-lookup"><span data-stu-id="d584d-103">Replication Monitor is a graphical tool that allows you to monitor a replication topology.</span></span> <span data-ttu-id="d584d-104">Mithilfe von gespeicherten [!INCLUDE[tsql](../../../includes/tsql-md.md)] -Replikationsprozeduren oder Replikationsverwaltungsobjekten (RMO) können Sie programmgesteuert auf diese Überwachungsdaten zugreifen.</span><span class="sxs-lookup"><span data-stu-id="d584d-104">You can access the same monitoring data programmatically by using [!INCLUDE[tsql](../../../includes/tsql-md.md)] replication stored procedures or replication management objects (RMO).</span></span> <span data-ttu-id="d584d-105">Diese Objekte ermöglichen das Programmieren der folgenden Tasks:</span><span class="sxs-lookup"><span data-stu-id="d584d-105">These objects enable you to program the following tasks:</span></span>  
  
-   <span data-ttu-id="d584d-106">Überwachen des Status von Verlegern, Veröffentlichungen und Abonnements.</span><span class="sxs-lookup"><span data-stu-id="d584d-106">Monitor the state of Publishers, publications, and subscriptions.</span></span>  
  
-   <span data-ttu-id="d584d-107">Überwachen von Merge-Agentsitzungen auf mindestens einem Abonnenten.</span><span class="sxs-lookup"><span data-stu-id="d584d-107">Monitor Merge Agent sessions at one or more Subscribers.</span></span>  
  
-   <span data-ttu-id="d584d-108">Überwachen von Transaktionsbefehlen, die darauf warten, auf mindestens einem Abonnenten angewendet zu werden.</span><span class="sxs-lookup"><span data-stu-id="d584d-108">Monitor transactional commands waiting to be applied at one or more Subscribers.</span></span>  
  
-   <span data-ttu-id="d584d-109">Definieren von Schwellenwertmetriken, um bestimmen zu können, wann eine Veröffentlichung einen Eingriff erfordert.</span><span class="sxs-lookup"><span data-stu-id="d584d-109">Define the threshold metrics that determine when a publication requires intervention.</span></span>  
  
-   <span data-ttu-id="d584d-110">Überwachen des Status von Überwachungstoken.</span><span class="sxs-lookup"><span data-stu-id="d584d-110">Monitor the status of tracer tokens.</span></span>  
  
 <span data-ttu-id="d584d-111">**In diesem Thema:**</span><span class="sxs-lookup"><span data-stu-id="d584d-111">**In this topic:**</span></span>  
  
 [<span data-ttu-id="d584d-112">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="d584d-112">Transact-SQL</span></span>](#Tsql)  
  
 [<span data-ttu-id="d584d-113">Replikationsverwaltungsobjekte (RMO)</span><span class="sxs-lookup"><span data-stu-id="d584d-113">Replication Management Objects (RMO)</span></span>](#RMO)  
  
##  <a name="transact-sql"></a><a name="Tsql"></a> <span data-ttu-id="d584d-114">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="d584d-114">Transact-SQL</span></span>  
  
#### <a name="to-monitor-publishers-publications-and-subscriptions-from-the-distributor"></a><span data-ttu-id="d584d-115">So überwachen Sie Verleger, Veröffentlichungen und Abonnements auf dem Verteiler</span><span class="sxs-lookup"><span data-stu-id="d584d-115">To monitor Publishers, publications, and subscriptions from the Distributor</span></span>  
  
1.  <span data-ttu-id="d584d-116">Führen Sie auf dem Verteiler für die Verteilerdatenbank [sp_replmonitorhelppublisher](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublisher-transact-sql)aus.</span><span class="sxs-lookup"><span data-stu-id="d584d-116">At the Distributor on the distribution database, execute [sp_replmonitorhelppublisher](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublisher-transact-sql).</span></span> <span data-ttu-id="d584d-117">Dadurch werden Überwachungsinformationen zu allen Verlegern zurückgegeben, die diesen Verteiler verwenden.</span><span class="sxs-lookup"><span data-stu-id="d584d-117">This returns monitoring information for all Publishers using this Distributor.</span></span> <span data-ttu-id="d584d-118">Um das Resultset auf einen einzelnen Verleger zu beschränken, geben Sie an **@publisher** .</span><span class="sxs-lookup"><span data-stu-id="d584d-118">To limit the result set to a single Publisher, specify **@publisher**.</span></span>  
  
2.  <span data-ttu-id="d584d-119">Führen Sie auf dem Verteiler für die Verteilerdatenbank [sp_replmonitorhelppublication](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublication-transact-sql)aus.</span><span class="sxs-lookup"><span data-stu-id="d584d-119">At the Distributor on the distribution database, execute [sp_replmonitorhelppublication](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublication-transact-sql).</span></span> <span data-ttu-id="d584d-120">Dadurch werden Überwachungsinformationen zu allen Veröffentlichungen zurückgegeben, die diesen Verteiler verwenden.</span><span class="sxs-lookup"><span data-stu-id="d584d-120">This returns monitoring information for all publications using this Distributor.</span></span> <span data-ttu-id="d584d-121">Um das Resultset auf einen einzelnen Verleger, eine Veröffentlichung oder eine veröffentlichte Datenbank zu beschränken, geben Sie **@publisher** , **@publication** **@publisher_db** bzw. an.</span><span class="sxs-lookup"><span data-stu-id="d584d-121">To limit the result set to a single Publisher, publication, or published database, specify **@publisher**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
3.  <span data-ttu-id="d584d-122">Führen Sie auf dem Verteiler für die Verteilerdatenbank [sp_replmonitorhelpsubscription](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpsubscription-transact-sql)aus.</span><span class="sxs-lookup"><span data-stu-id="d584d-122">At the Distributor on the distribution database, execute [sp_replmonitorhelpsubscription](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpsubscription-transact-sql).</span></span> <span data-ttu-id="d584d-123">Dadurch werden Überwachungsinformationen zu allen Abonnements zurückgegeben, die diesen Verteiler verwenden.</span><span class="sxs-lookup"><span data-stu-id="d584d-123">This returns monitoring information for all subscriptions using this Distributor.</span></span> <span data-ttu-id="d584d-124">Um das Resultset auf Abonnements zu beschränken, die zu einem einzelnen Verleger, einer Veröffentlichung oder einer veröffentlichten Datenbank gehören, geben Sie **@publisher** , **@publication** **@publisher_db** bzw. an.</span><span class="sxs-lookup"><span data-stu-id="d584d-124">To limit the result set to subscriptions belonging to a single Publisher, publication, or published database, specify **@publisher**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
#### <a name="to-monitor-transactional-commands-waiting-to-be-applied-at-the-subscriber"></a><span data-ttu-id="d584d-125">So überwachen Sie Transaktionsbefehle, die darauf warten, auf dem Abonnenten angewendet zu werden</span><span class="sxs-lookup"><span data-stu-id="d584d-125">To monitor transactional commands waiting to be applied at the Subscriber</span></span>  
  
1.  <span data-ttu-id="d584d-126">Führen Sie auf dem Verteiler für die Verteilerdatenbank [sp_replmonitorsubscriptionpendingcmds](/sql/relational-databases/system-stored-procedures/sp-replmonitorsubscriptionpendingcmds-transact-sql)aus.</span><span class="sxs-lookup"><span data-stu-id="d584d-126">At the Distributor on the distribution database, execute [sp_replmonitorsubscriptionpendingcmds](/sql/relational-databases/system-stored-procedures/sp-replmonitorsubscriptionpendingcmds-transact-sql).</span></span> <span data-ttu-id="d584d-127">Dadurch werden Überwachungsinformationen zu allen Befehlen zurückgegeben, die für alle Abonnements ausstehen, die diesen Verteiler verwenden.</span><span class="sxs-lookup"><span data-stu-id="d584d-127">This returns monitoring information for all commands pending for all subscriptions using this Distributor.</span></span> <span data-ttu-id="d584d-128">Um das Resultset auf ausstehende Befehle für Abonnements zu beschränken, die zu einem einzelnen Verleger, Abonnenten, einer Veröffentlichung oder einer veröffentlichten Datenbank gehören, geben Sie **@publisher** , **@subscriber** , **@publication** oder an **@publisher_db** .</span><span class="sxs-lookup"><span data-stu-id="d584d-128">To limit the result set to commands pending for subscriptions belonging to a single Publisher, Subscriber, publication, or published database, specify **@publisher**, **@subscriber**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
#### <a name="to-monitor-merge-changes-waiting-to-be-uploaded-or-downloaded"></a><span data-ttu-id="d584d-129">So überwachen Sie Mergeänderungen, die darauf warten, hoch- oder heruntergeladen zu werden</span><span class="sxs-lookup"><span data-stu-id="d584d-129">To monitor merge changes waiting to be uploaded or downloaded</span></span>  
  
1.  <span data-ttu-id="d584d-130">Führen Sie auf dem Verleger für die Veröffentlichungsdatenbank [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql)aus.</span><span class="sxs-lookup"><span data-stu-id="d584d-130">At the Publisher on the publication database, execute [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span></span> <span data-ttu-id="d584d-131">Dadurch wird ein Resultset mit Informationen zu Änderungen zurückgegeben, die darauf warten, auf Abonnenten repliziert zu werden.</span><span class="sxs-lookup"><span data-stu-id="d584d-131">This returns a result set showing information on changes that are waiting to be replicated to Subscribers.</span></span> <span data-ttu-id="d584d-132">Um das Resultset auf Änderungen zu beschränken, die zu einer einzelnen Veröffentlichung oder einem Artikel gehören, geben Sie **@publication** **@article** bzw. an.</span><span class="sxs-lookup"><span data-stu-id="d584d-132">To limit the result set to changes that belong to a single publication or article, specify **@publication** or **@article**, respectively.</span></span>  
  
2.  <span data-ttu-id="d584d-133">Führen Sie auf dem Abonnenten für die Abonnementdatenbank [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql)aus.</span><span class="sxs-lookup"><span data-stu-id="d584d-133">At a Subscriber on the subscription database, execute [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span></span> <span data-ttu-id="d584d-134">Dadurch wird ein Resultset mit Informationen zu Änderungen zurückgegeben, die darauf warten, auf dem Verleger repliziert zu werden.</span><span class="sxs-lookup"><span data-stu-id="d584d-134">This returns a result set showing information on changes that are waiting to be replicated to the Publisher.</span></span> <span data-ttu-id="d584d-135">Um das Resultset auf Änderungen zu beschränken, die zu einer einzelnen Veröffentlichung oder einem Artikel gehören, geben Sie **@publication** **@article** bzw. an.</span><span class="sxs-lookup"><span data-stu-id="d584d-135">To limit the result set to changes that belong to a single publication or article, specify **@publication** or **@article**, respectively.</span></span>  
  
#### <a name="to-monitor-merge-agent-sessions"></a><span data-ttu-id="d584d-136">So überwachen Sie Merge-Agentsitzungen</span><span class="sxs-lookup"><span data-stu-id="d584d-136">To monitor Merge Agent sessions</span></span>  
  
1.  <span data-ttu-id="d584d-137">Führen Sie auf dem Verteiler für die Verteilerdatenbank [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql)aus.</span><span class="sxs-lookup"><span data-stu-id="d584d-137">At the Distributor on the distribution database, execute [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span></span> <span data-ttu-id="d584d-138">Dadurch werden zu allen Merge-Agentsitzungen für alle Abonnements, die diesen Verteiler verwenden, Überwachungsinformationen, beispielsweise **Session_id**, zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="d584d-138">This returns monitoring information, including **Session_id**, on all Merge Agent sessions for all subscriptions using this Distributor.</span></span> <span data-ttu-id="d584d-139">Sie können **Session_id** auch ermitteln, indem Sie eine Abfrage der [MSmerge_sessions](/sql/relational-databases/system-tables/msmerge-sessions-transact-sql) -Systemtabelle ausführen.</span><span class="sxs-lookup"><span data-stu-id="d584d-139">You can also obtain **Session_id** by querying the [MSmerge_sessions](/sql/relational-databases/system-tables/msmerge-sessions-transact-sql) system table.</span></span>  
  
2.  <span data-ttu-id="d584d-140">Führen Sie auf dem Verteiler für die Verteilerdatenbank [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql)aus.</span><span class="sxs-lookup"><span data-stu-id="d584d-140">At the Distributor on the distribution database, execute [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span></span> <span data-ttu-id="d584d-141">Geben Sie einen Wert **Session_id** aus Schritt 1 für **@session_id**aus.</span><span class="sxs-lookup"><span data-stu-id="d584d-141">Specify a **Session_id** value from step 1 for **@session_id**.</span></span> <span data-ttu-id="d584d-142">Dadurch werden ausführliche Überwachungsinformationen zu der Sitzung angezeigt.</span><span class="sxs-lookup"><span data-stu-id="d584d-142">This displays detailed monitor information about the session.</span></span>  
  
3.  <span data-ttu-id="d584d-143">Wiederholen Sie Schritt 2 für jede Sitzung, die von Interesse ist.</span><span class="sxs-lookup"><span data-stu-id="d584d-143">Repeat step 2 for each session of interest.</span></span>  
  
#### <a name="to-monitor-merge-agent-sessions-for-pull-subscriptions-from-the-subscriber"></a><span data-ttu-id="d584d-144">So überwachen Sie Merge-Agentsitzungen für Pullabonnements auf dem Abonnenten</span><span class="sxs-lookup"><span data-stu-id="d584d-144">To monitor Merge Agent sessions for pull subscriptions from the Subscriber</span></span>  
  
1.  <span data-ttu-id="d584d-145">Führen Sie auf dem Abonnenten für die Abonnementdatenbank [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql)aus.</span><span class="sxs-lookup"><span data-stu-id="d584d-145">At the Subscriber on the subscription database, execute [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span></span> <span data-ttu-id="d584d-146">Geben Sie für ein bestimmtes Abonnement **@publisher** , **@publication** und den Namen der Veröffentlichungs Datenbank für an **@publisher_db** .</span><span class="sxs-lookup"><span data-stu-id="d584d-146">For a given subscription, specify **@publisher**, **@publication**, and the name of the publication database for **@publisher_db**.</span></span> <span data-ttu-id="d584d-147">Dadurch werden Überwachungsinformationen zu den letzten fünf Merge-Agentsitzungen für dieses Abonnement zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="d584d-147">This returns monitoring information for the last five Merge Agent sessions for this subscription.</span></span> <span data-ttu-id="d584d-148">Beachten Sie im Resultset den Wert **Session_id** für Sitzungen, die von Interesse sind.</span><span class="sxs-lookup"><span data-stu-id="d584d-148">Note the value of **Session_id** for sessions of interest in the result set.</span></span>  
  
2.  <span data-ttu-id="d584d-149">Führen Sie auf dem Abonnenten für die Abonnementdatenbank [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql)aus.</span><span class="sxs-lookup"><span data-stu-id="d584d-149">At the Subscriber on the subscription database, execute [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span></span> <span data-ttu-id="d584d-150">Geben Sie einen Wert **Session_id** aus Schritt 1 für **@session_id**aus.</span><span class="sxs-lookup"><span data-stu-id="d584d-150">Specify a **Session_id** value from step 1 for **@session_id**.</span></span> <span data-ttu-id="d584d-151">Dadurch werden ausführliche Überwachungsinformationen zu der Sitzung angezeigt.</span><span class="sxs-lookup"><span data-stu-id="d584d-151">This displays detailed monitoring information about the session.</span></span>  
  
3.  <span data-ttu-id="d584d-152">Wiederholen Sie Schritt 2 für jede Sitzung, die von Interesse ist.</span><span class="sxs-lookup"><span data-stu-id="d584d-152">Repeat step 2 for each session of interest.</span></span>  
  
#### <a name="to-view-and-modify-the-monitor-threshold-metrics-for-a-publication"></a><span data-ttu-id="d584d-153">So können Sie die Schwellenwertmetriken für die Überwachung für eine Veröffentlichung anzeigen und ändern</span><span class="sxs-lookup"><span data-stu-id="d584d-153">To view and modify the monitor threshold metrics for a publication</span></span>  
  
1.  <span data-ttu-id="d584d-154">Führen Sie auf dem Verteiler für die Verteilerdatenbank [sp_replmonitorhelppublicationthresholds](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublicationthresholds-transact-sql)aus.</span><span class="sxs-lookup"><span data-stu-id="d584d-154">At the Distributor on the distribution database, execute [sp_replmonitorhelppublicationthresholds](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublicationthresholds-transact-sql).</span></span> <span data-ttu-id="d584d-155">Dadurch werden Überwachungsschwellenwerte zurückgegeben, die für alle Veröffentlichungen festgelegt wurden, die diesen Verteiler verwenden.</span><span class="sxs-lookup"><span data-stu-id="d584d-155">This returns the monitoring thresholds set for all publications using this Distributor.</span></span> <span data-ttu-id="d584d-156">Um das Resultset auf Überwachungs Schwellenwerte für Veröffentlichungen zu beschränken, die zu einem einzelnen Verleger oder einer veröffentlichten Datenbank oder zu einer einzelnen Veröffentlichung gehören, geben Sie **@publisher** , **@publisher_db** **@publication** bzw. an.</span><span class="sxs-lookup"><span data-stu-id="d584d-156">To limit the result set to monitor thresholds to publications belonging to a single Publisher or published database or to a single publication, specify **@publisher**, **@publisher_db**, or **@publication**, respectively.</span></span> <span data-ttu-id="d584d-157">Beachten Sie den Wert **Metric_id** für alle Schwellenwerte, die geändert werden müssen.</span><span class="sxs-lookup"><span data-stu-id="d584d-157">Note the value of **Metric_id** for any thresholds that must be changed.</span></span> <span data-ttu-id="d584d-158">Weitere Informationen finden Sie unter [Set Thresholds and Warnings in Replication Monitor](set-thresholds-and-warnings-in-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="d584d-158">For more information, see [Set Thresholds and Warnings in Replication Monitor](set-thresholds-and-warnings-in-replication-monitor.md).</span></span>  
  
2.  <span data-ttu-id="d584d-159">Führen Sie auf dem Verteiler für die Verteilerdatenbank [sp_replmonitorchangepublicationthreshold](/sql/relational-databases/system-stored-procedures/sp-replmonitorchangepublicationthreshold-transact-sql)aus.</span><span class="sxs-lookup"><span data-stu-id="d584d-159">At the Distributor on the distribution database, execute [sp_replmonitorchangepublicationthreshold](/sql/relational-databases/system-stored-procedures/sp-replmonitorchangepublicationthreshold-transact-sql).</span></span> <span data-ttu-id="d584d-160">Geben Sie bei Bedarf Folgendes an:</span><span class="sxs-lookup"><span data-stu-id="d584d-160">Specify the following as needed:</span></span>  
  
    -   <span data-ttu-id="d584d-161">Den in Schritt 1 ermittelten **Metric_id** -Wert für **@metric_id**aus.</span><span class="sxs-lookup"><span data-stu-id="d584d-161">The **Metric_id** value obtained in step 1 for **@metric_id**.</span></span>  
  
    -   <span data-ttu-id="d584d-162">Ein neuer Wert für die Monitor Schwellenwert Metrik für **@value** .</span><span class="sxs-lookup"><span data-stu-id="d584d-162">A new value for the monitor threshold metric for **@value**.</span></span>  
  
    -   <span data-ttu-id="d584d-163">Einen Wert **1** für **@shouldalert** für eine Warnung, die protokolliert wird, wenn dieser Schwellenwert erreicht wird, oder einen Wert **0** , wenn keine Warnung erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="d584d-163">A value of **1** for **@shouldalert** for an alert to be logged when this threshold is reached, or a value of **0** if an alert is not needed.</span></span>  
  
    -   <span data-ttu-id="d584d-164">Einen Wert **1** für **@mode** , um die Schwellenwertmetrik für die Überwachung zu aktivieren, oder der Wert **2** , um diese zu deaktivieren.</span><span class="sxs-lookup"><span data-stu-id="d584d-164">A value of **1** for **@mode** to enable the monitor threshold metric or a value of **2** to disable it.</span></span>  
  
##  <a name="replication-management-objects-rmo"></a><a name="RMO"></a> <span data-ttu-id="d584d-165">Replikationsverwaltungsobjekte (RMO)</span><span class="sxs-lookup"><span data-stu-id="d584d-165">Replication Management Objects (RMO)</span></span>  
  
#### <a name="to-monitor-a-subscription-to-a-merge-publication-at-the-subscriber"></a><span data-ttu-id="d584d-166">So überwachen Sie ein Abonnement für eine Mergeveröffentlichung auf dem Abonnenten</span><span class="sxs-lookup"><span data-stu-id="d584d-166">To monitor a subscription to a merge publication at the Subscriber</span></span>  
  
1.  <span data-ttu-id="d584d-167">Erstellen Sie eine Verbindung mit dem Abonnenten, indem Sie die <xref:Microsoft.SqlServer.Management.Common.ServerConnection> -Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="d584d-167">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="d584d-168">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor> -Klasse, und legen Sie die Eigenschaften <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publisher%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publication%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.PublisherDB%2A>und <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.SubscriberDB%2A> für das Abonnement fest, und legen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> -Eigenschaft auf die in Schritt 1 erstellte <xref:Microsoft.SqlServer.Management.Common.ServerConnection> fest.</span><span class="sxs-lookup"><span data-stu-id="d584d-168">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor> class, and set the <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publisher%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publication%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.PublisherDB%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.SubscriberDB%2A> properties for the subscription, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
3.  <span data-ttu-id="d584d-169">Rufen Sie eine der folgenden Methoden auf, um Informationen zu Merge-Agentsitzungen für dieses Abonnement zurückzugeben:</span><span class="sxs-lookup"><span data-stu-id="d584d-169">Call one of the following methods to return information on Merge Agent sessions for this subscription:</span></span>  
  
    -   <span data-ttu-id="d584d-170"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - gibt ein Array von <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> -Objekten mit Informationen zu maximal den letzten fünf Merge-Agentsitzungen zurück.</span><span class="sxs-lookup"><span data-stu-id="d584d-170"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> objects with information on up to the last five Merge Agent sessions.</span></span> <span data-ttu-id="d584d-171">Beachten Sie den <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> -Wert für alle Sitzungen, die von Interesse sind.</span><span class="sxs-lookup"><span data-stu-id="d584d-171">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="d584d-172"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - gibt ein Array von <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> -Objekten mit Informationen zu Merge-Agentsitzungen zurück, die in der Anzahl der letzten Stunden aufgetreten sind, die als *hours* -Parameter übergeben wurde (maximal die letzten fünf Sitzungen).</span><span class="sxs-lookup"><span data-stu-id="d584d-172"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> objects with information on Merge Agent sessions that have occurred during the past number of hours passed in as the *hours* parameter (up to the last five sessions).</span></span> <span data-ttu-id="d584d-173">Beachten Sie den <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> -Wert für alle Sitzungen, die von Interesse sind.</span><span class="sxs-lookup"><span data-stu-id="d584d-173">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="d584d-174"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummary%2A> - gibt ein <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> -Objekt mit Informationen zu der letzten Merge-Agentsitzung zurück.</span><span class="sxs-lookup"><span data-stu-id="d584d-174"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummary%2A> - returns a <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> object with information on the last Merge Agent session.</span></span> <span data-ttu-id="d584d-175">Beachten Sie den <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> -Wert für diese Sitzung.</span><span class="sxs-lookup"><span data-stu-id="d584d-175">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for this session.</span></span>  
  
    -   <span data-ttu-id="d584d-176"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummaryDataSet%2A> - gibt ein <xref:System.Data.DataSet> -Objekt mit Informationen zu maximal den letzten fünf Merge-Agentsitzungen zurück (eine pro Zeile).</span><span class="sxs-lookup"><span data-stu-id="d584d-176"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummaryDataSet%2A> - returns a <xref:System.Data.DataSet> object with information on up to the last five Merge Agent sessions, one in each row.</span></span> <span data-ttu-id="d584d-177">Beachten Sie den Wert der **Session_id** -Spalte für alle Sitzungen, die von Interesse sind.</span><span class="sxs-lookup"><span data-stu-id="d584d-177">Note the value of the **Session_id** column for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="d584d-178"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummaryDataRow%2A> - gibt ein <xref:System.Data.DataRow> -Objekt mit Informationen zu der letzten Merge-Agentsitzung zurück.</span><span class="sxs-lookup"><span data-stu-id="d584d-178"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummaryDataRow%2A> - returns a <xref:System.Data.DataRow> object with information on the last Merge Agent session.</span></span> <span data-ttu-id="d584d-179">Beachten Sie den Wert der **Session_id** -Spalte für diese Sitzung.</span><span class="sxs-lookup"><span data-stu-id="d584d-179">Note the value of the **Session_id** column for this session.</span></span>  
  
4.  <span data-ttu-id="d584d-180">(Optional) Rufen Sie <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> auf, um die Daten für das <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> -Objekt zu aktualisieren, das als *mss,* übergeben wurde, oder rufen Sie <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> auf, um die Daten im <xref:System.Data.DataRow> -Objekt zu aktualisieren, das als *drRefresh*aus.</span><span class="sxs-lookup"><span data-stu-id="d584d-180">(Optional) Call <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> to refresh the data for the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> object passed as *mss,* or call <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> to refresh the data in the <xref:System.Data.DataRow> object passed as *drRefresh*.</span></span>  
  
5.  <span data-ttu-id="d584d-181">Rufen Sie mithilfe der in Schritt 3 abgerufenen Sitzungs-ID eine der folgenden Methoden auf, um Informationen zu den Details einer bestimmten Sitzung zurückzugeben:</span><span class="sxs-lookup"><span data-stu-id="d584d-181">Using the session ID obtained in step 3, call one of the following methods to return information on the details of a particular session:</span></span>  
  
    -   <span data-ttu-id="d584d-182"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetails%2A>-Gibt ein Array von- <xref:Microsoft.SqlServer.Replication.MergeSessionDetail> Objekten für die angegebene *SessionID*zurück.</span><span class="sxs-lookup"><span data-stu-id="d584d-182"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetails%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionDetail> objects for the supplied *sessionID*.</span></span>  
  
    -   <span data-ttu-id="d584d-183"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetailsDataSet%2A>-Gibt ein- <xref:System.Data.DataSet> Objekt mit Informationen für die angegebene *SessionID*zurück.</span><span class="sxs-lookup"><span data-stu-id="d584d-183"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetailsDataSet%2A> - returns a <xref:System.Data.DataSet> object with information for the specified *sessionID*.</span></span>  
  
#### <a name="to-monitor-replication-properties-for-all-publications-at-a-distributor"></a><span data-ttu-id="d584d-184">So überwachen Sie die Replikationseigenschaften für alle Veröffentlichungen auf einem Verteiler</span><span class="sxs-lookup"><span data-stu-id="d584d-184">To monitor replication properties for all publications at a Distributor</span></span>  
  
1.  <span data-ttu-id="d584d-185">Erstellen Sie eine Verbindung mit dem Verteiler, indem Sie die <xref:Microsoft.SqlServer.Management.Common.ServerConnection> -Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="d584d-185">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="d584d-186">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.ReplicationMonitor>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="d584d-186">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> class.</span></span>  
  
3.  <span data-ttu-id="d584d-187">Legen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> -Eigenschaft auf die in Schritt 1 erstellte <xref:Microsoft.SqlServer.Management.Common.ServerConnection> fest.</span><span class="sxs-lookup"><span data-stu-id="d584d-187">Set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
4.  <span data-ttu-id="d584d-188">Rufen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> -Methode auf, um die Eigenschaften des Objekts abzurufen.</span><span class="sxs-lookup"><span data-stu-id="d584d-188">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span>  
  
5.  <span data-ttu-id="d584d-189">Führen Sie mindestens eine der folgenden Methoden aus, um Replikationsinformationen für alle Verleger zurückzugeben, die diesen Verteiler verwenden:</span><span class="sxs-lookup"><span data-stu-id="d584d-189">Execute one or more of the following methods to return replication information for all Publishers that use this Distributor.</span></span>  
  
    -   <span data-ttu-id="d584d-190"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumDistributionAgents%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Informationen zu allen Verteilungs-Agents auf diesem Verteiler enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-190"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumDistributionAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Distribution Agents at this Distributor.</span></span>  
  
    -   <span data-ttu-id="d584d-191"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumErrorRecords%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Informationen zu auf dem Verteiler gespeicherten Fehlern enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-191"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains information about errors stored at the Distributor.</span></span>  
  
    -   <span data-ttu-id="d584d-192"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumLogReaderAgents%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Informationen zu allen Protokolllese-Agents auf dem Verteiler enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-192"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumLogReaderAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Log Reader Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="d584d-193"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMergeAgents%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Informationen zu allen Merge-Agents auf dem Verteiler enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-193"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMergeAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Merge Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="d584d-194"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMiscellaneousAgents%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Informationen zu allen anderen Replikations-Agents auf dem Verteiler enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-194"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMiscellaneousAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all other replication agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="d584d-195"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Informationen zu allen Verlegern auf diesem Verteiler enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-195"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Publishers at this Distributor.</span></span>  
  
    -   <span data-ttu-id="d584d-196"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers2%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das die Verleger zurückgibt, von denen dieser Verteiler verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="d584d-196"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers2%2A> - returns a <xref:System.Data.DataSet> object that returns the Publishers that use this Distributor.</span></span>  
  
    -   <span data-ttu-id="d584d-197"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgents%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Informationen zu allen Warteschlangenlese-Agents auf dem Verteiler enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-197"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Queue Reader Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="d584d-198"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessionDetails%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Details zu dem angegebenen Warteschlangenlese-Agent und der angegebenen Sitzung enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-198"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Queue Reader Agent and session.</span></span>  
  
    -   <span data-ttu-id="d584d-199"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessions%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Sitzungsinformationen zu dem angegebenen Warteschlangenlese-Agent enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-199"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information about the specified Queue Reader Agent.</span></span>  
  
    -   <span data-ttu-id="d584d-200"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumSnapshotAgents%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Informationen zu allen Momentaufnahme-Agents auf dem Verteiler enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-200"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumSnapshotAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Snapshot Agents at the Distributor.</span></span>  
  
#### <a name="to-monitor-publication-properties-for-a-specific-publisher-at-the-distributor"></a><span data-ttu-id="d584d-201">So überwachen Sie die Veröffentlichungseigenschaften für einen bestimmten Verleger auf dem Verteiler</span><span class="sxs-lookup"><span data-stu-id="d584d-201">To monitor publication properties for a specific Publisher at the Distributor</span></span>  
  
1.  <span data-ttu-id="d584d-202">Erstellen Sie eine Verbindung mit dem Verteiler, indem Sie die <xref:Microsoft.SqlServer.Management.Common.ServerConnection> -Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="d584d-202">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="d584d-203">Rufen Sie auf eine der folgenden Arten ein <xref:Microsoft.SqlServer.Replication.PublisherMonitor> -Objekt ab.</span><span class="sxs-lookup"><span data-stu-id="d584d-203">Get a <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="d584d-204">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.PublisherMonitor>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="d584d-204">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor> class.</span></span> <span data-ttu-id="d584d-205">Legen Sie die <xref:Microsoft.SqlServer.Replication.PublisherMonitor.Name%2A> -Eigenschaft für den Verleger fest, und legen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> -Eigenschaft auf die in Schritt 1 erstellte <xref:Microsoft.SqlServer.Management.Common.ServerConnection> fest.</span><span class="sxs-lookup"><span data-stu-id="d584d-205">Set the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.Name%2A> property for the Publisher, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="d584d-206">Rufen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> -Methode auf, um die Eigenschaften des Objekts abzurufen.</span><span class="sxs-lookup"><span data-stu-id="d584d-206">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="d584d-207">Wenn diese Methode `false` zurückgibt, ist der Verlegername falsch definiert, oder die Veröffentlichung ist nicht vorhanden.</span><span class="sxs-lookup"><span data-stu-id="d584d-207">If this method returns `false`, either the Publisher name was defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="d584d-208">Aus der <xref:Microsoft.SqlServer.Replication.PublisherMonitorCollection> , auf die mittels der <xref:Microsoft.SqlServer.Replication.ReplicationMonitor.PublisherMonitors%2A> -Eigenschaft eines vorhandenen <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> -Objekts zugegriffen wird.</span><span class="sxs-lookup"><span data-stu-id="d584d-208">From the <xref:Microsoft.SqlServer.Replication.PublisherMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.ReplicationMonitor.PublisherMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> object.</span></span>  
  
3.  <span data-ttu-id="d584d-209">Führen Sie mindestens eine der folgenden Methoden aus, um Replikationsinformationen für alle Veröffentlichungen zurückzugeben, die zu diesem Verleger gehören.</span><span class="sxs-lookup"><span data-stu-id="d584d-209">Execute one or more of the following methods to return replication information for all publications that belong to this Publisher.</span></span>  
  
    -   <span data-ttu-id="d584d-210"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessionDetails%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Details zu dem angegebenen Verteilungs-Agent und der angegebenen Sitzung enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-210"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Distribution Agent and session.</span></span>  
  
    -   <span data-ttu-id="d584d-211"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessions%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Sitzungsinformationen zu dem angegebenen Verteilungs-Agent enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-211"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information about the specified Distribution Agent.</span></span>  
  
    -   <span data-ttu-id="d584d-212"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumErrorRecords%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Fehlereintragsinformationen zu dem angegebenen Fehler enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-212"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains error record information about the specified error.</span></span>  
  
    -   <span data-ttu-id="d584d-213"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessionDetails%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Details für den angegebenen Protokolllese-Agent und die angegebene Sitzung enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-213"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details for the specified Log Reader Agent and session.</span></span>  
  
    -   <span data-ttu-id="d584d-214"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessions%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Sitzungsinformationen für den angegebenen Protokolllese-Agent enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-214"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Log Reader Agent.</span></span>  
  
    -   <span data-ttu-id="d584d-215"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Details zu dem angegebenen Merge-Agent und der angegebenen Sitzung enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-215"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Merge Agent and session.</span></span>  
  
    -   <span data-ttu-id="d584d-216"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails2%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das zusätzliche Details zu dem angegebenen Merge-Agent und der angegebenen Sitzung enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-216"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails2%2A> - returns a <xref:System.Data.DataSet> object that contains additional details about the specified Merge Agent and session.</span></span>  
  
    -   <span data-ttu-id="d584d-217"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Sitzungsinformationen für den angegebenen Merge-Agent enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-217"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Merge Agent.</span></span>  
  
    -   <span data-ttu-id="d584d-218"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions2%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das zusätzliche Sitzungsinformationen für den angegebenen Merge-Agent enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-218"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions2%2A> - returns a <xref:System.Data.DataSet> object that contains additional session information for the specified Merge Agent.</span></span>  
  
    -   <span data-ttu-id="d584d-219"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Informationen zu allen Veröffentlichungen auf diesem Verteiler enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-219"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications%2A> - returns a <xref:System.Data.DataSet> object that contains information about all publications at this Distributor.</span></span>  
  
    -   <span data-ttu-id="d584d-220"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications2%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Informationen zu allen Veröffentlichungen auf diesem Verteiler enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-220"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications2%2A> - returns a <xref:System.Data.DataSet> object that contains additional information about all publications at this Distributor.</span></span>  
  
    -   <span data-ttu-id="d584d-221"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessionDetails%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Details zu dem angegebenen Momentaufnahme-Agent und der angegebenen Sitzung enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-221"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Snapshot Agent and session.</span></span>  
  
    -   <span data-ttu-id="d584d-222"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessions%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Sitzungsinformationen für den angegebenen Momentaufnahme-Agent enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-222"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Snapshot Agent.</span></span>  
  
    -   <span data-ttu-id="d584d-223"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSubscriptions%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Informationen zu allen Abonnements für Veröffentlichungen auf diesem Verteiler enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-223"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSubscriptions%2A> - returns a <xref:System.Data.DataSet> object that contains information about all subscriptions to publications at this Distributor.</span></span>  
  
#### <a name="to-monitor-properties-for-a-specific-publication-at-the-distributor"></a><span data-ttu-id="d584d-224">So überwachen Sie die Eigenschaften für eine bestimmte Veröffentlichung auf dem Verteiler</span><span class="sxs-lookup"><span data-stu-id="d584d-224">To monitor properties for a specific publication at the Distributor</span></span>  
  
1.  <span data-ttu-id="d584d-225">Erstellen Sie eine Verbindung mit dem Verteiler, indem Sie die <xref:Microsoft.SqlServer.Management.Common.ServerConnection> -Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="d584d-225">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="d584d-226">Rufen Sie auf eine der folgenden Arten ein <xref:Microsoft.SqlServer.Replication.PublicationMonitor> -Objekt ab.</span><span class="sxs-lookup"><span data-stu-id="d584d-226">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="d584d-227">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.PublicationMonitor>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="d584d-227">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="d584d-228">Legen Sie die Eigenschaften <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>und <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> für die Veröffentlichung fest, und legen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> -Eigenschaft auf die in Schritt 1 erstellte <xref:Microsoft.SqlServer.Management.Common.ServerConnection> fest.</span><span class="sxs-lookup"><span data-stu-id="d584d-228">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="d584d-229">Rufen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> -Methode auf, um die Eigenschaften des Objekts abzurufen.</span><span class="sxs-lookup"><span data-stu-id="d584d-229">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="d584d-230">Wenn diese Methode `false` zurückgibt, sind die Veröffentlichungseigenschaften falsch definiert, oder die Veröffentlichung ist nicht vorhanden.</span><span class="sxs-lookup"><span data-stu-id="d584d-230">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="d584d-231">Aus der <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> , auf die mittels der <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> -Eigenschaft eines vorhandenen <xref:Microsoft.SqlServer.Replication.PublisherMonitor> -Objekts zugegriffen wird.</span><span class="sxs-lookup"><span data-stu-id="d584d-231">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="d584d-232">Führen Sie mindestens eine der folgenden Methoden aus, um Informationen zu dieser Veröffentlichung zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="d584d-232">Execute one or more of the following methods to return information about this publication.</span></span>  
  
    -   <span data-ttu-id="d584d-233"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumErrorRecords%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Fehlereinträge zu dem angegebenen Fehler enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-233"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains error records about the specified error.</span></span>  
  
    -   <span data-ttu-id="d584d-234"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumLogReaderAgent%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Informationen zu dem Protokolllese-Agents für diese Veröffentlichung enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-234"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumLogReaderAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Log Reader Agent for this publication.</span></span>  
  
    -   <span data-ttu-id="d584d-235"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Informationen zu den für diese Veröffentlichung festgelegten Warnungsschwellenwerten für die Überwachung enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-235"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> - returns a <xref:System.Data.DataSet> object that contains information about the monitor warning thresholds set for this publication.</span></span>  
  
    -   <span data-ttu-id="d584d-236"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumQueueReaderAgent%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Informationen zu dem von dieser Veröffentlichung verwendeten Warteschlangenlese-Agent enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-236"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumQueueReaderAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Queue Reader Agent used by this publication.</span></span>  
  
    -   <span data-ttu-id="d584d-237"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSnapshotAgent%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Informationen zu dem Momentaufnahme-Agent für diese Veröffentlichung enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-237"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSnapshotAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Snapshot Agent for this publication.</span></span>  
  
    -   <span data-ttu-id="d584d-238"><xref:Microsoft.SqlServer.Replication.Publication.EnumSubscriptions%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Informationen zu Abonnements für diese Veröffentlichung enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-238"><xref:Microsoft.SqlServer.Replication.Publication.EnumSubscriptions%2A> - returns a <xref:System.Data.DataSet> object that contains information about subscriptions to this publication.</span></span>  
  
    -   <span data-ttu-id="d584d-239"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSubscriptions2%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das basierend auf der angegebenen <xref:Microsoft.SqlServer.Replication.SubscriptionResultOption>zusätzliche Informationen zu Abonnements für diese Veröffentlichung enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-239"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSubscriptions2%2A> - returns a <xref:System.Data.DataSet> object that contains additional information about subscriptions to this publication based on the supplied <xref:Microsoft.SqlServer.Replication.SubscriptionResultOption>.</span></span>  
  
    -   <span data-ttu-id="d584d-240"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokenHistory%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Latenzzeitinformationen für das angegebene Überwachungstoken enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-240"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokenHistory%2A> - returns a <xref:System.Data.DataSet> object that contains latency information for the specified tracer token.</span></span>  
  
    -   <span data-ttu-id="d584d-241"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> - gibt ein <xref:System.Data.DataSet> -Objekt zurück, das Informationen zu allen in diese Veröffentlichung eingefügten Überwachungstoken enthält.</span><span class="sxs-lookup"><span data-stu-id="d584d-241"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> - returns a <xref:System.Data.DataSet> object that contains information about all tracer tokens inserted into this publication.</span></span>  
  
#### <a name="to-monitor-transactional-commands-that-are-waiting-to-be-applied-at-the-subscriber"></a><span data-ttu-id="d584d-242">So überwachen Sie Transaktionsbefehle, die darauf warten, auf dem Abonnenten angewendet zu werden</span><span class="sxs-lookup"><span data-stu-id="d584d-242">To monitor transactional commands that are waiting to be applied at the Subscriber</span></span>  
  
1.  <span data-ttu-id="d584d-243">Erstellen Sie eine Verbindung mit dem Verteiler, indem Sie die <xref:Microsoft.SqlServer.Management.Common.ServerConnection> -Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="d584d-243">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="d584d-244">Rufen Sie auf eine der folgenden Arten ein <xref:Microsoft.SqlServer.Replication.PublicationMonitor> -Objekt ab.</span><span class="sxs-lookup"><span data-stu-id="d584d-244">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="d584d-245">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.PublicationMonitor>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="d584d-245">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="d584d-246">Legen Sie die Eigenschaften <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>und <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> für die Veröffentlichung fest, und legen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> -Eigenschaft auf die in Schritt 1 erstellte <xref:Microsoft.SqlServer.Management.Common.ServerConnection> fest.</span><span class="sxs-lookup"><span data-stu-id="d584d-246">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="d584d-247">Rufen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> -Methode auf, um die Eigenschaften des Objekts abzurufen.</span><span class="sxs-lookup"><span data-stu-id="d584d-247">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="d584d-248">Wenn diese Methode `false` zurückgibt, sind die Veröffentlichungseigenschaften falsch definiert, oder die Veröffentlichung ist nicht vorhanden.</span><span class="sxs-lookup"><span data-stu-id="d584d-248">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="d584d-249">Aus der <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> , auf die mittels der <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> -Eigenschaft eines vorhandenen <xref:Microsoft.SqlServer.Replication.PublisherMonitor> -Objekts zugegriffen wird.</span><span class="sxs-lookup"><span data-stu-id="d584d-249">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="d584d-250">Führen Sie die <xref:Microsoft.SqlServer.Replication.PublicationMonitor.TransPendingCommandInfo%2A> -Methode aus, die ein <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> -Objekt zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="d584d-250">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.TransPendingCommandInfo%2A> method, which returns a <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> object.</span></span>  
  
4.  <span data-ttu-id="d584d-251">Verwenden Sie die Eigenschaften dieses <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> -Objekts, um die geschätzte Anzahl von ausstehenden Befehlen und die Dauer für das Abschließen der Übermittlung dieser Befehle zu bestimmen.</span><span class="sxs-lookup"><span data-stu-id="d584d-251">Use the properties of this <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> object to determine the estimated number of pending commands and the length of time it will take to complete the delivery of these commands.</span></span>  
  
#### <a name="to-set-the-monitor-warning-thresholds-for-a-publication"></a><span data-ttu-id="d584d-252">So legen Sie die Warnungsschwellenwerte für die Überwachung für eine Veröffentlichung fest</span><span class="sxs-lookup"><span data-stu-id="d584d-252">To set the monitor warning thresholds for a publication</span></span>  
  
1.  <span data-ttu-id="d584d-253">Erstellen Sie eine Verbindung mit dem Verteiler, indem Sie die <xref:Microsoft.SqlServer.Management.Common.ServerConnection> -Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="d584d-253">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="d584d-254">Rufen Sie auf eine der folgenden Arten ein <xref:Microsoft.SqlServer.Replication.PublicationMonitor> -Objekt ab.</span><span class="sxs-lookup"><span data-stu-id="d584d-254">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="d584d-255">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.PublicationMonitor>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="d584d-255">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="d584d-256">Legen Sie die Eigenschaften <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>und <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> für die Veröffentlichung fest, und legen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> -Eigenschaft auf die in Schritt 1 erstellte <xref:Microsoft.SqlServer.Management.Common.ServerConnection> fest.</span><span class="sxs-lookup"><span data-stu-id="d584d-256">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="d584d-257">Rufen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> -Methode auf, um die Eigenschaften des Objekts abzurufen.</span><span class="sxs-lookup"><span data-stu-id="d584d-257">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="d584d-258">Wenn diese Methode `false` zurückgibt, sind die Veröffentlichungseigenschaften falsch definiert, oder die Veröffentlichung ist nicht vorhanden.</span><span class="sxs-lookup"><span data-stu-id="d584d-258">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="d584d-259">Aus der <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> , auf die mittels der <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> -Eigenschaft eines vorhandenen <xref:Microsoft.SqlServer.Replication.PublisherMonitor> -Objekts zugegriffen wird.</span><span class="sxs-lookup"><span data-stu-id="d584d-259">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="d584d-260">Führen Sie die <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> -Methode aus.</span><span class="sxs-lookup"><span data-stu-id="d584d-260">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> method.</span></span> <span data-ttu-id="d584d-261">Beachten Sie die aktuellen Schwellenwerteinstellungen in der zurückgegebenen <xref:System.Collections.ArrayList> von <xref:Microsoft.SqlServer.Replication.MonitorThreshold> -Objekten.</span><span class="sxs-lookup"><span data-stu-id="d584d-261">Note the current threshold settings in the returned <xref:System.Collections.ArrayList> of <xref:Microsoft.SqlServer.Replication.MonitorThreshold> objects.</span></span>  
  
4.  <span data-ttu-id="d584d-262">Führen Sie die <xref:Microsoft.SqlServer.Replication.PublicationMonitor.ChangeMonitorThreshold%2A> -Methode aus.</span><span class="sxs-lookup"><span data-stu-id="d584d-262">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.ChangeMonitorThreshold%2A> method.</span></span> <span data-ttu-id="d584d-263">Übergeben Sie die folgenden Parameter:</span><span class="sxs-lookup"><span data-stu-id="d584d-263">Pass the following parameters:</span></span>  
  
    -   <span data-ttu-id="d584d-264">*metricID* - ein <xref:System.Int32> -Wert, der die Schwellenwertmetrik für die Überwachung aus der folgenden Tabelle darstellt:</span><span class="sxs-lookup"><span data-stu-id="d584d-264">*metricID* - an <xref:System.Int32> value that represents the monitoring threshold metric from the following table:</span></span>  
  
        |<span data-ttu-id="d584d-265">Wert</span><span class="sxs-lookup"><span data-stu-id="d584d-265">Value</span></span>|<span data-ttu-id="d584d-266">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="d584d-266">Description</span></span>|  
        |-----------|-----------------|  
        |<span data-ttu-id="d584d-267">1</span><span class="sxs-lookup"><span data-stu-id="d584d-267">1</span></span>|<span data-ttu-id="d584d-268">`expiration` - überwacht den bevorstehenden Ablauf von Abonnements für Transaktionsveröffentlichungen.</span><span class="sxs-lookup"><span data-stu-id="d584d-268">`expiration` - monitors for imminent expiration of subscriptions to transactional publications.</span></span>|  
        |<span data-ttu-id="d584d-269">2</span><span class="sxs-lookup"><span data-stu-id="d584d-269">2</span></span>|<span data-ttu-id="d584d-270">`latency` - überwacht die Leistung von Abonnements für Transaktionsveröffentlichungen.</span><span class="sxs-lookup"><span data-stu-id="d584d-270">`latency` - monitors for the performance of subscriptions to transactional publications.</span></span>|  
        |<span data-ttu-id="d584d-271">4</span><span class="sxs-lookup"><span data-stu-id="d584d-271">4</span></span>|<span data-ttu-id="d584d-272">`mergeexpiration` - überwacht den bevorstehenden Ablauf von Abonnements für Mergeveröffentlichungen.</span><span class="sxs-lookup"><span data-stu-id="d584d-272">`mergeexpiration` - monitors for imminent expiration of subscriptions to merge publications.</span></span>|  
        |<span data-ttu-id="d584d-273">5</span><span class="sxs-lookup"><span data-stu-id="d584d-273">5</span></span>|<span data-ttu-id="d584d-274">`mergeslowrunduration`-überwacht die Dauer von Mergesynchronisierungen über Verbindungen mit niedriger Bandbreite (DPS).</span><span class="sxs-lookup"><span data-stu-id="d584d-274">`mergeslowrunduration` - monitors the duration of merge synchronizations over low-bandwidth (dialup) connections.</span></span>|  
        |<span data-ttu-id="d584d-275">6</span><span class="sxs-lookup"><span data-stu-id="d584d-275">6</span></span>|<span data-ttu-id="d584d-276">`mergefastrunduration`-überwacht die Dauer von Mergesynchronisierungen über Verbindungen mit hoher Bandbreite (LAN-Verbindungen).</span><span class="sxs-lookup"><span data-stu-id="d584d-276">`mergefastrunduration` - monitors the duration of merge synchronizations over high-bandwidth (LAN) connections.</span></span>|  
        |<span data-ttu-id="d584d-277">7</span><span class="sxs-lookup"><span data-stu-id="d584d-277">7</span></span>|<span data-ttu-id="d584d-278">`mergefastrunspeed` - Überwachung der Synchronisierungsgeschwindigkeit von Mergesynchronisierungen über Verbindungen mit hoher Bandbreite (LAN-Verbindungen).</span><span class="sxs-lookup"><span data-stu-id="d584d-278">`mergefastrunspeed` - monitors the synchronization rate of merge synchronizations over high-bandwidth (LAN) connections.</span></span>|  
        |<span data-ttu-id="d584d-279">8</span><span class="sxs-lookup"><span data-stu-id="d584d-279">8</span></span>|<span data-ttu-id="d584d-280">`mergeslowrunspeed` - überwacht die Synchronisierungsgeschwindigkeit von Mergesynchronisierungen über Verbindungen mit niedriger Bandbreite (DFÜ-Verbindungen).</span><span class="sxs-lookup"><span data-stu-id="d584d-280">`mergeslowrunspeed` - monitors the synchronization rate of merge synchronizations over low-bandwidth (dialup) connections.</span></span>|  
  
    -   <span data-ttu-id="d584d-281">*enable* - <xref:System.Boolean> -Wert, der angibt, ob die Metrik für die Veröffentlichung aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="d584d-281">*enable* - <xref:System.Boolean> value that indicates whether the metric is enabled for the publication.</span></span>  
  
    -   <span data-ttu-id="d584d-282">*thresholdValue* - ganzzahliger Wert, der den Schwellenwert festlegt.</span><span class="sxs-lookup"><span data-stu-id="d584d-282">*thresholdValue* - integer value that sets the threshold.</span></span>  
  
    -   <span data-ttu-id="d584d-283">*shouldAlert* - ganze Zahl, die angibt, ob dieser Schwellenwert eine Warnung generieren soll.</span><span class="sxs-lookup"><span data-stu-id="d584d-283">*shouldAlert* - integer that indicates whether this threshold should generate an alert.</span></span>  
  
  

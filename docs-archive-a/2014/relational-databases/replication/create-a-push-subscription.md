---
title: Erstellen eines Pushabonnements | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- push subscriptions [SQL Server replication], creating
- merge replication subscribing [SQL Server replication], push subscriptions
- subscriptions [SQL Server replication], push
- snapshot replication [SQL Server], subscribing
- transactional replication, subscribing
ms.assetid: adfbbc61-58d1-4330-9ad6-b14ab1142e2b
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 2195d96f4337cc60ba213deb5e3cc2831d27da76
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87630630"
---
# <a name="create-a-push-subscription"></a><span data-ttu-id="e33f4-102">Erstellen eines Pushabonnements</span><span class="sxs-lookup"><span data-stu-id="e33f4-102">Create a Push Subscription</span></span>
  <span data-ttu-id="e33f4-103">In diesem Thema wird beschrieben, wie ein Pushabonnement in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] mit [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)]oder Replikationsverwaltungsobjekten (RMO) erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="e33f4-103">This topic describes how to create a push subscription in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="e33f4-104">Informationen zum Erstellen eines Pushabonnements für einen nicht-- [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Abonnenten finden Sie unter [Erstellen eines Abonnements für einen nicht-SQL Server Abonnenten](create-a-subscription-for-a-non-sql-server-subscriber.md).</span><span class="sxs-lookup"><span data-stu-id="e33f4-104">For information about creating a push subscription for a non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscriber, see [Create a Subscription for a Non-SQL Server Subscriber](create-a-subscription-for-a-non-sql-server-subscriber.md).</span></span>  
  
  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="e33f4-105">Verwenden von SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="e33f4-105">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="e33f4-106">Erstellen Sie mit dem Assistenten für neue Abonnements ein Pushabonnement auf dem Verleger oder dem Abonnenten.</span><span class="sxs-lookup"><span data-stu-id="e33f4-106">Create a push subscription at the Publisher or the Subscriber using the New Subscription Wizard.</span></span> <span data-ttu-id="e33f4-107">Folgen Sie den Seiten im Assistenten für folgende Aufgaben:</span><span class="sxs-lookup"><span data-stu-id="e33f4-107">Follow the pages in the wizard to:</span></span>  
  
-   <span data-ttu-id="e33f4-108">Angeben des Verlegers und der Veröffentlichung.</span><span class="sxs-lookup"><span data-stu-id="e33f4-108">Specify the Publisher and publication.</span></span>  
  
-   <span data-ttu-id="e33f4-109">Auswählen, wo die Replikations-Agents ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="e33f4-109">Select where replication agents will run.</span></span> <span data-ttu-id="e33f4-110">Wählen Sie für ein Pushabonnement je nach Veröffentlichungstyp auf der Seite **Speicherort des Verteilungs-Agents** bzw. **Speicherort des Merge-Agents** die Option **Alle Agents auf dem Verteiler ausführen (Pushabonnements)** aus.</span><span class="sxs-lookup"><span data-stu-id="e33f4-110">For a push subscription, select **Run all agents at the Distributor (push subscriptions)** on the **Distribution Agent Location** page or **Merge Agent Location** page, depending on the type of publication.</span></span>  
  
-   <span data-ttu-id="e33f4-111">Angeben der Abonnenten und Abonnentendatenbanken.</span><span class="sxs-lookup"><span data-stu-id="e33f4-111">Specify Subscribers and subscription databases.</span></span>  
  
-   <span data-ttu-id="e33f4-112">Angeben der Anmeldenamen und Kennwörter für Verbindungen zwischen den Replikations-Agents:</span><span class="sxs-lookup"><span data-stu-id="e33f4-112">Specify the logins and passwords used for connections made by replication agents:</span></span>  
  
    -   <span data-ttu-id="e33f4-113">Bei Abonnements für Momentaufnahme- und Transaktionsveröffentlichungen geben Sie die Anmeldeinformationen auf der Seite **Sicherheit für den Verteilungs-Agent** an.</span><span class="sxs-lookup"><span data-stu-id="e33f4-113">For subscriptions to snapshot and transactional publications, specify credentials on the **Distribution Agent Security** page.</span></span>  
  
    -   <span data-ttu-id="e33f4-114">Bei Abonnements für Mergeveröffentlichungen geben Sie die Anmeldeinformationen auf der Seite **Sicherheit für den Merge-Agent** an.</span><span class="sxs-lookup"><span data-stu-id="e33f4-114">For subscriptions to merge publications, specify credentials on the **Merge Agent Security** page.</span></span>  
  
     <span data-ttu-id="e33f4-115">Informationen zu den für die jeweiligen Agents erforderlichen Berechtigungen finden Sie unter [Sicherheitsmodell des Replikations-Agents](security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="e33f4-115">For information about the permissions required by each agent, see [Replication Agent Security Model](security/replication-agent-security-model.md).</span></span>  
  
-   <span data-ttu-id="e33f4-116">Angeben eines Synchronisierungszeitplans und wann der Abonnent initialisiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="e33f4-116">Specify a synchronization schedule and when the Subscriber should be initialized.</span></span>  
  
-   <span data-ttu-id="e33f4-117">Angeben weiterer Optionen für Mergeveröffentlichungen: Abonnementtyp und Werte für parametrisierte Filter.</span><span class="sxs-lookup"><span data-stu-id="e33f4-117">Specify additional options for merge publications: subscription type; and values for parameterized filtering.</span></span>  
  
-   <span data-ttu-id="e33f4-118">Angeben weiterer Optionen für Transaktionsveröffentlichungen, die aktualisierbare Abonnements zulassen: ob Abonnenten sofort ein Commit für Änderungen auf dem Verleger ausführen oder die Änderungen in eine Warteschlange schreiben sollen; die Anmeldeinformationen zum Herstellen einer Verbindung zwischen Abonnenten und Verleger.</span><span class="sxs-lookup"><span data-stu-id="e33f4-118">Specify additional options for transactional publications that allow updating subscriptions: whether Subscribers should commit changes at the Publisher immediately or write them to a queue; credentials used to connect from the Subscriber to the Publisher.</span></span>  
  
-   <span data-ttu-id="e33f4-119">Optionale Skripterstellung für das Abonnement.</span><span class="sxs-lookup"><span data-stu-id="e33f4-119">Optionally script the subscription.</span></span>  
  
#### <a name="to-create-a-push-subscription-from-the-publisher"></a><span data-ttu-id="e33f4-120">So erstellen Sie ein Pushabonnement auf dem Verleger</span><span class="sxs-lookup"><span data-stu-id="e33f4-120">To create a push subscription from the Publisher</span></span>  
  
1.  <span data-ttu-id="e33f4-121">Stellen Sie in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] eine Verbindung mit dem Herausgeber her, und erweitern Sie den Serverknoten.</span><span class="sxs-lookup"><span data-stu-id="e33f4-121">Connect to the Publisher in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="e33f4-122">Erweitern Sie den Ordner **Replikation** , und erweitern Sie dann den Ordner **Lokale Veröffentlichungen** .</span><span class="sxs-lookup"><span data-stu-id="e33f4-122">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="e33f4-123">Klicken Sie mit der rechten Maustaste auf die Veröffentlichung, für die Sie eine oder mehrere Abonnements erstellen möchten, und klicken Sie dann auf **Neue Abonnements**.</span><span class="sxs-lookup"><span data-stu-id="e33f4-123">Right-click the publication for which you want to create one or more subscriptions, and then click **New Subscriptions**.</span></span>  
  
4.  <span data-ttu-id="e33f4-124">Schließen Sie die Seiten im Assistenten für neue Abonnements ab.</span><span class="sxs-lookup"><span data-stu-id="e33f4-124">Complete the pages in the New Subscription Wizard.</span></span>  
  
#### <a name="to-create-a-push-subscription-from-the-subscriber"></a><span data-ttu-id="e33f4-125">So erstellen Sie ein Pushabonnement auf dem Abonnenten</span><span class="sxs-lookup"><span data-stu-id="e33f4-125">To create a push subscription from the Subscriber</span></span>  
  
1.  <span data-ttu-id="e33f4-126">Stellen Sie in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]eine Verbindung mit dem Abonnenten her, und erweitern Sie dann den Serverknoten.</span><span class="sxs-lookup"><span data-stu-id="e33f4-126">Connect to the Subscriber in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="e33f4-127">Erweitern Sie den Ordner **Replikation** .</span><span class="sxs-lookup"><span data-stu-id="e33f4-127">Expand the **Replication** folder.</span></span>  
  
3.  <span data-ttu-id="e33f4-128">Klicken Sie mit der rechten Maustaste auf den Ordner **Lokale Abonnements** , und klicken Sie dann auf **Neue Abonnements**.</span><span class="sxs-lookup"><span data-stu-id="e33f4-128">Right-click the **Local Subscriptions** folder, and then click **New Subscriptions**.</span></span>  
  
4.  <span data-ttu-id="e33f4-129">Wählen Sie auf der Seite **Veröffentlichung** des Assistenten für neue Abonnements **\<Find SQL Server Publisher>** oder **\<Find Oracle Publisher>** aus der Dropdownliste **Verleger** aus.</span><span class="sxs-lookup"><span data-stu-id="e33f4-129">On the **Publication** page of the New Subscription Wizard, select **\<Find SQL Server Publisher>** or **\<Find Oracle Publisher>** from the **Publisher** drop-down list.</span></span>  
  
5.  <span data-ttu-id="e33f4-130">Stellen Sie im Dialogfeld **Verbindung mit Server herstellen** eine Verbindung mit dem Verleger her.</span><span class="sxs-lookup"><span data-stu-id="e33f4-130">Connect to the Publisher in the **Connect to Server** dialog box.</span></span>  
  
6.  <span data-ttu-id="e33f4-131">Wählen Sie auf der Seite **Veröffentlichung** eine Veröffentlichung aus.</span><span class="sxs-lookup"><span data-stu-id="e33f4-131">Select a publication on the **Publication** page.</span></span>  
  
7.  <span data-ttu-id="e33f4-132">Schließen Sie die Seiten im Assistenten für neue Abonnements ab.</span><span class="sxs-lookup"><span data-stu-id="e33f4-132">Complete the pages in the New Subscription Wizard.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="e33f4-133">Verwenden von Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="e33f4-133">Using Transact-SQL</span></span>  
 <span data-ttu-id="e33f4-134">Pushabonnements können mithilfe von gespeicherten Replikationsprozeduren programmgesteuert erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="e33f4-134">Push subscriptions can be created programmatically using replication stored procedures.</span></span> <span data-ttu-id="e33f4-135">Die verwendeten gespeicherten Prozeduren hängen vom Typ der Veröffentlichung ab, zu der das Abonnement gehört.</span><span class="sxs-lookup"><span data-stu-id="e33f4-135">The stored procedures used will depend on the type of publication to which the subscription belongs.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="e33f4-136">Die Benutzer sollten nach Möglichkeit während der Laufzeit zur Eingabe von Anmeldeinformationen aufgefordert werden.</span><span class="sxs-lookup"><span data-stu-id="e33f4-136">When possible, prompt users to enter security credentials at run time.</span></span> <span data-ttu-id="e33f4-137">Wenn Anmeldeinformationen in einer Skriptdatei gespeichert werden müssen, muss die Datei an einem sicheren Ort gespeichert werden, um unberechtigten Zugriff zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="e33f4-137">If you must store credentials in a script file, you must secure the file to prevent unauthorized access.</span></span>  
  
#### <a name="to-create-a-push-subscription-to-a-snapshot-or-transactional-publication"></a><span data-ttu-id="e33f4-138">So erstellen Sie ein Pushabonnement für eine Momentaufnahme- oder Transaktionsveröffentlichung.</span><span class="sxs-lookup"><span data-stu-id="e33f4-138">To create a push subscription to a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="e33f4-139">Überprüfen Sie für die Veröffentlichungsdatenbank auf dem Verleger, ob die Veröffentlichung Pushabonnements unterstützt, indem Sie [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql)ausführen.</span><span class="sxs-lookup"><span data-stu-id="e33f4-139">At the Publisher on the publication database, verify that the publication supports push subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span>  
  
    -   <span data-ttu-id="e33f4-140">Wenn der Wert von **allow_push** **1**ist, werden Pushabonnements unterstützt.</span><span class="sxs-lookup"><span data-stu-id="e33f4-140">If the value of **allow_push** is **1**, push subscriptions are supported.</span></span>  
  
    -   <span data-ttu-id="e33f4-141">Wenn der Wert von **allow_push** **0**ist, führen Sie [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql)aus, und geben Sie **allow_push** für **@property** und `true` für an **@value** .</span><span class="sxs-lookup"><span data-stu-id="e33f4-141">If the value of **allow_push** is **0**, execute [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specifying **allow_push** for **@property** and `true` for **@value**.</span></span>  
  
2.  <span data-ttu-id="e33f4-142">Führen Sie auf dem Verleger für die Veröffentlichungsdatenbank [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)aus.</span><span class="sxs-lookup"><span data-stu-id="e33f4-142">At the Publisher on the publication database, execute [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="e33f4-143">Geben Sie **@publication** , **@subscriber** und an **@destination_db** .</span><span class="sxs-lookup"><span data-stu-id="e33f4-143">Specify **@publication**, **@subscriber** and **@destination_db**.</span></span> <span data-ttu-id="e33f4-144">Geben Sie den Wert **push** für **@subscription_type**.</span><span class="sxs-lookup"><span data-stu-id="e33f4-144">Specify a value of **push** for **@subscription_type**.</span></span> <span data-ttu-id="e33f4-145">Weitere Informationen zum Aktualisieren von Abonnements finden Sie unter [Erstellen eines aktualisierbaren Abonnements für eine Transaktions Veröffentlichung](publish/create-an-updatable-subscription-to-a-transactional-publication.md) .</span><span class="sxs-lookup"><span data-stu-id="e33f4-145">For information about how to update subscriptions, see [Create an Updatable Subscription to a Transactional Publication](publish/create-an-updatable-subscription-to-a-transactional-publication.md)</span></span>  
  
3.  <span data-ttu-id="e33f4-146">Führen Sie auf dem Verleger für die Veröffentlichungsdatenbank [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql)aus.</span><span class="sxs-lookup"><span data-stu-id="e33f4-146">At the Publisher on the publication database, execute [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql).</span></span> <span data-ttu-id="e33f4-147">Geben Sie Folgendes an:</span><span class="sxs-lookup"><span data-stu-id="e33f4-147">Specify the following:</span></span>  
  
    -   <span data-ttu-id="e33f4-148">Die **@subscriber** **@subscriber_db** Parameter, und **@publication** .</span><span class="sxs-lookup"><span data-stu-id="e33f4-148">The **@subscriber**, **@subscriber_db**, and **@publication** parameters.</span></span>  
  
    -   <span data-ttu-id="e33f4-149">Die [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows-Anmelde Informationen, unter denen die Verteilungs-Agent auf dem Verteiler für und ausgeführt wird **@job_login** **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="e33f4-149">The [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows credentials under which the Distribution Agent at the Distributor runs for **@job_login** and **@job_password**.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="e33f4-150">Bei Verbindungen, die mit der integrierten Windows-Authentifizierung hergestellt werden, werden immer die Windows-Anmelde Informationen verwendet, **@job_login** **@job_password**</span><span class="sxs-lookup"><span data-stu-id="e33f4-150">Connections made using Windows Integrated Authentication always use the Windows credentials specified by **@job_login** and **@job_password**.</span></span> <span data-ttu-id="e33f4-151">Der Verteilungs-Agent stellt die lokale Verbindung mit dem Verteiler immer mithilfe der Windows-Authentifizierung her.</span><span class="sxs-lookup"><span data-stu-id="e33f4-151">The Distribution Agent always makes the local connection to the Distributor using Windows Integrated Authentication.</span></span> <span data-ttu-id="e33f4-152">Standardmäßig stellt der Agent mithilfe der integrierten Windows-Authentifizierung eine Verbindung mit dem Abonnenten her.</span><span class="sxs-lookup"><span data-stu-id="e33f4-152">By default, the agent will connect to the Subscriber using Windows Integrated Authentication.</span></span>  
  
    -   <span data-ttu-id="e33f4-153">(Optional) Den Wert **0** für **@subscriber_security_mode** und die [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Anmeldeinformationen für **@subscriber_login** und **@subscriber_password**.</span><span class="sxs-lookup"><span data-stu-id="e33f4-153">(Optional) A value of **0** for **@subscriber_security_mode** and the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login information for **@subscriber_login** and **@subscriber_password**.</span></span> <span data-ttu-id="e33f4-154">Geben Sie diese Parameter an, falls Sie beim Herstellen einer Verbindung mit dem Abonnenten die SQL Server-Authentifizierung verwenden müssen.</span><span class="sxs-lookup"><span data-stu-id="e33f4-154">Specify these parameters if you need to use SQL Server Authentication when connecting to the Subscriber.</span></span>  
  
    -   <span data-ttu-id="e33f4-155">Einen Zeitplan für den Verteilungs-Agentauftrag für dieses Abonnement.</span><span class="sxs-lookup"><span data-stu-id="e33f4-155">A schedule for the Distribution Agent job for this subscription.</span></span> <span data-ttu-id="e33f4-156">Weitere Informationen finden Sie unter [Angeben von Synchronisierungszeitplänen](specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="e33f4-156">For more information, see [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="e33f4-157">Beim Erstellen eines Pushabonnements auf einem Verleger mit einem Remoteverteiler werden die angegebenen Werte für alle Parameter, einschließlich *job_login* und *job_password*, an den Verteiler als Nur-Text gesendet.</span><span class="sxs-lookup"><span data-stu-id="e33f4-157">When creating a push subscription at a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="e33f4-158">Sie sollten die Verbindung zwischen dem Verleger und dem zugehörigen Remoteverteiler verschlüsseln, bevor Sie diese gespeicherte Prozedur ausführen.</span><span class="sxs-lookup"><span data-stu-id="e33f4-158">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="e33f4-159">Weitere Informationen finden Sie unter [Aktivieren von verschlüsselten Verbindungen zur Datenbank-Engine &#40;SQL Server-Konfigurations-Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="e33f4-159">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-create-a-push-subscription-to-a-merge-publication"></a><span data-ttu-id="e33f4-160">So erstellen Sie ein Pushabonnement für eine Mergeveröffentlichung</span><span class="sxs-lookup"><span data-stu-id="e33f4-160">To create a push subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="e33f4-161">Überprüfen Sie für die Veröffentlichungsdatenbank auf dem Verleger, ob die Veröffentlichung Pushabonnements unterstützt, indem Sie [sp_helpmergepublication](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql)ausführen.</span><span class="sxs-lookup"><span data-stu-id="e33f4-161">At the Publisher on the publication database, verify that the publication supports push subscriptions by executing [sp_helpmergepublication](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql).</span></span>  
  
    -   <span data-ttu-id="e33f4-162">Wenn der Wert von **allow_push** **1**ist, werden Pushabonnements von der Veröffentlichung unterstützt.</span><span class="sxs-lookup"><span data-stu-id="e33f4-162">If the value of **allow_push** is **1**, the publication supports push subscriptions.</span></span>  
  
    -   <span data-ttu-id="e33f4-163">Wenn der Wert von **allow_push** nicht **1**ist, führen Sie [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql)aus, und geben Sie **allow_push** für **@property** und `true` für an **@value** .</span><span class="sxs-lookup"><span data-stu-id="e33f4-163">If the value of **allow_push** is not **1**, execute [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql), specifying **allow_push** for **@property** and `true` for **@value**.</span></span>  
  
2.  <span data-ttu-id="e33f4-164">Führen Sie auf dem Verleger für die Veröffentlichungsdatenbank [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql)aus, und geben Sie die folgenden Parameter an:</span><span class="sxs-lookup"><span data-stu-id="e33f4-164">At the Publisher on the publication database, execute [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql), specifying the following parameters:</span></span>  
  
    -   <span data-ttu-id="e33f4-165">**@publication**.</span><span class="sxs-lookup"><span data-stu-id="e33f4-165">**@publication**.</span></span> <span data-ttu-id="e33f4-166">Das ist der Name der Veröffentlichung.</span><span class="sxs-lookup"><span data-stu-id="e33f4-166">This is the name of the publication.</span></span>  
  
    -   <span data-ttu-id="e33f4-167">**@subscriber_type**.</span><span class="sxs-lookup"><span data-stu-id="e33f4-167">**@subscriber_type**.</span></span> <span data-ttu-id="e33f4-168">Geben Sie für ein Clientabonnement **local** und für ein Serverabonnement **global**an.</span><span class="sxs-lookup"><span data-stu-id="e33f4-168">For a client subscription, specify **local** and for a server subscription, specify **global**.</span></span>  
  
    -   <span data-ttu-id="e33f4-169">**@subscription_priority**.</span><span class="sxs-lookup"><span data-stu-id="e33f4-169">**@subscription_priority**.</span></span> <span data-ttu-id="e33f4-170">Geben Sie für ein Serverabonnement eine Priorität für das Abonnement (**0.00** bis **99.99**) an.</span><span class="sxs-lookup"><span data-stu-id="e33f4-170">For a server subscription, specify a priority for the subscription (**0.00** to **99.99**).</span></span>  
  
         <span data-ttu-id="e33f4-171">Weitere Informationen finden Sie unter [Erweiterte Konflikterkennung und -lösung bei der Mergereplikation](merge/advanced-merge-replication-conflict-detection-and-resolution.md)angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="e33f4-171">For more information, see [Advanced Merge Replication Conflict Detection and Resolution](merge/advanced-merge-replication-conflict-detection-and-resolution.md).</span></span>  
  
3.  <span data-ttu-id="e33f4-172">Führen Sie auf dem Verleger für die Veröffentlichungsdatenbank [sp_addmergepushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql)aus.</span><span class="sxs-lookup"><span data-stu-id="e33f4-172">At the Publisher on the publication database, execute [sp_addmergepushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql).</span></span> <span data-ttu-id="e33f4-173">Geben Sie Folgendes an:</span><span class="sxs-lookup"><span data-stu-id="e33f4-173">Specify the following:</span></span>  
  
    -   <span data-ttu-id="e33f4-174">Die **@subscriber** **@subscriber_db** Parameter, und **@publication** .</span><span class="sxs-lookup"><span data-stu-id="e33f4-174">The **@subscriber**, **@subscriber_db**, and **@publication** parameters.</span></span>  
  
    -   <span data-ttu-id="e33f4-175">Die Windows-Anmelde Informationen, unter denen die Merge-Agent auf dem Verteiler für und ausgeführt wird **@job_login** **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="e33f4-175">The Windows credentials under which the Merge Agent at the Distributor runs for **@job_login** and **@job_password**.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="e33f4-176">Bei Verbindungen, die mit der integrierten Windows-Authentifizierung hergestellt werden, werden immer die Windows-Anmelde Informationen verwendet, **@job_login** **@job_password**</span><span class="sxs-lookup"><span data-stu-id="e33f4-176">Connections made using Windows Integrated Authentication always use the Windows credentials specified by **@job_login** and **@job_password**.</span></span> <span data-ttu-id="e33f4-177">Der Merge-Agent stellt die lokale Verbindung mit dem Verteiler immer mithilfe der Windows-Authentifizierung her.</span><span class="sxs-lookup"><span data-stu-id="e33f4-177">The Merge Agent always makes the local connection to the Distributor using Windows Integrated Authentication.</span></span> <span data-ttu-id="e33f4-178">Standardmäßig stellt der Agent mithilfe der integrierten Windows-Authentifizierung eine Verbindung mit dem Abonnenten her.</span><span class="sxs-lookup"><span data-stu-id="e33f4-178">By default, the agent will connect to the Subscriber using Windows Integrated Authentication.</span></span>  
  
    -   <span data-ttu-id="e33f4-179">(Optional) Den Wert **0** für **@subscriber_security_mode** und die [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Anmeldeinformationen für **@subscriber_login** und **@subscriber_password**.</span><span class="sxs-lookup"><span data-stu-id="e33f4-179">(Optional) A value of **0** for **@subscriber_security_mode** and the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login information for **@subscriber_login** and **@subscriber_password**.</span></span> <span data-ttu-id="e33f4-180">Geben Sie diese Parameter an, falls Sie beim Herstellen einer Verbindung mit dem Abonnenten die SQL Server-Authentifizierung verwenden müssen.</span><span class="sxs-lookup"><span data-stu-id="e33f4-180">Specify these parameters if you need to use SQL Server Authentication when connecting to the Subscriber.</span></span>  
  
    -   <span data-ttu-id="e33f4-181">(Optional) Den Wert **0** für **@publisher_security_mode** und die [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Anmeldeinformationen für **@publisher_login** und **@publisher_password**.</span><span class="sxs-lookup"><span data-stu-id="e33f4-181">(Optional) A value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="e33f4-182">Geben Sie diese Werte an, falls Sie beim Herstellen einer Verbindung mit dem Verleger die SQL Server-Authentifizierung verwenden müssen.</span><span class="sxs-lookup"><span data-stu-id="e33f4-182">Specify these values if you need to use SQL Server Authentication when connecting to the Publisher.</span></span>  
  
    -   <span data-ttu-id="e33f4-183">Einen Zeitplan für den Merge-Agentauftrag für dieses Abonnement.</span><span class="sxs-lookup"><span data-stu-id="e33f4-183">A schedule for the Merge Agent job for this subscription.</span></span> <span data-ttu-id="e33f4-184">Weitere Informationen finden Sie unter [Angeben von Synchronisierungszeitplänen](specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="e33f4-184">For more information, see [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="e33f4-185">Beim Erstellen eines Pushabonnements auf einem Verleger mit einem Remoteverteiler werden die angegebenen Werte für alle Parameter, einschließlich *job_login* und *job_password*, an den Verteiler als Nur-Text gesendet.</span><span class="sxs-lookup"><span data-stu-id="e33f4-185">When creating a push subscription at a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="e33f4-186">Sie sollten die Verbindung zwischen dem Verleger und dem zugehörigen Remoteverteiler verschlüsseln, bevor Sie diese gespeicherte Prozedur ausführen.</span><span class="sxs-lookup"><span data-stu-id="e33f4-186">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="e33f4-187">Weitere Informationen finden Sie unter [Aktivieren von verschlüsselten Verbindungen zur Datenbank-Engine &#40;SQL Server-Konfigurations-Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="e33f4-187">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
###  <a name="examples-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="e33f4-188">Beispiele (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="e33f4-188">Examples (Transact-SQL)</span></span>  
 <span data-ttu-id="e33f4-189">Im folgenden Beispiel wird ein Pushabonnement für eine Transaktionsveröffentlichung erstellt.</span><span class="sxs-lookup"><span data-stu-id="e33f4-189">The following example creates a push subscription to a transactional publication.</span></span> <span data-ttu-id="e33f4-190">Die Werte für den Anmeldenamen und das Kennwort werden zur Laufzeit mithilfe von **sqlcmd** -Skriptvariablen bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="e33f4-190">Login and password values are supplied at run time by using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_addtranpushsubscription_agent](../../snippets/tsql/SQL15/replication/howto/tsql/createtranpushsub.sql#sp_addtranpushsubscription_agent)]  
  
 <span data-ttu-id="e33f4-191">Im folgenden Beispiel wird ein Pushabonnement für eine Mergeveröffentlichung erstellt.</span><span class="sxs-lookup"><span data-stu-id="e33f4-191">The following example creates a push subscription to a merge publication.</span></span> <span data-ttu-id="e33f4-192">Die Werte für den Anmeldenamen und das Kennwort werden zur Laufzeit mithilfe von **sqlcmd** -Skriptvariablen bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="e33f4-192">Login and password values are supplied at run time by using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_addmergepushsubscriptionagent](../../snippets/tsql/SQL15/replication/howto/tsql/createmergepushsub.sql#sp_addmergepushsubscriptionagent)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="e33f4-193">Verwenden von Replikationsverwaltungsobjekten (RMO)</span><span class="sxs-lookup"><span data-stu-id="e33f4-193">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="e33f4-194">Sie können Pushabonnements mithilfe von Replikationsverwaltungsobjekten (RMO) programmgesteuert erstellen.</span><span class="sxs-lookup"><span data-stu-id="e33f4-194">You can create push subscriptions programmatically by using Replication Management Objects (RMO).</span></span> <span data-ttu-id="e33f4-195">Die RMO-Klassen, die Sie zum Erstellen eines Pushabonnements verwenden, hängen vom Typ der Veröffentlichung ab, für die das Abonnement erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="e33f4-195">The RMO classes you use to create a push subscription depend on the type of publication to which the subscription is created.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="e33f4-196">Benutzer sollten nach Möglichkeit dazu aufgefordert werden, Anmeldeinformationen zur Laufzeit anzugeben.</span><span class="sxs-lookup"><span data-stu-id="e33f4-196">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="e33f4-197">Wenn Sie Anmeldeinformationen speichern müssen, verwenden Sie die [Kryptografiedienste](https://go.microsoft.com/fwlink/?LinkId=34733) von [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="e33f4-197">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows .NET Framework.</span></span>  
  
#### <a name="to-create-a-push-subscription-to-a-snapshot-or-transactional-publication"></a><span data-ttu-id="e33f4-198">So erstellen Sie ein Pushabonnement für eine Momentaufnahme- oder Transaktionsveröffentlichung.</span><span class="sxs-lookup"><span data-stu-id="e33f4-198">To create a push subscription to a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="e33f4-199">Erstellen Sie eine Verbindung mit dem Verleger, indem Sie die <xref:Microsoft.SqlServer.Management.Common.ServerConnection> -Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="e33f4-199">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="e33f4-200">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.TransPublication> -Klasse, indem Sie die Verlegerverbindung aus Schritt 1 verwenden.</span><span class="sxs-lookup"><span data-stu-id="e33f4-200">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPublication> class by using the Publisher connection from step 1.</span></span> <span data-ttu-id="e33f4-201">Geben Sie <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>und <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>an.</span><span class="sxs-lookup"><span data-stu-id="e33f4-201">Specify <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>, and <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="e33f4-202">Rufen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="e33f4-202">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method.</span></span> <span data-ttu-id="e33f4-203">Wenn diese Methode zurückgibt `false` , sind entweder die in Schritt 2 angegebenen Eigenschaften falsch, oder die Veröffentlichung ist auf dem Server nicht vorhanden.</span><span class="sxs-lookup"><span data-stu-id="e33f4-203">If this method returns `false`, either the properties specified in step 2 are incorrect or the publication does not exists on the server.</span></span>  
  
4.  <span data-ttu-id="e33f4-204">Führen Sie ein bitweises logisches AND (`&` in Visual C# und `And` in Visual Basic) zwischen der <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A>-Eigenschaft und <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush> aus.</span><span class="sxs-lookup"><span data-stu-id="e33f4-204">Perform a bitwise logical AND (`&` in Visual C# and `And` in Visual Basic) between the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span></span> <span data-ttu-id="e33f4-205">Falls das Ergebnis <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None> lautet, legen Sie für <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> das Ergebnis eines bitweisen logischen OR (`|` in Visual C# und `Or` in Visual Basic) zwischen <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> und <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush> fest.</span><span class="sxs-lookup"><span data-stu-id="e33f4-205">If the result is <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None>, set <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> to the result of a bitwise logical OR (`|` in Visual C# and `Or` in Visual Basic) between <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span></span> <span data-ttu-id="e33f4-206">Rufen Sie dann <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> auf, um Pushabonnements zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="e33f4-206">Then, call <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> to enable push subscriptions.</span></span>  
  
5.  <span data-ttu-id="e33f4-207">Falls die Abonnementdatenbank nicht vorhanden ist, erstellen Sie sie mithilfe der <xref:Microsoft.SqlServer.Management.Smo.Database> -Klasse.</span><span class="sxs-lookup"><span data-stu-id="e33f4-207">If the subscription database does not exist, create it by using the <xref:Microsoft.SqlServer.Management.Smo.Database> class.</span></span> <span data-ttu-id="e33f4-208">Weitere Informationen finden Sie unter [Erstellen, Ändern und Löschen von Datenbanken](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md).</span><span class="sxs-lookup"><span data-stu-id="e33f4-208">For more information, see [Creating, Altering, and Removing Databases](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md).</span></span>  
  
6.  <span data-ttu-id="e33f4-209">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.TransSubscription>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="e33f4-209">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransSubscription> class.</span></span>  
  
7.  <span data-ttu-id="e33f4-210">Legen Sie folgende Eigenschaften für das Abonnement fest:</span><span class="sxs-lookup"><span data-stu-id="e33f4-210">Set the following subscription properties:</span></span>  
  
    -   <span data-ttu-id="e33f4-211"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> auf den in Schritt 1 erstellten Verleger für <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="e33f4-211">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> to the Publisher created in step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
    -   <span data-ttu-id="e33f4-212">Name der Abonnementdatenbank für <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>.</span><span class="sxs-lookup"><span data-stu-id="e33f4-212">Name of the subscription database for <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>.</span></span>  
  
    -   <span data-ttu-id="e33f4-213">Name des Abonnenten für <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>.</span><span class="sxs-lookup"><span data-stu-id="e33f4-213">Name of the Subscriber for <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>.</span></span>  
  
    -   <span data-ttu-id="e33f4-214">Name der Veröffentlichungsdatenbank für <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>.</span><span class="sxs-lookup"><span data-stu-id="e33f4-214">Name of the publication database for <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>.</span></span>  
  
    -   <span data-ttu-id="e33f4-215">Name der Veröffentlichung für <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>.</span><span class="sxs-lookup"><span data-stu-id="e33f4-215">Name of the publication for <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>.</span></span>  
  
    -   <span data-ttu-id="e33f4-216">Die Felder <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> und <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> oder <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> von <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>, um die Anmeldeinformationen für das [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows-Konto bereitzustellen, unter dem der Verteilungs-Agent auf dem Verteiler ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="e33f4-216">The <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> or <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> fields of <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> to provide the credentials for the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows account under which the Distribution Agent runs at the Distributor.</span></span> <span data-ttu-id="e33f4-217">Mit diesem Konto werden lokale Verbindungen mit dem Verteiler sowie Remoteverbindungen mithilfe der Windows-Authentifizierung hergestellt.</span><span class="sxs-lookup"><span data-stu-id="e33f4-217">This account is used to make local connections to the Distributor and to make remote connections using Windows Authentication.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="e33f4-218"><xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> muss zwar nicht festgelegt werden, wenn das Abonnement von einem Mitglied der festen Serverrolle `sysadmin` erstellt wurde, aber es empfiehlt sich.</span><span class="sxs-lookup"><span data-stu-id="e33f4-218">Setting <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> is not required when the subscription is created by a member of the `sysadmin` fixed server role, however it is recommended.</span></span> <span data-ttu-id="e33f4-219">In diesem Fall nimmt der Agent die Identität des SQL Server-Agent-Kontos an.</span><span class="sxs-lookup"><span data-stu-id="e33f4-219">In this case, the agent will impersonate the SQL Server Agent account.</span></span> <span data-ttu-id="e33f4-220">Weitere Informationen finden Sie unter [Replication Agent Security Model](security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="e33f4-220">For more information, see [Replication Agent Security Model](security/replication-agent-security-model.md).</span></span>  
  
    -   <span data-ttu-id="e33f4-221">(Optional) Den Wert `true` (Standard) für <xref:Microsoft.SqlServer.Replication.Subscription.CreateSyncAgentByDefault%2A>, um einen Agentauftrag zu erstellen, mit dem das Abonnement synchronisiert wird.</span><span class="sxs-lookup"><span data-stu-id="e33f4-221">(Optional) A value of `true` (the default) for <xref:Microsoft.SqlServer.Replication.Subscription.CreateSyncAgentByDefault%2A> to create an agent job that is used to synchronize the subscription.</span></span> <span data-ttu-id="e33f4-222">Wenn Sie `false` angeben, kann das Abonnement nur programmgesteuert synchronisiert werden.</span><span class="sxs-lookup"><span data-stu-id="e33f4-222">If you specify `false`, the subscription can only be synchronized programmatically.</span></span>  
  
    -   <span data-ttu-id="e33f4-223">(Optional) Legen Sie die Felder <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> und <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> oder <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> von <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> fest, wenn Sie die SQL Server-Authentifizierung zum Herstellen einer Verbindung mit dem Abonnenten verwenden.</span><span class="sxs-lookup"><span data-stu-id="e33f4-223">(Optional) Set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> when using SQL Server Authentication to connect to the Subscriber.</span></span>  
  
8.  <span data-ttu-id="e33f4-224">Rufen Sie die <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="e33f4-224">Call the <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> method.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="e33f4-225">Beim Erstellen eines Pushabonnements auf einem Verleger mit einem Remoteverteiler werden die angegebenen Werte für alle Eigenschaften, einschließlich <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>, als Nur-Text an den Verteiler gesendet.</span><span class="sxs-lookup"><span data-stu-id="e33f4-225">When creating a push subscription at a Publisher with a remote Distributor, the values supplied for all properties, including <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="e33f4-226">Sie sollten die Verbindung zwischen dem Verleger und dem zugehörigen Remoteverteiler verschlüsseln, bevor Sie die <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A>-Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="e33f4-226">You should encrypt the connection between the Publisher and its remote Distributor before calling the <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> method.</span></span> <span data-ttu-id="e33f4-227">Weitere Informationen finden Sie unter [Aktivieren von verschlüsselten Verbindungen zur Datenbank-Engine &#40;SQL Server-Konfigurations-Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="e33f4-227">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-create-a-push-subscription-to-a-merge-publication"></a><span data-ttu-id="e33f4-228">So erstellen Sie ein Pushabonnement für eine Mergeveröffentlichung</span><span class="sxs-lookup"><span data-stu-id="e33f4-228">To create a push subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="e33f4-229">Erstellen Sie eine Verbindung mit dem Verleger, indem Sie die <xref:Microsoft.SqlServer.Management.Common.ServerConnection> -Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="e33f4-229">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="e33f4-230">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.MergePublication> -Klasse, indem Sie die Verlegerverbindung aus Schritt 1 verwenden.</span><span class="sxs-lookup"><span data-stu-id="e33f4-230">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class by using the Publisher connection from step 1.</span></span> <span data-ttu-id="e33f4-231">Geben Sie <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>und <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>an.</span><span class="sxs-lookup"><span data-stu-id="e33f4-231">Specify <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>, and <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="e33f4-232">Rufen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="e33f4-232">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method.</span></span> <span data-ttu-id="e33f4-233">Wenn diese Methode zurückgibt `false` , sind entweder die in Schritt 2 angegebenen Eigenschaften falsch, oder die Veröffentlichung ist auf dem Server nicht vorhanden.</span><span class="sxs-lookup"><span data-stu-id="e33f4-233">If this method returns `false`, either the properties specified in step 2 are incorrect or the publication does not exists on the server.</span></span>  
  
4.  <span data-ttu-id="e33f4-234">Führen Sie ein bitweises logisches AND (`&` in Visual C# und `And` in Visual Basic) zwischen der <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A>-Eigenschaft und <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush> aus.</span><span class="sxs-lookup"><span data-stu-id="e33f4-234">Perform a bitwise logical AND (`&` in Visual C# and `And` in Visual Basic) between the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span></span> <span data-ttu-id="e33f4-235">Falls das Ergebnis <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None> lautet, legen Sie für <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> das Ergebnis eines bitweisen logischen OR (`|` in Visual C# und `Or` in Visual Basic) zwischen <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> und <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush> fest.</span><span class="sxs-lookup"><span data-stu-id="e33f4-235">If the result is <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None>, set <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> to the result of a bitwise logical OR (`|` in Visual C# and `Or` in Visual Basic) between <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span></span> <span data-ttu-id="e33f4-236">Rufen Sie dann <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> auf, um Pushabonnements zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="e33f4-236">Then, call <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> to enable push subscriptions.</span></span>  
  
5.  <span data-ttu-id="e33f4-237">Falls die Abonnementdatenbank nicht vorhanden ist, erstellen Sie sie mithilfe der <xref:Microsoft.SqlServer.Management.Smo.Database> -Klasse.</span><span class="sxs-lookup"><span data-stu-id="e33f4-237">If the subscription database does not exist, create it by using the <xref:Microsoft.SqlServer.Management.Smo.Database> class.</span></span> <span data-ttu-id="e33f4-238">Weitere Informationen finden Sie unter [Erstellen, Ändern und Löschen von Datenbanken](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md).</span><span class="sxs-lookup"><span data-stu-id="e33f4-238">For more information, see [Creating, Altering, and Removing Databases](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md).</span></span>  
  
6.  <span data-ttu-id="e33f4-239">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.MergeSubscription>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="e33f4-239">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeSubscription> class.</span></span>  
  
7.  <span data-ttu-id="e33f4-240">Legen Sie folgende Eigenschaften für das Abonnement fest:</span><span class="sxs-lookup"><span data-stu-id="e33f4-240">Set the following subscription properties:</span></span>  
  
    -   <span data-ttu-id="e33f4-241"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> auf den in Schritt 1 erstellten Verleger für <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="e33f4-241">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> to the Publisher created in step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
    -   <span data-ttu-id="e33f4-242">Name der Abonnementdatenbank für <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>.</span><span class="sxs-lookup"><span data-stu-id="e33f4-242">Name of the subscription database for <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>.</span></span>  
  
    -   <span data-ttu-id="e33f4-243">Name des Abonnenten für <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>.</span><span class="sxs-lookup"><span data-stu-id="e33f4-243">Name of the Subscriber for <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>.</span></span>  
  
    -   <span data-ttu-id="e33f4-244">Name der Veröffentlichungsdatenbank für <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>.</span><span class="sxs-lookup"><span data-stu-id="e33f4-244">Name of the publication database for <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>.</span></span>  
  
    -   <span data-ttu-id="e33f4-245">Name der Veröffentlichung für <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>.</span><span class="sxs-lookup"><span data-stu-id="e33f4-245">Name of the publication for <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>.</span></span>  
  
    -   <span data-ttu-id="e33f4-246">Die Felder <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> und <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> oder <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> von <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>, um die Anmeldeinformationen für das [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows-Konto bereitzustellen, unter dem der Merge-Agent auf dem Verteiler ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="e33f4-246">The <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> or <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> fields of <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> to provide the credentials for the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows account under which the Merge Agent runs at the Distributor.</span></span> <span data-ttu-id="e33f4-247">Mit diesem Konto werden lokale Verbindungen mit dem Verteiler sowie Remoteverbindungen mithilfe der Windows-Authentifizierung hergestellt.</span><span class="sxs-lookup"><span data-stu-id="e33f4-247">This account is used to make local connections to the Distributor and to make remote connections using Windows Authentication.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="e33f4-248"><xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> muss zwar nicht festgelegt werden, wenn das Abonnement von einem Mitglied der festen Serverrolle `sysadmin` erstellt wurde, aber es empfiehlt sich.</span><span class="sxs-lookup"><span data-stu-id="e33f4-248">Setting <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> is not required when the subscription is created by a member of the `sysadmin` fixed server role, however it is recommended.</span></span> <span data-ttu-id="e33f4-249">In diesem Fall nimmt der Agent die Identität des SQL Server-Agent-Kontos an.</span><span class="sxs-lookup"><span data-stu-id="e33f4-249">In this case, the agent will impersonate the SQL Server Agent account.</span></span> <span data-ttu-id="e33f4-250">Weitere Informationen finden Sie unter [Replication Agent Security Model](security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="e33f4-250">For more information, see [Replication Agent Security Model](security/replication-agent-security-model.md).</span></span>  
  
    -   <span data-ttu-id="e33f4-251">(Optional) Den Wert `true` (Standard) für <xref:Microsoft.SqlServer.Replication.Subscription.CreateSyncAgentByDefault%2A>, um einen Agentauftrag zu erstellen, mit dem das Abonnement synchronisiert wird.</span><span class="sxs-lookup"><span data-stu-id="e33f4-251">(Optional) A value of `true` (the default) for <xref:Microsoft.SqlServer.Replication.Subscription.CreateSyncAgentByDefault%2A> to create an agent job that is used to synchronize the subscription.</span></span> <span data-ttu-id="e33f4-252">Wenn Sie `false` angeben, kann das Abonnement nur programmgesteuert synchronisiert werden.</span><span class="sxs-lookup"><span data-stu-id="e33f4-252">If you specify `false`, the subscription can only be synchronized programmatically.</span></span>  
  
    -   <span data-ttu-id="e33f4-253">(Optional) Legen Sie die Felder <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> und <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> oder <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> von <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> fest, wenn Sie die SQL Server-Authentifizierung zum Herstellen einer Verbindung mit dem Abonnenten verwenden.</span><span class="sxs-lookup"><span data-stu-id="e33f4-253">(Optional) Set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> when using SQL Server Authentication to connect to the Subscriber.</span></span>  
  
    -   <span data-ttu-id="e33f4-254">(Optional) Legen Sie die Felder <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> und <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> oder <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> von <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> fest, wenn Sie die SQL Server-Authentifizierung zum Herstellen einer Verbindung mit dem Verleger verwenden.</span><span class="sxs-lookup"><span data-stu-id="e33f4-254">(Optional) Set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> when using SQL Server Authentication to connect to the Publisher.</span></span>  
  
8.  <span data-ttu-id="e33f4-255">Rufen Sie die <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="e33f4-255">Call the <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> method.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="e33f4-256">Beim Erstellen eines Pushabonnements auf einem Verleger mit einem Remoteverteiler werden die angegebenen Werte für alle Eigenschaften, einschließlich <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>, als Nur-Text an den Verteiler gesendet.</span><span class="sxs-lookup"><span data-stu-id="e33f4-256">When creating a push subscription at a Publisher with a remote Distributor, the values supplied for all properties, including <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="e33f4-257">Sie sollten die Verbindung zwischen dem Verleger und dem zugehörigen Remoteverteiler verschlüsseln, bevor Sie die <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A>-Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="e33f4-257">You should encrypt the connection between the Publisher and its remote Distributor before calling the <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> method.</span></span> <span data-ttu-id="e33f4-258">Weitere Informationen finden Sie unter [Aktivieren von verschlüsselten Verbindungen zur Datenbank-Engine &#40;SQL Server-Konfigurations-Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="e33f4-258">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
###  <a name="examples-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="e33f4-259">Beispiele (RMO)</span><span class="sxs-lookup"><span data-stu-id="e33f4-259">Examples (RMO)</span></span>  
 <span data-ttu-id="e33f4-260">Im folgenden Beispiel wird ein neues Pushabonnement für eine Transaktionsveröffentlichung erstellt.</span><span class="sxs-lookup"><span data-stu-id="e33f4-260">This example creates a new push subscription to a transactional publication.</span></span> <span data-ttu-id="e33f4-261">Die Anmeldeinformationen für das Windows-Konto, mit dem der Verteilungs-Agent-Auftrag ausgeführt wird, werden zur Laufzeit übergeben.</span><span class="sxs-lookup"><span data-stu-id="e33f4-261">The Windows account credentials you use to run the Distribution Agent job are passed at runtime.</span></span>  
  
 [!code-csharp[HowTo#rmo_CreateTranPushSub](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_createtranpushsub)]  
  
 [!code-vb[HowTo#rmo_vb_CreateTranPushSub](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_createtranpushsub)]  
  
 <span data-ttu-id="e33f4-262">Im folgenden Beispiel wird ein neues Pushabonnement für eine Mergeveröffentlichung erstellt.</span><span class="sxs-lookup"><span data-stu-id="e33f4-262">This example creates a new push subscription to a merge publication.</span></span> <span data-ttu-id="e33f4-263">Die Anmeldeinformationen für das Windows-Konto, mit dem der Merge-Agent-Auftrag ausgeführt wird, werden zur Laufzeit übergeben.</span><span class="sxs-lookup"><span data-stu-id="e33f4-263">The Windows account credentials you use to run the Merge Agent job are passed at runtime.</span></span>  
  
 [!code-csharp[HowTo#rmo_CreateMergePushSub](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_createmergepushsub)]  
  
 [!code-vb[HowTo#rmo_vb_CreateMergePushSub](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_createmergepushsub)]  
  
## <a name="see-also"></a><span data-ttu-id="e33f4-264">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="e33f4-264">See Also</span></span>  
 <span data-ttu-id="e33f4-265">[Anzeigen und Ändern der Eigenschaften von Pushabonnements](view-and-modify-push-subscription-properties.md) </span><span class="sxs-lookup"><span data-stu-id="e33f4-265">[View and Modify Push Subscription Properties](view-and-modify-push-subscription-properties.md) </span></span>  
 <span data-ttu-id="e33f4-266">[Replication Security Best Practices](security/replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="e33f4-266">[Replication Security Best Practices](security/replication-security-best-practices.md) </span></span>  
 <span data-ttu-id="e33f4-267">[Create a Publication](publish/create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="e33f4-267">[Create a Publication](publish/create-a-publication.md) </span></span>  
 <span data-ttu-id="e33f4-268">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="e33f4-268">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span></span>  
 <span data-ttu-id="e33f4-269">[Synchronisieren eines Pushabonnements](synchronize-a-push-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="e33f4-269">[Synchronize a Push Subscription](synchronize-a-push-subscription.md) </span></span>  
 <span data-ttu-id="e33f4-270">[Abonnieren von Veröffentlichungen](subscribe-to-publications.md) </span><span class="sxs-lookup"><span data-stu-id="e33f4-270">[Subscribe to Publications](subscribe-to-publications.md) </span></span>  
 [<span data-ttu-id="e33f4-271">Verwenden von sqlcmd mit Skriptvariablen</span><span class="sxs-lookup"><span data-stu-id="e33f4-271">Use sqlcmd with Scripting Variables</span></span>](../scripting/sqlcmd-use-with-scripting-variables.md)  
  
  

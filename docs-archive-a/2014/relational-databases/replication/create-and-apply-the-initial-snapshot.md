---
title: Erstellen und Anwenden der Anfangsmomentaufnahme | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- snapshots [SQL Server replication], creating
- snapshot replication [SQL Server], initial snapshots
ms.assetid: 742727a1-5189-44ec-b3ae-6fd7aa1f5347
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: b7ac008fe139adf55376bb50fbf60dddcd6b9ae5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87609143"
---
# <a name="create-and-apply-the-initial-snapshot"></a><span data-ttu-id="ca62c-102">Erstellen und Anwenden der Anfangsmomentaufnahme</span><span class="sxs-lookup"><span data-stu-id="ca62c-102">Create and Apply the Initial Snapshot</span></span>
  <span data-ttu-id="ca62c-103">In diesem Thema wird beschrieben, wie die Anfangsmomentaufnahme in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] mit [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)]oder Replikationsverwaltungsobjekten (RMO) erstellt und übernommen wird.</span><span class="sxs-lookup"><span data-stu-id="ca62c-103">This topic describes how to create and apply the initial snapshot in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="ca62c-104">Mergeveröffentlichungen, die parametrisierte Filter verwenden, erfordern eine zweiteilige Momentaufnahme.</span><span class="sxs-lookup"><span data-stu-id="ca62c-104">Merge publications that use parameterized filters require a two-part snapshot.</span></span> <span data-ttu-id="ca62c-105">Weitere Informationen finden Sie unter [Erstellen einer Momentaufnahme für eine Mergeveröffentlichung mit parametrisierten Filtern](create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="ca62c-105">For more information, see [Create a Snapshot for a Merge Publication with Parameterized Filters](create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span></span>  
  
 <span data-ttu-id="ca62c-106">**In diesem Thema**</span><span class="sxs-lookup"><span data-stu-id="ca62c-106">**In This Topic**</span></span>  
  
-   <span data-ttu-id="ca62c-107">**So erstellen Sie die Anfangsmomentaufnahme und wenden sie an mit:**</span><span class="sxs-lookup"><span data-stu-id="ca62c-107">**To create and apply the initial snapshot, using:**</span></span>  
  
     [<span data-ttu-id="ca62c-108">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="ca62c-108">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="ca62c-109">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="ca62c-109">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="ca62c-110">Replikationsverwaltungsobjekte (RMO)</span><span class="sxs-lookup"><span data-stu-id="ca62c-110">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="ca62c-111">Verwenden von SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="ca62c-111">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="ca62c-112">Wenn der [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Agent ausgeführt wird, wird vom Momentaufnahme-Agent standardmäßig sofort eine Momentaufnahme generiert, nachdem mit dem Assistenten für neue Veröffentlichung eine Veröffentlichung erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="ca62c-112">By default, if [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent is running, a snapshot is generated by the Snapshot Agent immediately after a publication is created with the New Publication Wizard.</span></span> <span data-ttu-id="ca62c-113">Diese Momentaufnahme wird dann standardmäßig vom Verteilungs-Agent (bei der Momentaufnahme- und der Transaktionsreplikation) oder vom Merge-Agent (bei Mergeabonnement) für alle Abonnements angewendet.</span><span class="sxs-lookup"><span data-stu-id="ca62c-113">By default, it is then applied by the Distribution Agent (for snapshot and transactional replication) or Merge Agent (for merge subscriptions) for all subscriptions.</span></span> <span data-ttu-id="ca62c-114">Eine Momentaufnahme kann auch mit [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] und dem Replikationsmonitor generiert werden.</span><span class="sxs-lookup"><span data-stu-id="ca62c-114">A snapshot can also be generated using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] and Replication Monitor.</span></span> <span data-ttu-id="ca62c-115">Informationen zum Starten des Replikationsmonitors finden Sie unter [Starten des Replikationsmonitors](monitor/start-the-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="ca62c-115">For information about starting Replication Monitor, see [Start the Replication Monitor](monitor/start-the-replication-monitor.md).</span></span>  
  
#### <a name="to-create-a-snapshot-in-management-studio"></a><span data-ttu-id="ca62c-116">So erstellen Sie eine Momentaufnahme in Management Studio</span><span class="sxs-lookup"><span data-stu-id="ca62c-116">To create a snapshot in Management Studio</span></span>  
  
1.  <span data-ttu-id="ca62c-117">Stellen Sie in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)]eine Verbindung mit dem Verleger her, und erweitern Sie dann den Serverknoten.</span><span class="sxs-lookup"><span data-stu-id="ca62c-117">Connect to the Publisher in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="ca62c-118">Erweitern Sie den Ordner **Replikation** , und erweitern Sie dann den Ordner **Lokale Veröffentlichungen** .</span><span class="sxs-lookup"><span data-stu-id="ca62c-118">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="ca62c-119">Klicken Sie mit der rechten Maustaste auf die Veröffentlichung, für die Sie eine Momentaufnahme erstellen möchten, und klicken Sie anschließend auf **Status des Momentaufnahme-Agents anzeigen**.</span><span class="sxs-lookup"><span data-stu-id="ca62c-119">Right-click the publication for which you want to create a snapshot, and then click **View Snapshot Agent Status**.</span></span>  
  
4.  <span data-ttu-id="ca62c-120">Klicken Sie im Dialogfeld **Status des Momentaufnahmen-Agents anzeigen – \<Publication>** auf **Start**.</span><span class="sxs-lookup"><span data-stu-id="ca62c-120">In the **View Snapshot Agent Status - \<Publication>** dialog box, click **Start**.</span></span>  
  
 <span data-ttu-id="ca62c-121">Nachdem der Momentaufnahme-Agent die Momentaufnahme generiert hat, wird eine Meldung angezeigt, die beispielsweise wie folgt lautet: "[100%] Es wurde eine Momentaufnahme mit 17 Artikel(n) generiert".</span><span class="sxs-lookup"><span data-stu-id="ca62c-121">When the Snapshot Agent finishes generating the snapshot, a message will be displayed, such as "[100%] A snapshot of 17 article(s) was generated."</span></span>  
  
#### <a name="to-create-a-snapshot-in-replication-monitor"></a><span data-ttu-id="ca62c-122">So erstellen Sie eine Momentaufnahme im Replikationsmonitor</span><span class="sxs-lookup"><span data-stu-id="ca62c-122">To create a snapshot in Replication Monitor</span></span>  
  
1.  <span data-ttu-id="ca62c-123">Erweitern Sie im Replikationsmonitor im linken Bereich eine Verlegergruppe, und erweitern Sie dann einen Verleger.</span><span class="sxs-lookup"><span data-stu-id="ca62c-123">In Replication Monitor, expand a Publisher group in the left pane, and then expand a Publisher.</span></span>  
  
2.  <span data-ttu-id="ca62c-124">Klicken Sie mit der rechten Maustaste auf die Veröffentlichung, für die Sie eine Momentaufnahme generieren möchten, und klicken Sie anschließend auf **Momentaufnahme generieren**.</span><span class="sxs-lookup"><span data-stu-id="ca62c-124">Right-click the publication for which you want to generate a snapshot, and then click **Generate Snapshot**.</span></span>  
  
3.  <span data-ttu-id="ca62c-125">Um den Status des Momentaufnahme-Agents anzuzeigen, klicken Sie auf die Registerkarte **Agents** . Wenn Sie genauere Informationen anzeigen möchten, klicken Sie im Raster mit der rechten Maustaste auf den Momentaufnahme-Agent, und klicken Sie dann auf **Details anzeigen**.</span><span class="sxs-lookup"><span data-stu-id="ca62c-125">To view the status of the Snapshot Agent, click the **Agents** tab. For more detailed information, right-click the Snapshot Agent in the grid, and then click **View Details**.</span></span>  
  
#### <a name="to-apply-a-snapshot"></a><span data-ttu-id="ca62c-126">So wenden Sie eine Momentaufnahme an</span><span class="sxs-lookup"><span data-stu-id="ca62c-126">To apply a snapshot</span></span>  
  
1.  <span data-ttu-id="ca62c-127">Eine generierte Momentaufnahme wird angewendet, indem das Abonnement mit dem Verteilungs-Agent oder dem Merge-Agent synchronisiert wird:</span><span class="sxs-lookup"><span data-stu-id="ca62c-127">After the snapshot is generated, it is applied by synchronizing the subscription with the Distribution Agent or the Merge Agent:</span></span>  
  
    -   <span data-ttu-id="ca62c-128">Wenn der Agent fortlaufend ausgeführt wird (die Standardeinstellung bei der Transaktionsreplikation), wird die Momentaufnahme automatisch nach dem Generieren angewendet.</span><span class="sxs-lookup"><span data-stu-id="ca62c-128">If the agent is set to run continuously (the default for transactional replication), the snapshot is automatically applied after it is generated.</span></span>  
  
    -   <span data-ttu-id="ca62c-129">Wenn der Agent nach einem Zeitplan ausgeführt wird, wird die Momentaufnahme bei der nächsten geplanten Ausführung des Agents angewendet.</span><span class="sxs-lookup"><span data-stu-id="ca62c-129">If the agent is set to run on a schedule, the snapshot is applied the next time the agent is scheduled to run.</span></span>  
  
    -   <span data-ttu-id="ca62c-130">Wenn der Agent bedarfsgesteuert ausgeführt wird, wird der Snapshot bei der nächsten Ausführung des Agents angewendet.</span><span class="sxs-lookup"><span data-stu-id="ca62c-130">If the agent is set to run on demand, it is applied the next time you run the agent.</span></span>  
  
     <span data-ttu-id="ca62c-131">Weitere Informationen zum Synchronisieren von Abonnements finden Sie unter [Synchronize a Push Subscription](synchronize-a-push-subscription.md) und [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md)verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="ca62c-131">For more information about synchronizing subscriptions, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md) and [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="ca62c-132">Verwenden von Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="ca62c-132">Using Transact-SQL</span></span>  
 <span data-ttu-id="ca62c-133">Sie können Anfangsmomentaufnahmen programmgesteuert erstellen, indem Sie entweder einen Momentaufnahme-Agentauftrag erstellen und ausführen oder die ausführbare Datei für den Momentaufnahme-Agent von einer Batchdatei ausführen.</span><span class="sxs-lookup"><span data-stu-id="ca62c-133">Initial snapshots can be programmatically created either by creating and running a Snapshot Agent job or by running the Snapshot Agent executable file from a batch file.</span></span> <span data-ttu-id="ca62c-134">Nachdem eine Anfangsmomentaufnahme generiert wurde, wird sie an den Abonnenten übertragen und auf diesen angewendet, sobald die erste Synchronisierung für das Abonnement durchgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="ca62c-134">After an initial snapshot has been generated, it is transferred to and applied at the Subscriber when the subscription is first synchronized.</span></span> <span data-ttu-id="ca62c-135">Wenn Sie den Momentaufnahme-Agent von der Eingabeaufforderung oder einer Batchdatei ausführen, müssen Sie den Agent immer dann erneut ausführen, wenn die bestehende Momentaufnahme ungültig wird.</span><span class="sxs-lookup"><span data-stu-id="ca62c-135">If you run the Snapshot Agent from a command prompt or a batch file, you will need to rerun the agent whenever the existing snapshot becomes invalid.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="ca62c-136">Benutzer sollten nach Möglichkeit dazu aufgefordert werden, Anmeldeinformationen zur Laufzeit anzugeben.</span><span class="sxs-lookup"><span data-stu-id="ca62c-136">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="ca62c-137">Wenn Anmeldeinformationen in einer Skriptdatei gespeichert werden müssen, muss die Datei an einem sicheren Ort gespeichert werden, um unberechtigten Zugriff zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="ca62c-137">If you must store credentials in a script file, you must secure the file to prevent unauthorized access.</span></span>  
  
#### <a name="to-create-and-run-a-snapshot-agent-job-to-generate-the-initial-snapshot"></a><span data-ttu-id="ca62c-138">So erstellen Sie einen Momentaufnahme-Agentauftrag und führen ihn aus, um die Anfangsmomentaufnahme zu generieren</span><span class="sxs-lookup"><span data-stu-id="ca62c-138">To create and run a Snapshot Agent job to generate the initial snapshot</span></span>  
  
1.  <span data-ttu-id="ca62c-139">Erstellen Sie eine Momentaufnahme-, Transaktions- oder Mergeveröffentlichung.</span><span class="sxs-lookup"><span data-stu-id="ca62c-139">Create a snapshot, transactional, or merge publication.</span></span> <span data-ttu-id="ca62c-140">Weitere Informationen finden Sie unter [Create a Publication](publish/create-a-publication.md).</span><span class="sxs-lookup"><span data-stu-id="ca62c-140">For more information, see [Create a Publication](publish/create-a-publication.md).</span></span>  
  
2.  <span data-ttu-id="ca62c-141">Führen Sie [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) aus.</span><span class="sxs-lookup"><span data-stu-id="ca62c-141">Execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql).</span></span> <span data-ttu-id="ca62c-142">Geben Sie **@publication** und die folgenden Parameter an:</span><span class="sxs-lookup"><span data-stu-id="ca62c-142">Specify **@publication** and the following parameters:</span></span>  
  
    -   <span data-ttu-id="ca62c-143">**Der @job_login**: Gibt die Anmeldeinformationen für die Windows-Authentifizierung an, mit denen der Momentaufnahme-Agent auf dem Verteiler ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="ca62c-143">**The @job_login, which specifies** the Windows Authentication credentials under which the Snapshot Agent runs at the Distributor.</span></span>  
  
    -   <span data-ttu-id="ca62c-144">**Der @job_password**: Kennwort für die angegebenen Windows-Anmeldeinformationen.</span><span class="sxs-lookup"><span data-stu-id="ca62c-144">**The @job_password**, which is the password for the supplied Windows credentials.</span></span>  
  
    -   <span data-ttu-id="ca62c-145">(Optional) Den Wert **0** für **@publisher_security_mode** , wenn der Agent die SQL Server-Authentifizierung zum Herstellen der Verbindung mit dem Verleger verwendet.</span><span class="sxs-lookup"><span data-stu-id="ca62c-145">(Optional) A value of **0** for **@publisher_security_mode** if the agent will use SQL Server Authentication when connecting to the Publisher.</span></span> <span data-ttu-id="ca62c-146">In diesem Fall müssen Sie auch die Anmelde Informationen für die SQL Server Authentifizierung für **@publisher_login** und angeben **@publisher_password** .</span><span class="sxs-lookup"><span data-stu-id="ca62c-146">In this case, you must also specify the SQL Server Authentication login information for **@publisher_login** and **@publisher_password**.</span></span>  
  
    -   <span data-ttu-id="ca62c-147">(Optional) Einen Synchronisierungszeitplan für den Momentaufnahme-Agentauftrag.</span><span class="sxs-lookup"><span data-stu-id="ca62c-147">(Optional) A synchronization schedule for the Snapshot Agent job.</span></span> <span data-ttu-id="ca62c-148">Weitere Informationen finden Sie unter [Angeben von Synchronisierungszeitplänen](specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="ca62c-148">For more information, see [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="ca62c-149">Beim Konfigurieren eines Verlegers mit einem Remoteverteiler werden die Werte, die für alle Parameter, einschließlich *job_login* und *job_password*, bereitgestellt werden, als Nur-Text an den Verteiler gesendet.</span><span class="sxs-lookup"><span data-stu-id="ca62c-149">When configuring a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="ca62c-150">Sie sollten die Verbindung zwischen dem Verleger und dem zugehörigen Remoteverteiler verschlüsseln, bevor Sie diese gespeicherte Prozedur ausführen.</span><span class="sxs-lookup"><span data-stu-id="ca62c-150">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="ca62c-151">Weitere Informationen finden Sie unter [Aktivieren von verschlüsselten Verbindungen zur Datenbank-Engine &#40;SQL Server-Konfigurations-Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="ca62c-151">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
3.  <span data-ttu-id="ca62c-152">Fügen Sie der Veröffentlichung Artikel hinzu.</span><span class="sxs-lookup"><span data-stu-id="ca62c-152">Add articles to the publication.</span></span> <span data-ttu-id="ca62c-153">Weitere Informationen finden Sie unter [Definieren eines Artikels](publish/define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="ca62c-153">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
4.  <span data-ttu-id="ca62c-154">Führen Sie auf dem Verleger für die Veröffentlichungsdatenbank [sp_startpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-startpublication-snapshot-transact-sql) unter Angabe des Werts **@publication** aus Schritt 1 aus.</span><span class="sxs-lookup"><span data-stu-id="ca62c-154">At the Publisher on the publication database, execute [sp_startpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-startpublication-snapshot-transact-sql), specifying the value of **@publication** from step 1.</span></span>  
  
#### <a name="to-run-the-snapshot-agent-to-generate-the-initial-snapshot"></a><span data-ttu-id="ca62c-155">So führen Sie den Momentaufnahme-Agent zum Generieren der Anfangsmomentaufnahme aus</span><span class="sxs-lookup"><span data-stu-id="ca62c-155">To run the Snapshot Agent to generate the initial snapshot</span></span>  
  
1.  <span data-ttu-id="ca62c-156">Erstellen Sie eine Momentaufnahme-, Transaktions- oder Mergeveröffentlichung.</span><span class="sxs-lookup"><span data-stu-id="ca62c-156">Create a snapshot, transactional, or merge publication.</span></span> <span data-ttu-id="ca62c-157">Weitere Informationen finden Sie unter [Create a Publication](publish/create-a-publication.md).</span><span class="sxs-lookup"><span data-stu-id="ca62c-157">For more information, see [Create a Publication](publish/create-a-publication.md).</span></span>  
  
2.  <span data-ttu-id="ca62c-158">Fügen Sie der Veröffentlichung Artikel hinzu.</span><span class="sxs-lookup"><span data-stu-id="ca62c-158">Add articles to the publication.</span></span> <span data-ttu-id="ca62c-159">Weitere Informationen finden Sie unter [Definieren eines Artikels](publish/define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="ca62c-159">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
3.  <span data-ttu-id="ca62c-160">Starten Sie den [Replication Snapshot Agent](agents/replication-snapshot-agent.md) von der Eingabeaufforderung oder in einer Batchdatei, indem Sie die Datei **snapshot.exe**ausführen. Geben Sie hierzu die folgenden Befehlszeilenargumente ein:</span><span class="sxs-lookup"><span data-stu-id="ca62c-160">From the command prompt or in a batch file, start the [Replication Snapshot Agent](agents/replication-snapshot-agent.md) by running **snapshot.exe**, specifying the following command-line arguments:</span></span>  
  
    -   <span data-ttu-id="ca62c-161">**-Publication**</span><span class="sxs-lookup"><span data-stu-id="ca62c-161">**-Publication**</span></span>  
  
    -   <span data-ttu-id="ca62c-162">**-Publisher**</span><span class="sxs-lookup"><span data-stu-id="ca62c-162">**-Publisher**</span></span>  
  
    -   <span data-ttu-id="ca62c-163">**-Distributor**</span><span class="sxs-lookup"><span data-stu-id="ca62c-163">**-Distributor**</span></span>  
  
    -   <span data-ttu-id="ca62c-164">**-PublisherDB**</span><span class="sxs-lookup"><span data-stu-id="ca62c-164">**-PublisherDB**</span></span>  
  
    -   <span data-ttu-id="ca62c-165">**-ReplicationType**</span><span class="sxs-lookup"><span data-stu-id="ca62c-165">**-ReplicationType**</span></span>  
  
     <span data-ttu-id="ca62c-166">Wenn Sie die SQL Server-Authentifizierung verwenden, müssen Sie auch die folgenden Argumente angeben:</span><span class="sxs-lookup"><span data-stu-id="ca62c-166">If you are using SQL Server Authentication, you must also specify the following arguments:</span></span>  
  
    -   <span data-ttu-id="ca62c-167">**-DistributorLogin**</span><span class="sxs-lookup"><span data-stu-id="ca62c-167">**-DistributorLogin**</span></span>  
  
    -   <span data-ttu-id="ca62c-168">**-DistributorPassword**</span><span class="sxs-lookup"><span data-stu-id="ca62c-168">**-DistributorPassword**</span></span>  
  
    -   <span data-ttu-id="ca62c-169">**-DistributorSecurityMode** = **0**</span><span class="sxs-lookup"><span data-stu-id="ca62c-169">**-DistributorSecurityMode** = **0**</span></span>  
  
    -   <span data-ttu-id="ca62c-170">**-PublisherLogin**</span><span class="sxs-lookup"><span data-stu-id="ca62c-170">**-PublisherLogin**</span></span>  
  
    -   <span data-ttu-id="ca62c-171">**-PublisherPassword**</span><span class="sxs-lookup"><span data-stu-id="ca62c-171">**-PublisherPassword**</span></span>  
  
    -   <span data-ttu-id="ca62c-172">**-PublisherSecurityMode** = **0**</span><span class="sxs-lookup"><span data-stu-id="ca62c-172">**-PublisherSecurityMode** = **0**</span></span>  
  
###  <a name="examples-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="ca62c-173">Beispiele (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="ca62c-173">Examples (Transact-SQL)</span></span>  
 <span data-ttu-id="ca62c-174">In diesem Beispiel wird eine Transaktionsveröffentlichung erstellt und ein Momentaufnahme-Agentauftrag für die neue Veröffentlichung hinzugefügt (mithilfe von **sqlcmd** -Skriptvariablen).</span><span class="sxs-lookup"><span data-stu-id="ca62c-174">This example shows how to create a transactional publication and add a Snapshot Agent job for the new publication (using **sqlcmd** scripting variables).</span></span> <span data-ttu-id="ca62c-175">Im Beispiel wird der Auftrag auch gestartet.</span><span class="sxs-lookup"><span data-stu-id="ca62c-175">The example also starts the job.</span></span>  
  
 [!code-sql[HowTo#sp_trangenerate_snapshot](../../snippets/tsql/SQL15/replication/howto/tsql/createtranpubinitialsnapshot.sql#sp_trangenerate_snapshot)]  
  
 <span data-ttu-id="ca62c-176">In diesem Beispiel wird eine Mergeveröffentlichung erstellt und ein Momentaufnahme-Agentauftrag für die Veröffentlichung hinzugefügt (mithilfe von **sqlcmd** -Variablen).</span><span class="sxs-lookup"><span data-stu-id="ca62c-176">This example creates a merge publication and adds a Snapshot Agent job (using **sqlcmd** variables) for the publication.</span></span> <span data-ttu-id="ca62c-177">Im Beispiel wird der Auftrag auch gestartet.</span><span class="sxs-lookup"><span data-stu-id="ca62c-177">This example also starts the job.</span></span>  
  
 [!code-sql[HowTo#sp_mergegenerate_snapshot](../../snippets/tsql/SQL15/replication/howto/tsql/createmergepubinitialsnapshot.sql#sp_mergegenerate_snapshot)]  
  
 <span data-ttu-id="ca62c-178">Die folgenden Befehlszeilenargumente starten den Momentaufnahme-Agent, um die Momentaufnahme für eine Mergeveröffentlichung zu generieren.</span><span class="sxs-lookup"><span data-stu-id="ca62c-178">The following command-line arguments start the Snapshot Agent to generate the snapshot for a merge publication.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ca62c-179">Zeilenumbrüche wurden hinzugefügt, um die Lesbarkeit zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="ca62c-179">Line breaks were added to improve readability.</span></span> <span data-ttu-id="ca62c-180">In einer Batchdatei müssen Befehle in einer einzelnen Zeile stehen.</span><span class="sxs-lookup"><span data-stu-id="ca62c-180">In a batch file, commands must be made in a single line.</span></span>  
  
 [!code-sql[HowTo#startmergesnapshot_10](../../snippets/tsql/SQL15/replication/howto/tsql/createmergesnapshot_10.bat)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="ca62c-181">Verwenden von Replikationsverwaltungsobjekten (RMO)</span><span class="sxs-lookup"><span data-stu-id="ca62c-181">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="ca62c-182">Momentaufnahmen werden nach dem Erstellen einer Veröffentlichung vom Momentaufnahme-Agent generiert.</span><span class="sxs-lookup"><span data-stu-id="ca62c-182">The Snapshot Agent generates snapshots after a publication is created.</span></span> <span data-ttu-id="ca62c-183">Sie können diese Momentaufnahmen mit Replikationsverwaltungsobjekten (RMO) und dem direkten Zugriff von verwaltetem Code auf Funktionen des Replikations-Agents programmgesteuert generieren.</span><span class="sxs-lookup"><span data-stu-id="ca62c-183">You can generate these snapshots programmatically by using Replication Management Objects (RMO) and direct managed code access to replication agent functionalities.</span></span> <span data-ttu-id="ca62c-184">Welche Objekte Sie verwenden, hängt vom Typ der Replikation ab.</span><span class="sxs-lookup"><span data-stu-id="ca62c-184">The objects you use depend on the type of replication.</span></span> <span data-ttu-id="ca62c-185">Der Momentaufnahme-Agent kann synchron mit dem <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> -Objekt oder asynchron mit dem Agentauftrag gestartet werden.</span><span class="sxs-lookup"><span data-stu-id="ca62c-185">The Snapshot Agent can be started synchronously using the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> object or asynchronously using the agent job.</span></span> <span data-ttu-id="ca62c-186">Nachdem die Anfangsmomentaufnahme generiert wurde, wird sie an den Abonnenten übertragen und auf diesen angewendet, sobald die erste Synchronisierung für das Abonnement durchgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="ca62c-186">After the initial snapshot has been generated, it is transferred to and applied at the Subscriber when the subscription is first synchronized.</span></span> <span data-ttu-id="ca62c-187">Sie müssen den Agent immer dann erneut ausführen, wenn die vorhandene Momentaufnahme keine gültigen und aktuellen Daten mehr enthält.</span><span class="sxs-lookup"><span data-stu-id="ca62c-187">You will need to rerun the agent whenever the existing snapshot no longer contains valid, up-to-date data.</span></span> <span data-ttu-id="ca62c-188">Weitere Informationen finden Sie unter [Verwalten von Veröffentlichungen](publish/maintain-publications.md).</span><span class="sxs-lookup"><span data-stu-id="ca62c-188">For more information, see [Maintain Publications](publish/maintain-publications.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="ca62c-189">Benutzer sollten nach Möglichkeit dazu aufgefordert werden, Anmeldeinformationen zur Laufzeit anzugeben.</span><span class="sxs-lookup"><span data-stu-id="ca62c-189">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="ca62c-190">Wenn Sie Anmeldeinformationen speichern müssen, verwenden Sie die [Kryptografiedienste](https://go.microsoft.com/fwlink/?LinkId=34733) von [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="ca62c-190">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows .NET Framework.</span></span>  
  
#### <a name="to-generate-the-initial-snapshot-for-a-snapshot-or-transactional-publication-by-starting-the-snapshot-agent-job-asynchronous"></a><span data-ttu-id="ca62c-191">So generieren Sie die Anfangsmomentaufnahme für eine Momentaufnahme- oder Transaktionsveröffentlichung durch Starten des Auftrags des Momentaufnahme-Agents (asynchron)</span><span class="sxs-lookup"><span data-stu-id="ca62c-191">To generate the initial snapshot for a snapshot or transactional publication by starting the Snapshot Agent job (asynchronous)</span></span>  
  
1.  <span data-ttu-id="ca62c-192">Erstellen Sie eine Verbindung mit dem Verleger, indem Sie die <xref:Microsoft.SqlServer.Management.Common.ServerConnection> -Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="ca62c-192">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="ca62c-193">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.TransPublication>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="ca62c-193">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPublication> class.</span></span> <span data-ttu-id="ca62c-194">Legen Sie die <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> -Eigenschaft und die <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> -Eigenschaft für die Veröffentlichung fest, und legen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> -Eigenschaft auf die in Schritt 1 erstellte Verbindung fest.</span><span class="sxs-lookup"><span data-stu-id="ca62c-194">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>  
  
3.  <span data-ttu-id="ca62c-195">Rufen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> -Methode auf, um die restlichen Objekteigenschaften zu laden.</span><span class="sxs-lookup"><span data-stu-id="ca62c-195">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to load the remaining properties of the object.</span></span> <span data-ttu-id="ca62c-196">Wenn diese Methode `false` zurückgibt, sind die Veröffentlichungseigenschaften in Schritt 2 falsch definiert, oder die Veröffentlichung ist nicht vorhanden.</span><span class="sxs-lookup"><span data-stu-id="ca62c-196">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>  
  
4.  <span data-ttu-id="ca62c-197">Wenn der Wert von <xref:Microsoft.SqlServer.Replication.Publication.SnapshotAgentExists%2A> auf `false` lautet, rufen Sie <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> auf, um den Agentauftrag für die Momentaufnahme dieser Veröffentlichung zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="ca62c-197">If the value of <xref:Microsoft.SqlServer.Replication.Publication.SnapshotAgentExists%2A> is `false`, call <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> to create the snapshot agent job for this publication.</span></span>  
  
5.  <span data-ttu-id="ca62c-198">Rufen Sie die <xref:Microsoft.SqlServer.Replication.Publication.StartSnapshotGenerationAgentJob%2A> -Methode auf, um den Agentauftrag zu starten, der die Momentaufnahme für diese Veröffentlichung generiert.</span><span class="sxs-lookup"><span data-stu-id="ca62c-198">Call the <xref:Microsoft.SqlServer.Replication.Publication.StartSnapshotGenerationAgentJob%2A> method to start the agent job that generates the snapshot for this publication.</span></span>  
  
6.  <span data-ttu-id="ca62c-199">(Optional) Wenn der Wert von <xref:Microsoft.SqlServer.Replication.TransPublication.SnapshotAvailable%2A> auf `true` lautet, steht die Momentaufnahme den Abonnenten zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="ca62c-199">(Optional) When the value of <xref:Microsoft.SqlServer.Replication.TransPublication.SnapshotAvailable%2A> is `true`, the snapshot is available to Subscribers.</span></span>  
  
#### <a name="to-generate-the-initial-snapshot-for-a-snapshot-or-transactional-publication-by-running-the-snapshot-agent-synchronous"></a><span data-ttu-id="ca62c-200">So generieren Sie die Anfangsmomentaufnahme für eine Momentaufnahme- oder Transaktionsveröffentlichung durch Ausführen des Momentaufnahme-Agents (synchron)</span><span class="sxs-lookup"><span data-stu-id="ca62c-200">To generate the initial snapshot for a snapshot or transactional publication by running the Snapshot Agent (synchronous)</span></span>  
  
1.  <span data-ttu-id="ca62c-201">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> -Klasse, und legen Sie die folgenden erforderlichen Eigenschaften fest:</span><span class="sxs-lookup"><span data-stu-id="ca62c-201">Create an instance of the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> class, and set the following required properties:</span></span>  
  
    -   <span data-ttu-id="ca62c-202"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publisher%2A> – Name des Verlegers</span><span class="sxs-lookup"><span data-stu-id="ca62c-202"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publisher%2A> - name of the Publisher</span></span>  
  
    -   <span data-ttu-id="ca62c-203"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherDatabase%2A> – Name der Veröffentlichungsdatenbank</span><span class="sxs-lookup"><span data-stu-id="ca62c-203"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherDatabase%2A> - name of the publication database</span></span>  
  
    -   <span data-ttu-id="ca62c-204"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publication%2A> &ndash; Den Namen der Veröffentlichung</span><span class="sxs-lookup"><span data-stu-id="ca62c-204"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publication%2A> - name of the publication</span></span>  
  
    -   <span data-ttu-id="ca62c-205"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Distributor%2A> &ndash; Den Namen des Verteilers</span><span class="sxs-lookup"><span data-stu-id="ca62c-205"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Distributor%2A> - name of the Distributor</span></span>  
  
    -   <span data-ttu-id="ca62c-206"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherSecurityMode%2A> Den Wert <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> zur Verwendung der Windows-Authentifizierung, wenn eine Verbindung mit dem Verleger hergestellt wird, oder den Wert <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> sowie Werte für <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherLogin%2A> und <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherPassword%2A> zur Verwendung der [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Authentifizierung, wenn eine Verbindung mit dem Verleger hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="ca62c-206"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherSecurityMode%2A> - a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> to use Windows Authentication when connecting to the Publisher or a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> and values for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherLogin%2A> and <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherPassword%2A> to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher.</span></span> <span data-ttu-id="ca62c-207">Die Windows-Authentifizierung wird empfohlen.</span><span class="sxs-lookup"><span data-stu-id="ca62c-207">Windows Authentication is recommended.</span></span>  
  
    -   <span data-ttu-id="ca62c-208"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorSecurityMode%2A> Den Wert <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> zur Verwendung der Windows-Authentifizierung, wenn eine Verbindung mit dem Verteiler hergestellt wird, oder den Wert <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> sowie Werte für <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorLogin%2A> und <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorPassword%2A> zur Verwendung der [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Authentifizierung, wenn eine Verbindung mit dem Verteiler hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="ca62c-208"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorSecurityMode%2A> - a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> to use Windows Authentication when connecting to the Distributor or a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> and values for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorLogin%2A> and <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorPassword%2A> to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Distributor.</span></span> <span data-ttu-id="ca62c-209">Die Windows-Authentifizierung wird empfohlen.</span><span class="sxs-lookup"><span data-stu-id="ca62c-209">Windows Authentication is recommended.</span></span>  
  
2.  <span data-ttu-id="ca62c-210">Legen Sie den Wert <xref:Microsoft.SqlServer.Replication.ReplicationType.Transactional> oder <xref:Microsoft.SqlServer.Replication.ReplicationType.Snapshot> für <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.ReplicationType%2A>fest.</span><span class="sxs-lookup"><span data-stu-id="ca62c-210">Set a value of <xref:Microsoft.SqlServer.Replication.ReplicationType.Transactional> or <xref:Microsoft.SqlServer.Replication.ReplicationType.Snapshot> for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.ReplicationType%2A>.</span></span>  
  
3.  <span data-ttu-id="ca62c-211">Rufen Sie die <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.GenerateSnapshot%2A> -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="ca62c-211">Call the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.GenerateSnapshot%2A> method.</span></span>  
  
#### <a name="to-generate-the-initial-snapshot-for-a-merge-publication-by-starting-the-snapshot-agent-job-asynchronous"></a><span data-ttu-id="ca62c-212">So generieren Sie die Anfangsmomentaufnahme für eine Mergeveröffentlichung durch Starten des Auftrags des Momentaufnahme-Agents (asynchron)</span><span class="sxs-lookup"><span data-stu-id="ca62c-212">To generate the initial snapshot for a merge publication by starting the Snapshot Agent job (asynchronous)</span></span>  
  
1.  <span data-ttu-id="ca62c-213">Erstellen Sie eine Verbindung mit dem Verleger, indem Sie die <xref:Microsoft.SqlServer.Management.Common.ServerConnection> -Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="ca62c-213">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="ca62c-214">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.MergePublication>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="ca62c-214">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class.</span></span> <span data-ttu-id="ca62c-215">Legen Sie die <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> -Eigenschaft und die <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> -Eigenschaft für die Veröffentlichung fest, und legen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> -Eigenschaft auf die in Schritt 1 erstellte Verbindung fest.</span><span class="sxs-lookup"><span data-stu-id="ca62c-215">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>  
  
3.  <span data-ttu-id="ca62c-216">Rufen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> -Methode auf, um die restlichen Objekteigenschaften zu laden.</span><span class="sxs-lookup"><span data-stu-id="ca62c-216">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to load the remaining properties of the object.</span></span> <span data-ttu-id="ca62c-217">Wenn diese Methode `false` zurückgibt, sind die Veröffentlichungseigenschaften in Schritt 2 falsch definiert, oder die Veröffentlichung ist nicht vorhanden.</span><span class="sxs-lookup"><span data-stu-id="ca62c-217">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>  
  
4.  <span data-ttu-id="ca62c-218">Wenn der Wert von <xref:Microsoft.SqlServer.Replication.Publication.SnapshotAgentExists%2A> auf `false` lautet, rufen Sie <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> auf, um den Agentauftrag für die Momentaufnahme dieser Veröffentlichung zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="ca62c-218">If the value of <xref:Microsoft.SqlServer.Replication.Publication.SnapshotAgentExists%2A> is `false`, call <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> to create the snapshot agent job for this publication.</span></span>  
  
5.  <span data-ttu-id="ca62c-219">Rufen Sie die <xref:Microsoft.SqlServer.Replication.Publication.StartSnapshotGenerationAgentJob%2A> -Methode auf, um den Agentauftrag zu starten, der die Momentaufnahme für diese Veröffentlichung generiert.</span><span class="sxs-lookup"><span data-stu-id="ca62c-219">Call the <xref:Microsoft.SqlServer.Replication.Publication.StartSnapshotGenerationAgentJob%2A> method to start the agent job that generates the snapshot for this publication.</span></span>  
  
6.  <span data-ttu-id="ca62c-220">(Optional) Wenn der Wert von <xref:Microsoft.SqlServer.Replication.MergePublication.SnapshotAvailable%2A> auf `true` lautet, steht die Momentaufnahme den Abonnenten zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="ca62c-220">(Optional) When the value of <xref:Microsoft.SqlServer.Replication.MergePublication.SnapshotAvailable%2A> is `true`, the snapshot is available to Subscribers.</span></span>  
  
#### <a name="to-generate-the-initial-snapshot-for-a-merge-publication-by-running-the-snapshot-agent-synchronous"></a><span data-ttu-id="ca62c-221">So generieren Sie die Anfangsmomentaufnahme für eine Mergeveröffentlichung durch Ausführen des Momentaufnahme-Agents (synchron)</span><span class="sxs-lookup"><span data-stu-id="ca62c-221">To generate the initial snapshot for a merge publication by running the Snapshot Agent (synchronous)</span></span>  
  
1.  <span data-ttu-id="ca62c-222">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> -Klasse, und legen Sie die folgenden erforderlichen Eigenschaften fest:</span><span class="sxs-lookup"><span data-stu-id="ca62c-222">Create an instance of the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> class, and set the following required properties:</span></span>  
  
    -   <span data-ttu-id="ca62c-223"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publisher%2A> – Name des Verlegers</span><span class="sxs-lookup"><span data-stu-id="ca62c-223"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publisher%2A> - name of the Publisher</span></span>  
  
    -   <span data-ttu-id="ca62c-224"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherDatabase%2A> – Name der Veröffentlichungsdatenbank</span><span class="sxs-lookup"><span data-stu-id="ca62c-224"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherDatabase%2A> - name of the publication database</span></span>  
  
    -   <span data-ttu-id="ca62c-225"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publication%2A> &ndash; Den Namen der Veröffentlichung</span><span class="sxs-lookup"><span data-stu-id="ca62c-225"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publication%2A> - name of the publication</span></span>  
  
    -   <span data-ttu-id="ca62c-226"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Distributor%2A> &ndash; Den Namen des Verteilers</span><span class="sxs-lookup"><span data-stu-id="ca62c-226"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Distributor%2A> - name of the Distributor</span></span>  
  
    -   <span data-ttu-id="ca62c-227"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherSecurityMode%2A> Den Wert <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> zur Verwendung der Windows-Authentifizierung, wenn eine Verbindung mit dem Verleger hergestellt wird, oder den Wert <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> sowie Werte für <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherLogin%2A> und <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherPassword%2A> zur Verwendung der [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Authentifizierung, wenn eine Verbindung mit dem Verleger hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="ca62c-227"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherSecurityMode%2A> - a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> to use Windows Authentication when connecting to the Publisher or a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> and values for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherLogin%2A> and <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherPassword%2A> to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher.</span></span> <span data-ttu-id="ca62c-228">Die Windows-Authentifizierung wird empfohlen.</span><span class="sxs-lookup"><span data-stu-id="ca62c-228">Windows Authentication is recommended.</span></span>  
  
    -   <span data-ttu-id="ca62c-229"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorSecurityMode%2A> Den Wert <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> zur Verwendung der Windows-Authentifizierung, wenn eine Verbindung mit dem Verteiler hergestellt wird, oder den Wert <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> sowie Werte für <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorLogin%2A> und <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorPassword%2A> zur Verwendung der [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Authentifizierung, wenn eine Verbindung mit dem Verteiler hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="ca62c-229"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorSecurityMode%2A> - a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> to use Windows Authentication when connecting to the Distributor or a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> and values for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorLogin%2A> and <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorPassword%2A> to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Distributor.</span></span> <span data-ttu-id="ca62c-230">Die Windows-Authentifizierung wird empfohlen.</span><span class="sxs-lookup"><span data-stu-id="ca62c-230">Windows Authentication is recommended.</span></span>  
  
2.  <span data-ttu-id="ca62c-231">Legen Sie den Wert <xref:Microsoft.SqlServer.Replication.ReplicationType.Merge> für <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.ReplicationType%2A>fest.</span><span class="sxs-lookup"><span data-stu-id="ca62c-231">Set a value of <xref:Microsoft.SqlServer.Replication.ReplicationType.Merge> for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.ReplicationType%2A>.</span></span>  
  
3.  <span data-ttu-id="ca62c-232">Rufen Sie die <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.GenerateSnapshot%2A> -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="ca62c-232">Call the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.GenerateSnapshot%2A> method.</span></span>  
  
###  <a name="examples-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="ca62c-233">Beispiele (RMO)</span><span class="sxs-lookup"><span data-stu-id="ca62c-233">Examples (RMO)</span></span>  
 <span data-ttu-id="ca62c-234">In diesem Beispiel wird der Momentaufnahme-Agent synchron ausgeführt, um die Anfangsmomentaufnahme für eine Transaktionsveröffentlichung zu generieren.</span><span class="sxs-lookup"><span data-stu-id="ca62c-234">This example synchronously runs the Snapshot Agent to generate the initial snapshot for a transactional publication.</span></span>  
  
 [!code-csharp[HowTo#rmo_GenerateSnapshot](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_generatesnapshot)]  
  
 [!code-vb[HowTo#rmo_vb_GenerateSnapshot](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_generatesnapshot)]  
  
 <span data-ttu-id="ca62c-235">In diesem Beispiel wird der Agentauftrag asynchron ausgeführt, um die Anfangsmomentaufnahme für eine Transaktionsveröffentlichung zu generieren.</span><span class="sxs-lookup"><span data-stu-id="ca62c-235">This example asynchronously starts the agent job to generate the initial snapshot for a transactional publication.</span></span>  
  
 [!code-csharp[HowTo#rmo_GenerateSnapshot_WithJob](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_generatesnapshot_withjob)]  
  
 [!code-vb[HowTo#rmo_vb_GenerateSnapshot_WithJob](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_generatesnapshot_withjob)]  
  
## <a name="see-also"></a><span data-ttu-id="ca62c-236">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="ca62c-236">See Also</span></span>  
 <span data-ttu-id="ca62c-237">[Create a Publication](publish/create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="ca62c-237">[Create a Publication](publish/create-a-publication.md) </span></span>  
 <span data-ttu-id="ca62c-238">[Create a Pull Subscription](create-a-pull-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="ca62c-238">[Create a Pull Subscription](create-a-pull-subscription.md) </span></span>  
 <span data-ttu-id="ca62c-239">[Create a Push Subscription](create-a-push-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="ca62c-239">[Create a Push Subscription](create-a-push-subscription.md) </span></span>  
 <span data-ttu-id="ca62c-240">[Specify Synchronization Schedules](specify-synchronization-schedules.md) </span><span class="sxs-lookup"><span data-stu-id="ca62c-240">[Specify Synchronization Schedules](specify-synchronization-schedules.md) </span></span>  
 <span data-ttu-id="ca62c-241">[Erstellen und Anwenden der Momentaufnahme](create-and-apply-the-snapshot.md) </span><span class="sxs-lookup"><span data-stu-id="ca62c-241">[Create and Apply the Snapshot](create-and-apply-the-snapshot.md) </span></span>  
 <span data-ttu-id="ca62c-242">[Initialisieren eines Abonnements mit einer Momentaufnahme](initialize-a-subscription-with-a-snapshot.md) </span><span class="sxs-lookup"><span data-stu-id="ca62c-242">[Initialize a Subscription with a Snapshot](initialize-a-subscription-with-a-snapshot.md) </span></span>  
 <span data-ttu-id="ca62c-243">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="ca62c-243">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span></span>  
 <span data-ttu-id="ca62c-244">[Replication Security Best Practices](security/replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="ca62c-244">[Replication Security Best Practices](security/replication-security-best-practices.md) </span></span>  
 <span data-ttu-id="ca62c-245">[Replication System Stored Procedures Concepts](concepts/replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="ca62c-245">[Replication System Stored Procedures Concepts](concepts/replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="ca62c-246">Verwenden von sqlcmd mit Skriptvariablen</span><span class="sxs-lookup"><span data-stu-id="ca62c-246">Use sqlcmd with Scripting Variables</span></span>](../scripting/sqlcmd-use-with-scripting-variables.md)  
  
  

---
title: Implementieren eines benutzerdefinierten Konfliktlösers für einen Mergeartikel | Microsoft Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- merge replication conflict resolution [SQL Server replication], stored procedure-based resolvers
- articles [SQL Server replication], conflict resolution
- conflict resolution [SQL Server replication], merge replication
ms.assetid: 76bd8524-ebc1-4d80-b5a2-4169944d6ac0
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 23e684213114f3c9bb2f1ad56de06fcfc89b819a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87609085"
---
# <a name="implement-a-custom-conflict-resolver-for-a-merge-article"></a><span data-ttu-id="6fab8-102">Implementieren eines benutzerdefinierten Konfliktlösers für einen Mergeartikel</span><span class="sxs-lookup"><span data-stu-id="6fab8-102">Implement a Custom Conflict Resolver for a Merge Article</span></span>
  <span data-ttu-id="6fab8-103"> In diesem Thema wird beschrieben, wie ein benutzerdefinierter Konfliktlöser für einen Mergeartikel mit [!INCLUDE[tsql](../../includes/tsql-md.md)] oder einem [COM-basierten benutzerdefinierten Konfliktlöser](merge/advanced-merge-replication-conflict-com-based-custom-resolvers.md) in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="6fab8-103">This topic describes how to implement custom conflict resolver for a merge article in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[tsql](../../includes/tsql-md.md)] or a [COM-based custom resolver](merge/advanced-merge-replication-conflict-com-based-custom-resolvers.md).</span></span>  
  
 <span data-ttu-id="6fab8-104">**In diesem Thema**</span><span class="sxs-lookup"><span data-stu-id="6fab8-104">**In This Topic**</span></span>  
  
-   <span data-ttu-id="6fab8-105">**So implementieren Sie einen benutzerdefinierten Konfliktlöser für einen Mergeartikel mit:**</span><span class="sxs-lookup"><span data-stu-id="6fab8-105">**To implement custom conflict resolver for a merge article, using:**</span></span>  
  
     [<span data-ttu-id="6fab8-106">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="6fab8-106">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="6fab8-107">COM-basierter Konfliktlöser</span><span class="sxs-lookup"><span data-stu-id="6fab8-107">COM-based Resolver</span></span>](#COM)  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="6fab8-108">Verwenden von Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="6fab8-108">Using Transact-SQL</span></span>  
 <span data-ttu-id="6fab8-109">Sie können einen eigenen benutzerdefinierten Konfliktlöser als gespeicherte [!INCLUDE[tsql](../../includes/tsql-md.md)] -Prozedur in einem Verleger schreiben.</span><span class="sxs-lookup"><span data-stu-id="6fab8-109">You can write your own custom conflict resolver as a [!INCLUDE[tsql](../../includes/tsql-md.md)] stored procedure at each Publisher.</span></span> <span data-ttu-id="6fab8-110">Diese gespeicherte Prozedur wird während der Synchronisierung aufgerufen, wenn in einem Artikel, für den der Konfliktlöser registriert wurde, Konflikte erkannt werden. Die Informationen zur Konfliktzeile werden vom Merge-Agent an die erforderlichen Parameter der Prozedur übergeben.</span><span class="sxs-lookup"><span data-stu-id="6fab8-110">During synchronization, this stored procedure is invoked when conflicts are encountered in an article to which the resolver was registered, and information on the conflict row is passed by the Merge Agent to the required parameters of the procedure.</span></span> <span data-ttu-id="6fab8-111">Auf gespeicherten Prozeduren basierende benutzerdefinierte Konfliktlöser werden immer auf dem Verleger erstellt.</span><span class="sxs-lookup"><span data-stu-id="6fab8-111">Stored procedure-based custom conflict resolvers are always created at the Publisher.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[msCoName](../../includes/msconame-md.md)]<span data-ttu-id="6fab8-112">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Konflikt Löser für gespeicherte Prozeduren werden nur aufgerufen, um auf Zeilen Änderungen basierende Konflikte zu behandeln.</span><span class="sxs-lookup"><span data-stu-id="6fab8-112">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] stored procedure resolvers are only invoked to handle row change-based conflicts.</span></span> <span data-ttu-id="6fab8-113">Sie können nicht zur Behandlung anderer Arten von Konflikten verwendet werden, z.&nbsp;B. von Einfügefehlern, die durch den Verstoß gegen eine PRIMARY&nbsp;KEY-Einschränkung oder einen eindeutigen Index verursacht werden.</span><span class="sxs-lookup"><span data-stu-id="6fab8-113">They cannot be used to handle other types of conflicts such as insert failures due to PRIMARY KEY violations or unique index constraint violations.</span></span>  
  
#### <a name="to-create-a-stored-procedure-based-custom-conflict-resolver"></a><span data-ttu-id="6fab8-114">So erstellen und registrieren Sie einen auf gespeicherten Prozeduren basierenden benutzerdefinierten Konfliktlöser</span><span class="sxs-lookup"><span data-stu-id="6fab8-114">To create a stored procedure-based custom conflict resolver</span></span>  
  
1.  <span data-ttu-id="6fab8-115">Erstellen Sie auf dem Verleger entweder in der Veröffentlichungs- oder der **msdb** -Datenbank eine neue gespeicherte Systemprozedur, welche die folgenden erforderlichen Parameter implementiert:</span><span class="sxs-lookup"><span data-stu-id="6fab8-115">At the Publisher in either the publication or **msdb** database, create a new system stored procedure that implements the following required parameters:</span></span>  
  
    |<span data-ttu-id="6fab8-116">Parameter</span><span class="sxs-lookup"><span data-stu-id="6fab8-116">Parameter</span></span>|<span data-ttu-id="6fab8-117">Datentyp</span><span class="sxs-lookup"><span data-stu-id="6fab8-117">Data type</span></span>|<span data-ttu-id="6fab8-118">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="6fab8-118">Description</span></span>|  
    |---------------|---------------|-----------------|  
    |**@tableowner**|`sysname`|<span data-ttu-id="6fab8-119">Name des Besitzers der Tabelle, für die ein Konflikt gelöst wird.</span><span class="sxs-lookup"><span data-stu-id="6fab8-119">Name of the owner of the table for which a conflict is being resolved.</span></span> <span data-ttu-id="6fab8-120">Dies ist der Besitzer der Tabelle der Veröffentlichungsdatenbank.</span><span class="sxs-lookup"><span data-stu-id="6fab8-120">This is the owner for the table in the publication database.</span></span>|  
    |**@tablename**|`sysname`|<span data-ttu-id="6fab8-121">Name der Tabelle, für die ein Konflikt gelöst wird.</span><span class="sxs-lookup"><span data-stu-id="6fab8-121">Name of the table for which a conflict is being resolved.</span></span>|  
    |**@rowguid**|`uniqueidentifier`|<span data-ttu-id="6fab8-122">Eindeutiger Bezeichner für die Zeile, die den Konflikt enthält.</span><span class="sxs-lookup"><span data-stu-id="6fab8-122">Unique identifier for the row having the conflict.</span></span>|  
    |**@subscriber**|`sysname`|<span data-ttu-id="6fab8-123">Name des Servers, von dem eine konfliktverursachende Änderung weitergegeben wird.</span><span class="sxs-lookup"><span data-stu-id="6fab8-123">Name of the server from where a conflicting change is being propagated.</span></span>|  
    |**@subscriber_db**|`sysname`|<span data-ttu-id="6fab8-124">Name der Datenbank, von der eine konfliktverursachende Änderung weitergegeben wird.</span><span class="sxs-lookup"><span data-stu-id="6fab8-124">Name of the database from where conflicting change is being propagated.</span></span>|  
    |<span data-ttu-id="6fab8-125">**@log_conflictAusgeben**</span><span class="sxs-lookup"><span data-stu-id="6fab8-125">**@log_conflict OUTPUT**</span></span>|`int`|<span data-ttu-id="6fab8-126">Ob der Mergeprozess einen Konflikt für eine spätere Auflösung protokollieren soll:</span><span class="sxs-lookup"><span data-stu-id="6fab8-126">Whether the merge process should log a conflict for later resolution:</span></span><br /><br /> <span data-ttu-id="6fab8-127">**0** = Den Konflikt nicht protokollieren.</span><span class="sxs-lookup"><span data-stu-id="6fab8-127">**0** = Do not log the conflict.</span></span><br /><br /> <span data-ttu-id="6fab8-128">**1** = Der Abonnent verliert den Konflikt.</span><span class="sxs-lookup"><span data-stu-id="6fab8-128">**1** = Subscriber is the conflict loser.</span></span><br /><br /> <span data-ttu-id="6fab8-129">**2** = Der Verleger verliert den Konflikt.</span><span class="sxs-lookup"><span data-stu-id="6fab8-129">**2** = Publisher is the conflict loser.</span></span>|  
    |<span data-ttu-id="6fab8-130">**@conflict_messageAusgeben**</span><span class="sxs-lookup"><span data-stu-id="6fab8-130">**@conflict_message OUTPUT**</span></span>|`nvarchar(512)`|<span data-ttu-id="6fab8-131">Meldung, die über die Auflösung ausgegeben werden soll, wenn der Konflikt protokolliert wird.</span><span class="sxs-lookup"><span data-stu-id="6fab8-131">Message to be given about the resolution if the conflict is logged.</span></span>|  
    |**@destowner**|`sysname`|<span data-ttu-id="6fab8-132">Der Besitzer der auf dem Abonnenten veröffentlichten Tabelle.</span><span class="sxs-lookup"><span data-stu-id="6fab8-132">The owner of the published table at the Subscriber.</span></span>|  
  
     <span data-ttu-id="6fab8-133">Diese gespeicherte Prozedur verwendet die Werte, die vom Merge-Agent für diese Parameter übergeben werden, um die benutzerdefinierte Konfliktlöserlogik zu implementieren. Sie muss ein einzeiliges Resultset zurückgeben, dessen Struktur mit der Struktur der Basistabelle identisch ist, und das die Datenwerte für die gewinnende Version der Zeile enthält.</span><span class="sxs-lookup"><span data-stu-id="6fab8-133">This stored procedure uses the values passed by the Merge Agent to these parameters to implement your custom conflict resolution logic; it must return a single row result set that is identical in structure to the base table and contains the data values for the winning version of the row.</span></span>  
  
2.  <span data-ttu-id="6fab8-134">Gewähren Sie allen Anmeldungen, die von Abonnenten zum Verbindungsaufbau mit dem Verleger verwendet werden, EXECUTE-Berechtigungen für die gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="6fab8-134">Grant EXECUTE permissions on the stored procedure to any logins used by Subscribers to connect to the Publisher.</span></span>  
  
#### <a name="to-use-a-custom-conflict-resolver-with-a-new-table-article"></a><span data-ttu-id="6fab8-135">So verwenden Sie einen benutzerdefinierten Konfliktlöser mit einem neuen Tabellenartikel</span><span class="sxs-lookup"><span data-stu-id="6fab8-135">To use a custom conflict resolver with a new table article</span></span>  
  
1.  <span data-ttu-id="6fab8-136">Führen Sie [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) zur Definition eines Artikels unter Angabe eines Werts des **MicrosoftSQL-** **Konfliktlösers für gespeicherte Prozeduren** für den **@article_resolver**-Parameter und den Namen der gespeicherten Prozedur, mit der die Konfliktlöserlogik implementiert wird, für den Parameter **@resolver_info** aus.</span><span class="sxs-lookup"><span data-stu-id="6fab8-136">Execute [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) to define an article, specifying a value of **MicrosoftSQL** **Server Stored Procedure Resolver** for the **@article_resolver** parameter and the name of the stored procedure that implements the conflict resolver logic for the **@resolver_info** parameter.</span></span> <span data-ttu-id="6fab8-137">Weitere Informationen finden Sie unter [Definieren eines Artikels](publish/define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="6fab8-137">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
#### <a name="to-use-a-custom-conflict-resolver-with-an-existing-table-article"></a><span data-ttu-id="6fab8-138">So verwenden Sie einen benutzerdefinierten Konfliktlöser mit einem vorhandenen Tabellenartikel</span><span class="sxs-lookup"><span data-stu-id="6fab8-138">To use a custom conflict resolver with an existing table article</span></span>  
  
1.  <span data-ttu-id="6fab8-139">Führen Sie [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql)aus, und geben Sie, **@publication** , den **@article** Wert **article_resolver** für **@property** und den Wert **MicrosoftSQL** **Server gespeicherter prozelageresolver** für an **@value** .</span><span class="sxs-lookup"><span data-stu-id="6fab8-139">Execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specifying **@publication**, **@article**, a value of **article_resolver** for **@property**, and a value of **MicrosoftSQL** **Server Stored ProcedureResolver** for **@value**.</span></span>  
  
2.  <span data-ttu-id="6fab8-140">Führen Sie [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql)aus, und geben Sie, **@publication** **@article** , den Wert **resolver_info** für **@property** und den Namen der gespeicherten Prozedur an, die die Konflikt Löser Logik für implementiert **@value** .</span><span class="sxs-lookup"><span data-stu-id="6fab8-140">Execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specifying **@publication**, **@article**, a value of **resolver_info** for **@property**, and the name of the stored procedure that implements the conflict resolver logic for **@value**.</span></span>  
  
##  <a name="using-a-com-based-custom-resolver"></a><a name="COM"></a><span data-ttu-id="6fab8-141">Verwenden eines COM-basierten benutzerdefinierten Konflikt Lösers</span><span class="sxs-lookup"><span data-stu-id="6fab8-141">Using a COM-based Custom Resolver</span></span>  
 <span data-ttu-id="6fab8-142">Der <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> -Namespace implementiert eine Schnittstelle, mit der Sie eine komplexe Geschäftslogik zum Verarbeiten von Ereignissen und zur Lösung von Konflikten schreiben können, die während der Synchronisierung der Mergereplikation eintreten.</span><span class="sxs-lookup"><span data-stu-id="6fab8-142">The <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> namespace implements an interface that enables you to write complex business logic to handle events and resolve conflicts that occur during the merge replication synchronization process.</span></span> <span data-ttu-id="6fab8-143">Weitere Informationen finden Sie unter [Implementieren eines Geschäftslogikhandlers für einen Mergeartikel](implement-a-business-logic-handler-for-a-merge-article.md).</span><span class="sxs-lookup"><span data-stu-id="6fab8-143">For more information, see [Implement a Business Logic Handler for a Merge Article](implement-a-business-logic-handler-for-a-merge-article.md).</span></span> <span data-ttu-id="6fab8-144">Sie können auch eine eigene, auf systemeigenem Code basierende benutzerdefinierte Geschäftslogik zur Lösung von Konflikten schreiben.</span><span class="sxs-lookup"><span data-stu-id="6fab8-144">You can also write your own native code-based custom business logic to resolve conflicts.</span></span> <span data-ttu-id="6fab8-145">Diese Logik wird mithilfe von Produkten wie [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C++ als COM-Komponente konzipiert und in DLLs (Dynamic-Link Libraries) kompiliert.</span><span class="sxs-lookup"><span data-stu-id="6fab8-145">This logic is built as a COM component and compiled into dynamic-link libraries (DLL), using products such as [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C++.</span></span> <span data-ttu-id="6fab8-146">Ein solcher com-basierter benutzerdefinierter Konflikt Löser muss die **ICustomResolver** -Schnittstelle implementieren, die speziell für die Konfliktlösung entworfen wurde.</span><span class="sxs-lookup"><span data-stu-id="6fab8-146">Such a COM-based custom conflict resolver must implement the **ICustomResolver** interface, which is designed specifically for conflict resolution.</span></span>  
  
#### <a name="to-create-and-register-a-com-based-custom-conflict-resolver"></a><span data-ttu-id="6fab8-147">So erstellen und registrieren Sie einen COM-basierten benutzerdefinierten Konfliktlöser</span><span class="sxs-lookup"><span data-stu-id="6fab8-147">To create and register a COM-based custom conflict resolver</span></span>  
  
1.  <span data-ttu-id="6fab8-148">Fügen Sie in einer COM-kompatiblen Erstellungsumgebung Verweise auf die benutzerdefinierte Konfliktlöserbibliothek hinzu.</span><span class="sxs-lookup"><span data-stu-id="6fab8-148">In a COM-compatible authoring environment, add references to the Custom Conflict Resolver library.</span></span>  
  
2.  <span data-ttu-id="6fab8-149">Verwenden Sie für ein Visual&nbsp;C++-Projekt die #import-Direktive, um diese Bibliothek in Ihr Projekt zu importieren.</span><span class="sxs-lookup"><span data-stu-id="6fab8-149">For a Visual C++ project, use the #import directive to import this library into your project.</span></span>  
  
3.  <span data-ttu-id="6fab8-150">Fügen Sie eine Klasse hinzu, die die **ICustomResolver** -Schnittstelle implementiert.</span><span class="sxs-lookup"><span data-stu-id="6fab8-150">Create a class that implements the **ICustomResolver** interface.</span></span>  
  
4.  <span data-ttu-id="6fab8-151">Implementieren Sie bestimmte Methoden und Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="6fab8-151">Implement certain methods and properties.</span></span>  
  
5.  <span data-ttu-id="6fab8-152">Erstellen Sie das Projekt, um die benutzerdefinierte Konfliktlöserbibliotheksdatei zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="6fab8-152">Build the project to create the custom conflict resolver library file.</span></span>  
  
6.  <span data-ttu-id="6fab8-153">Stellen Sie die Bibliothek in dem Verzeichnis bereit, das die ausführbare Datei des Merge-Agents (normalerweise \Microsoft SQL Server\100\COM) enthält.</span><span class="sxs-lookup"><span data-stu-id="6fab8-153">Deploy the library in the directory containing the merge agent executable (usually \Microsoft SQL Server\100\COM).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6fab8-154">Ein benutzerdefinierter Konfliktlöser muss bei einem Pullabonnement auf dem Abonnenten, bei einem Pushabonnement auf dem Verteiler oder auf dem mit der Websynchronisierung verwendeten Webserver bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="6fab8-154">A custom conflict resolver must be deployed at the Subscriber for a pull subscription, at the Distributor for a push subscription, or at the Web server used with Web synchronization.</span></span>  
  
7.  <span data-ttu-id="6fab8-155">Registrieren Sie die benutzerdefinierte Konfliktlöserbibliothek folgendermaßen mit regsvr32.exe vom Bereitstellungsverzeichnis aus:</span><span class="sxs-lookup"><span data-stu-id="6fab8-155">Register the custom conflict resolver library using regsvr32.exe from the deployment directory as follows:</span></span>  
  
    ```  
    regsvr32.exe mycustomresolver.dll  
    ```  
  
8.  <span data-ttu-id="6fab8-156">Führen Sie auf dem Verleger [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) aus, um zu prüfen, ob die Bibliothek noch nicht als benutzerdefinierter Konfliktlöser registriert wurde.</span><span class="sxs-lookup"><span data-stu-id="6fab8-156">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) to verify that the library is not already registered as a custom conflict resolver.</span></span>  
  
9. <span data-ttu-id="6fab8-157">Um die Bibliothek als benutzerdefinierten Konfliktlöser zu registrieren, führen Sie auf dem Verteiler [sp_registercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-registercustomresolver-transact-sql) aus.</span><span class="sxs-lookup"><span data-stu-id="6fab8-157">To register the library as a custom conflict resolver, execute [sp_registercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-registercustomresolver-transact-sql), at the Distributor.</span></span> <span data-ttu-id="6fab8-158">Geben Sie den anzeigen amen des COM-Objekts für **@article_resolver** , die Bibliotheks-ID (CLSID) für **@resolver_clsid** und den Wert für an `false` **@is_dotnet_assembly** .</span><span class="sxs-lookup"><span data-stu-id="6fab8-158">Specify the friendly name of the COM object for **@article_resolver**, the library's ID (CLSID) for **@resolver_clsid**, and a value of `false` for **@is_dotnet_assembly**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6fab8-159">Wenn er nicht mehr benötigt wird, kann die Registrierung eines benutzerdefinierten Konfliktlösers mit [sp_unregistercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-unregistercustomresolver-transact-sql) aufgehoben werden.</span><span class="sxs-lookup"><span data-stu-id="6fab8-159">When no longer needed, a custom conflict resolver can be unregistered using [sp_unregistercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-unregistercustomresolver-transact-sql).</span></span>  
  
10. <span data-ttu-id="6fab8-160">(Optional) Wiederholen Sie bei einem Cluster die Schritte 5&nbsp;bis&nbsp;8, um den benutzerdefinierten Konfliktlöser auf allen Knoten des Clusters zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="6fab8-160">(Optional) On a cluster, repeat steps 5-8 to register the custom resolver on all nodes of the cluster.</span></span> <span data-ttu-id="6fab8-161">Dies ist erforderlich, um sicherzustellen, dass der benutzerdefinierte Konfliktlöser nach einem Failover die Synchronisierung korrekt laden kann.</span><span class="sxs-lookup"><span data-stu-id="6fab8-161">This is required to ensure that the custom resolver will be able to properly load the reconciler following a failover.</span></span>  
  
#### <a name="to-use-a-custom-conflict-resolver-with-a-new-table-article"></a><span data-ttu-id="6fab8-162">So verwenden Sie einen benutzerdefinierten Konfliktlöser mit einem neuen Tabellenartikel</span><span class="sxs-lookup"><span data-stu-id="6fab8-162">To use a custom conflict resolver with a new table article</span></span>  
  
1.  <span data-ttu-id="6fab8-163">Führen Sie auf dem Verleger [sp_unregistercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) aus, und achten Sie auf den Anzeigenamen des gewünschten Konfliktlösers.</span><span class="sxs-lookup"><span data-stu-id="6fab8-163">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) and note the friendly name of the desired resolver.</span></span>  
  
2.  <span data-ttu-id="6fab8-164">Führen Sie auf dem Verleger für die Veröffentlichungsdatenbank [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) zur Definition eines Artikels aus.</span><span class="sxs-lookup"><span data-stu-id="6fab8-164">At the Publisher on the publication database, execute [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) to define an article.</span></span> <span data-ttu-id="6fab8-165">Geben Sie den anzeigen amen des Artikel Konflikt Lösers aus Schritt 1 für an **@article_resolver** .</span><span class="sxs-lookup"><span data-stu-id="6fab8-165">Specify the friendly name of the article resolver from step 1 for **@article_resolver**.</span></span> <span data-ttu-id="6fab8-166">Weitere Informationen finden Sie unter [Definieren eines Artikels](publish/define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="6fab8-166">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
#### <a name="to-use-a-custom-conflict-resolver-with-an-existing-table-article"></a><span data-ttu-id="6fab8-167">So verwenden Sie einen benutzerdefinierten Konfliktlöser mit einem vorhandenen Tabellenartikel</span><span class="sxs-lookup"><span data-stu-id="6fab8-167">To use a custom conflict resolver with an existing table article</span></span>  
  
1.  <span data-ttu-id="6fab8-168">Führen Sie auf dem Verleger [sp_unregistercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) aus, und achten Sie auf den Anzeigenamen des gewünschten Konfliktlösers.</span><span class="sxs-lookup"><span data-stu-id="6fab8-168">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) and note the friendly name of the desired resolver.</span></span>  
  
2.  <span data-ttu-id="6fab8-169">Führen Sie [sp_changemergearticle &#40;Transact-SQL-&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql)aus, und geben Sie, **@publication** , den **@article** Wert **article_resolver** für **@property** und den anzeigen amen des Artikel Konflikt Lösers aus Schritt 1 für an **@value** .</span><span class="sxs-lookup"><span data-stu-id="6fab8-169">Execute [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specifying **@publication**, **@article**, a value of **article_resolver** for **@property**, and the friendly name of the article resolver from step 1 for **@value**.</span></span>  
  
#### <a name="viewing-a-sample-custom-resolver"></a><span data-ttu-id="6fab8-170">Anzeigen eines Beispiels für einen benutzerdefinierten Konfliktlöser</span><span class="sxs-lookup"><span data-stu-id="6fab8-170">Viewing a Sample Custom Resolver</span></span>  
  
1.  <span data-ttu-id="6fab8-171">Ein Beispiel ist in SQL Server 2000-Beispieldateien verfügbar.</span><span class="sxs-lookup"><span data-stu-id="6fab8-171">A sample is available in the SQL Server 2000 sample files.</span></span> <span data-ttu-id="6fab8-172">Laden Sie die [**sql2000samples.zip**](https://github.com/Microsoft/sql-server-samples/blob/master/samples/tutorials/Miscellaneous/sql2000samples.zip)herunter.</span><span class="sxs-lookup"><span data-stu-id="6fab8-172">Download the [**sql2000samples.zip**](https://github.com/Microsoft/sql-server-samples/blob/master/samples/tutorials/Miscellaneous/sql2000samples.zip).</span></span> <span data-ttu-id="6fab8-173">Dadurch werden 3 Dateien mit einer Größe von 6,9 MB heruntergeladen.</span><span class="sxs-lookup"><span data-stu-id="6fab8-173">This downloads 3 files amounting to 6.9 MB.</span></span>  
  
2.  <span data-ttu-id="6fab8-174">Extrahieren Sie die Dateien aus der heruntergeladenen komprimierten CAB-Datei.</span><span class="sxs-lookup"><span data-stu-id="6fab8-174">Extract the files from downloaded compressed .cab file.</span></span>  
  
3.  <span data-ttu-id="6fab8-175">Ausführen **setup.exe**</span><span class="sxs-lookup"><span data-stu-id="6fab8-175">Run **setup.exe**</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6fab8-176">Bei der Auswahl der Installationsoptionen müssen Sie nur die Beispiele für die **Replikation** installieren.</span><span class="sxs-lookup"><span data-stu-id="6fab8-176">When choosing the installation options, it is only necessary to install the **Replication** samples.</span></span> <span data-ttu-id="6fab8-177">(Der Standard Installationspfad lautet " \*\*c:\Programme (x86) \Microsoft SQL Server 2000 samples\1033 \\ \*\*)".</span><span class="sxs-lookup"><span data-stu-id="6fab8-177">(The default installation path is **C:\Program Files (x86)\Microsoft SQL Server 2000 Samples\1033\\**)</span></span>  
  
4.  <span data-ttu-id="6fab8-178">Wechseln Sie zum Installationsordner.</span><span class="sxs-lookup"><span data-stu-id="6fab8-178">Go to installation folder.</span></span> <span data-ttu-id="6fab8-179">(Der Standardordner ist **C:\Programme (x86)\Microsoft SQL Server 2000 Samples\1033\sqlrepl\unzip_sqlreplSP3.exe**)</span><span class="sxs-lookup"><span data-stu-id="6fab8-179">(The default folder is **C:\Program Files (x86)\Microsoft SQL Server 2000 Samples\1033\sqlrepl\unzip_sqlreplSP3.exe**)</span></span>  
  
5.  <span data-ttu-id="6fab8-180">Führen Sie das Programm **unzip_sqlreplSP3.exe** aus.</span><span class="sxs-lookup"><span data-stu-id="6fab8-180">Run the **unzip_sqlreplSP3.exe** program.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6fab8-181">Der Beispielkonfliktlöser wird (standardmäßig) im Ordner **C:\Programme (x86)\Microsoft SQL Server 2000 Samples\1033\sqlrepl\resolver\subspres** installiert.</span><span class="sxs-lookup"><span data-stu-id="6fab8-181">The sample com resolver will install (by default) to the **C:\Program Files (x86)\Microsoft SQL Server 2000 Samples\1033\sqlrepl\resolver\subspres** folder.</span></span>  
  
6.  <span data-ttu-id="6fab8-182">Suchen Sie im Ordner **subspres** alle Vorkommen von **#include sqlres.h** in allen Quelldateien, und ersetzen Sie sie durch **#import "replrec.dll" no_namespace, raw_interfaces_only**.</span><span class="sxs-lookup"><span data-stu-id="6fab8-182">In the **subspres** folder, find all occurrences of **#include sqlres.h** in all of the source files and replace them with **#import "replrec.dll" no_namespace, raw_interfaces_only**</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6fab8-183">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="6fab8-183">See Also</span></span>  
 <span data-ttu-id="6fab8-184">[Erweiterte Konflikterkennung und -lösung der Mergereplikation](merge/advanced-merge-replication-conflict-detection-and-resolution.md) </span><span class="sxs-lookup"><span data-stu-id="6fab8-184">[Advanced Merge Replication Conflict Detection and Resolution](merge/advanced-merge-replication-conflict-detection-and-resolution.md) </span></span>  
 <span data-ttu-id="6fab8-185">[COM-basierte benutzerdefinierte Konflikt Löser](merge/advanced-merge-replication-conflict-com-based-custom-resolvers.md) </span><span class="sxs-lookup"><span data-stu-id="6fab8-185">[COM-Based Custom Resolvers](merge/advanced-merge-replication-conflict-com-based-custom-resolvers.md) </span></span>  
 [<span data-ttu-id="6fab8-186">Bewährte Methoden für die Replikationssicherheit</span><span class="sxs-lookup"><span data-stu-id="6fab8-186">Replication Security Best Practices</span></span>](security/replication-security-best-practices.md)  
  
  

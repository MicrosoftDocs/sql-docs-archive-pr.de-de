---
title: Sichern des Momentaufnahmeordners | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- snapshots [SQL Server replication], security
ms.assetid: 3cd877d1-ffb8-48fd-a72b-98eb948aad27
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c977936ad2aca6e5a98ee685a15662a00b625494
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87620270"
---
# <a name="secure-the-snapshot-folder"></a><span data-ttu-id="b33b6-102">Sichern des Momentaufnahmeordners</span><span class="sxs-lookup"><span data-stu-id="b33b6-102">Secure the Snapshot Folder</span></span>
  <span data-ttu-id="b33b6-103">Der Momentaufnahmeordner ist ein Verzeichnis, in dem Momentaufnahmedateien gespeichert werden. Es empfiehlt sich, dieses Verzeichnis zum Speichern von Momentaufnahmen zu reservieren.</span><span class="sxs-lookup"><span data-stu-id="b33b6-103">The snapshot folder is a directory that stores snapshot files; it is recommended that you dedicate the directory for snapshot storage.</span></span> <span data-ttu-id="b33b6-104">Gewähren Sie dem Momentaufnahme-Agent Schreibzugriff auf den Ordner, und stellen Sie sicher, dass nur das Windows-Konto Leseberechtigung erhält, das der Merge-Agent bzw. der Verteilungs-Agent für den Zugriff auf den Ordner verwendet.</span><span class="sxs-lookup"><span data-stu-id="b33b6-104">Grant the Snapshot Agent write permission to the folder, and ensure that read permission is granted only to the Windows account that the Merge Agent or Distribution agent uses when accessing the folder.</span></span> <span data-ttu-id="b33b6-105">Das dem Agent zugeordnete Windows-Konto muss ein Domänenkonto sein, damit auf den Momentaufnahmeordner zugegriffen werden kann, der sich auf einem Remotecomputer befindet.</span><span class="sxs-lookup"><span data-stu-id="b33b6-105">The Windows account associated with the agent must be a domain account to access a snapshot folder that is located on a remote computer.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="b33b6-106">Die Benutzerkontensteuerung (User Account Control, UAC) unterstützt Administratoren bei der Verwaltung erhöhter Benutzerrechte (auch *Privilegien*genannt).</span><span class="sxs-lookup"><span data-stu-id="b33b6-106">User Account Control (UAC)  helps administrators manage their elevated user rights (sometimes called *privileges*).</span></span> <span data-ttu-id="b33b6-107">Bei der Ausführung unter Betriebssystemen mit aktivierter Benutzerkontensteuerung nutzen Administratoren keine Administratorrechte.</span><span class="sxs-lookup"><span data-stu-id="b33b6-107">When running on operating systems that have UAC enabled, administrators do not use their administrative rights.</span></span> <span data-ttu-id="b33b6-108">Sie führen stattdessen die meisten Aktionen als Standardbenutzer (nicht als Administrator) aus und nehmen ihre Administratorrechte nur bei Bedarf vorübergehend in Anspruch.</span><span class="sxs-lookup"><span data-stu-id="b33b6-108">Instead, they perform most actions as standard (non-administrative) users, temporarily assuming their administrative rights only when it is required.</span></span> <span data-ttu-id="b33b6-109">Durch die Benutzerkontensteuerung wird möglicherweise der Administratorzugriff auf die Momentaufnahmefreigabe verhindert.</span><span class="sxs-lookup"><span data-stu-id="b33b6-109">UAC can prevent administrative access to the snapshot share.</span></span> <span data-ttu-id="b33b6-110">Sie müssen daher den vom Momentaufnahme-Agent, Verteilungs-Agent und Merge-Agent verwendeten Windows-Konten explizit Berechtigungen für die Momentaufnahmefreigabe erteilen.</span><span class="sxs-lookup"><span data-stu-id="b33b6-110">You must therefore explicitly grant snapshot share permissions to the Windows accounts that are used by the Snapshot Agent, Distribution Agent, and Merge Agent.</span></span> <span data-ttu-id="b33b6-111">Dies ist auch dann erforderlich, wenn die Windows-Konten Mitglieder der Administratorengruppe sind.</span><span class="sxs-lookup"><span data-stu-id="b33b6-111">You must do this even if the Windows accounts are members of the Administrators group.</span></span>  
  
 <span data-ttu-id="b33b6-112">Wenn Sie mit dem Verteilungskonfigurations-Assistenten oder mit dem Assistenten für neue Veröffentlichung einen Verteiler konfigurieren, wird als Momentaufnahmeordner standardmäßig dieses lokale Verzeichnis verwendet: X:\Programme\Microsoft SQL Server\\ *\<instance>* \MSSQL\ReplData.</span><span class="sxs-lookup"><span data-stu-id="b33b6-112">When configuring a Distributor through the Configure Distribution Wizard or the New Publication Wizard, the snapshot folder defaults to a local path: X:\Program Files\Microsoft SQL Server\\*\<instance>* \MSSQL\ReplData.</span></span> <span data-ttu-id="b33b6-113">Wenn Sie einen Remoteverteiler oder Pullabonnements verwenden, müssen Sie eine UNC-Netzwerkfreigabe (z.B. \\\\<*Computername>* \Momentaufnahme) anstelle eines lokalen Pfads angeben.</span><span class="sxs-lookup"><span data-stu-id="b33b6-113">If you are using a remote Distributor or pull subscriptions, you must specify a UNC network share (such as \\\\<*computername>* \snapshot) rather than a local path.</span></span>  
  
 <span data-ttu-id="b33b6-114">Wenn Sie Zugriffsberechtigungen für den Momentaufnahmeordner erteilen, müssen Sie sie entsprechend der Zugriffsweise für den Ordner festlegen.</span><span class="sxs-lookup"><span data-stu-id="b33b6-114">When granting permissions to access the snapshot folder, you must grant them according to the way in which the folder is accessed.</span></span> <span data-ttu-id="b33b6-115">Unter [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows 2003 werden die folgenden Registerkarten des Dialogfelds verwendet:</span><span class="sxs-lookup"><span data-stu-id="b33b6-115">The following dialog box tabs are used in [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows 2003:</span></span>  
  
-   <span data-ttu-id="b33b6-116">Beim Angeben eines lokalen Pfads erteilen Sie die Berechtigungen für den Ordner im Dialogfeld **Eigenschaften** über die Registerkarte **Sicherheit** .</span><span class="sxs-lookup"><span data-stu-id="b33b6-116">If you specify a local path, grant permissions through the **Security** tab of the **Properties** dialog box for the folder.</span></span>  
  
-   <span data-ttu-id="b33b6-117">Beim Angeben einer Netzwerkfreigabe erteilen Sie die Berechtigungen für den Ordner im Dialogfeld **Eigenschaften** über die Registerkarte **Freigabe** .</span><span class="sxs-lookup"><span data-stu-id="b33b6-117">If you specify a network share, grant permissions through the **Sharing** tab of the **Properties** dialog box for the folder.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b33b6-118">Wenn der Replikations-Agent auf dem Verteiler ausgeführt wird, verwenden Sie im Dialogfeld **Eigenschaften** die Registerkarte **Sicherheit** für den Ordner, um dem Windows-Konto, unter dem der Agent ausgeführt wird, die Berechtigungen zu erteilen.</span><span class="sxs-lookup"><span data-stu-id="b33b6-118">If the replication agent runs on the Distributor, use the **Security** tab of the **Properties** dialog box for the folder to grant permissions to the Windows account used to run the agent.</span></span> <span data-ttu-id="b33b6-119">Führen Sie diesen Vorgang auch bei Verwendung einer Netzwerkfreigabe aus.</span><span class="sxs-lookup"><span data-stu-id="b33b6-119">Do this even when a network share is used.</span></span> <span data-ttu-id="b33b6-120">Dies gilt für den Merge-Agent und den Verteilungs-Agent bei einem Pushabonnement und für den Momentaufnahme-Agent, wenn sich der Verleger und der Verteiler auf demselben Computer befinden.</span><span class="sxs-lookup"><span data-stu-id="b33b6-120">This applies to the Merge Agent and Distribution Agent for a push subscription and to the Snapshot Agent when the Publisher and Distributor are on the same computer.</span></span>  
  
 <span data-ttu-id="b33b6-121">Weitere Informationen zum Festlegen der Berechtigungen für lokale Pfade und Netzwerkfreigaben finden Sie in der Windows-Dokumentation.</span><span class="sxs-lookup"><span data-stu-id="b33b6-121">For more information about setting permissions for local paths and network shares, see the Windows documentation.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="b33b6-122">Wenn eine Veröffentlichung gelöscht wird, wird bei der Replikation versucht, den Momentaufnahmeordner im Sicherheitskontext des Kontos für den [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] -Dienst zu entfernen.</span><span class="sxs-lookup"><span data-stu-id="b33b6-122">If a publication is dropped, replication attempts to remove the snapshot folder under the security context of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service account.</span></span> <span data-ttu-id="b33b6-123">Falls dieses Konto nicht über ausreichende Berechtigungen verfügt, melden Sie sich mit einem anderen Konto mit ausreichenden Berechtigungen an, und entfernen Sie den Ordner manuell.</span><span class="sxs-lookup"><span data-stu-id="b33b6-123">If this account does not have sufficient privileges, log in with an account that does have sufficient privileges and remove the folder manually.</span></span> <span data-ttu-id="b33b6-124">Zum Entfernen eines Ordners ist die Berechtigung **Ändern** erforderlich, wenn es sich um einen lokalen Pfad handelt. Wenn es sich bei dem Ordner um einen Netzwerkpfad handelt, ist die Berechtigung **Vollzugriff** erforderlich.</span><span class="sxs-lookup"><span data-stu-id="b33b6-124">Removing a folder requires the **Modify** privilege if the folder is a local path or the **Full Control** privilege if the folder is a network path.</span></span>  
  
## <a name="delivering-snapshots-through-ftp"></a><span data-ttu-id="b33b6-125">Übermitteln von Momentaufnahmen über FTP</span><span class="sxs-lookup"><span data-stu-id="b33b6-125">Delivering Snapshots Through FTP</span></span>  
 <span data-ttu-id="b33b6-126">Als bewährte Sicherheitsmethode empfiehlt es sich, Momentaufnahmen in einer UNC-Freigabe zu speichern, sie können jedoch auch in einer FTP-Freigabe gespeichert und anschließend über FTP an einen Abonnenten übermittelt werden.</span><span class="sxs-lookup"><span data-stu-id="b33b6-126">It is recommended as a security best practice that snapshots be stored in a UNC share, but snapshots can be stored in an FTP share and then delivered to a Subscriber through FTP.</span></span> <span data-ttu-id="b33b6-127">Stellen Sie bei der Konfiguration des FTP-Servers sicher, dass das virtuelle Verzeichnis eine zugrunde liegende UNC-Freigabe verfügbar macht, die dem Momentaufnahme-Agent Schreibzugriff auf die Veröffentlichung gewährt.</span><span class="sxs-lookup"><span data-stu-id="b33b6-127">When configuring the FTP server, ensure that the virtual directory exposes an underlying UNC share that permits write access by the Snapshot Agent for the publication.</span></span>  
  
 <span data-ttu-id="b33b6-128">Um einen Abonnenten so zu konfigurieren, dass er die Momentaufnahme über FTP abruft, richten Sie zuerst einen FTP-Server mit einem FTP-Benutzernamen und -Kennwort ein, der den Abonnenten Lese-(bzw. "abrufen"-)Zugriff zum Herunterladen der Momentaufnahmedateien gewährt.</span><span class="sxs-lookup"><span data-stu-id="b33b6-128">To configure a Subscriber to retrieve the Snapshot via FTP, first set up an FTP server with an FTP login and password that allows Subscribers read (or "get") access to allow the snapshot files to be downloaded.</span></span>  
  
 <span data-ttu-id="b33b6-129">Informationen zum Übermitteln einer Momentaufnahme über FTP finden Sie unter [Übermitteln einer Momentaufnahme über FTP](../publish/deliver-a-snapshot-through-ftp.md).</span><span class="sxs-lookup"><span data-stu-id="b33b6-129">To deliver snapshots through FTP, see [Deliver a Snapshot Through FTP](../publish/deliver-a-snapshot-through-ftp.md).</span></span>  
  
 <span data-ttu-id="b33b6-130">Informationen zum Festlegen und Ändern des Kennworts für den Zugriff auf Momentaufnahmen über FTP finden Sie im Abschnitt "Momentaufnahmeübermittlung per FTP" im Thema [Secure the Publisher](secure-the-publisher.md).</span><span class="sxs-lookup"><span data-stu-id="b33b6-130">For information about setting and changing the password for access to snapshots through FTP, see the section "FTP Snapshot Delivery" in the topic [Secure the Publisher](secure-the-publisher.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b33b6-131">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="b33b6-131">See Also</span></span>  
 <span data-ttu-id="b33b6-132">[Alternative Speicherorte für Momentaufnahme Ordner](../alternate-snapshot-folder-locations.md) </span><span class="sxs-lookup"><span data-stu-id="b33b6-132">[Alternate Snapshot Folder Locations](../alternate-snapshot-folder-locations.md) </span></span>  
 <span data-ttu-id="b33b6-133">[Initialisieren eines Abonnements mit einer Momentaufnahme](../initialize-a-subscription-with-a-snapshot.md) </span><span class="sxs-lookup"><span data-stu-id="b33b6-133">[Initialize a Subscription with a Snapshot](../initialize-a-subscription-with-a-snapshot.md) </span></span>  
 <span data-ttu-id="b33b6-134">[Replication Security Best Practices](replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="b33b6-134">[Replication Security Best Practices](replication-security-best-practices.md) </span></span>  
 <span data-ttu-id="b33b6-135">[SQL Server-Replikation Sicherheit](view-and-modify-replication-security-settings.md) </span><span class="sxs-lookup"><span data-stu-id="b33b6-135">[SQL Server Replication Security](view-and-modify-replication-security-settings.md) </span></span>  
 [<span data-ttu-id="b33b6-136">Übertragen von Momentaufnahmen über FTP</span><span class="sxs-lookup"><span data-stu-id="b33b6-136">Transfer Snapshots Through FTP</span></span>](../transfer-snapshots-through-ftp.md)  
  
  

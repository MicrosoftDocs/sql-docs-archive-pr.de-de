---
title: Implementieren eines Geschäftslogikhandlers für einen Mergeartikel | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- merge replication conflict resolution [SQL Server replication], business logic handlers
- merge replication business logic handlers [SQL Server replication]
- conflict resolution [SQL Server replication], merge replication
- business logic handlers [SQL Server replication]
- BusinessLogicModule class
ms.assetid: ed477595-6d46-4fa2-b0d3-a5358903ec05
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c2996a8ca8471ef59d4781e21239a72262daa759
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87609087"
---
# <a name="implement-a-business-logic-handler-for-a-merge-article"></a><span data-ttu-id="9f34f-102">Implementieren eines Geschäftslogikhandlers für einen Mergeartikel</span><span class="sxs-lookup"><span data-stu-id="9f34f-102">Implement a Business Logic Handler for a Merge Article</span></span>
  <span data-ttu-id="9f34f-103">In diesem Thema wird beschrieben, wie ein Geschäftslogikhandler für einen Mergeartikel mit Replikationsprogrammierung oder Replikationsverwaltungsobjekten (RMO) in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="9f34f-103">This topic describes how to implement a business logic handler for a merge article in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using replication programming or Replication Management Objects (RMO).</span></span>  
  
 <span data-ttu-id="9f34f-104">Der <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> -Namespace implementiert eine Schnittstelle, mit der Sie eine komplexe Geschäftslogik zum Verarbeiten von Ereignissen schreiben können, die während der Synchronisierung der Mergereplikation eintreten.</span><span class="sxs-lookup"><span data-stu-id="9f34f-104">The <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> namespace implements an interface that enables you to write complex business logic to handle events that occur during the merge replication synchronization process.</span></span> <span data-ttu-id="9f34f-105">Die Methoden im Geschäftslogikhandler können vom Replikationsvorgang für jede geänderte Zeile aufgerufen werden, die während der Synchronisierung repliziert wird.</span><span class="sxs-lookup"><span data-stu-id="9f34f-105">Methods in the business logic handler can be invoked by the replication process for each changed row that is replicated during synchronization.</span></span>  
  
 <span data-ttu-id="9f34f-106">Der allgemeine Vorgang zum Implementieren eines Geschäftslogikhandlers ist Folgender:</span><span class="sxs-lookup"><span data-stu-id="9f34f-106">The general process for implementing a business logic handler is:</span></span>  
  
1.  <span data-ttu-id="9f34f-107">Erstellen Sie die Geschäftslogikhandler-Assembly.</span><span class="sxs-lookup"><span data-stu-id="9f34f-107">Create the business logic hander assembly.</span></span>  
  
2.  <span data-ttu-id="9f34f-108">Registrieren Sie die Assembly beim Verteiler.</span><span class="sxs-lookup"><span data-stu-id="9f34f-108">Register the assembly at the Distributor.</span></span>  
  
3.  <span data-ttu-id="9f34f-109">Stellen Sie die Assembly auf dem Server bereit, auf dem der Merge-Agent ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="9f34f-109">Deploy the assembly at the server on which the Merge Agent runs.</span></span> <span data-ttu-id="9f34f-110">Für ein Pullabonnement wird der Agent auf dem Abonnenten ausgeführt, und für ein Pushabonnement wird der Agent auf dem Verteiler ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="9f34f-110">For a pull subscription the agent runs on the Subscriber, and for a push subscription the agent runs on the Distributor.</span></span> <span data-ttu-id="9f34f-111">Wenn Sie die Websynchronisierung verwenden, wird der Agent auf dem Webserver ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="9f34f-111">When you are using Web synchronization, the agent runs on the Web server.</span></span>  
  
4.  <span data-ttu-id="9f34f-112">Erstellen Sie einen Artikel, der den Geschäftslogikhandler verwendet, oder ändern Sie einen vorhandenen Artikel so, dass er den Geschäftslogikhandler verwendet.</span><span class="sxs-lookup"><span data-stu-id="9f34f-112">Create an article that uses the business logic handler or modify an existing article to use the business logic handler.</span></span>  
  
 <span data-ttu-id="9f34f-113">Der von Ihnen angegebene Geschäftslogikhandler wird für jede Zeile ausgeführt, die synchronisiert wird.</span><span class="sxs-lookup"><span data-stu-id="9f34f-113">The business logic handler you specify is executed for every row that is synchronized.</span></span> <span data-ttu-id="9f34f-114">Eine komplexe Logik und Aufrufe anderer Anwendungen oder Netzwerkdienste können sich auf die Leistung auswirken.</span><span class="sxs-lookup"><span data-stu-id="9f34f-114">Complex logic and calls to other applications or network services can impact performance.</span></span> <span data-ttu-id="9f34f-115">Weitere Informationen zu Geschäftslogikhandlern finden Sie unter [Ausführen der Geschäftslogik während der Mergesynchronisierung](merge/execute-business-logic-during-merge-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="9f34f-115">For more information about business logic handlers, see [Execute Business Logic During Merge Synchronization](merge/execute-business-logic-during-merge-synchronization.md).</span></span>  
  
 <span data-ttu-id="9f34f-116">**In diesem Thema**</span><span class="sxs-lookup"><span data-stu-id="9f34f-116">**In This Topic**</span></span>  
  
-   <span data-ttu-id="9f34f-117">**So implementieren Sie einen Geschäftslogikhandler für einen Mergeartikel mit:**</span><span class="sxs-lookup"><span data-stu-id="9f34f-117">**To implement a business logic handler for a merge article, using:**</span></span>  
  
     [<span data-ttu-id="9f34f-118">Replikations Programmierung</span><span class="sxs-lookup"><span data-stu-id="9f34f-118">Replication Programming</span></span>](#ReplProg)  
  
     [<span data-ttu-id="9f34f-119">Replikationsverwaltungsobjekte (RMO)</span><span class="sxs-lookup"><span data-stu-id="9f34f-119">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
##  <a name="using-replication-programming"></a><a name="ReplProg"></a> <span data-ttu-id="9f34f-120">Verwenden der Replikationsprogrammierung</span><span class="sxs-lookup"><span data-stu-id="9f34f-120">Using Replication Programming</span></span>  
  
#### <a name="to-create-and-deploy-a-business-logic-handler"></a><span data-ttu-id="9f34f-121">So erstellen Sie einen Geschäftslogikhandler und stellen ihn bereit</span><span class="sxs-lookup"><span data-stu-id="9f34f-121">To create and deploy a business logic handler</span></span>  
  
1.  <span data-ttu-id="9f34f-122">Erstellen Sie in [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Studio ein neues Projekt für die .NET-Assembly mit dem Code, der den Geschäftslogikhandler implementiert.</span><span class="sxs-lookup"><span data-stu-id="9f34f-122">In [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Studio, create a new project for the .NET assembly that contains the code that implements the business logic handler.</span></span>  
  
2.  <span data-ttu-id="9f34f-123">Fügen Sie Verweise auf das Projekt für die folgenden Namespaces hinzu.</span><span class="sxs-lookup"><span data-stu-id="9f34f-123">Add references to the project for the following namespaces.</span></span>  
  
    |<span data-ttu-id="9f34f-124">Assemblyverweis</span><span class="sxs-lookup"><span data-stu-id="9f34f-124">Assembly Reference</span></span>|<span data-ttu-id="9f34f-125">Standort</span><span class="sxs-lookup"><span data-stu-id="9f34f-125">Location</span></span>|  
    |------------------------|--------------|  
    |<xref:Microsoft.SqlServer.Replication.BusinessLogicSupport>|[!INCLUDE[ssInstallPath](../../includes/ssinstallpath-md.md)]<span data-ttu-id="9f34f-126">COM (Standardinstallation)</span><span class="sxs-lookup"><span data-stu-id="9f34f-126">COM (default installation)</span></span>|  
    |<xref:System.Data>|<span data-ttu-id="9f34f-127">GAC (Komponente von .NET Framework)</span><span class="sxs-lookup"><span data-stu-id="9f34f-127">GAC (component of the .NET Framework)</span></span>|  
    |<xref:System.Data.Common>|<span data-ttu-id="9f34f-128">GAC (Komponente von .NET Framework)</span><span class="sxs-lookup"><span data-stu-id="9f34f-128">GAC (component of the .NET Framework)</span></span>|  
  
3.  <span data-ttu-id="9f34f-129">Fügen Sie eine Klasse hinzu, die die <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> -Klasse überschreibt.</span><span class="sxs-lookup"><span data-stu-id="9f34f-129">Add a class that overrides the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> class.</span></span>  
  
4.  <span data-ttu-id="9f34f-130">Implementieren Sie die <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.HandledChangeStates%2A> -Eigenschaft, um die Typen von Änderungen anzugeben, die verarbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="9f34f-130">Implement the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.HandledChangeStates%2A> property to indicate the types of changes that are handled.</span></span>  
  
5.  <span data-ttu-id="9f34f-131">Überschreiben Sie mindestens eine der folgenden Methoden der <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> -Klasse:</span><span class="sxs-lookup"><span data-stu-id="9f34f-131">Override one or more of the following methods of the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> class:</span></span>  
  
    -   <span data-ttu-id="9f34f-132"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.CommitHandler%2A> &ndash; wird aufgerufen, wenn während der Synchronisierung ein Commit für eine Datenänderung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="9f34f-132"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.CommitHandler%2A> - invoked when a data change is committed during synchronization.</span></span>  
  
    -   <span data-ttu-id="9f34f-133"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteErrorHandler%2A> &ndash; wird aufgerufen, wenn beim Hochladen oder Herunterladen einer DELETE-Anweisung ein Fehler auftritt.</span><span class="sxs-lookup"><span data-stu-id="9f34f-133"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteErrorHandler%2A> - invoked when an error occurs when a DELETE statement is being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="9f34f-134"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteHandler%2A> &ndash; wird aufgerufen, wenn DELETE-Anweisungen hochgeladen oder heruntergeladen werden.</span><span class="sxs-lookup"><span data-stu-id="9f34f-134"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteHandler%2A> - invoked when DELETE statements are being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="9f34f-135"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertErrorHandler%2A> &ndash; wird aufgerufen, wenn beim Hochladen oder Herunterladen einer INSERT-Anweisung ein Fehler auftritt.</span><span class="sxs-lookup"><span data-stu-id="9f34f-135"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertErrorHandler%2A> - invoked when an error occurs when an INSERT statement is being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="9f34f-136"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertHandler%2A> &ndash; wird aufgerufen, wenn INSERT-Anweisungen hochgeladen oder heruntergeladen werden.</span><span class="sxs-lookup"><span data-stu-id="9f34f-136"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertHandler%2A> - invoked when INSERT statements are being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="9f34f-137"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateConflictsHandler%2A> &ndash; wird aufgerufen, wenn in Konflikt stehende UPDATE-Anweisungen auf dem Verleger und dem Abonnenten auftreten.</span><span class="sxs-lookup"><span data-stu-id="9f34f-137"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateConflictsHandler%2A> - invoked when conflicting UPDATE statements occur at the Publisher and Subscriber.</span></span>  
  
    -   <span data-ttu-id="9f34f-138"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateDeleteConflictHandler%2A> &ndash; wird aufgerufen, wenn UPDATE-Anweisungen mit DELETE-Anweisungen auf dem Verleger und dem Abonnenten in Konflikt stehen.</span><span class="sxs-lookup"><span data-stu-id="9f34f-138"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateDeleteConflictHandler%2A> - invoked when UPDATE statements conflict with DELETE statements at the Publisher and Subscriber.</span></span>  
  
    -   <span data-ttu-id="9f34f-139"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateErrorHandler%2A> &ndash; wird aufgerufen, wenn beim Hochladen oder Herunterladen einer UPDATE-Anweisung ein Fehler auftritt.</span><span class="sxs-lookup"><span data-stu-id="9f34f-139"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateErrorHandler%2A> - invoked when an error occurs when an UPDATE statement is being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="9f34f-140"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateHandler%2A> &ndash; wird aufgerufen, wenn UPDATE-Anweisungen hochgeladen oder heruntergeladen werden.</span><span class="sxs-lookup"><span data-stu-id="9f34f-140"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateHandler%2A> - invoked when UPDATE statements are being uploaded or downloaded.</span></span>  
  
6.  <span data-ttu-id="9f34f-141">Erstellen Sie das Projekt, um die Geschäftslogikhandler-Assembly zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="9f34f-141">Build the project to create the business logic handler assembly.</span></span>  
  
7.  <span data-ttu-id="9f34f-142">Stellen Sie die Assembly in dem Verzeichnis mit der ausführbaren Datei für den Merge-Agent (replmerg.exe) bereit (bei der Standardinstallation ist dies [!INCLUDE[ssInstallPath](../../includes/ssinstallpath-md.md)]COM), oder installieren Sie sie im globalen Assemblycache (GAC) von .NET.</span><span class="sxs-lookup"><span data-stu-id="9f34f-142">Deploy the assembly in the directory that contains the Merge Agent executable file (replmerg.exe), which for a default installation is [!INCLUDE[ssInstallPath](../../includes/ssinstallpath-md.md)]COM, or install it in the .NET global assembly cache (GAC).</span></span> <span data-ttu-id="9f34f-143">Installieren Sie die Assembly nur dann im GAC, wenn andere Anwendungen als der Merge-Agent auf die Assembly zugreifen müssen.</span><span class="sxs-lookup"><span data-stu-id="9f34f-143">You should only install the assembly in the GAC if applications other than the Merge Agent require access to the assembly.</span></span> <span data-ttu-id="9f34f-144">Die Assembly kann mit dem im .NET Framework SDK bereitgestellten Global Assembly Cache-Tool (**Gacutil.exe** ) im GAC installiert werden.</span><span class="sxs-lookup"><span data-stu-id="9f34f-144">The assembly can be installed into the GAC using the Global Assembly Cache tool (**Gacutil.exe)** provided in the .NET Framework SDK.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="9f34f-145">Auf jedem Server, auf dem der Merge-Agent ausgeführt wird, muss ein Geschäftslogikhandler bereitgestellt werden. Dazu gehört auch der IIS-Server, der die Datei replisapi.dll hostet, wenn die Websynchronisierung verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="9f34f-145">A business logic handler must be deployed on every server on which the Merge Agent runs, which includes the IIS server that hosts the replisapi.dll when using Web synchronization.</span></span>  
  
#### <a name="to-register-a-business-logic-handler"></a><span data-ttu-id="9f34f-146">So registrieren Sie einen Geschäftslogikhandler</span><span class="sxs-lookup"><span data-stu-id="9f34f-146">To register a business logic handler</span></span>  
  
1.  <span data-ttu-id="9f34f-147">Führen Sie auf dem Verleger [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) aus, um zu prüfen, ob die Assembly noch nicht als Geschäftslogikhandler registriert wurde.</span><span class="sxs-lookup"><span data-stu-id="9f34f-147">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) to verify that the assembly has not already been registered as a business logic handler.</span></span>  
  
2.  <span data-ttu-id="9f34f-148">Führen Sie auf dem Verteiler [sp_registercustomresolver &#40;Transact-SQL-&#41;](/sql/relational-databases/system-stored-procedures/sp-registercustomresolver-transact-sql)aus, und geben Sie einen anzeigen Amen für den Geschäftslogik Handler für **@article_resolver** , den Wert für, `true` **@is_dotnet_assembly** den Namen der Assembly für **@dotnet_assembly_name** und den voll qualifizierten Namen der Klasse an, die für überschreibt <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> **@dotnet_class_name** .</span><span class="sxs-lookup"><span data-stu-id="9f34f-148">At the Distributor, execute [sp_registercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-registercustomresolver-transact-sql), specifying a friendly name for the business logic handler for **@article_resolver**, a value of `true` for **@is_dotnet_assembly**, the name of the assembly for **@dotnet_assembly_name**, and the fully-qualified name of the class that overrides <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> for **@dotnet_class_name**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="9f34f-149">Wenn die Assembly nicht im gleichen Verzeichnis wie die ausführbare Datei Merge-Agent bereitgestellt wird, im gleichen Verzeichnis wie die Anwendung, die die Merge-Agent synchron startet, oder im globalen Assemblycache (GAC), müssen Sie den vollständigen Pfad mit dem Assemblynamen für angeben **@dotnet_assembly_name** .</span><span class="sxs-lookup"><span data-stu-id="9f34f-149">If the assembly is not deployed in the same directory as the Merge Agent executable, in the same directory as the application that synchronously starts the Merge Agent, or in the global assembly cache (GAC), you need to specify the full path with the assembly name for **@dotnet_assembly_name**.</span></span> <span data-ttu-id="9f34f-150">Wenn Sie die Websynchronisierung verwenden, müssen Sie den Speicherort der Assembly auf dem Webserver angeben.</span><span class="sxs-lookup"><span data-stu-id="9f34f-150">When using Web synchronization, you must specify the location of assembly at the Web server.</span></span>  
  
#### <a name="to-use-a-business-logic-handler-with-a-new-table-article"></a><span data-ttu-id="9f34f-151">So verwenden Sie einen Geschäftslogikhandler mit einem neuen Tabellenartikel</span><span class="sxs-lookup"><span data-stu-id="9f34f-151">To use a business logic handler with a new table article</span></span>  
  
1.  <span data-ttu-id="9f34f-152">Führen Sie [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) aus, um einen Artikel zu definieren. Geben Sie dabei den Anzeigenamen des Geschäftslogikhandlers für **@article_resolver** an.</span><span class="sxs-lookup"><span data-stu-id="9f34f-152">Execute [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) to define an article, specifying the friendly name of the business logic handler for **@article_resolver**.</span></span> <span data-ttu-id="9f34f-153">Weitere Informationen finden Sie unter [Definieren eines Artikels](publish/define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="9f34f-153">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
#### <a name="to-use-a-business-logic-handler-with-an-existing-table-article"></a><span data-ttu-id="9f34f-154">So verwenden Sie einen Geschäftslogikhandler mit einem bestehenden Tabellenartikel</span><span class="sxs-lookup"><span data-stu-id="9f34f-154">To use a business logic handler with an existing table article</span></span>  
  
1.  <span data-ttu-id="9f34f-155">Führen Sie [sp_changemergearticle &#40;Transact-SQL-&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql)aus, und geben Sie, **@publication** , den **@article** Wert **article_resolver** für **@property** und den anzeigen amen des Geschäftslogik Handlers für an **@value** .</span><span class="sxs-lookup"><span data-stu-id="9f34f-155">Execute [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specifying **@publication**, **@article**, a value of **article_resolver** for **@property**, and the friendly name of the business logic handler for **@value**.</span></span>  
  
###  <a name="examples-replication-programming"></a><a name="TsqlExample"></a><span data-ttu-id="9f34f-156">Beispiele (Replikations Programmierung)</span><span class="sxs-lookup"><span data-stu-id="9f34f-156">Examples (Replication Programming)</span></span>  
 <span data-ttu-id="9f34f-157">In diesem Beispiel wird ein Geschäftslogikhandler gezeigt, der ein Überwachungsprotokoll erstellt.</span><span class="sxs-lookup"><span data-stu-id="9f34f-157">This example shows a business logic handler that creates an audit log.</span></span>  
  
 [!code-csharp[HowTo#rmo_BusinessLogicCode](../../snippets/csharp/SQL15/replication/howto/cs/businesslogic.cs#rmo_businesslogiccode)]  
  
 [!code-vb[HowTo#rmo_vb_BusinessLogicCode](../../snippets/visualbasic/SQL15/replication/howto/vb/businesslogic.vb#rmo_vb_businesslogiccode)]  
  
 <span data-ttu-id="9f34f-158">Das folgende Beispiel registriert eine Geschäftslogikhandler-Assembly auf dem Verteiler und ändert einen bestehenden Mergeartikel so, dass diese benutzerdefinierte Geschäftslogik verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="9f34f-158">The following example registers a business logic handler assembly at the Distributor and changes an existing merge article to use this custom business logic.</span></span>  
  
 [!code-sql[HowTo#sp_RegisterBLH_10](../../snippets/tsql/SQL15/replication/howto/tsql/registerblh_10.sql#sp_registerblh_10)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="9f34f-159">Verwenden von Replikationsverwaltungsobjekten (RMO)</span><span class="sxs-lookup"><span data-stu-id="9f34f-159">Using Replication Management Objects (RMO)</span></span>  
  
#### <a name="to-create-a-business-logic-handler"></a><span data-ttu-id="9f34f-160">So erstellen Sie einen Geschäftslogikhandler</span><span class="sxs-lookup"><span data-stu-id="9f34f-160">To create a business logic handler</span></span>  
  
1.  <span data-ttu-id="9f34f-161">Erstellen Sie in [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Studio ein neues Projekt für die .NET-Assembly mit dem Code, der den Geschäftslogikhandler implementiert.</span><span class="sxs-lookup"><span data-stu-id="9f34f-161">In [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Studio, create a new project for the .NET assembly that contains the code that implements the business logic handler.</span></span>  
  
2.  <span data-ttu-id="9f34f-162">Fügen Sie Verweise auf das Projekt für die folgenden Namespaces hinzu.</span><span class="sxs-lookup"><span data-stu-id="9f34f-162">Add references to the project for the following namespaces.</span></span>  
  
    |<span data-ttu-id="9f34f-163">Assemblyverweis</span><span class="sxs-lookup"><span data-stu-id="9f34f-163">Assembly Reference</span></span>|<span data-ttu-id="9f34f-164">Standort</span><span class="sxs-lookup"><span data-stu-id="9f34f-164">Location</span></span>|  
    |------------------------|--------------|  
    |<xref:Microsoft.SqlServer.Replication.BusinessLogicSupport>|[!INCLUDE[ssInstallPath](../../includes/ssinstallpath-md.md)]<span data-ttu-id="9f34f-165">COM (Standardinstallation)</span><span class="sxs-lookup"><span data-stu-id="9f34f-165">COM (default installation)</span></span>|  
    |<xref:System.Data>|<span data-ttu-id="9f34f-166">GAC (Komponente von .NET Framework)</span><span class="sxs-lookup"><span data-stu-id="9f34f-166">GAC (component of the .NET Framework)</span></span>|  
    |<xref:System.Data.Common>|<span data-ttu-id="9f34f-167">GAC (Komponente von .NET Framework)</span><span class="sxs-lookup"><span data-stu-id="9f34f-167">GAC (component of the .NET Framework)</span></span>|  
  
3.  <span data-ttu-id="9f34f-168">Fügen Sie eine Klasse hinzu, die die <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> -Klasse überschreibt.</span><span class="sxs-lookup"><span data-stu-id="9f34f-168">Add a class that overrides the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> class.</span></span>  
  
4.  <span data-ttu-id="9f34f-169">Implementieren Sie die <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.HandledChangeStates%2A> -Eigenschaft, um die Typen von Änderungen anzugeben, die verarbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="9f34f-169">Implement the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.HandledChangeStates%2A> property to indicate the types of changes that are handled.</span></span>  
  
5.  <span data-ttu-id="9f34f-170">Überschreiben Sie mindestens eine der folgenden Methoden der <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> -Klasse:</span><span class="sxs-lookup"><span data-stu-id="9f34f-170">Override one or more of the following methods of the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> class:</span></span>  
  
    -   <span data-ttu-id="9f34f-171"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.CommitHandler%2A> &ndash; wird aufgerufen, wenn während der Synchronisierung ein Commit für eine Datenänderung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="9f34f-171"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.CommitHandler%2A> - invoked when a data change is committed during synchronization.</span></span>  
  
    -   <span data-ttu-id="9f34f-172"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteErrorHandler%2A> &ndash; wird aufgerufen, wenn ein Fehler auftritt, während eine DELETE-Anweisung hochgeladen oder heruntergeladen wird.</span><span class="sxs-lookup"><span data-stu-id="9f34f-172"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteErrorHandler%2A> - invoked if an error occurs while a DELETE statement is being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="9f34f-173"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteHandler%2A> &ndash; wird aufgerufen, wenn DELETE-Anweisungen hochgeladen oder heruntergeladen werden.</span><span class="sxs-lookup"><span data-stu-id="9f34f-173"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteHandler%2A> - invoked when DELETE statements are being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="9f34f-174"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertErrorHandler%2A> &ndash; wird aufgerufen, wenn ein Fehler auftritt, während eine INSERT-Anweisung hochgeladen oder heruntergeladen wird.</span><span class="sxs-lookup"><span data-stu-id="9f34f-174"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertErrorHandler%2A> - invoked if an error occurs when an INSERT statement is being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="9f34f-175"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertHandler%2A> &ndash; wird aufgerufen, wenn INSERT-Anweisungen hochgeladen oder heruntergeladen werden.</span><span class="sxs-lookup"><span data-stu-id="9f34f-175"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertHandler%2A> - invoked when INSERT statements are being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="9f34f-176"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateConflictsHandler%2A> &ndash; wird aufgerufen, wenn in Konflikt stehende UPDATE-Anweisungen auf dem Verleger und dem Abonnenten auftreten.</span><span class="sxs-lookup"><span data-stu-id="9f34f-176"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateConflictsHandler%2A> - invoked when conflicting UPDATE statements occur at the Publisher and Subscriber.</span></span>  
  
    -   <span data-ttu-id="9f34f-177"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateDeleteConflictHandler%2A> &ndash; wird aufgerufen, wenn UPDATE-Anweisungen mit DELETE-Anweisungen auf dem Verleger und dem Abonnenten in Konflikt stehen.</span><span class="sxs-lookup"><span data-stu-id="9f34f-177"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateDeleteConflictHandler%2A> - invoked when UPDATE statements conflict with DELETE statements at the Publisher and Subscriber.</span></span>  
  
    -   <span data-ttu-id="9f34f-178"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateErrorHandler%2A> &ndash; wird aufgerufen, wenn ein Fehler auftritt, während eine UPDATE-Anweisung hochgeladen oder heruntergeladen wird.</span><span class="sxs-lookup"><span data-stu-id="9f34f-178"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateErrorHandler%2A> - invoked if an error occurs when an UPDATE statement is being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="9f34f-179"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateHandler%2A> &ndash; wird aufgerufen, wenn UPDATE-Anweisungen hochgeladen oder heruntergeladen werden.</span><span class="sxs-lookup"><span data-stu-id="9f34f-179"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateHandler%2A> - invoked when UPDATE statements are being uploaded or downloaded.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="9f34f-180">Alle Artikelkonflikte, die nicht explizit von Ihrem benutzerdefinierten Geschäftslogikhandler verarbeitet werden, werden vom Standardkonfliktlöser für den Artikel bearbeitet.</span><span class="sxs-lookup"><span data-stu-id="9f34f-180">Any article conflicts not explicitly handled by your custom business logic are handled by the default resolver for the article.</span></span>  
  
6.  <span data-ttu-id="9f34f-181">Erstellen Sie das Projekt, um die Geschäftslogikhandler-Assembly zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="9f34f-181">Build the project to create the business logic handler assembly.</span></span>  
  
#### <a name="to-register-a-business-logic-handler"></a><span data-ttu-id="9f34f-182">So registrieren Sie einen Geschäftslogikhandler</span><span class="sxs-lookup"><span data-stu-id="9f34f-182">To register a business logic handler</span></span>  
  
1.  <span data-ttu-id="9f34f-183">Erstellen Sie eine Verbindung mit dem Verteiler, indem Sie die <xref:Microsoft.SqlServer.Management.Common.ServerConnection> -Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="9f34f-183">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="9f34f-184">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.ReplicationServer>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="9f34f-184">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationServer> class.</span></span> <span data-ttu-id="9f34f-185">Übergeben Sie <xref:Microsoft.SqlServer.Management.Common.ServerConnection> von Schritt 1.</span><span class="sxs-lookup"><span data-stu-id="9f34f-185">Pass the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
3.  <span data-ttu-id="9f34f-186">Rufen Sie <xref:Microsoft.SqlServer.Replication.ReplicationServer.EnumBusinessLogicHandlers%2A> auf, und überprüfen Sie das zurückgegebene <xref:System.Collections.ArrayList> -Objekt, um sicherzustellen, dass die Assembly noch nicht als Geschäftslogikhandler registriert wurde.</span><span class="sxs-lookup"><span data-stu-id="9f34f-186">Call <xref:Microsoft.SqlServer.Replication.ReplicationServer.EnumBusinessLogicHandlers%2A> and check the returned <xref:System.Collections.ArrayList> object to ensure that the assembly has not already been registered as a business logic handler.</span></span>  
  
4.  <span data-ttu-id="9f34f-187">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.BusinessLogicHandler>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="9f34f-187">Create an instance of the <xref:Microsoft.SqlServer.Replication.BusinessLogicHandler> class.</span></span> <span data-ttu-id="9f34f-188">Geben Sie die folgenden Eigenschaften an:</span><span class="sxs-lookup"><span data-stu-id="9f34f-188">Specify the following properties:</span></span>  
  
    -   <span data-ttu-id="9f34f-189"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.DotNetAssemblyName%2A> &ndash; der Name der .NET-Assembly.</span><span class="sxs-lookup"><span data-stu-id="9f34f-189"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.DotNetAssemblyName%2A> - the name of the .NET assembly.</span></span> <span data-ttu-id="9f34f-190">Sie müssen den vollständigen Pfad mit dem Assemblynamen angeben, falls die Assembly nicht im gleichen Verzeichnis wie die ausführbare Datei für den Merge-Agent, im gleichen Verzeichnis wie die Anwendung, mit der der Merge-Agent synchron gestartet wird, oder im GAC bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="9f34f-190">If the assembly is not deployed in the same directory as the Merge Agent executable, in the same directory as the application that synchronously starts the Merge Agent, or in the GAC, you must include the full path with the assembly name.</span></span> <span data-ttu-id="9f34f-191">Sie müssen den vollständigen Pfad mit dem Assemblynamen angeben, wenn Sie einen Geschäftslogikhandler mit der Websynchronisierung verwenden.</span><span class="sxs-lookup"><span data-stu-id="9f34f-191">You must include the full path with the assembly name when using a business logic handler with Web synchronization.</span></span>  
  
    -   <span data-ttu-id="9f34f-192"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.DotNetClassName%2A> &ndash; der vollqualifizierte Name der Klasse, die <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> überschreibt und den Geschäftslogikhandler implementiert.</span><span class="sxs-lookup"><span data-stu-id="9f34f-192"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.DotNetClassName%2A> - the fully-qualified name of the class that overrides <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> and implements the business logic handler.</span></span>  
  
    -   <span data-ttu-id="9f34f-193"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.FriendlyName%2A> &ndash; ein Anzeigename, den Sie beim Zugriff auf den Geschäftslogikhandler verwenden.</span><span class="sxs-lookup"><span data-stu-id="9f34f-193"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.FriendlyName%2A> - a friendly name you use when you access the business logic handler.</span></span>  
  
    -   <span data-ttu-id="9f34f-194"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.IsDotNetAssembly%2A> &ndash; der Wert `true`.</span><span class="sxs-lookup"><span data-stu-id="9f34f-194"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.IsDotNetAssembly%2A> - a value of `true`.</span></span>  
  
#### <a name="to-deploy-a-business-logic-handler"></a><span data-ttu-id="9f34f-195">So stellen Sie einen Geschäftslogikhandler bereit</span><span class="sxs-lookup"><span data-stu-id="9f34f-195">To deploy a business logic handler</span></span>  
  
1.  <span data-ttu-id="9f34f-196">Stellen Sie die Assembly auf dem Server, auf dem der Merge-Agent ausgeführt wird, in dem Dateispeicherort bereit, der angegeben wurde, als der Geschäftslogikhandler beim Verteiler registriert wurde.</span><span class="sxs-lookup"><span data-stu-id="9f34f-196">Deploy the assembly on the server where the Merge Agent runs in the file location specified when the business logic handler was registered at the Distributor.</span></span> <span data-ttu-id="9f34f-197">Für ein Pullabonnement wird der Agent auf dem Abonnenten ausgeführt, und für ein Pushabonnement wird der Agent auf dem Verteiler ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="9f34f-197">For a pull subscription the agent runs on the Subscriber, and for a push subscription the agent runs on the Distributor.</span></span> <span data-ttu-id="9f34f-198">Wenn Sie die Websynchronisierung verwenden, wird der Agent auf dem Webserver ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="9f34f-198">When you are using Web synchronization, the agent runs on the Web server.</span></span> <span data-ttu-id="9f34f-199">Wenn der vollständige Pfad beim Registrieren des Geschäftslogikhandlers nicht zusammen mit dem Assemblynamen angegeben wurde, stellen Sie die Assembly im gleichen Verzeichnis wie die ausführbare Datei für den Merge-Agent, im gleichen Verzeichnis wie die Anwendung, mit der der Merge-Agent synchron gestartet wird, bereit.</span><span class="sxs-lookup"><span data-stu-id="9f34f-199">If the full path was not included with the assembly name when the business logic handler was registered, deploy the assembly in the same directory as the Merge Agent executable, in the same directory as the application that synchronously starts the Merge Agent.</span></span> <span data-ttu-id="9f34f-200">Sie können die Assembly im GAC installieren, wenn es mehrere Anwendungen gibt, die die gleiche Assembly verwenden.</span><span class="sxs-lookup"><span data-stu-id="9f34f-200">You may install the assembly in the GAC if there are multiple applications that use the same assembly.</span></span>  
  
#### <a name="to-use-a-business-logic-handler-with-a-new-table-article"></a><span data-ttu-id="9f34f-201">So verwenden Sie einen Geschäftslogikhandler mit einem neuen Tabellenartikel</span><span class="sxs-lookup"><span data-stu-id="9f34f-201">To use a business logic handler with a new table article</span></span>  
  
1.  <span data-ttu-id="9f34f-202">Erstellen Sie eine Verbindung mit dem Verleger, indem Sie die <xref:Microsoft.SqlServer.Management.Common.ServerConnection> -Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="9f34f-202">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="9f34f-203">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.MergeArticle>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="9f34f-203">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeArticle> class.</span></span> <span data-ttu-id="9f34f-204">Legen Sie die folgenden Eigenschaften fest:</span><span class="sxs-lookup"><span data-stu-id="9f34f-204">Set the following properties:</span></span>  
  
    -   <span data-ttu-id="9f34f-205">Den Namen des Artikels für <xref:Microsoft.SqlServer.Replication.Article.Name%2A></span><span class="sxs-lookup"><span data-stu-id="9f34f-205">The name of the article for <xref:Microsoft.SqlServer.Replication.Article.Name%2A>.</span></span>  
  
    -   <span data-ttu-id="9f34f-206">Den Namen der Veröffentlichung für <xref:Microsoft.SqlServer.Replication.Article.PublicationName%2A></span><span class="sxs-lookup"><span data-stu-id="9f34f-206">The name of the publication for <xref:Microsoft.SqlServer.Replication.Article.PublicationName%2A>.</span></span>  
  
    -   <span data-ttu-id="9f34f-207">Den Namen der Veröffentlichungsdatenbank für <xref:Microsoft.SqlServer.Replication.Article.DatabaseName%2A>.</span><span class="sxs-lookup"><span data-stu-id="9f34f-207">The name of the publication database for <xref:Microsoft.SqlServer.Replication.Article.DatabaseName%2A>.</span></span>  
  
    -   <span data-ttu-id="9f34f-208">Den Anzeigenamen des Geschäftslogikhandlers (<xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.FriendlyName%2A>) für <xref:Microsoft.SqlServer.Replication.MergeArticle.ArticleResolver%2A>.</span><span class="sxs-lookup"><span data-stu-id="9f34f-208">The friendly name of the business logic handler (<xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.FriendlyName%2A>) for <xref:Microsoft.SqlServer.Replication.MergeArticle.ArticleResolver%2A>.</span></span>  
  
3.  <span data-ttu-id="9f34f-209">Rufen Sie die <xref:Microsoft.SqlServer.Replication.Article.Create%2A> -Methode auf.</span><span class="sxs-lookup"><span data-stu-id="9f34f-209">Call the <xref:Microsoft.SqlServer.Replication.Article.Create%2A> method.</span></span> <span data-ttu-id="9f34f-210">Weitere Informationen finden Sie unter [Definieren eines Artikels](publish/define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="9f34f-210">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
#### <a name="to-use-a-business-logic-handler-with-an-existing-table-article"></a><span data-ttu-id="9f34f-211">So verwenden Sie einen Geschäftslogikhandler mit einem bestehenden Tabellenartikel</span><span class="sxs-lookup"><span data-stu-id="9f34f-211">To use a business logic handler with an existing table article</span></span>  
  
1.  <span data-ttu-id="9f34f-212">Erstellen Sie eine Verbindung mit dem Verleger, indem Sie die <xref:Microsoft.SqlServer.Management.Common.ServerConnection> -Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="9f34f-212">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="9f34f-213">Erstellen Sie eine Instanz der <xref:Microsoft.SqlServer.Replication.MergeArticle>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="9f34f-213">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeArticle> class.</span></span>  
  
3.  <span data-ttu-id="9f34f-214">Legen Sie die Eigenschaften <xref:Microsoft.SqlServer.Replication.Article.Name%2A>, <xref:Microsoft.SqlServer.Replication.Article.PublicationName%2A>und <xref:Microsoft.SqlServer.Replication.Article.DatabaseName%2A> fest.</span><span class="sxs-lookup"><span data-stu-id="9f34f-214">Set the <xref:Microsoft.SqlServer.Replication.Article.Name%2A>, <xref:Microsoft.SqlServer.Replication.Article.PublicationName%2A>, and <xref:Microsoft.SqlServer.Replication.Article.DatabaseName%2A> properties.</span></span>  
  
4.  <span data-ttu-id="9f34f-215">Legen Sie die Verbindung aus Schritt 1 für die <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> -Eigenschaft fest.</span><span class="sxs-lookup"><span data-stu-id="9f34f-215">Set the connection from step 1 for the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property.</span></span>  
  
5.  <span data-ttu-id="9f34f-216">Rufen Sie die <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> -Methode auf, um die Eigenschaften des Objekts abzurufen.</span><span class="sxs-lookup"><span data-stu-id="9f34f-216">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="9f34f-217">Wenn diese Methode `false` zurückgibt, wurden entweder die Artikeleigenschaften in Schritt 3 falsch definiert, oder der Artikel ist nicht vorhanden.</span><span class="sxs-lookup"><span data-stu-id="9f34f-217">If this method returns `false`, either the article properties in step 3 were defined incorrectly or the article does not exist.</span></span> <span data-ttu-id="9f34f-218">Weitere Informationen finden Sie unter [View and Modify Article Properties](publish/view-and-modify-article-properties.md).</span><span class="sxs-lookup"><span data-stu-id="9f34f-218">For more information, see [View and Modify Article Properties](publish/view-and-modify-article-properties.md).</span></span>  
  
6.  <span data-ttu-id="9f34f-219">Legen Sie den Anzeigenamen des Geschäftslogikhandlers für <xref:Microsoft.SqlServer.Replication.MergeArticle.ArticleResolver%2A>fest.</span><span class="sxs-lookup"><span data-stu-id="9f34f-219">Set the friendly name of the business logic handler for <xref:Microsoft.SqlServer.Replication.MergeArticle.ArticleResolver%2A>.</span></span> <span data-ttu-id="9f34f-220">Dies ist der Wert der <xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.FriendlyName%2A> -Eigenschaft, die beim Registrieren des Geschäftslogikhandlers angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="9f34f-220">This is the value of the <xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.FriendlyName%2A> property specified when registering the business logic handler.</span></span>  
  
###  <a name="examples-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="9f34f-221">Beispiele (RMO)</span><span class="sxs-lookup"><span data-stu-id="9f34f-221">Examples (RMO)</span></span>  
 <span data-ttu-id="9f34f-222">Dieses Beispiel zeigt einen Geschäftslogikhandler, der Informationen über Einfüge-, Update- und Löschvorgänge auf dem Abonnenten protokolliert.</span><span class="sxs-lookup"><span data-stu-id="9f34f-222">This example is a business logic handler that logs information about inserts, updates, and deletes at the Subscriber.</span></span>  
  
 [!code-csharp[HowTo#rmo_BusinessLogicCode](../../snippets/csharp/SQL15/replication/howto/cs/businesslogic.cs#rmo_businesslogiccode)]  
  
 [!code-vb[HowTo#rmo_vb_BusinessLogicCode](../../snippets/visualbasic/SQL15/replication/howto/vb/businesslogic.vb#rmo_vb_businesslogiccode)]  
  
 <span data-ttu-id="9f34f-223">In diesem Beispiel wird ein Geschäftslogikhandler beim Verteiler registriert.</span><span class="sxs-lookup"><span data-stu-id="9f34f-223">This example registers a business logic handler at the Distributor.</span></span>  
  
 [!code-csharp[HowTo#rmo_RegisterBLH_10](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_registerblh_10)]  
  
 [!code-vb[HowTo#rmo_vb_RegisterBLH_10](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_registerblh_10)]  
  
 <span data-ttu-id="9f34f-224">In diesem Beispiel wird ein vorhandener Artikel geändert, um den Geschäftslogikhandler zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="9f34f-224">This example changes an existing article to use the business logic handler.</span></span>  
  
 [!code-csharp[HowTo#rmo_ChangeMergeArticle_BLH](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_changemergearticle_blh)]  
  
 [!code-vb[HowTo#rmo_vb_ChangeMergeArticle_BLH](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_changemergearticle_blh)]  
  
## <a name="see-also"></a><span data-ttu-id="9f34f-225">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="9f34f-225">See Also</span></span>  
 <span data-ttu-id="9f34f-226">[Implementieren eines benutzerdefinierten Konflikt Lösers für einen Mergeartikel](implement-a-custom-conflict-resolver-for-a-merge-article.md) </span><span class="sxs-lookup"><span data-stu-id="9f34f-226">[Implement a Custom Conflict Resolver for a Merge Article](implement-a-custom-conflict-resolver-for-a-merge-article.md) </span></span>  
 <span data-ttu-id="9f34f-227">[Debuggen eines Geschäftslogik Handlers &#40;Replikations Programmierung&#41;](debug-a-business-logic-handler-replication-programming.md) </span><span class="sxs-lookup"><span data-stu-id="9f34f-227">[Debug a Business Logic Handler &#40;Replication Programming&#41;](debug-a-business-logic-handler-replication-programming.md) </span></span>  
 <span data-ttu-id="9f34f-228">[Replication Security Best Practices](security/replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="9f34f-228">[Replication Security Best Practices](security/replication-security-best-practices.md) </span></span>  
 [<span data-ttu-id="9f34f-229">Replication Management Objects Concepts</span><span class="sxs-lookup"><span data-stu-id="9f34f-229">Replication Management Objects Concepts</span></span>](concepts/replication-management-objects-concepts.md)  
  
  

---
title: Aktualisieren von Replikationsskripts (Replikationsprogrammierung mit Transact-SQL) | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- scripts [SQL Server replication], upgrading
- upgrading SQL Server, replicated databases
- upgrading replication applications
- replication [SQL Server], scripting
- replication [SQL Server], upgrading
- upgrading replicated databases
ms.assetid: 0b8720bd-f339-4842-bc8f-b35a46f6d3ee
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c47101c76ca2c585accd493b74f0e59c56bf009e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87615965"
---
# <a name="upgrade-replication-scripts-replication-transact-sql-programming"></a><span data-ttu-id="ca8e5-102">Aktualisieren von Replikationsskripts (Replikationsprogrammierung mit Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="ca8e5-102">Upgrade Replication Scripts (Replication Transact-SQL Programming)</span></span>
  <span data-ttu-id="ca8e5-103">Mithilfe von[!INCLUDE[tsql](../../../includes/tsql-md.md)] -Skriptdateien kann eine Replikationstopologie programmgesteuert konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-103">[!INCLUDE[tsql](../../../includes/tsql-md.md)] script files can be used to programmatically configure a replication topology.</span></span> <span data-ttu-id="ca8e5-104">Weitere Informationen finden Sie unter [Replikationskonzepte für gespeicherte Systemprozeduren](../concepts/replication-system-stored-procedures-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="ca8e5-104">For more information, see [Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="ca8e5-105">Skripts, die von Mitgliedern der `sysadmin`-Rolle ausgeführt werden, müssen nicht aktualisiert werden. Dennoch empfiehlt es sich, vorhandene Skripts wie in diesem Thema beschrieben zu ändern.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-105">Although you are not required to upgrade scripts that are executed by members of the `sysadmin` role, we recommend that you modify existing scripts as described in this topic.</span></span> <span data-ttu-id="ca8e5-106">Geben Sie ein Konto mit Mindestberechtigungen für jeden Replikations-Agent an, wie im Abschnitt zu den für die Agents erforderlichen Berechtigungen im Thema [Replication Agent Security Model](../security/replication-agent-security-model.md)beschrieben.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-106">Specify an account that has minimum permissions for each replication agent as described in the "Permissions Required By Agents" section of the topic [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
 <span data-ttu-id="ca8e5-107">Diese Sicherheitsverbesserungen, die Ihnen mehr Kontrolle über Berechtigungen bieten, indem Sie explizit die [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows-Konten angeben können, unter denen Replikations-Agentaufträge ausgeführt werden, wirken sich auf die folgenden gespeicherten Prozeduren in vorhandenen Skripts aus:</span><span class="sxs-lookup"><span data-stu-id="ca8e5-107">These security improvements, which enable more control over permissions by allowing you to explicitly specify the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows accounts under which replication agent jobs are executed, affect the following stored procedures in existing scripts:</span></span>  
  
-   <span data-ttu-id="ca8e5-108">**sp_addpublication_snapshot**:</span><span class="sxs-lookup"><span data-stu-id="ca8e5-108">**sp_addpublication_snapshot**:</span></span>  
  
     <span data-ttu-id="ca8e5-109">Sie sollten nun die Windows-Anmelde Informationen als **@job_login** und angeben **@job_password** , wenn Sie [sp_addpublication_snapshot &#40;Transact-SQL-&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) ausführen, um den Auftrag zu erstellen, unter dem der Momentaufnahmen-Agent auf dem Verteiler ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-109">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) to create the job under which the Snapshot Agent runs at the Distributor.</span></span>  
  
-   <span data-ttu-id="ca8e5-110">**sp_addpushsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="ca8e5-110">**sp_addpushsubscription_agent**:</span></span>  
  
     <span data-ttu-id="ca8e5-111">Sie sollten nun [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) ausführen, um explizit einen Auftrag hinzuzufügen, und die Windows-Anmeldeinformationen (**@job_login** und **@job_password**) anzugeben, unter denen der Auftrag des Verteilungs-Agents auf dem Verteiler ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-111">You should now execute [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) to explicitly add a job and supply the Windows credentials (**@job_login** and **@job_password**) under which the Distribution Agent job runs at the Distributor.</span></span> <span data-ttu-id="ca8e5-112">In Versionen von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] vor [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]wurde dieser Vorgang automatisch beim Erstellen eines Pushabonnements ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-112">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a push subscription was created.</span></span>  
  
-   <span data-ttu-id="ca8e5-113">**sp_addmergepushsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="ca8e5-113">**sp_addmergepushsubscription_agent**:</span></span>  
  
     <span data-ttu-id="ca8e5-114">Sie sollten nun [sp_addmergepushsubscription_agent &#40;Transact-SQL-&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) ausführen, um explizit einen Auftrag hinzuzufügen und die Windows-Anmelde Informationen ( **@job_login** und) anzugeben, **@job_password** unter denen der Merge-Agent Auftrag auf dem Verteiler ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-114">You should now execute [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) to explicitly add a job and supply the Windows credentials (**@job_login** and **@job_password**) under which the Merge Agent job runs at the Distributor.</span></span> <span data-ttu-id="ca8e5-115">In Versionen von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] vor [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]wurde dieser Vorgang automatisch beim Erstellen eines Pushabonnements ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-115">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a push subscription was created.</span></span>  
  
-   <span data-ttu-id="ca8e5-116">**sp_addpullsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="ca8e5-116">**sp_addpullsubscription_agent**:</span></span>  
  
     <span data-ttu-id="ca8e5-117">Sie sollten nun die Windows-Anmelde Informationen als **@job_login** und angeben **@job_password** , wenn Sie [sp_addpullsubscription_agent &#40;Transact-SQL-&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) ausführen, um den Auftrag zu erstellen, unter dem der Verteilungs-Agent auf dem Abonnenten ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-117">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) to create the job under which the Distribution Agent runs at the Subscriber.</span></span>  
  
-   <span data-ttu-id="ca8e5-118">**sp_addmergepullsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="ca8e5-118">**sp_addmergepullsubscription_agent**:</span></span>  
  
     <span data-ttu-id="ca8e5-119">Sie sollten nun die Windows-Anmelde Informationen als **@job_login** und angeben **@job_password** , wenn Sie [sp_addmergepullsubscription_agent &#40;Transact-SQL-&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) ausführen, um den Auftrag zu erstellen, unter dem der Merge-Agent auf dem Abonnenten ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-119">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) to create the job under which the Merge Agent runs at the Subscriber.</span></span>  
  
-   <span data-ttu-id="ca8e5-120">**sp_addlogreader_agent**:</span><span class="sxs-lookup"><span data-stu-id="ca8e5-120">**sp_addlogreader_agent**:</span></span>  
  
     <span data-ttu-id="ca8e5-121">Sie sollten nun [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) ausführen, um den Auftrag manuell hinzuzufügen, und die Windows-Anmeldeinformationen anzugeben, unter denen der Protokolllese-Agent auf dem Verteiler ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-121">You should now execute [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) to manually add the job and supply the Windows credentials under which the Log Reader Agent runs at the Distributor.</span></span> <span data-ttu-id="ca8e5-122">In Versionen von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] vor [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]wurde dieser Vorgang automatisch beim Erstellen einer Transaktionsveröffentlichung ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-122">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a transactional publication was created.</span></span>  
  
-   <span data-ttu-id="ca8e5-123">**sp_addqreader_agent**:</span><span class="sxs-lookup"><span data-stu-id="ca8e5-123">**sp_addqreader_agent**:</span></span>  
  
     <span data-ttu-id="ca8e5-124">Sie sollten nun [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) ausführen, um den Auftrag manuell hinzuzufügen, und die Windows-Anmeldeinformationen anzugeben, unter denen der Warteschlangenlese-Agent auf dem Verteiler ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-124">You should now execute [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) to manually add the job and supply the Windows credentials under which the Queue Reader Agent runs at the Distributor.</span></span> <span data-ttu-id="ca8e5-125">In Versionen von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] vor [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]wurde dieser Vorgang automatisch beim Erstellen einer Transaktionsveröffentlichung mit Unterstützung des verzögerten Aktualisierens ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-125">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a transactional publication that supported queued updating was created.</span></span>  
  
 <span data-ttu-id="ca8e5-126">In dem in eingeführten Sicherheitsmodell [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] stellen Replikations-Agents Verbindungen mit der lokalen Instanz von immer [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] mit der Windows-Authentifizierung her. dabei werden die in und angegebenen Anmelde Informationen verwendet **@job_name** **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="ca8e5-126">In the security model introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], replication agents always make connections to the local instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] with Windows Authentication using the credentials supplied in **@job_name** and **@job_password**.</span></span> <span data-ttu-id="ca8e5-127">Informationen zu den Anforderungen für beim Ausführen von Replikations-Agentaufträgen verwendeten Windows-Konten finden Sie unter [Replication Agent Security Model](../security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="ca8e5-127">For information about the requirements of Windows accounts used when running replication agent jobs, see [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="ca8e5-128">Benutzer sollten nach Möglichkeit dazu aufgefordert werden, Anmeldeinformationen zur Laufzeit anzugeben.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-128">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="ca8e5-129">Wenn Anmeldeinformationen in einer Skriptdatei gespeichert werden, müssen Sie sicherstellen, dass die Datei geschützt ist.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-129">If you store credentials in a script file, ensure that the file itself is secured.</span></span>  
  
### <a name="to-upgrade-scripts-that-configure-a-snapshot-or-transactional-publication"></a><span data-ttu-id="ca8e5-130">So aktualisieren Sie Skripts, mit denen eine Momentaufnahme- oder eine Transaktionsveröffentlichung konfiguriert werden</span><span class="sxs-lookup"><span data-stu-id="ca8e5-130">To upgrade scripts that configure a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="ca8e5-131">Führen Sie im vorhandenen Skript [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) vor [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) auf dem Verleger für die Veröffentlichungsdatenbank aus.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-131">In the existing script, before [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="ca8e5-132">Geben Sie die Windows-Anmelde Informationen an, unter denen die Protokolllese-Agent für und ausgeführt wird **@job_name** **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="ca8e5-132">Specify the Windows credentials under which the Log Reader Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="ca8e5-133">Wenn der Agent zum Herstellen der Verbindung mit dem Verleger die [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] -Authentifizierung verwendet, müssen Sie zudem den Wert **0** für **@publisher_security_mode** und die [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] -Anmeldeinformationen für **@publisher_login** und **@publisher_password**.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-133">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="ca8e5-134">Dadurch wird ein Auftrag des Protokolllese-Agents für die Veröffentlichungsdatenbank erstellt.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-134">This creates a Log Reader Agent job for the publication database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="ca8e5-135">Dieser Schritt muss nur bei Transaktionsveröffentlichungen, nicht bei Momentaufnahmeveröffentlichungen ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-135">This step is only for transactional publications and is not required for snapshot publications.</span></span>  
  
2.  <span data-ttu-id="ca8e5-136">(Optional) Führen Sie [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) vor [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) auf dem Verteiler für die Verteilungsdatenbank aus.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-136">(Optional) Before [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) at the Distributor on the distribution database.</span></span> <span data-ttu-id="ca8e5-137">Geben Sie die Windows-Anmelde Informationen an, unter denen die Warteschlangenlese-Agent für und ausgeführt wird **@job_name** **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="ca8e5-137">Specify the Windows credentials under which the Queue Reader Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="ca8e5-138">Dadurch wird ein Auftrag des Warteschlangenlese-Agents für den Verteiler erstellt.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-138">This creates a Queue Reader Agent job for the Distributor.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="ca8e5-139">Dieser Schritt muss nur bei Transaktionsveröffentlichungen ausgeführt werden, die Abonnenten mit verzögertem Update über eine Warteschlange unterstützen.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-139">This step is only required for transactional publications that support queued updating subscribers.</span></span>  
  
3.  <span data-ttu-id="ca8e5-140">(Optional) Aktualisieren Sie die Ausführung von [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), um alle Nichtstandardwerte für Parameter festzulegen, die neue Replikationsfunktionen implementieren.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-140">(Optional) Update the execution of [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
4.  <span data-ttu-id="ca8e5-141">Führen Sie nach [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql)[sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) auf dem Verleger für die Veröffentlichungsdatenbank aus.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-141">After [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="ca8e5-142">Geben Sie **@publication** und die Windows-Anmelde Informationen an, unter denen die Momentaufnahmen-Agent für und ausgeführt wird **@job_name** **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="ca8e5-142">Specify **@publication** and the Windows credentials under which the Snapshot Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="ca8e5-143">Wenn der Agent zum Herstellen der Verbindung mit dem Verleger die [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] -Authentifizierung verwendet, müssen Sie zudem den Wert **0** für **@publisher_security_mode** und die [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] -Anmeldeinformationen für **@publisher_login** und **@publisher_password**.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-143">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="ca8e5-144">Dadurch wird ein Auftrag des Momentaufnahme-Agents für die Veröffentlichung erstellt.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-144">This creates a Snapshot Agent job for the publication.</span></span>  
  
5.  <span data-ttu-id="ca8e5-145">(Optional) Aktualisieren Sie die Ausführung von [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql), um alle Nichtstandardwerte für Parameter festzulegen, die neue Replikationsfunktionen implementieren.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-145">(Optional) Update the execution of [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
### <a name="to-upgrade-scripts-that-add-subscriptions-to-a-snapshot-or-transactional-publication"></a><span data-ttu-id="ca8e5-146">So aktualisieren Sie Skripts, mit denen einer Momentaufnahme- oder Transaktionsveröffentlichung Abonnements hinzugefügt werden</span><span class="sxs-lookup"><span data-stu-id="ca8e5-146">To upgrade scripts that add subscriptions to a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="ca8e5-147">Nach dem Ausführen der gespeicherten Prozedur, mit der das Abonnement erstellt wird, müssen Sie die gespeicherte Prozedur ausführen, mit der der Auftrag des Verteilungs-Agents erstellt wird, damit das Abonnement synchronisiert wird.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-147">After executing the stored procedure that creates the subscription, ensure that you execute the stored procedure that creates a Distribution Agent job to synchronize the subscription.</span></span> <span data-ttu-id="ca8e5-148">Welche gespeicherte Prozedur Sie verwenden, hängt vom Typ des Abonnements ab.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-148">The stored procedure that you use will depend on the type of subscription.</span></span>  
  
    -   <span data-ttu-id="ca8e5-149">Aktualisieren Sie bei einem Pullabonnement die Ausführung von [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql), um die Windows-Anmeldeinformationen bereitzustellen, unter denen der Verteilungs-Agent auf dem Abonnenten für **@job_name** und **@job_password** ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-149">For a pull subscription, update the execution of [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) to supply the Windows credentials under which the Distribution Agent runs at the Subscriber for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="ca8e5-150">Dies geschieht nach der Ausführung von [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="ca8e5-150">This is done after the execution of [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span></span> <span data-ttu-id="ca8e5-151">Weitere Informationen finden Sie unter [Create a Pull Subscription](../create-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="ca8e5-151">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>  
  
    -   <span data-ttu-id="ca8e5-152">Führen Sie [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) für ein Pushabonnement auf dem Verleger aus.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-152">For a push subscription, execute [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) at the Publisher.</span></span> <span data-ttu-id="ca8e5-153">Geben Sie **@subscriber** , **@subscriber_db** ,, Windows-Anmelde Informationen, **@publication** unter denen die Verteilungs-Agent auf dem Verteiler für **@job_name** und ausgeführt **@job_password** wird, sowie einen Zeitplan für diesen Agentauftrag an.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-153">Specify **@subscriber**, **@subscriber_db**, **@publication**, Windows credentials under which the Distribution Agent runs at the Distributor for **@job_name** and **@job_password**, and a schedule for this agent job.</span></span> <span data-ttu-id="ca8e5-154">Weitere Informationen finden Sie unter [Angeben von Synchronisierungszeitplänen](../specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="ca8e5-154">For more information, see [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span></span> <span data-ttu-id="ca8e5-155">Dies geschieht nach der Ausführung von [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="ca8e5-155">This is done after the execution of [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="ca8e5-156">Weitere Informationen finden Sie unter [Create a Push Subscription](../create-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="ca8e5-156">For more information, see [Create a Push Subscription](../create-a-push-subscription.md).</span></span>  
  
### <a name="to-upgrade-scripts-that-configure-a-merge-publication"></a><span data-ttu-id="ca8e5-157">So aktualisieren Sie Skripts, mit denen eine Mergeveröffentlichung konfiguriert wird</span><span class="sxs-lookup"><span data-stu-id="ca8e5-157">To upgrade scripts that configure a merge publication</span></span>  
  
1.  <span data-ttu-id="ca8e5-158">(Optional) Aktualisieren Sie im vorhandenen Skript die Ausführung von [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql), um alle Nichtstandardwerte für Parameter festzulegen, die neue Replikationsfunktionen implementieren.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-158">(Optional) In the existing script, update the execution of [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
2.  <span data-ttu-id="ca8e5-159">Führen Sie nach [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql)[sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) auf dem Verleger für die Veröffentlichungsdatenbank aus.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-159">After [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql), execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="ca8e5-160">Geben Sie **@publication** und die Windows-Anmelde Informationen an, unter denen die Momentaufnahmen-Agent für und ausgeführt wird **@job_name** **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="ca8e5-160">Specify **@publication** and the Windows credentials under which the Snapshot Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="ca8e5-161">Wenn der Agent zum Herstellen der Verbindung mit dem Verleger die [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] -Authentifizierung verwendet, müssen Sie zudem den Wert **0** für **@publisher_security_mode** und die [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] -Anmeldeinformationen für **@publisher_login** und **@publisher_password**.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-161">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="ca8e5-162">Dadurch wird ein Auftrag des Momentaufnahme-Agents für die Veröffentlichung erstellt.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-162">This creates a Snapshot Agent job for the publication.</span></span>  
  
3.  <span data-ttu-id="ca8e5-163">(Optional) Aktualisieren Sie die Ausführung von [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql), um alle Nichtstandardwerte für Parameter festzulegen, die neue Replikationsfunktionen implementieren.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-163">(Optional) Update the execution of [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
### <a name="to-upgrade-scripts-that-add-subscriptions-to-a-merge-publication"></a><span data-ttu-id="ca8e5-164">So aktualisieren Sie Skripts, mit denen einer Mergeveröffentlichung Abonnements hinzugefügt werden</span><span class="sxs-lookup"><span data-stu-id="ca8e5-164">To upgrade scripts that add subscriptions to a merge publication</span></span>  
  
1.  <span data-ttu-id="ca8e5-165">Nach dem Ausführen der gespeicherten Prozedur, mit der das Abonnement erstellt wird, müssen Sie die gespeicherte Prozedur ausführen, mit der der Auftrag des Merge-Agents erstellt wird, damit das Abonnement synchronisiert wird.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-165">After executing the stored procedure that creates the subscription, ensure that you execute the stored procedure that creates a Merge Agent job to synchronize the subscription.</span></span> <span data-ttu-id="ca8e5-166">Welche gespeicherte Prozedur Sie verwenden, hängt vom Typ des Abonnements ab.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-166">The stored procedure that you use will depend on the type of subscription.</span></span>  
  
    -   <span data-ttu-id="ca8e5-167">Aktualisieren Sie bei einem Pullabonnement die Ausführung von [sp_addmergepullsubscription_agent &#40;Transact-SQL-&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) , um die Windows-Anmelde Informationen bereitzustellen, unter denen die Merge-Agent auf dem Abonnenten für und ausgeführt wird **@job_name** **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="ca8e5-167">For a pull subscription, update the execution of [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) to supply the Windows credentials under which the Merge Agent runs at the Subscriber for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="ca8e5-168">Dies geschieht nach der Ausführung von [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="ca8e5-168">This is done after the execution of [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span></span> <span data-ttu-id="ca8e5-169">Weitere Informationen finden Sie unter [Create a Pull Subscription](../create-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="ca8e5-169">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>  
  
    -   <span data-ttu-id="ca8e5-170">Führen Sie für ein Pushabonnement [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) auf dem Verleger aus.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-170">For a push subscription, execute [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) at the Publisher.</span></span> <span data-ttu-id="ca8e5-171">Geben Sie **@subscriber** , **@subscriber_db** , **@publication** , die Windows-Anmelde Informationen, unter denen die Merge-Agent auf dem Verteiler ausgeführt wird, für **@job_name** und **@job_password** und einen Zeitplan für diesen Agentauftrag an.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-171">Specify **@subscriber**, **@subscriber_db**, **@publication**, the Windows credentials under which the Merge Agent at the Distributor runs for **@job_name** and **@job_password**, and a schedule for this agent job.</span></span> <span data-ttu-id="ca8e5-172">Weitere Informationen finden Sie unter [Angeben von Synchronisierungszeitplänen](../specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="ca8e5-172">For more information, see [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span></span> <span data-ttu-id="ca8e5-173">Dies geschieht nach der Ausführung von [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="ca8e5-173">This is done after the execution of [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span></span> <span data-ttu-id="ca8e5-174">Weitere Informationen finden Sie unter [Create a Push Subscription](../create-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="ca8e5-174">For more information, see [Create a Push Subscription](../create-a-push-subscription.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="ca8e5-175">Beispiel</span><span class="sxs-lookup"><span data-stu-id="ca8e5-175">Example</span></span>  
 <span data-ttu-id="ca8e5-176">Im folgenden Beispiel wird ein [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] -Skript dargestellt, mit dem eine Transaktionsveröffentlichung für die Product-Tabelle erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-176">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a transactional publication for the Product table.</span></span> <span data-ttu-id="ca8e5-177">Diese Veröffentlichung unterstützt sofortige Updates mit Updates über eine Warteschlange als Failover.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-177">This publication supports immediate updating with queued updating as failover.</span></span> <span data-ttu-id="ca8e5-178">Standardparameter wurden zwecks besserer Lesbarkeit entfernt.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-178">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpub80.sql#sp_createtranpub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ca8e5-179">Beispiel</span><span class="sxs-lookup"><span data-stu-id="ca8e5-179">Example</span></span>  
 <span data-ttu-id="ca8e5-180">Im folgenden Beispiel wird die Aktualisierung des vorherigen Skripts dargestellt, mit dem eine Transaktionsveröffentlichung erstellt wird, damit es unter [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] und späteren Versionen erfolgreich ausgeführt werden kann.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-180">The following is an example of upgrading the previous script, which creates a transactional publication, to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="ca8e5-181">Diese Veröffentlichung unterstützt sofortige Updates mit Updates über eine Warteschlange als Failover.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-181">This publication supports immediate updating with queued updating as failover.</span></span> <span data-ttu-id="ca8e5-182">Standardwerte für neue Parameter wurden explizit deklariert.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-182">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ca8e5-183"> Windows-Anmeldeinformationen werden zur Laufzeit mithilfe von **sqlcmd** -Skriptvariablen angegeben.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-183">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpublication.sql#sp_createtranpub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ca8e5-184">Beispiel</span><span class="sxs-lookup"><span data-stu-id="ca8e5-184">Example</span></span>  
 <span data-ttu-id="ca8e5-185">Im folgenden Beispiel wird ein [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] -Skript dargestellt, mit dem eine Mergeveröffentlichung für die Customers-Tabelle erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-185">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a merge publication for the Customers table.</span></span> <span data-ttu-id="ca8e5-186">Standardparameter wurden zwecks besserer Lesbarkeit entfernt.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-186">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepub80.sql#sp_createmergepub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ca8e5-187">Beispiel</span><span class="sxs-lookup"><span data-stu-id="ca8e5-187">Example</span></span>  
 <span data-ttu-id="ca8e5-188">Im folgenden Beispiel wird das vorherige Skript dargestellt, mit dem eine Mergeveröffentlichung erstellt wird und das aktualisiert wurde, damit es unter [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] und späteren Versionen erfolgreich ausgeführt werden kann.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-188">The following is an example of the previous script, which creates a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="ca8e5-189">Standardwerte für neue Parameter wurden explizit deklariert.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-189">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ca8e5-190"> Windows-Anmeldeinformationen werden zur Laufzeit mithilfe von **sqlcmd** -Skriptvariablen angegeben.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-190">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepublication.sql#sp_createmergepub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ca8e5-191">Beispiel</span><span class="sxs-lookup"><span data-stu-id="ca8e5-191">Example</span></span>  
 <span data-ttu-id="ca8e5-192">Im folgenden Beispiel wird ein [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] -Skript dargestellt, mit dem ein Pushabonnement für eine Transaktionsveröffentlichung erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-192">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a push subscription to a transactional publication.</span></span> <span data-ttu-id="ca8e5-193">Standardparameter wurden zwecks besserer Lesbarkeit entfernt.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-193">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpushsub80.sql#sp_createtranpushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ca8e5-194">Beispiel</span><span class="sxs-lookup"><span data-stu-id="ca8e5-194">Example</span></span>  
 <span data-ttu-id="ca8e5-195">Im folgenden Beispiel wird die Aktualisierung des vorherigen Skripts dargestellt, mit dem ein Pushabonnement für eine Transaktionsveröffentlichung erstellt wird und das aktualisiert wurde, damit es unter [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] und späteren Versionen erfolgreich ausgeführt werden kann.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-195">The following is an example of the previous script, which creates a push subscription to a transactional publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="ca8e5-196">Standardwerte für neue Parameter wurden explizit deklariert.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-196">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ca8e5-197"> Windows-Anmeldeinformationen werden zur Laufzeit mithilfe von **sqlcmd** -Skriptvariablen angegeben.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-197">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpushsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpushsub.sql#sp_createtranpushsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ca8e5-198">Beispiel</span><span class="sxs-lookup"><span data-stu-id="ca8e5-198">Example</span></span>  
 <span data-ttu-id="ca8e5-199">Im folgenden Beispiel wird ein [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] -Skript dargestellt, mit dem ein Pushabonnement für eine Mergeveröffentlichung erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-199">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a push subscription to a merge publication.</span></span> <span data-ttu-id="ca8e5-200">Standardparameter wurden zwecks besserer Lesbarkeit entfernt.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-200">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepushsub80.sql#sp_createmergepushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ca8e5-201">Beispiel</span><span class="sxs-lookup"><span data-stu-id="ca8e5-201">Example</span></span>  
 <span data-ttu-id="ca8e5-202">Im folgenden Beispiel wird die Aktualisierung des vorherigen Skripts dargestellt, mit dem ein Pushabonnement für eine Mergeveröffentlichung erstellt wird und das aktualisiert wurde, damit es unter [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] und späteren Versionen erfolgreich ausgeführt werden kann.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-202">The following is an example of the previous script, which creates a push subscription to a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="ca8e5-203">Standardwerte für neue Parameter wurden explizit deklariert.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-203">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ca8e5-204"> Windows-Anmeldeinformationen werden zur Laufzeit mithilfe von **sqlcmd** -Skriptvariablen angegeben.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-204">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpushsub.sql#sp_createmergepushsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ca8e5-205">Beispiel</span><span class="sxs-lookup"><span data-stu-id="ca8e5-205">Example</span></span>  
 <span data-ttu-id="ca8e5-206">Im folgenden Beispiel wird ein [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] -Skript dargestellt, mit dem ein Pullabonnement für eine Transaktionsveröffentlichung erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-206">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a pull subscription to a transactional publication.</span></span> <span data-ttu-id="ca8e5-207">Standardparameter wurden zwecks besserer Lesbarkeit entfernt.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-207">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepushsub80.sql#sp_createmergepushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ca8e5-208">Beispiel</span><span class="sxs-lookup"><span data-stu-id="ca8e5-208">Example</span></span>  
 <span data-ttu-id="ca8e5-209">Im folgenden Beispiel wird die Aktualisierung des vorherigen Skripts dargestellt, mit dem ein Pullabonnement für eine Transaktionsveröffentlichung erstellt wird und das aktualisiert wurde, damit es unter [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] und späteren Versionen erfolgreich ausgeführt werden kann.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-209">The following is an example of the previous script, which creates a pull subscription to a transactional publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="ca8e5-210">Standardwerte für neue Parameter wurden explizit deklariert.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-210">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ca8e5-211"> Windows-Anmeldeinformationen werden zur Laufzeit mithilfe von **sqlcmd** -Skriptvariablen angegeben.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-211">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpullsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpullsub.sql#sp_createtranpullsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ca8e5-212">Beispiel</span><span class="sxs-lookup"><span data-stu-id="ca8e5-212">Example</span></span>  
 <span data-ttu-id="ca8e5-213">Im folgenden Beispiel wird ein [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] -Skript dargestellt, mit dem ein Pullabonnement für eine Mergeveröffentlichung erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-213">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a pull subscription to a merge publication.</span></span> <span data-ttu-id="ca8e5-214">Standardparameter wurden zwecks besserer Lesbarkeit entfernt.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-214">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepullsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepullsub80.sql#sp_createmergepullsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ca8e5-215">Beispiel</span><span class="sxs-lookup"><span data-stu-id="ca8e5-215">Example</span></span>  
 <span data-ttu-id="ca8e5-216">Im folgenden Beispiel wird die Aktualisierung des vorherigen Skripts dargestellt, mit dem ein Pullabonnement für eine Mergeveröffentlichung erstellt wird und das aktualisiert wurde, damit es unter [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] und späteren Versionen erfolgreich ausgeführt werden kann.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-216">The following is an example of the previous script, which creates a pull subscription to a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="ca8e5-217">Standardwerte für neue Parameter wurden explizit deklariert.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-217">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ca8e5-218"> Windows-Anmeldeinformationen werden zur Laufzeit mithilfe von **sqlcmd** -Skriptvariablen angegeben.</span><span class="sxs-lookup"><span data-stu-id="ca8e5-218">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepullsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpullsub.sql#sp_createmergepullsub_nwpostupgrade)]  
  
## <a name="see-also"></a><span data-ttu-id="ca8e5-219">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="ca8e5-219">See Also</span></span>  
 <span data-ttu-id="ca8e5-220">[Create a Publication](../publish/create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="ca8e5-220">[Create a Publication](../publish/create-a-publication.md) </span></span>  
 <span data-ttu-id="ca8e5-221">[Create a Push Subscription](../create-a-push-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="ca8e5-221">[Create a Push Subscription](../create-a-push-subscription.md) </span></span>  
 <span data-ttu-id="ca8e5-222">[Create a Pull Subscription](../create-a-pull-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="ca8e5-222">[Create a Pull Subscription](../create-a-pull-subscription.md) </span></span>  
 <span data-ttu-id="ca8e5-223">[Anzeigen und Ändern von Replikationssicherheitseinstellungen](../security/view-and-modify-replication-security-settings.md) </span><span class="sxs-lookup"><span data-stu-id="ca8e5-223">[View and Modify Replication Security Settings](../security/view-and-modify-replication-security-settings.md) </span></span>  
 <span data-ttu-id="ca8e5-224">[MSSQL_ENG021797](../mssql-eng021797.md) </span><span class="sxs-lookup"><span data-stu-id="ca8e5-224">[MSSQL_ENG021797](../mssql-eng021797.md) </span></span>  
 <span data-ttu-id="ca8e5-225">[MSSQL_ENG021798](../mssql-eng021798.md) </span><span class="sxs-lookup"><span data-stu-id="ca8e5-225">[MSSQL_ENG021798](../mssql-eng021798.md) </span></span>  
 <span data-ttu-id="ca8e5-226">[Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="ca8e5-226">[Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="ca8e5-227">Aktualisieren von replizierten Datenbanken</span><span class="sxs-lookup"><span data-stu-id="ca8e5-227">Upgrade Replicated Databases</span></span>](../../../database-engine/install-windows/upgrade-replicated-databases.md)  
  
  

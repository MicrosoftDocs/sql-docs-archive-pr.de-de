---
title: Ereignisablaufverfolgung für Windows-Ziel | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: xevents
ms.topic: conceptual
helpviewer_keywords:
- event tracing for windows target
- ETW target
- targets [SQL Server extended events], event tracing for windows target
ms.assetid: ca2bb295-b7f6-49c3-91ed-0ad4c39f89d5
author: rothja
ms.author: jroth
ms.openlocfilehash: 55f247af30b5278f614b6505a94266cc07ec6c54
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87609224"
---
# <a name="event-tracing-for-windows-target"></a><span data-ttu-id="e9463-102">Ereignisablaufverfolgung für Windows-Ziel</span><span class="sxs-lookup"><span data-stu-id="e9463-102">Event Tracing for Windows Target</span></span>
  <span data-ttu-id="e9463-103">Bevor Sie die Ereignisablaufverfolgung für Windows (Event Tracing for Windows, ETW) als Ziel verwenden, sollten Sie über ausreichende Kenntnisse der ETW verfügen.</span><span class="sxs-lookup"><span data-stu-id="e9463-103">Before you use Event Tracing for Windows (ETW) as a target, we recommend that you have a working knowledge of ETW.</span></span> <span data-ttu-id="e9463-104">ETW wird entweder in Verbindung mit erweiterten Ereignissen oder als Ereignisconsumer für erweiterte Ereignisse verwendet.</span><span class="sxs-lookup"><span data-stu-id="e9463-104">ETW tracing is either used together with Extended Events or as an Extended Events event consumer.</span></span> <span data-ttu-id="e9463-105">Über die folgenden externen Links erhalten Sie erste Hintergrundinformationen zur ETW:</span><span class="sxs-lookup"><span data-stu-id="e9463-105">The following external links provide a starting point for obtaining background information about ETW:</span></span>  
  
-   [<span data-ttu-id="e9463-106">Windows-Ereignisse</span><span class="sxs-lookup"><span data-stu-id="e9463-106">Windows Events</span></span>](https://go.microsoft.com/fwlink/?LinkId=92380)  
  
-   [<span data-ttu-id="e9463-107">Verbessertes Debugging und Leistungsoptimierung mit ETW</span><span class="sxs-lookup"><span data-stu-id="e9463-107">Improve Debugging And Performance Tuning With ETW</span></span>](https://go.microsoft.com/fwlink/?LinkId=92381)  
  
 <span data-ttu-id="e9463-108">Das ETW-Ziel ist ein Singletonziel, auch wenn es mehreren Sitzungen hinzugefügt werden kann.</span><span class="sxs-lookup"><span data-stu-id="e9463-108">The ETW target is a singleton target, although the target can be added to many sessions.</span></span> <span data-ttu-id="e9463-109">Auch wenn ein Ereignis in vielen Sitzungen ausgelöst wird, wird das Ereignis nur einmal je aufgetretenem Ereignis an das ETW-Ziel weitergeleitet.</span><span class="sxs-lookup"><span data-stu-id="e9463-109">If an event is raised on many sessions, the event will only be propagated to the ETW target one time per event occurrence.</span></span> <span data-ttu-id="e9463-110">Die Engine für erweiterte Ereignisse ist pro Prozess auf eine einzelne Instanz beschränkt.</span><span class="sxs-lookup"><span data-stu-id="e9463-110">The Extended Events engine is limited to a single instance per process.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="e9463-111">Das [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Dienststartkonto muss Mitglied der Gruppe der Leistungsprotokollbenutzer sein, damit das ETW-Ziel funktionieren kann.</span><span class="sxs-lookup"><span data-stu-id="e9463-111">For the ETW target to work, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Service startup account must be a member of the Performance Log Users group.</span></span>  
  
 <span data-ttu-id="e9463-112">Die Konfiguration der Ereignisse in einer ETW-Sitzung wird von einem Prozess gesteuert, in dem die Engine für erweiterte Ereignisse gehostet ist.</span><span class="sxs-lookup"><span data-stu-id="e9463-112">The configuration of the events present in an ETW session is controlled by the process that hosts the Extended Events engine.</span></span> <span data-ttu-id="e9463-113">Die Engine steuert, welche Ereignisse ausgelöst werden und welche Bedingungen erfüllt sein müssen, damit ein Ereignis ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="e9463-113">The engine controls which events to raise and what conditions must be met for an event to occur.</span></span>  
  
 <span data-ttu-id="e9463-114">Nachdem ein ETW-Ziel an eine Sitzung für erweiterte Ereignisse gebunden wurde, in der das ETW-Ziel zum ersten Mal während der Lebenszeit eines Prozesses angefügt wird, öffnet das ETW-Ziel eine einzelne ETW-Sitzung für den [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Anbieter.</span><span class="sxs-lookup"><span data-stu-id="e9463-114">After binding to an Extended Events session, which attaches the ETW target for the first time during the lifetime of a process, the ETW target opens a single ETW session on the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] provider.</span></span> <span data-ttu-id="e9463-115">Wenn bereits eine ETW-Sitzung vorhanden ist, erhält das ETW-Ziel einen Verweis auf die vorhandene Sitzung.</span><span class="sxs-lookup"><span data-stu-id="e9463-115">If an ETW session already exists, the ETW target obtains a reference to the existing session.</span></span> <span data-ttu-id="e9463-116">Diese ETW-Sitzung ist für alle [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Instanzen auf einem bestimmten Computer freigegeben.</span><span class="sxs-lookup"><span data-stu-id="e9463-116">This ETW session is shared across all [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instances on a given computer.</span></span> <span data-ttu-id="e9463-117">Diese ETW-Sitzung empfängt alle Ereignisse von Sitzungen, die das ETW-Ziel aufweisen.</span><span class="sxs-lookup"><span data-stu-id="e9463-117">This ETW session receives all the events from sessions that have the ETW target.</span></span>  
  
 <span data-ttu-id="e9463-118">Da für ETW Anbieter erforderlich sind, damit Ereignisse verwendet werden und an ETW fließen können, sind alle Pakete für erweiterte Ereignisse für die Sitzung aktiviert.</span><span class="sxs-lookup"><span data-stu-id="e9463-118">Because ETW needs providers to be enabled to consume events and flow them down to the ETW, all Extended Events packages are enabled on the session.</span></span> <span data-ttu-id="e9463-119">Wenn ein Ereignis ausgelöst wird, sendet das ETW-Ziel das Ereignis an die Sitzung, in der der Anbieter für das Ereignis aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="e9463-119">When an event is fired, the ETW target sends the event to the session on which the provider for the event is enabled.</span></span>  
  
 <span data-ttu-id="e9463-120">Das ETW-Ziel unterstützt die synchrone Veröffentlichung von Ereignissen in dem Thread, der das Ereignis auslöst.</span><span class="sxs-lookup"><span data-stu-id="e9463-120">The ETW target supports synchronous publishing of events on the thread that raises the event.</span></span> <span data-ttu-id="e9463-121">Das ETW-Ziel unterstützt jedoch keine asynchrone Ereignisveröffentlichung.</span><span class="sxs-lookup"><span data-stu-id="e9463-121">However, the ETW target does not support asynchronous event publishing.</span></span>  
  
 <span data-ttu-id="e9463-122">Das ETW-Ziel unterstützt keine Steuerung durch externe ETW-Controller, z. B. Logman.exe.</span><span class="sxs-lookup"><span data-stu-id="e9463-122">The ETW target does not support control from external ETW controllers such as Logman.exe.</span></span> <span data-ttu-id="e9463-123">Für ETW-Ablaufverfolgungen muss eine Ereignissitzung mit dem ETW-Ziel erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="e9463-123">To produce ETW traces, an event session must be created with the ETW target.</span></span> <span data-ttu-id="e9463-124">Weitere Informationen finden Sie unter [CREATE EVENT SESSION &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-event-session-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e9463-124">For more information, see [CREATE EVENT SESSION &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-event-session-transact-sql).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e9463-125">Bei Aktivieren des ETW-Ziels wird eine ETW-Sitzung mit dem Namen XE_DEFAULT_ETW_SESSION erstellt.</span><span class="sxs-lookup"><span data-stu-id="e9463-125">Enabling the ETW target creates an ETW session that is named XE_DEFAULT_ETW_SESSION.</span></span> <span data-ttu-id="e9463-126">Wenn eine Sitzung mit dem Namen XE_DEFAULT_ETW_SESSION bereits vorhanden ist, wird diese ohne Änderung der Eigenschaften der vorhandenen Sitzung verwendet.</span><span class="sxs-lookup"><span data-stu-id="e9463-126">If a session with the name XE_DEFAULT_ETW_SESSION already exists, it is used without modifying any properties of the existing session.</span></span> <span data-ttu-id="e9463-127">XE_DEFAULT_ETW_SESSION wird von allen Instanzen von [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]gemeinsam genutzt.</span><span class="sxs-lookup"><span data-stu-id="e9463-127">The XE_DEFAULT_ETW_SESSION is shared between all instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="e9463-128">Nachdem Sie XE_DEFAULT_ETW_SESSION gestartet haben, müssen Sie dies mit einem ETW-Controller beenden, z. B. dem Logman-Tool.</span><span class="sxs-lookup"><span data-stu-id="e9463-128">After you start the XE_DEFAULT_ETW_SESSION, you must stop it by using an ETW controller, such as the Logman tool.</span></span> <span data-ttu-id="e9463-129">Sie können zum Beispiel den folgenden Befehl an der Eingabeaufforderung ausführen: `logman stop XE_DEFAULT_ETW_SESSION -ets`.</span><span class="sxs-lookup"><span data-stu-id="e9463-129">For example, you can run the following command at the command prompt: `logman stop XE_DEFAULT_ETW_SESSION -ets`.</span></span>  
  
 <span data-ttu-id="e9463-130">In der folgenden Tabelle werden die verfügbaren Optionen für das Konfigurieren des ETW-Ziels beschrieben.</span><span class="sxs-lookup"><span data-stu-id="e9463-130">The following table describes the available options for configuring the ETW target.</span></span>  
  
|<span data-ttu-id="e9463-131">Option</span><span class="sxs-lookup"><span data-stu-id="e9463-131">Option</span></span>|<span data-ttu-id="e9463-132">Zulässige Werte</span><span class="sxs-lookup"><span data-stu-id="e9463-132">Allowed values</span></span>|<span data-ttu-id="e9463-133">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="e9463-133">Description</span></span>|  
|------------|--------------------|-----------------|  
|<span data-ttu-id="e9463-134">default_xe_session_name</span><span class="sxs-lookup"><span data-stu-id="e9463-134">default_xe_session_name</span></span>|<span data-ttu-id="e9463-135">Eine Zeichenfolge mit bis zu 256 Zeichen.</span><span class="sxs-lookup"><span data-stu-id="e9463-135">Any string up to 256 characters.</span></span> <span data-ttu-id="e9463-136">Dieser Wert ist optional.</span><span class="sxs-lookup"><span data-stu-id="e9463-136">This value is optional.</span></span>|<span data-ttu-id="e9463-137">Der Name der Sitzung für erweiterte Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="e9463-137">The Extended Events session name.</span></span> <span data-ttu-id="e9463-138">Standardmäßig ist dies XE_DEFAULT_ETW_SESSION.</span><span class="sxs-lookup"><span data-stu-id="e9463-138">By default, this is XE_DEFAULT_ETW_SESSION.</span></span>|  
|<span data-ttu-id="e9463-139">default_etw_session_logfile_path</span><span class="sxs-lookup"><span data-stu-id="e9463-139">default_etw_session_logfile_path</span></span>|<span data-ttu-id="e9463-140">Eine Zeichenfolge mit bis zu 256 Zeichen.</span><span class="sxs-lookup"><span data-stu-id="e9463-140">Any string up to 256 characters.</span></span> <span data-ttu-id="e9463-141">Dieser Wert ist optional.</span><span class="sxs-lookup"><span data-stu-id="e9463-141">This value is optional.</span></span>|<span data-ttu-id="e9463-142">Der Pfad der Protokolldatei für die Sitzung für erweiterte Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="e9463-142">The path of the log file for the Extended Events session.</span></span> <span data-ttu-id="e9463-143">Standardmäßig ist dies %TEMP%\XEEtw.etl.</span><span class="sxs-lookup"><span data-stu-id="e9463-143">By default, this is %TEMP%\ XEEtw.etl.</span></span>|  
|<span data-ttu-id="e9463-144">default_etw_session_logfile_size_mb</span><span class="sxs-lookup"><span data-stu-id="e9463-144">default_etw_session_logfile_size_mb</span></span>|<span data-ttu-id="e9463-145">Eine beliebige Ganzzahl ohne Vorzeichen.</span><span class="sxs-lookup"><span data-stu-id="e9463-145">Any unsigned integer.</span></span> <span data-ttu-id="e9463-146">Dieser Wert ist optional.</span><span class="sxs-lookup"><span data-stu-id="e9463-146">This value is optional.</span></span>|<span data-ttu-id="e9463-147">Die Protokolldateigröße in Megabyte (MB) für die Sitzung für erweiterte Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="e9463-147">The log file size, in megabytes (MB), for the Extended Events session.</span></span> <span data-ttu-id="e9463-148">Die Standardeinstellung ist 20 MB.</span><span class="sxs-lookup"><span data-stu-id="e9463-148">The default is 20 MB.</span></span>|  
|<span data-ttu-id="e9463-149">default_etw_session_buffer_size_kb</span><span class="sxs-lookup"><span data-stu-id="e9463-149">default_etw_session_buffer_size_kb</span></span>|<span data-ttu-id="e9463-150">Eine beliebige Ganzzahl ohne Vorzeichen.</span><span class="sxs-lookup"><span data-stu-id="e9463-150">Any unsigned integer.</span></span> <span data-ttu-id="e9463-151">Dieser Wert ist optional.</span><span class="sxs-lookup"><span data-stu-id="e9463-151">This value is optional.</span></span>|<span data-ttu-id="e9463-152">Die Größe des Puffers im Arbeitsspeicher in Kilobyte (KB) für die Sitzung für erweiterte Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="e9463-152">The in-memory buffer size, in kilobytes (KB), for the Extended Events session.</span></span> <span data-ttu-id="e9463-153">Die Standardeinstellung ist 128 KB.</span><span class="sxs-lookup"><span data-stu-id="e9463-153">The default is 128 KB.</span></span>|  
|<span data-ttu-id="e9463-154">retries</span><span class="sxs-lookup"><span data-stu-id="e9463-154">retries</span></span>|<span data-ttu-id="e9463-155">Eine beliebige Ganzzahl ohne Vorzeichen.</span><span class="sxs-lookup"><span data-stu-id="e9463-155">Any unsigned integer.</span></span>|<span data-ttu-id="e9463-156">Die Anzahl erneuter Versuche, das Ereignis im ETW-Subsystem zu veröffentlichen, bevor es gelöscht wird.</span><span class="sxs-lookup"><span data-stu-id="e9463-156">The number of times to retry publishing the event to the ETW subsystem before dropping the event.</span></span> <span data-ttu-id="e9463-157">Die Standardeinstellung ist 0.</span><span class="sxs-lookup"><span data-stu-id="e9463-157">The default is 0.</span></span>|  
  
 <span data-ttu-id="e9463-158">Die Konfiguration dieser Einstellungen ist optional.</span><span class="sxs-lookup"><span data-stu-id="e9463-158">Configuring these settings is optional.</span></span> <span data-ttu-id="e9463-159">Das ETW-Ziel verwendet Standardwerte für diese Einstellungen.</span><span class="sxs-lookup"><span data-stu-id="e9463-159">The ETW target uses default values for these settings.</span></span>  
  
 <span data-ttu-id="e9463-160">Das ETW-Ziel führt die folgenden Aufgaben aus:</span><span class="sxs-lookup"><span data-stu-id="e9463-160">The ETW target is responsible for:</span></span>  
  
-   <span data-ttu-id="e9463-161">Erstellen der ETW-Standardsitzung.</span><span class="sxs-lookup"><span data-stu-id="e9463-161">Creating the default ETW session.</span></span>  
  
-   <span data-ttu-id="e9463-162">Registrieren aller Pakete für erweiterte Ereignisse bei ETW.</span><span class="sxs-lookup"><span data-stu-id="e9463-162">Registering all Extended Events packages with ETW.</span></span> <span data-ttu-id="e9463-163">So kann sichergestellt werden, dass Ereignisse nicht von ETW gelöscht werden.</span><span class="sxs-lookup"><span data-stu-id="e9463-163">This ensures that events are not dropped by ETW.</span></span>  
  
-   <span data-ttu-id="e9463-164">Verwalten des Ereignisflusses zu ETW.</span><span class="sxs-lookup"><span data-stu-id="e9463-164">Managing the flow of events to ETW.</span></span> <span data-ttu-id="e9463-165">Das ETW-Ziel erstellt ein ETW-Ereignis mit Daten für erweiterte Ereignisse und sendet es an die zugehörige ETW-Sitzung.</span><span class="sxs-lookup"><span data-stu-id="e9463-165">The ETW target creates an ETW event with Extended Events data and sends it to the appropriate ETW session.</span></span> <span data-ttu-id="e9463-166">Wenn das Ereignis die Puffergröße überschreitet oder die Daten für ein ETW-Ereignis zu groß sind, teilt ETW das Ereignis in Fragmente.</span><span class="sxs-lookup"><span data-stu-id="e9463-166">If the event is larger than the buffer size, or data cannot fit in one ETW event, ETW splits the event into fragments.</span></span>  
  
-   <span data-ttu-id="e9463-167">Ständiges Beibehalten der Aktivierung von Paketen für erweiterte Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="e9463-167">Keeping Extended Events packages enabled at all times.</span></span>  
  
 <span data-ttu-id="e9463-168">Die folgenden Standarddateispeicherorte werden von ETW verwendet:</span><span class="sxs-lookup"><span data-stu-id="e9463-168">The following default file locations are used by ETW:</span></span>  
  
-   <span data-ttu-id="e9463-169">Die ETW-Ausgabedatei befindet sich im Ordner %TEMP%\XEEtw.etl.</span><span class="sxs-lookup"><span data-stu-id="e9463-169">The ETW output file is in %TEMP%\XEEtw.etl.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="e9463-170">Der Dateipfad kann nicht geändert werden, nachdem die erste Sitzung gestartet wurde.</span><span class="sxs-lookup"><span data-stu-id="e9463-170">The file path cannot be changed after the first session starts.</span></span>  
  
-   <span data-ttu-id="e9463-171">Die MOF-Dateien (Managed Object Format) befinden sich im Ordner *\<your install path>* \Microsoft SQL Server\Shared.</span><span class="sxs-lookup"><span data-stu-id="e9463-171">Managed Object Format (MOF) files are in *\<your install path>* \Microsoft SQL Server\Shared.</span></span> <span data-ttu-id="e9463-172">Weitere Informationen finden Sie unter [Managed Object Format](https://go.microsoft.com/fwlink/?LinkId=92851) auf der MSDN-Website.</span><span class="sxs-lookup"><span data-stu-id="e9463-172">For more information, see [Managed Object Format](https://go.microsoft.com/fwlink/?LinkId=92851) on MSDN.</span></span>  
  
## <a name="adding-the-target-to-a-session"></a><span data-ttu-id="e9463-173">Hinzufügen des Ziels zu einer Sitzung</span><span class="sxs-lookup"><span data-stu-id="e9463-173">Adding the Target to a Session</span></span>  
 <span data-ttu-id="e9463-174">Wenn Sie das ETW-Ziel einer Sitzung für erweiterte Ereignisse hinzufügen möchten, müssen Sie beim Erstellen oder Ändern einer Ereignissitzung die folgende Anweisung einschließen:</span><span class="sxs-lookup"><span data-stu-id="e9463-174">To add the ETW target to an Extended Events session, you must include the following statement when you create or alter an event session:</span></span>  
  
```  
ADD TARGET package0.etw_classic_sync_target  
```  
  
 <span data-ttu-id="e9463-175">Weitere Informationen zu einem vollständigen Beispiel, das zeigt, wie das ETW-Ziel verwendet wird und wie die Daten angezeigt werden, finden Sie unter [Überwachen der Systemaktivität mit erweiterten Ereignissen](monitor-system-activity-using-extended-events.md).</span><span class="sxs-lookup"><span data-stu-id="e9463-175">For more information about a full example that shows how to use the ETW target, including how to view the data, see [Monitor System Activity Using Extended Events](monitor-system-activity-using-extended-events.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e9463-176">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="e9463-176">See Also</span></span>  
 <span data-ttu-id="e9463-177">[Ziele für erweiterte Ereignisse von SQL Server](../../database-engine/sql-server-extended-events-targets.md) </span><span class="sxs-lookup"><span data-stu-id="e9463-177">[SQL Server Extended Events Targets](../../database-engine/sql-server-extended-events-targets.md) </span></span>  
 <span data-ttu-id="e9463-178">[sys.dm_xe_session_targets &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-xe-session-targets-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="e9463-178">[sys.dm_xe_session_targets &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-xe-session-targets-transact-sql) </span></span>  
 <span data-ttu-id="e9463-179">[CREATE EVENT SESSION &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-event-session-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="e9463-179">[CREATE EVENT SESSION &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-event-session-transact-sql) </span></span>  
 [<span data-ttu-id="e9463-180">ALTER EVENT SESSION &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="e9463-180">ALTER EVENT SESSION &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-event-session-transact-sql)  
  
  

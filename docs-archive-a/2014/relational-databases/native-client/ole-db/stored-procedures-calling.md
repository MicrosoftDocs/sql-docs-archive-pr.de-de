---
title: Aufrufen einer gespeicherten Prozedur (OLE DB) | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- calling stored procedures
- RPC escape sequence
- OLE DB, stored procedures
- parameters [SQL Server Native Client], OLE DB
- ODBC CALL escape sequence
- stored procedures [OLE DB], calling
- SQL Server Native Client OLE DB provider, stored procedures
ms.assetid: 8e5738e5-4bbe-4f34-bd69-0c0633290bdd
author: rothja
ms.author: jroth
ms.openlocfilehash: 695848c8633d310f5e8ee21e9e738749d1550e4a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87722693"
---
# <a name="calling-a-stored-procedure-ole-db"></a><span data-ttu-id="eba5c-102">Aufrufen einer gespeicherten Prozedur (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="eba5c-102">Calling a Stored Procedure (OLE DB)</span></span>
  <span data-ttu-id="eba5c-103">Eine gespeicherte Prozedur kann 0 oder mehr Parameter haben.</span><span class="sxs-lookup"><span data-stu-id="eba5c-103">A stored procedure can have zero or more parameters.</span></span> <span data-ttu-id="eba5c-104">Sie kann auch einen Wert zurückgeben:</span><span class="sxs-lookup"><span data-stu-id="eba5c-104">It can also return a value.</span></span> <span data-ttu-id="eba5c-105">Wenn Sie den [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client-OLE DB-Anbieter verwenden, können die Parameter für eine gespeicherte Prozedur wie folgt übermittelt werden:</span><span class="sxs-lookup"><span data-stu-id="eba5c-105">When using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider, parameters to a stored procedure can be passed by:</span></span>  
  
-   <span data-ttu-id="eba5c-106">Durch Hartcodierung des Datenwerts</span><span class="sxs-lookup"><span data-stu-id="eba5c-106">Hard-coding the data value.</span></span>  
  
-   <span data-ttu-id="eba5c-107">Durch Verwendung einer Parametermarkierung (?) zum Angeben von Parametern, Binden einer Programmvariablen an die Parametermarkierung und Einfügen des Datenwerts in die Programmvariable</span><span class="sxs-lookup"><span data-stu-id="eba5c-107">Using a parameter marker (?) to specify parameters, bind a program variable to the parameter marker, and then place the data value in the program variable.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="eba5c-108">Wenn gespeicherte [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-Prozeduren mit benannten Parametern mit OLE DB aufgerufen werden, müssen die Parameternamen mit dem Zeichen „\@“ beginnen.</span><span class="sxs-lookup"><span data-stu-id="eba5c-108">When calling [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] stored procedures using named parameters with OLE DB, the parameter names must start with the '\@' character.</span></span> <span data-ttu-id="eba5c-109">Dies ist eine [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-spezifische Einschränkung.</span><span class="sxs-lookup"><span data-stu-id="eba5c-109">This is a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] specific restriction.</span></span> <span data-ttu-id="eba5c-110">Der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter erzwingt diese Einschränkung strenger als MDAC.</span><span class="sxs-lookup"><span data-stu-id="eba5c-110">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider enforces this restriction more strictly than MDAC.</span></span>  
  
 <span data-ttu-id="eba5c-111">Damit Parameter unterstützt werden, wird die **ICommandWithParameters**-Schnittstelle auf dem Befehlsobjekt verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="eba5c-111">To support parameters, the **ICommandWithParameters** interface is exposed on the command object.</span></span> <span data-ttu-id="eba5c-112">Wenn die Parameter verwendet werden sollen, beschreibt der Consumer die Parameter zunächst dem Anbieter, indem er die **ICommandWithParameters::SetParameterInfo**-Methode aufruft (oder optional eine Aufrufanweisung vorbereitet, die die **GetParameterInfo**-Methode aufruft).</span><span class="sxs-lookup"><span data-stu-id="eba5c-112">To use parameters, the consumer first describes the parameters to the provider by calling the **ICommandWithParameters::SetParameterInfo** method (or optionally prepares a calling statement that calls the **GetParameterInfo** method).</span></span> <span data-ttu-id="eba5c-113">Der Consumer erstellt dann einen Accessor, der die Struktur eines Puffers angibt und Parameterwerte in diesen Puffer einfügt.</span><span class="sxs-lookup"><span data-stu-id="eba5c-113">The consumer then creates an accessor that specifies the structure of a buffer and places parameter values in this buffer.</span></span> <span data-ttu-id="eba5c-114">Schließlich übergibt er das Handle des Accessors und einen Zeiger auf den Puffer an **Execute**.</span><span class="sxs-lookup"><span data-stu-id="eba5c-114">Finally, it passes the handle of the accessor and a pointer to the buffer to **Execute**.</span></span> <span data-ttu-id="eba5c-115">Bei späteren Aufrufen von **Execute** fügt der Consumer neue Parameterwerte in den Puffer ein und ruft **Execute** mit dem Accessorhandle und Pufferzeiger auf.</span><span class="sxs-lookup"><span data-stu-id="eba5c-115">On later calls to **Execute**, the consumer places new parameter values in the buffer and calls **Execute** with the accessor handle and buffer pointer.</span></span>  
  
 <span data-ttu-id="eba5c-116">Ein Befehl, der eine temporär gespeicherte Prozedur mit Parametern aufruft, muss zunächst **ICommandWithParameters::SetParameterInfo** aufrufen, um die Parameterinformationen zu definieren, bevor der Befehl erfolgreich vorbereitet werden kann.</span><span class="sxs-lookup"><span data-stu-id="eba5c-116">A command that calls a temporary stored procedure using parameters must first call **ICommandWithParameters::SetParameterInfo** to define the parameter information, before the command can be successfully prepared.</span></span> <span data-ttu-id="eba5c-117">Der Grund dafür ist, dass der interne Name für eine temporär gespeicherte Prozedur anders lautet als der externe Name, der von einem Client verwendet wird. Zudem kann SQLOLEDB die Systemtabellen nicht abfragen, um die Parameterinformationen für eine temporär gespeicherte Prozedur zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="eba5c-117">This is because the internal name for a temporary stored procedure differs from the external name used by a client and SQLOLEDB cannot query the system tables to determine the parameter information for a temporary stored procedure.</span></span>  
  
 <span data-ttu-id="eba5c-118">Der Parameterbindungsprozess umfasst folgende Schritte:</span><span class="sxs-lookup"><span data-stu-id="eba5c-118">These are the steps in the parameter binding process:</span></span>  
  
1.  <span data-ttu-id="eba5c-119">Geben Sie die Parameterinformationen in ein Array aus DBPARAMBINDINFO-Strukturen ein, also den Parameternamen, den anbieterspezifischen Namen für den Datentyp des Parameters oder einen standardmäßigen Datentypennamen usw.</span><span class="sxs-lookup"><span data-stu-id="eba5c-119">Fill in the parameter information in an array of DBPARAMBINDINFO structures; that is, parameter name, provider-specific name for the data type of the parameter or a standard data type name, and so on.</span></span> <span data-ttu-id="eba5c-120">Jede Struktur im Array beschreibt einen Parameter.</span><span class="sxs-lookup"><span data-stu-id="eba5c-120">Each structure in the array describes one parameter.</span></span> <span data-ttu-id="eba5c-121">Dieses Array wird dann an die **SetParameterInfo**-Methode übergeben.</span><span class="sxs-lookup"><span data-stu-id="eba5c-121">This array is then passed to the **SetParameterInfo** method.</span></span>  
  
2.  <span data-ttu-id="eba5c-122">Rufen Sie die **ICommandWithParameters::SetParameterInfo**-Methode auf, um dem Anbieter Parameter zu beschreiben.</span><span class="sxs-lookup"><span data-stu-id="eba5c-122">Call the **ICommandWithParameters::SetParameterInfo** method to describe parameters to the provider.</span></span> <span data-ttu-id="eba5c-123">**SetParameterInfo** gibt den nativen Datentyp jedes Parameters an.</span><span class="sxs-lookup"><span data-stu-id="eba5c-123">**SetParameterInfo** specifies the native data type of each parameter.</span></span> <span data-ttu-id="eba5c-124">**SetParameterInfo**-Argumente sind:</span><span class="sxs-lookup"><span data-stu-id="eba5c-124">**SetParameterInfo** arguments are:</span></span>  
  
    -   <span data-ttu-id="eba5c-125">Die Anzahl von Parametern, für die Typinformationen festzulegen sind</span><span class="sxs-lookup"><span data-stu-id="eba5c-125">The number of parameters for which to set type information.</span></span>  
  
    -   <span data-ttu-id="eba5c-126">Ein Array aus Ordnungszahlen von Parametern, für die Typinformationen festzulegen sind</span><span class="sxs-lookup"><span data-stu-id="eba5c-126">An array of parameter ordinals for which to set type information.</span></span>  
  
    -   <span data-ttu-id="eba5c-127">Ein Array aus DBPARAMBINDINFO-Strukturen</span><span class="sxs-lookup"><span data-stu-id="eba5c-127">An array of DBPARAMBINDINFO structures.</span></span>  
  
3.  <span data-ttu-id="eba5c-128">Erstellen Sie mit dem Befehl **IAccessor::CreateAccessor** einen Parameteraccessor.</span><span class="sxs-lookup"><span data-stu-id="eba5c-128">Create a parameter accessor by using the **IAccessor::CreateAccessor** command.</span></span> <span data-ttu-id="eba5c-129">Der Accessor gibt die Struktur eines Puffers an und fügt Parameterwerte in den Puffer ein.</span><span class="sxs-lookup"><span data-stu-id="eba5c-129">The accessor specifies the structure of a buffer and places parameter values in the buffer.</span></span> <span data-ttu-id="eba5c-130">Der Befehl **CreateAccessor** erstellt aus mehreren Bindungen einen Accessor.</span><span class="sxs-lookup"><span data-stu-id="eba5c-130">The **CreateAccessor** command creates an accessor from a set of bindings.</span></span> <span data-ttu-id="eba5c-131">Diese Bindungen werden vom Consumer mithilfe eines Arrays aus DBBINDING-Strukturen beschrieben.</span><span class="sxs-lookup"><span data-stu-id="eba5c-131">These bindings are described by the consumer by using an array of DBBINDING structures.</span></span> <span data-ttu-id="eba5c-132">Jede Bindung ordnet dem Puffer des Consumers einen einzelnen Parameter zu und enthält Informationen wie z. B.:</span><span class="sxs-lookup"><span data-stu-id="eba5c-132">Each binding associates a single parameter to the buffer of the consumer and contains information such as:</span></span>  
  
    -   <span data-ttu-id="eba5c-133">Die Ordnungszahl des Parameters, auf den sich die Bindung bezieht</span><span class="sxs-lookup"><span data-stu-id="eba5c-133">The ordinal of the parameter to which the binding applies.</span></span>  
  
    -   <span data-ttu-id="eba5c-134">Die Angabe, was gebunden wird (der Datenwert, seine Länge und sein Status)</span><span class="sxs-lookup"><span data-stu-id="eba5c-134">What is bound (the data value, its length, and its status).</span></span>  
  
    -   <span data-ttu-id="eba5c-135">Den Offset im Puffer zu jedem dieser Teile</span><span class="sxs-lookup"><span data-stu-id="eba5c-135">The offset in the buffer to each of these parts.</span></span>  
  
    -   <span data-ttu-id="eba5c-136">Die Länge und den Typ des Datenwerts, wie er im Puffer des Consumers vorhanden ist</span><span class="sxs-lookup"><span data-stu-id="eba5c-136">The length and type of the data value as it exists in the buffer of the consumer.</span></span>  
  
     <span data-ttu-id="eba5c-137">Ein Accessor wird von seinem Handle identifiziert, das den Typ HACCESSOR aufweist.</span><span class="sxs-lookup"><span data-stu-id="eba5c-137">An accessor is identified by its handle, which is of type HACCESSOR.</span></span> <span data-ttu-id="eba5c-138">Dieses Handle wird von der **CreateAccessor**-Methode zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="eba5c-138">This handle is returned by the **CreateAccessor** method.</span></span> <span data-ttu-id="eba5c-139">Sobald der Consumer einen Accessor nicht mehr benötigt, muss er die **ReleaseAccessor**-Methode aufrufen, um den belegten Arbeitsspeicher freizugeben.</span><span class="sxs-lookup"><span data-stu-id="eba5c-139">Whenever the consumer finishes using an accessor, the consumer must call the **ReleaseAccessor** method to release the memory it holds.</span></span>  
  
     <span data-ttu-id="eba5c-140">Wenn der Consumer eine Methode wie z.B. **ICommand::Execute** aufruft, übergibt er das Handle an einen Accessor und einen Zeiger auf den Puffer selbst.</span><span class="sxs-lookup"><span data-stu-id="eba5c-140">When the consumer calls a method, such as **ICommand::Execute**, it passes the handle to an accessor and a pointer to a buffer itself.</span></span> <span data-ttu-id="eba5c-141">Der Anbieter verwendet diesen Accessor, um zu bestimmen, wie die im Puffer enthaltenen Daten übertragen werden.</span><span class="sxs-lookup"><span data-stu-id="eba5c-141">The provider uses this accessor to determine how to transfer the data contained in the buffer.</span></span>  
  
4.  <span data-ttu-id="eba5c-142">Geben Sie die DBPARAMS-Struktur ein.</span><span class="sxs-lookup"><span data-stu-id="eba5c-142">Fill in the DBPARAMS structure.</span></span> <span data-ttu-id="eba5c-143">Die Consumervariablen, von denen Eingabeparameterwerte übernommen und in die Ausgabeparameterwerte geschrieben werden, werden zur Laufzeit an **ICommand::Execute** in der DBPARAMS-Struktur übergeben.</span><span class="sxs-lookup"><span data-stu-id="eba5c-143">The consumer variables from which input parameter values are taken and to which output parameter values are written are passed at run time to **ICommand::Execute** in the DBPARAMS structure.</span></span> <span data-ttu-id="eba5c-144">Die DBPARAMS-Struktur beinhaltet drei Elemente:</span><span class="sxs-lookup"><span data-stu-id="eba5c-144">The DBPARAMS structure includes three elements:</span></span>  
  
    -   <span data-ttu-id="eba5c-145">Einen Zeiger auf den Puffer, aus dem der Anbieter Eingabeparameterdaten abruft und in den der Anbieter Ausgabeparameterdaten zurückgibt, gemäß den vom Accessorhandle angegebenen Bindungen</span><span class="sxs-lookup"><span data-stu-id="eba5c-145">A pointer to the buffer from which the provider retrieves input parameter data and to which the provider returns output parameter data, according to the bindings specified by the accessor handle.</span></span>  
  
    -   <span data-ttu-id="eba5c-146">Die Anzahl von Parametersätzen im Puffer</span><span class="sxs-lookup"><span data-stu-id="eba5c-146">The number of sets of parameters in the buffer.</span></span>  
  
    -   <span data-ttu-id="eba5c-147">Das in Schritt 3 erstellte Accessorhandle</span><span class="sxs-lookup"><span data-stu-id="eba5c-147">The accessor handle created in Step 3.</span></span>  
  
5.  <span data-ttu-id="eba5c-148">Führen Sie den Befehl mit **ICommand::Execute** aus.</span><span class="sxs-lookup"><span data-stu-id="eba5c-148">Execute the command by using **ICommand::Execute**.</span></span>  
  
## <a name="methods-of-calling-a-stored-procedure"></a><span data-ttu-id="eba5c-149">Methoden zum Aufrufen einer gespeicherten Prozedur</span><span class="sxs-lookup"><span data-stu-id="eba5c-149">Methods of Calling a Stored Procedure</span></span>  
 <span data-ttu-id="eba5c-150">Beim Ausführen einer gespeicherten Prozedur in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] unterstützt der Native Client OLE DB-Anbieter Folgendes:</span><span class="sxs-lookup"><span data-stu-id="eba5c-150">When executing a stored procedure in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports the:</span></span>  
  
-   <span data-ttu-id="eba5c-151">ODBC CALL-Escapesequenz</span><span class="sxs-lookup"><span data-stu-id="eba5c-151">ODBC CALL escape sequence.</span></span>  
  
-   <span data-ttu-id="eba5c-152">RPC-Escapesequenz (Remote Procedure Call, Remoteprozeduraufruf)</span><span class="sxs-lookup"><span data-stu-id="eba5c-152">Remote procedure call (RPC) escape sequence.</span></span>  
  
-   [!INCLUDE[tsql](../../../includes/tsql-md.md)]<span data-ttu-id="eba5c-153">EXECUTE-Anweisung</span><span class="sxs-lookup"><span data-stu-id="eba5c-153">EXECUTE statement.</span></span>  
  
### <a name="odbc-call-escape-sequence"></a><span data-ttu-id="eba5c-154">ODBC CALL-Escapesequenz</span><span class="sxs-lookup"><span data-stu-id="eba5c-154">ODBC CALL Escape Sequence</span></span>  
 <span data-ttu-id="eba5c-155">Wenn Sie die Parameterinformationen kennen, rufen Sie die **ICommandWithParameters::SetParameterInfo**-Methode auf, um dem Anbieter die Parameter zu beschreiben.</span><span class="sxs-lookup"><span data-stu-id="eba5c-155">If you know parameter information, call **ICommandWithParameters::SetParameterInfo** method to describe the parameters to the provider.</span></span> <span data-ttu-id="eba5c-156">Wenn hingegen die ODBC CALL-Syntax zum Aufrufen einer gespeicherten Prozedur verwendet wird, ruft der Anbieter eine Hilfsfunktion auf, um die Parameterinformationen der gespeicherten Prozedur zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="eba5c-156">Otherwise, when the ODBC CALL syntax is used in calling a stored procedure, the provider calls a helper function to find the stored procedure parameter information.</span></span>  
  
 <span data-ttu-id="eba5c-157">Wenn Sie nicht sicher sind, was die Parameterinformationen (Parametermetadaten) betrifft, empfiehlt sich die Verwendung der ODBC CALL-Syntax.</span><span class="sxs-lookup"><span data-stu-id="eba5c-157">If you are not sure about the parameter information (parameter metadata), ODBC CALL syntax is recommended.</span></span>  
  
 <span data-ttu-id="eba5c-158">Die allgemeine Syntax zum Aufrufen einer Prozedur mit der ODBC CALL-Escapesequenz lautet:</span><span class="sxs-lookup"><span data-stu-id="eba5c-158">The general syntax for calling a procedure by using the ODBC CALL escape sequence is:</span></span>  
  
 <span data-ttu-id="eba5c-159">{[**? =**]**aufrufen**_procedure_name_[**(**[*Parameter*] [**,**[*Parameter*]]... **)**]}</span><span class="sxs-lookup"><span data-stu-id="eba5c-159">{[**?=**]**call**_procedure_name_[**(**[*parameter*][**,**[*parameter*]]...**)**]}</span></span>  
  
 <span data-ttu-id="eba5c-160">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="eba5c-160">For example:</span></span>  
  
```  
{call SalesByCategory('Produce', '1995')}  
```  
  
### <a name="rpc-escape-sequence"></a><span data-ttu-id="eba5c-161">RPC-Escapesequenz</span><span class="sxs-lookup"><span data-stu-id="eba5c-161">RPC Escape Sequence</span></span>  
 <span data-ttu-id="eba5c-162">Die RPC-Escapesequenz ist der ODBC CALL-Syntax für den Aufruf einer gespeicherten Prozedur ähnlich.</span><span class="sxs-lookup"><span data-stu-id="eba5c-162">The RPC escape sequence is similar to the ODBC CALL syntax of calling a stored procedure.</span></span> <span data-ttu-id="eba5c-163">Wenn Sie die Prozedur mehrmals aufrufen müssen, ist die RPC-Escapesequenz von den drei Methoden zum Aufrufen einer gespeicherten Prozedur die leistungsfähigste.</span><span class="sxs-lookup"><span data-stu-id="eba5c-163">If you will call the procedure multiple times, the RPC escape sequence provides most optimal performance among the three methods of calling a stored procedure.</span></span>  
  
 <span data-ttu-id="eba5c-164">Wenn die RPC-Escapesequenz zur Ausführung einer gespeicherten Prozedur verwendet wird, ruft der Anbieter keine Hilfsfunktion auf, um die Parameterinformationen zu ermitteln (wie dies bei der ODBC CALL-Syntax der Fall ist).</span><span class="sxs-lookup"><span data-stu-id="eba5c-164">When the RPC escape sequence is used to execute a stored procedure, the provider does not call any helper function to determine the parameter information (as it does in the case of ODBC CALL syntax).</span></span> <span data-ttu-id="eba5c-165">Die RPC-Syntax ist einfacher als die ODBC CALL-Syntax, weshalb der Befehl schneller verarbeitet und die Leistung gesteigert wird.</span><span class="sxs-lookup"><span data-stu-id="eba5c-165">The RPC syntax is simpler than the ODBC CALL syntax, so the command is parsed faster, improving performance.</span></span> <span data-ttu-id="eba5c-166">In diesem Fall müssen Sie die Parameterinformationen durch Ausführen von **ICommandWithParameters::SetParameterInfo** bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="eba5c-166">In this case, you need to provide the parameter information by executing **ICommandWithParameters::SetParameterInfo**.</span></span>  
  
 <span data-ttu-id="eba5c-167">Bei der RPC-Escapesequenz ist es erforderlich, einen Rückgabewert zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="eba5c-167">The RPC escape sequence requires you to have a return value.</span></span> <span data-ttu-id="eba5c-168">Wenn die gespeicherte Prozedur keinen Wert zurückgibt, gibt der Server standardmäßig 0 (null) zurück.</span><span class="sxs-lookup"><span data-stu-id="eba5c-168">If the stored procedure does not return a value, the server returns a 0 by default.</span></span> <span data-ttu-id="eba5c-169">Außerdem können Sie keinen [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-Cursor für die gespeicherte Prozedur öffnen.</span><span class="sxs-lookup"><span data-stu-id="eba5c-169">In addition, you cannot open a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] cursor on the stored procedure.</span></span> <span data-ttu-id="eba5c-170">Die gespeicherte Prozedur wird implizit vorbereitet, und beim Aufruf von **ICommandPrepare::Prepare** tritt ein Fehler auf.</span><span class="sxs-lookup"><span data-stu-id="eba5c-170">The stored procedure is prepared implicitly and the call to **ICommandPrepare::Prepare** will fail.</span></span> <span data-ttu-id="eba5c-171">Da es nicht möglich ist, einen RPC-Aufruf vorzubereiten, können keine Spaltenmetadaten abgefragt werden. IColumnsInfo::GetColumnInfo und IColumnsRowset::GetColumnsRowset geben DB_E_NOTPREPARED zurück.</span><span class="sxs-lookup"><span data-stu-id="eba5c-171">Because of the inability to prepare an RPC call, you can not query column metadata; IColumnsInfo::GetColumnInfo and IColumnsRowset::GetColumnsRowset will return DB_E_NOTPREPARED.</span></span>  
  
 <span data-ttu-id="eba5c-172">Wenn Sie alle Parametermetadaten kennen, ist die RPC-Escapesequenz die empfohlene Methode für die Ausführung gespeicherter Prozeduren.</span><span class="sxs-lookup"><span data-stu-id="eba5c-172">If you know all the parameter metadata, RPC escape sequence is the recommended way to execute stored procedures.</span></span>  
  
 <span data-ttu-id="eba5c-173">Es folgt ein Beispiel für eine RPC-Escapesequenz zum Aufrufen einer gespeicherten Prozedur:</span><span class="sxs-lookup"><span data-stu-id="eba5c-173">This is an example of RPC escape sequence for calling a stored procedure:</span></span>  
  
```  
{rpc SalesByCategory}  
```  
  
 <span data-ttu-id="eba5c-174">Eine Beispielanwendung, die eine RPC-Escapesequenz veranschaulicht, finden Sie unter [Ausführen einer gespeicherten Prozedur &#40;mithilfe der RPC-Syntax&#41; und Verarbeiten von Rückgabecode und Ausgabeparametern &#40;OLE DB&#41;](../../native-client-ole-db-how-to/results/execute-stored-procedure-with-rpc-and-process-output.md).</span><span class="sxs-lookup"><span data-stu-id="eba5c-174">For a sample application that demonstrates an RPC escape sequence, see [Execute a Stored Procedure &#40;Using RPC Syntax&#41; and Process Return Codes and Output Parameters &#40;OLE DB&#41;](../../native-client-ole-db-how-to/results/execute-stored-procedure-with-rpc-and-process-output.md).</span></span>  
  
### <a name="transact-sql-execute-statement"></a><span data-ttu-id="eba5c-175">'EXECUTE'-Anweisung (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="eba5c-175">Transact-SQL EXECUTE Statement</span></span>  
 <span data-ttu-id="eba5c-176">Die ODBC CALL-Escapesequenz und die RPC-Escapesequenz stellen im Vergleich zur [EXECUTE](/sql/t-sql/language-elements/execute-transact-sql)-Anweisung die bevorzugten Methoden zum Aufrufen einer gespeicherten Prozedur dar.</span><span class="sxs-lookup"><span data-stu-id="eba5c-176">The ODBC CALL escape sequence and the RPC escape sequence are the preferred methods for calling a stored procedure rather than the [EXECUTE](/sql/t-sql/language-elements/execute-transact-sql) statement.</span></span> <span data-ttu-id="eba5c-177">Der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter verwendet den RPC-Mechanismus von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , um die Befehls Verarbeitung zu optimieren.</span><span class="sxs-lookup"><span data-stu-id="eba5c-177">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider uses the RPC mechanism of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to optimize command processing.</span></span> <span data-ttu-id="eba5c-178">Dieses RPC-Protokoll erhöht die Leistung, indem es einen Großteil der Parameterverarbeitung und Anweisungsauswertung auf dem Server überflüssig macht.</span><span class="sxs-lookup"><span data-stu-id="eba5c-178">This RPC protocol increases performance by eliminating much of the parameter processing and statement parsing done on the server.</span></span>  
  
 <span data-ttu-id="eba5c-179">Dies ist ein Beispiel für die -Anweisung [!INCLUDE[tsql](../../../includes/tsql-md.md)] **EXECUTE**:</span><span class="sxs-lookup"><span data-stu-id="eba5c-179">This is an example of the [!INCLUDE[tsql](../../../includes/tsql-md.md)] **EXECUTE** statement:</span></span>  
  
```  
EXECUTE SalesByCategory 'Produce', '1995'  
```  
  
## <a name="see-also"></a><span data-ttu-id="eba5c-180">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="eba5c-180">See Also</span></span>  
 [<span data-ttu-id="eba5c-181">Gespeicherte Prozeduren</span><span class="sxs-lookup"><span data-stu-id="eba5c-181">Stored Procedures</span></span>](stored-procedures.md)  
  
  

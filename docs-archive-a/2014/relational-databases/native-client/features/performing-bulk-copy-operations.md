---
title: Ausführen von Massenkopiervorgängen | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- bulk copy [SQL Server Native Client]
- data access [SQL Server Native Client], bulk copy operations
- SQL Server Native Client, bulk copy operations
- SQLNCLI, bulk copy operations
ms.assetid: 50d8456b-e6a1-4b25-bc7e-56946ed654a7
author: rothja
ms.author: jroth
ms.openlocfilehash: 51a4cd3ebd4cb2e16baa75a268bf307a549a694b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87609870"
---
# <a name="performing-bulk-copy-operations"></a><span data-ttu-id="72a2f-102">Durchführen von Massenkopiervorgängen</span><span class="sxs-lookup"><span data-stu-id="72a2f-102">Performing Bulk Copy Operations</span></span>
  <span data-ttu-id="72a2f-103">Die Massenkopierfunktion von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] unterstützt die Übertragung großer Datenmengen in bzw. aus einer [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-Tabelle oder Sicht.</span><span class="sxs-lookup"><span data-stu-id="72a2f-103">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy feature supports the transfer of large amounts of data into or out of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table or view.</span></span> <span data-ttu-id="72a2f-104">Daten können auch mithilfe einer SELECT-Anweisung aus einer Tabelle oder Sicht übertragen werden.</span><span class="sxs-lookup"><span data-stu-id="72a2f-104">Data can also be transferred out by specifying a SELECT statement.</span></span> <span data-ttu-id="72a2f-105">Die Daten können zwischen [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] und einer Betriebssystemdatendatei verschoben werden, z. B. eine ASCII-Datei.</span><span class="sxs-lookup"><span data-stu-id="72a2f-105">The data can be moved between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and an operating-system data file, such as an ASCII file.</span></span> <span data-ttu-id="72a2f-106">Datendateien können verschiedene Formate aufweisen. Das Format wird in einer Formatdatei definiert.</span><span class="sxs-lookup"><span data-stu-id="72a2f-106">The data file can have different formats; the format is defined to bulk copy in a format file.</span></span> <span data-ttu-id="72a2f-107">Optional können die Daten in Programmvariablen geladen und mithilfe von Massenkopierfunktionen und -methoden in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] übertragen werden.</span><span class="sxs-lookup"><span data-stu-id="72a2f-107">Optionally, data can be loaded into program variables and transferred to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] using bulk copy functions and methods.</span></span>  
  
 <span data-ttu-id="72a2f-108">Eine Beispielanwendung zur Veranschaulichung dieses Features finden Sie unter [Massenkopieren von Daten mithilfe von IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="72a2f-108">For a sample application that demonstrates this feature, see [Bulk Copy Data Using IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md).</span></span>  
  
 <span data-ttu-id="72a2f-109">Eine Anwendung verwendet Massenkopiervorgänge in der Regel in einer der folgenden Arten:</span><span class="sxs-lookup"><span data-stu-id="72a2f-109">An application typically uses bulk copy in one of the following ways:</span></span>  
  
-   <span data-ttu-id="72a2f-110">Massenkopieren aus einer Tabelle, Sicht oder dem Resultset einer Transact-SQL-Anweisung in eine Datendatei, in der die Daten im selben Format gespeichert werden wie in der Tabelle bzw. Sicht.</span><span class="sxs-lookup"><span data-stu-id="72a2f-110">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in the same format as the table or view.</span></span>  
  
     <span data-ttu-id="72a2f-111">Diese Datei wird als Datendatei im einheitlichen Modus bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="72a2f-111">This is called a native-mode data file.</span></span>  
  
-   <span data-ttu-id="72a2f-112">Massenkopieren aus einer Tabelle, Sicht oder dem Resultset einer Transact-SQL-Anweisung in eine Datendatei, in der die Daten in einem anderen Format gespeichert werden als in der Tabelle bzw. Sicht.</span><span class="sxs-lookup"><span data-stu-id="72a2f-112">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in a format other than the one of the table or view.</span></span>  
  
     <span data-ttu-id="72a2f-113">In diesem Fall wird eine separate Formatdatei erstellt, in der die Charakteristika (Datentyp, Position, Länge, Abschlusszeichen, usw.) der einzelnen, in der Datendatei zu speichernden Spalten definiert werden.</span><span class="sxs-lookup"><span data-stu-id="72a2f-113">In this case, a separate format file is created that defines the characteristics (data type, position, length, terminator, and so on) of each column as it is stored in the data file.</span></span> <span data-ttu-id="72a2f-114">Wenn alle Spalten in Zeichenformat konvertiert werden, wird die resultierende Datei als Datendatei im Zeichenmodus bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="72a2f-114">If all columns are converted to character format, the resulting file is called a character-mode data file.</span></span>  
  
-   <span data-ttu-id="72a2f-115">Massenkopieren aus einer Datendatei in eine Tabelle oder Sicht.</span><span class="sxs-lookup"><span data-stu-id="72a2f-115">Bulk copy from a data file into a table or view.</span></span>  
  
     <span data-ttu-id="72a2f-116">Gegebenenfalls wird eine Formatdatei verwendet, um das Layout der Datendatei zu bestimmen.</span><span class="sxs-lookup"><span data-stu-id="72a2f-116">If needed, a format file is used to determine the layout of the data file.</span></span>  
  
-   <span data-ttu-id="72a2f-117">Laden der Daten in Programmvariablen und anschließender Import der Daten in eine Tabelle oder Sicht unter Verwendung der Massenkopierfunktionen für das Massenkopieren von jeweils einer Zeile.</span><span class="sxs-lookup"><span data-stu-id="72a2f-117">Load data into program variables, then import the data into a table or view using the bulk copy functions for bulk copying in a row at a time.</span></span>  
  
 <span data-ttu-id="72a2f-118">Datendateien, die von Massenkopierfunktionen verwendet werden, brauchen nicht von einem anderen Massenkopierprogramm erstellt worden sein.</span><span class="sxs-lookup"><span data-stu-id="72a2f-118">Data files used by bulk copy functions do not have to be created by another bulk copy program.</span></span> <span data-ttu-id="72a2f-119">Beliebige andere Systeme können entsprechend den Massenkopierdefinitionen Datendateien und Formatdateien generieren. Diese Dateien können dann mit einem [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-Massenkopierprogramm verwendet werden, um Daten in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] zu importieren.</span><span class="sxs-lookup"><span data-stu-id="72a2f-119">Any other system can generate a data file and format file according to bulk copy definitions; these files can then be used with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy program to import data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="72a2f-120">Beispielsweise könnten Sie Daten aus einer Kalkulationstabelle in eine durch Tabstopps getrennte Datei exportieren, eine die durch Tabstopps getrennte Datei in einer Formatdatei beschreiben und schließlich mithilfe eines Massenkopierprogramms die Daten in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] importieren.</span><span class="sxs-lookup"><span data-stu-id="72a2f-120">For example, you could export data from a spreadsheet in a tab-delimited file, build a format file describing the tab-delimited file, and then use a bulk copy program to quickly import the data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="72a2f-121">Datendateien, die mit einer Massenkopierfunktion generiert wurden, können auch in andere Anwendungen importiert werden.</span><span class="sxs-lookup"><span data-stu-id="72a2f-121">Data files generated by bulk copy can also be imported into other applications.</span></span> <span data-ttu-id="72a2f-122">Beispielsweise könnten Sie Massenkopierfunktionen verwenden, um Daten aus einer Tabelle oder Sicht in eine durch Tabstopps getrennte Datei zu exportieren, die Sie dann in eine Kalkulationstabelle laden.</span><span class="sxs-lookup"><span data-stu-id="72a2f-122">For example, you could use bulk copy functions to export data from a table or view into a tab-delimited file that could then be loaded into a spreadsheet.</span></span>  
  
 <span data-ttu-id="72a2f-123">Programmierern von Anwendungen, die Massenkopierfunktionen verwenden, wird empfohlen, folgende allgemeine Regeln zu beachten, um die Leistung des Massenkopierens zu gewähren.</span><span class="sxs-lookup"><span data-stu-id="72a2f-123">Programmers coding applications to use the bulk copy functions should follow the general rules for good bulk copy performance.</span></span> <span data-ttu-id="72a2f-124">Weitere Informationen zur Unterstützung für Massenladevorgänge in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] finden Sie unter [Massenimport und -export von Daten &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="72a2f-124">For more information about support for bulk copy operations in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], see [Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md).</span></span>  
  
## <a name="limitations-and-restrictions"></a><span data-ttu-id="72a2f-125">Einschränkungen</span><span class="sxs-lookup"><span data-stu-id="72a2f-125">Limitations and Restrictions</span></span>  
 <span data-ttu-id="72a2f-126">Ein CLR-benutzerdefinierter Typ (User Defined Type, UDT) muss als Binärdaten gebunden werden.</span><span class="sxs-lookup"><span data-stu-id="72a2f-126">A CLR user-defined type (UDT) must be bound as binary data.</span></span> <span data-ttu-id="72a2f-127">Auch wenn eine Formatdatei SQLCHAR als Datentyp für eine Ziel-UDT-Spalte angibt, verarbeitet das BCP-Hilfsprogramm die Daten als Binärdaten.</span><span class="sxs-lookup"><span data-stu-id="72a2f-127">Even if a format file specifies SQLCHAR as the data type for a target UDT column, The BCP utility will treat the data as binary.</span></span>  
  
 <span data-ttu-id="72a2f-128">SET FMTONLY OFF kann nicht mit Massenkopiervorgängen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="72a2f-128">Do not use SET FMTONLY OFF with bulk copy operations.</span></span> <span data-ttu-id="72a2f-129">SET FMTONLY OFF führt möglicherweise bei Massenkopiervorgängen zu unerwarteten Ergebnissen oder Fehlern.</span><span class="sxs-lookup"><span data-stu-id="72a2f-129">SET FMTONLY OFF may cause your bulk copy operation to fail or give unexpected results.</span></span>  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="72a2f-130">SQL Server Native Client OLE DB-Anbieter</span><span class="sxs-lookup"><span data-stu-id="72a2f-130">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="72a2f-131">Der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter implementiert zwei Methoden zum Ausführen von Massen Kopier Vorgängen mit einer- [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Datenbank.</span><span class="sxs-lookup"><span data-stu-id="72a2f-131">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements two methods for performing bulk copy operations with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="72a2f-132">Bei der ersten Methode kommt die [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md)-Schnittstelle für speicherbasierte Massenkopiervorgänge zur Anwendung. Die zweite Methode stützt sich auf die [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md)-Schnittstelle für dateibasierte Massenkopiervorgänge.</span><span class="sxs-lookup"><span data-stu-id="72a2f-132">The first method involves using the [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) interface for memory-based bulk copy operations; and the second involves using the [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) interface for file-based bulk copy operations.</span></span>  
  
### <a name="using-memory-based-bulk-copy-operations"></a><span data-ttu-id="72a2f-133">Verwenden von speicherbasierten Massenkopiervorgängen</span><span class="sxs-lookup"><span data-stu-id="72a2f-133">Using Memory Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="72a2f-134">Der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter implementiert die **IRowsetFastLoad** -Schnittstelle, um die Unterstützung für [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] speicherbasierte Massen Kopiervorgänge verfügbar zu machen.</span><span class="sxs-lookup"><span data-stu-id="72a2f-134">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IRowsetFastLoad** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] memory-based bulk copy operations.</span></span> <span data-ttu-id="72a2f-135">Die **IRowsetFastLoad**-Schnittstelle implementiert die Methoden [IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) und [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="72a2f-135">The **IRowsetFastLoad** interface implements the [IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) and [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md) methods.</span></span>  
  
#### <a name="enabling-a-session-for-irowsetfastload"></a><span data-ttu-id="72a2f-136">Aktivieren einer Sitzung für IRowsetFastLoad</span><span class="sxs-lookup"><span data-stu-id="72a2f-136">Enabling a Session for IRowsetFastLoad</span></span>  
 <span data-ttu-id="72a2f-137">Der Consumer benachrichtigt den [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client-OLE DB-Anbieter, dass ein Massenkopiervorgang erforderlich ist, indem er für die SSPROP_ENABLEFASTLOAD-Eigenschaft, die für den systemeigenen [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Client-OLE DB-Anbieter spezifisch ist, VARIANT_TRUE festlegt.</span><span class="sxs-lookup"><span data-stu-id="72a2f-137">The consumer notifies the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider of its need for bulk copy by setting the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider-specific data source property SSPROP_ENABLEFASTLOAD to VARIANT_TRUE.</span></span> <span data-ttu-id="72a2f-138">Wenn die Datenquelle für die Eigenschaft festgelegt wurde, erstellt der Consumer eine [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client-OLE DB-Anbietersitzung.</span><span class="sxs-lookup"><span data-stu-id="72a2f-138">With the property set on the data source, the consumer creates a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session.</span></span> <span data-ttu-id="72a2f-139">Die neue Sitzung lässt den Zugriff des Consumers auf die **IRowsetFastLoad**-Schnittstelle zu.</span><span class="sxs-lookup"><span data-stu-id="72a2f-139">The new session allows consumer access to the **IRowsetFastLoad** interface.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="72a2f-140">Wenn die **IDataInitialize**-Schnittstelle für die Initialisierung der Datenquelle verwendet wird, muss die SSPROP_IRowsetFastLoad-Eigenschaft im *rgPropertySets*-Parameter der **IOpenRowset::OpenRowset**-Methode festgelegt werden. Andernfalls gibt der Aufruf der **OpenRowset**-Methode E_NOINTERFACE zurück.</span><span class="sxs-lookup"><span data-stu-id="72a2f-140">If the **IDataInitialize** interface is used for initializing the data source, then it is necessary to set the SSPROP_IRowsetFastLoad property in the *rgPropertySets* parameter of the **IOpenRowset::OpenRowset** method; otherwise, the call to the **OpenRowset** method will return E_NOINTERFACE.</span></span>  
  
 <span data-ttu-id="72a2f-141">Das Aktivieren einer Sitzung zum Massenkopieren schränkt die Unterstützung des [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client-OLE DB-Anbieters für Schnittstellen in dieser Sitzung ein.</span><span class="sxs-lookup"><span data-stu-id="72a2f-141">Enabling a session for bulk copy constrains the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider support for interfaces on the session.</span></span> <span data-ttu-id="72a2f-142">Eine Sitzung mit aktivierter Massenkopierfunktion bietet lediglich die folgenden Schnittstellen:</span><span class="sxs-lookup"><span data-stu-id="72a2f-142">A bulk copy-enabled session exposes only the following interfaces:</span></span>  
  
-   <span data-ttu-id="72a2f-143">**IDBSchemaRowset**</span><span class="sxs-lookup"><span data-stu-id="72a2f-143">**IDBSchemaRowset**</span></span>  
  
-   <span data-ttu-id="72a2f-144">**IGetDataSource**</span><span class="sxs-lookup"><span data-stu-id="72a2f-144">**IGetDataSource**</span></span>  
  
-   <span data-ttu-id="72a2f-145">**IOpenRowset**</span><span class="sxs-lookup"><span data-stu-id="72a2f-145">**IOpenRowset**</span></span>  
  
-   <span data-ttu-id="72a2f-146">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="72a2f-146">**ISupportErrorInfo**</span></span>  
  
-   <span data-ttu-id="72a2f-147">**ITransactionJoin**</span><span class="sxs-lookup"><span data-stu-id="72a2f-147">**ITransactionJoin**</span></span>  
  
 <span data-ttu-id="72a2f-148">Um die Erstellung massenkopierter Rowsets zu deaktivieren und die [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client-OLE DB-Anbietersitzung auf die Standardverarbeitungsweise zurückzusetzen, legen Sie für SSPROP_ENABLEFASTLOAD den Parameter VARIANT_FALSE fest.</span><span class="sxs-lookup"><span data-stu-id="72a2f-148">To disable the creation of bulk copy-enabled rowsets and cause the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session to revert to standard processing, reset SSPROP_ENABLEFASTLOAD to VARIANT_FALSE.</span></span>  
  
#### <a name="irowsetfastload-rowsets"></a><span data-ttu-id="72a2f-149">IRowsetFastLoad Rowsets</span><span class="sxs-lookup"><span data-stu-id="72a2f-149">IRowsetFastLoad Rowsets</span></span>  
 <span data-ttu-id="72a2f-150">Die massenkopierten Rowsets im [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client-OLE DB-Anbieter weisen nur Schreibzugriff auf, machen jedoch Schnittstellen verfügbar, die dem Consumer ermöglichen, die Struktur einer [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-Tabelle zu bestimmen.</span><span class="sxs-lookup"><span data-stu-id="72a2f-150">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk copy rowsets are write-only, but they expose interfaces that allow the consumer to determine the structure of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="72a2f-151">Die folgenden Schnittstellen sind in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client-OLE DB-Anbieterrowsets verfügbar, in denen die Massenkopierfunktion aktiviert ist:</span><span class="sxs-lookup"><span data-stu-id="72a2f-151">The following interfaces are exposed on a bulk copy-enabled [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider rowset:</span></span>  
  
-   <span data-ttu-id="72a2f-152">**IAccessor**</span><span class="sxs-lookup"><span data-stu-id="72a2f-152">**IAccessor**</span></span>  
  
-   <span data-ttu-id="72a2f-153">**IColumnsInfo**</span><span class="sxs-lookup"><span data-stu-id="72a2f-153">**IColumnsInfo**</span></span>  
  
-   <span data-ttu-id="72a2f-154">**IColumnsRowset**</span><span class="sxs-lookup"><span data-stu-id="72a2f-154">**IColumnsRowset**</span></span>  
  
-   <span data-ttu-id="72a2f-155">**IConvertType**</span><span class="sxs-lookup"><span data-stu-id="72a2f-155">**IConvertType**</span></span>  
  
-   <span data-ttu-id="72a2f-156">**IRowsetFastLoad**</span><span class="sxs-lookup"><span data-stu-id="72a2f-156">**IRowsetFastLoad**</span></span>  
  
-   <span data-ttu-id="72a2f-157">**IRowsetInfo**</span><span class="sxs-lookup"><span data-stu-id="72a2f-157">**IRowsetInfo**</span></span>  
  
-   <span data-ttu-id="72a2f-158">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="72a2f-158">**ISupportErrorInfo**</span></span>  
  
 <span data-ttu-id="72a2f-159">Die anbieterspezifischen Eigenschaften SSPROP_FASTLOADOPTIONS, SSPROP_FASTLOADKEEPNULLS und SSPROP_FASTLOADKEEPIDENTITY steuern die Verhalten des Massenkopierrowsets eines [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client-OLE DB-Anbieters.</span><span class="sxs-lookup"><span data-stu-id="72a2f-159">The provider-specific properties SSPROP_FASTLOADOPTIONS, SSPROP_FASTLOADKEEPNULLS, and SSPROP_FASTLOADKEEPIDENTITY control behaviors of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk-copy rowset.</span></span> <span data-ttu-id="72a2f-160">Die Eigenschaften werden im *rgProperties* -Member eines _rgPropertySets_-**IOpenRowset**-Parameter Elements angegeben.</span><span class="sxs-lookup"><span data-stu-id="72a2f-160">The properties are specified in the *rgProperties* member of an _rgPropertySets_**IOpenRowset**parameter member.</span></span>  
  
|<span data-ttu-id="72a2f-161">Eigenschafts-ID</span><span class="sxs-lookup"><span data-stu-id="72a2f-161">Property ID</span></span>|<span data-ttu-id="72a2f-162">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="72a2f-162">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="72a2f-163">SSPROP_FASTLOADKEEPIDENTITY</span><span class="sxs-lookup"><span data-stu-id="72a2f-163">SSPROP_FASTLOADKEEPIDENTITY</span></span>|<span data-ttu-id="72a2f-164">Spalte: Nein</span><span class="sxs-lookup"><span data-stu-id="72a2f-164">Column: No</span></span><br /><br /> <span data-ttu-id="72a2f-165">R/W: Lesen/Schreiben</span><span class="sxs-lookup"><span data-stu-id="72a2f-165">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="72a2f-166">Typ: VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="72a2f-166">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="72a2f-167">Standardwert: VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="72a2f-167">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="72a2f-168">Beschreibung: Verwaltet vom Consumer angegebene Identitätswerte.</span><span class="sxs-lookup"><span data-stu-id="72a2f-168">Description: Maintains identity values supplied by the consumer.</span></span><br /><br /> <span data-ttu-id="72a2f-169">VARIANT_FALSE: Werte für eine Identitätsspalte in der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-Tabelle werden von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] generiert.</span><span class="sxs-lookup"><span data-stu-id="72a2f-169">VARIANT_FALSE: Values for an identity column in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table are generated by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="72a2f-170">Alle Werte, die für die Spalte gebunden sind, werden vom [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter ignoriert.</span><span class="sxs-lookup"><span data-stu-id="72a2f-170">Any value bound for the column is ignored by the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span><br /><br /> <span data-ttu-id="72a2f-171">VARIANT_TRUE: Der Consumer bindet einen Accessor, der einen Wert für eine [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-Identitätsspalte bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="72a2f-171">VARIANT_TRUE: The consumer binds an accessor providing a value for a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] identity column.</span></span> <span data-ttu-id="72a2f-172">Die IDENTITY-Eigenschaft ist nicht für Spalten verfügbar, die NULL-Werte akzeptieren, daher stellt der Consumer für jeden **IRowsetFastLoad::Insert**-Aufruf einen eindeutigen Wert bereit.</span><span class="sxs-lookup"><span data-stu-id="72a2f-172">The identity property is not available on columns accepting NULL, so the consumer provides a unique value on each **IRowsetFastLoad::Insert** call.</span></span>|  
|<span data-ttu-id="72a2f-173">SSPROP_FASTLOADKEEPNULLS</span><span class="sxs-lookup"><span data-stu-id="72a2f-173">SSPROP_FASTLOADKEEPNULLS</span></span>|<span data-ttu-id="72a2f-174">Spalte: Nein</span><span class="sxs-lookup"><span data-stu-id="72a2f-174">Column: No</span></span><br /><br /> <span data-ttu-id="72a2f-175">R/W: Lesen/Schreiben</span><span class="sxs-lookup"><span data-stu-id="72a2f-175">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="72a2f-176">Typ: VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="72a2f-176">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="72a2f-177">Standardwert: VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="72a2f-177">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="72a2f-178">Beschreibung: Behält NULL-Werte für Spalten mit einer DEFAULT-Einschränkung bei.</span><span class="sxs-lookup"><span data-stu-id="72a2f-178">Description: Maintains NULL for columns with a DEFAULT constraint.</span></span> <span data-ttu-id="72a2f-179">Betrifft nur [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-Spalten, die NULL-Werte akzeptieren und eine DEFAULT-Einschränkung aufweisen.</span><span class="sxs-lookup"><span data-stu-id="72a2f-179">Affects only [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] columns that accept NULL and have a DEFAULT constraint applied.</span></span><br /><br /> <span data-ttu-id="72a2f-180">VARIANT_FALSE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] fügt den Standardwert für die Spalte ein, wenn der Consumer des [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client-OLE DB-Anbieters eine Zeile einfügt, die einen NULL-Wert für die Spalte enthält.</span><span class="sxs-lookup"><span data-stu-id="72a2f-180">VARIANT_FALSE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts the default value for the column when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span><br /><br /> <span data-ttu-id="72a2f-181">VARIANT_TRUE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] fügt einen NULL-Wert in die Spalte ein, wenn der Consumer des [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client-OLE DB-Anbieters eine Zeile einfügt, die einen NULL-Wert für die Spalte enthält.</span><span class="sxs-lookup"><span data-stu-id="72a2f-181">VARIANT_TRUE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts NULL for the column value when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span>|  
|<span data-ttu-id="72a2f-182">SSPROP_FASTLOADOPTIONS</span><span class="sxs-lookup"><span data-stu-id="72a2f-182">SSPROP_FASTLOADOPTIONS</span></span>|<span data-ttu-id="72a2f-183">Spalte: Nein</span><span class="sxs-lookup"><span data-stu-id="72a2f-183">Column: No</span></span><br /><br /> <span data-ttu-id="72a2f-184">R/W: Lesen/Schreiben</span><span class="sxs-lookup"><span data-stu-id="72a2f-184">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="72a2f-185">Typ: VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="72a2f-185">Type: VT_BSTR</span></span><br /><br /> <span data-ttu-id="72a2f-186">Standardwert: keiner</span><span class="sxs-lookup"><span data-stu-id="72a2f-186">Default: none</span></span><br /><br /> <span data-ttu-id="72a2f-187">Beschreibung: Diese Eigenschaft ist mit der **-h** "*hint*[,...*n*]"-Option des **BCP**-Hilfsprogramms identisch.</span><span class="sxs-lookup"><span data-stu-id="72a2f-187">Description: This property is the same as the **-h** "*hint*[,...*n*]" option of the **bcp** utility.</span></span> <span data-ttu-id="72a2f-188">Die folgende(n) Zeichenfolge(n) kann/können beim Massenkopieren von Daten in eine Tabelle optional verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="72a2f-188">The following string(s) can be used as option(s) in the bulk copying of data into a table.</span></span><br /><br /> <span data-ttu-id="72a2f-189">**ORDER**(*column*[**ASC** &#124; **DESC**][,...*n*]): Sortierreihenfolge der Daten in der Datendatei.</span><span class="sxs-lookup"><span data-stu-id="72a2f-189">**ORDER**(*column*[**ASC** &#124; **DESC**][,...*n*]): Sort order of data in the data file.</span></span> <span data-ttu-id="72a2f-190">Die Leistung des Massenkopierens wird verbessert, wenn die zu ladende Datendatei entsprechend dem gruppierten Index der Tabelle sortiert ist.</span><span class="sxs-lookup"><span data-stu-id="72a2f-190">Bulk copy performance is improved if the data file being loaded is sorted according to the clustered index on the table.</span></span><br /><br /> <span data-ttu-id="72a2f-191">**ROWS_PER_BATCH** = *bb*: Die Anzahl von Datenzeilen pro Batch (als *bb*).</span><span class="sxs-lookup"><span data-stu-id="72a2f-191">**ROWS_PER_BATCH** = *bb*: Number of rows of data per batch (as *bb*).</span></span> <span data-ttu-id="72a2f-192">Der Server optimiert das Massenladen entsprechend dem Wert von *bb*.</span><span class="sxs-lookup"><span data-stu-id="72a2f-192">The server optimizes the bulk load according to the value *bb*.</span></span> <span data-ttu-id="72a2f-193">Standardmäßig ist **ROWS_PER_BATCH** unbekannt.</span><span class="sxs-lookup"><span data-stu-id="72a2f-193">By default, **ROWS_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="72a2f-194">**KILOBYTES_PER_BATCH** = *cc*: Anzahl von Kilobyte (KB) an Daten pro Batch (als „cc“).</span><span class="sxs-lookup"><span data-stu-id="72a2f-194">**KILOBYTES_PER_BATCH** = *cc*: Number of kilobytes (KB) of data per batch (as cc).</span></span> <span data-ttu-id="72a2f-195">Standardmäßig ist **KILOBYTES_PER_BATCH** unbekannt.</span><span class="sxs-lookup"><span data-stu-id="72a2f-195">By default, **KILOBYTES_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="72a2f-196">**TABLOCK**: Für die Dauer des Massenimportvorgangs wird eine Sperre auf Tabellenebene aktiviert.</span><span class="sxs-lookup"><span data-stu-id="72a2f-196">**TABLOCK**: A table-level lock is acquired for the duration of the bulk copy operation.</span></span> <span data-ttu-id="72a2f-197">Diese Option verbessert die Leistung beträchtlich, da weniger Sperrkonflikte für die Tabelle auftreten, wenn diese nur während des Massenkopiervorgangs gesperrt wird.</span><span class="sxs-lookup"><span data-stu-id="72a2f-197">This option significantly improves performance because holding a lock only for the duration of the bulk copy operation reduces lock contention on the table.</span></span> <span data-ttu-id="72a2f-198">Eine Tabelle kann gleichzeitig von mehreren Clients geladen werden, wenn die Tabelle keine Indizes aufweist und **TABLOCK** angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="72a2f-198">A table can be loaded by multiple clients concurrently if the table has no indexes and **TABLOCK** is specified.</span></span> <span data-ttu-id="72a2f-199">Standardmäßig wird das Sperrverhalten durch die Tabellenoption **table lock on bulk load** bestimmt.</span><span class="sxs-lookup"><span data-stu-id="72a2f-199">By default, the locking behavior is determined by the table option **table lock on bulk load**.</span></span><br /><br /> <span data-ttu-id="72a2f-200">**CHECK_CONSTRAINTS**: Alle Einschränkungen für*table_name* werden während des Massenkopiervorgangs überprüft.</span><span class="sxs-lookup"><span data-stu-id="72a2f-200">**CHECK_CONSTRAINTS**: Any constraints on *table_name* are checked during the bulk copy operation.</span></span> <span data-ttu-id="72a2f-201">Standardmäßig werden Einschränkungen ignoriert.</span><span class="sxs-lookup"><span data-stu-id="72a2f-201">By default, constraints are ignored.</span></span><br /><br /> <span data-ttu-id="72a2f-202">**FIRE_TRIGGER**: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] verwendet die Zeilenversionsverwaltung für Trigger und speichert die Zeilenversionen im Versionsspeicher in **tempdb**.</span><span class="sxs-lookup"><span data-stu-id="72a2f-202">**FIRE_TRIGGER**: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] uses row versioning for triggers and stores the row versions in the version store in **tempdb**.</span></span> <span data-ttu-id="72a2f-203">Deshalb sind Massenprotokollierungsoptimierungen verfügbar, auch wenn Trigger aktiviert sind.</span><span class="sxs-lookup"><span data-stu-id="72a2f-203">Therefore, bulk logging optimizations are available even when triggers are enabled.</span></span> <span data-ttu-id="72a2f-204">Bevor Sie einen Massenimport eines Batches mit einer großen Anzahl von Zeilen vornehmen, für die Trigger aktiviert sind, müssen Sie gegebenenfalls die Größe von **tempdb** erweitern.</span><span class="sxs-lookup"><span data-stu-id="72a2f-204">Before bulk importing a batch with a large number of rows with triggers enabled, you may need to expand the size of **tempdb**.</span></span>|  
  
### <a name="using-file-based-bulk-copy-operations"></a><span data-ttu-id="72a2f-205">Verwenden von dateibasierten Massenkopiervorgängen</span><span class="sxs-lookup"><span data-stu-id="72a2f-205">Using File Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="72a2f-206">Der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter implementiert die **IBCPSession** -Schnittstelle, um die Unterstützung für [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] dateibasierte Massen Kopiervorgänge verfügbar zu machen.</span><span class="sxs-lookup"><span data-stu-id="72a2f-206">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IBCPSession** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] file-based bulk copy operations.</span></span> <span data-ttu-id="72a2f-207">Die **IBCPSession**-Schnittstelle implementiert die Methoden [IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md), [IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md), [IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md), [IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md), [IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md), [IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md), [IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md) und [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="72a2f-207">The **IBCPSession** interface implements the [IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md), [IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md), [IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md), [IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md), [IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md), [IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md), [IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md), and [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md)methods.</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="72a2f-208">ODBC-Treiber für SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="72a2f-208">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="72a2f-209">Der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client-ODBC-Treiber unterstützt Massenkopiervorgänge in derselben Weise wie in Vorgängerversionen [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] des ODBC-Treibers.</span><span class="sxs-lookup"><span data-stu-id="72a2f-209">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver maintains the same support for bulk copy operations that were part of previous versions of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ODBC driver.</span></span> <span data-ttu-id="72a2f-210">Informationen zu Massen Kopier Vorgängen mithilfe des [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client-ODBC-Treibers finden Sie unter [Durchführen von Massen Kopier Vorgängen &#40;ODBC-&#41;](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="72a2f-210">For information about bulk copy operations using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, see [Performing Bulk Copy Operations &#40;ODBC&#41;](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="72a2f-211">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="72a2f-211">See Also</span></span>  
 <span data-ttu-id="72a2f-212">[SQL Server Native Client-Funktionen](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="72a2f-212">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 <span data-ttu-id="72a2f-213">[Datenquelleneigenschaften &#40;OLE DB&#41;](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="72a2f-213">[Data Source Properties &#40;OLE DB&#41;](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span></span>  
 <span data-ttu-id="72a2f-214">[Massenimport und -export von Daten &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="72a2f-214">[Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span></span>  
 <span data-ttu-id="72a2f-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="72a2f-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span></span>  
 <span data-ttu-id="72a2f-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="72a2f-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span></span>  
 <span data-ttu-id="72a2f-217">[Optimieren der Leistung des Massenimports](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span><span class="sxs-lookup"><span data-stu-id="72a2f-217">[Optimizing Bulk Import Performance](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span></span>  
  
  

---
title: Programmgesteuertes Ändern von Kennwörtern | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- data access [SQL Server Native Client], password expiration
- SQL Server Native Client ODBC driver, passwords
- SQL Server Native Client OLE DB provider, passwords
- passwords [SQL Server], expiration
- SQLNCLI, password expiration
- expiration [SQL Server Native Client]
- passwords [SQL Server], modifying
- expired passwords [SQL Server Native Client]
- SQL Server Native Client, password expiration
- modifying passwords
ms.assetid: 624ad949-5fed-4ce5-b319-878549f9487b
author: rothja
ms.author: jroth
ms.openlocfilehash: 86085f8ba7c54cfcab1a3c7f6e8ade30ecf9d0da
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87698103"
---
# <a name="changing-passwords-programmatically"></a><span data-ttu-id="ee1e9-102">Programmgesteuertes Ändern von Kennwörtern</span><span class="sxs-lookup"><span data-stu-id="ee1e9-102">Changing Passwords Programmatically</span></span>
  <span data-ttu-id="ee1e9-103">Vor [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] konnte nur ein Administrator ein abgelaufenes Kennwort eines Benutzers zurücksetzen.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-103">Before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], when a user's password expired, only an administrator could reset it.</span></span> <span data-ttu-id="ee1e9-104">Ab [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] unterstützt Native Client die programmgesteuerte Verarbeitung des Kenn Wort Ablaufs sowohl über den [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter als auch [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] über den Native Client-ODBC-Treiber und durch Änderungen an den **SQL Server Anmelde** Dialogfeldern.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-104">Beginning with [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supports handling password expiration programmatically through both the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, and through changes to the **SQL Server Login** dialog boxes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ee1e9-105">Fordern Sie, wenn möglich, Benutzer dazu auf, ihre Anmeldeinformationen zur Laufzeit einzugeben, um zu vermeiden, diese Informationen in einem persistenten Format speichern zu müssen.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-105">When possible, prompt users to enter their credentials at run time and avoid storing their credentials in a persisted format.</span></span> <span data-ttu-id="ee1e9-106">Wenn Sie die Anmeldeinformationen persistent speichern müssen, verschlüsseln Sie sie mit der [Win32 Crypto-API](https://go.microsoft.com/fwlink/?LinkId=64532).</span><span class="sxs-lookup"><span data-stu-id="ee1e9-106">If you must persist their credentials, you should encrypt them using the [Win32 crypto API](https://go.microsoft.com/fwlink/?LinkId=64532).</span></span> <span data-ttu-id="ee1e9-107">Weitere Informationen zur Verwendung von Kennwörtern finden Sie unter [Sichere Kennwörter](../../security/strong-passwords.md).</span><span class="sxs-lookup"><span data-stu-id="ee1e9-107">For more information about the use of passwords, see [Strong Passwords](../../security/strong-passwords.md).</span></span>  
  
## <a name="sql-server-login-error-codes"></a><span data-ttu-id="ee1e9-108">Fehlercodes bei der SQL Server-Anmeldung</span><span class="sxs-lookup"><span data-stu-id="ee1e9-108">SQL Server Login Error Codes</span></span>  
 <span data-ttu-id="ee1e9-109">Wenn eine Verbindung aufgrund von Authentifizierungsproblemen nicht hergestellt werden kann, wird für die Anwendung einer der folgenden SQL Server-Fehlercodes bereitgestellt, um Diagnose und Wiederherstellung zu erleichtern.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-109">When a connection cannot be made because of authentication problems, one of the following SQL Server error codes will be available to the application to assist diagnosis and recovery.</span></span>  
  
|<span data-ttu-id="ee1e9-110">SQL Server-Fehlercode</span><span class="sxs-lookup"><span data-stu-id="ee1e9-110">SQL Server Error Code</span></span>|<span data-ttu-id="ee1e9-111">Fehlermeldung</span><span class="sxs-lookup"><span data-stu-id="ee1e9-111">Error Message</span></span>|  
|---------------------------|-------------------|  
|<span data-ttu-id="ee1e9-112">15113</span><span class="sxs-lookup"><span data-stu-id="ee1e9-112">15113</span></span>|<span data-ttu-id="ee1e9-113">Fehler bei der Anmeldung für den Benutzer '%.\*ls'. Ursache: Fehler bei der Kennwortüberprüfung.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-113">Login failed for user '%.\*ls' Reason: Password validation failed.</span></span> <span data-ttu-id="ee1e9-114">Das Konto ist gesperrt.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-114">The account is locked out.</span></span>|  
|<span data-ttu-id="ee1e9-115">18463</span><span class="sxs-lookup"><span data-stu-id="ee1e9-115">18463</span></span>|<span data-ttu-id="ee1e9-116">Fehler bei der Anmeldung für den Benutzer '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-116">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="ee1e9-117">Ursache: Fehler bei der Kennwortänderung.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-117">Reason: Password change failed.</span></span> <span data-ttu-id="ee1e9-118">Das Kennwort kann zurzeit nicht verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-118">The password cannot be used at this time.</span></span>|  
|<span data-ttu-id="ee1e9-119">18464</span><span class="sxs-lookup"><span data-stu-id="ee1e9-119">18464</span></span>|<span data-ttu-id="ee1e9-120">Fehler bei der Anmeldung für den Benutzer '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-120">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="ee1e9-121">Ursache: Fehler bei der Kennwortänderung.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-121">Reason: Password change failed.</span></span> <span data-ttu-id="ee1e9-122">Das Kennwort ist zu kurz und erfüllt daher nicht die Anforderungen der Richtlinie.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-122">The password does not meet policy requirements because it is too short.</span></span>|  
|<span data-ttu-id="ee1e9-123">18465</span><span class="sxs-lookup"><span data-stu-id="ee1e9-123">18465</span></span>|<span data-ttu-id="ee1e9-124">Fehler bei der Anmeldung für den Benutzer '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-124">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="ee1e9-125">Ursache: Fehler bei der Kennwortänderung.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-125">Reason: Password change failed.</span></span> <span data-ttu-id="ee1e9-126">Das Kennwort ist zu lang und erfüllt daher nicht die Anforderungen der Richtlinie.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-126">The password does not meet policy requirements because it is too long.</span></span>|  
|<span data-ttu-id="ee1e9-127">18466</span><span class="sxs-lookup"><span data-stu-id="ee1e9-127">18466</span></span>|<span data-ttu-id="ee1e9-128">Fehler bei der Anmeldung für den Benutzer '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-128">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="ee1e9-129">Ursache: Fehler bei der Kennwortänderung.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-129">Reason: Password change failed.</span></span> <span data-ttu-id="ee1e9-130">Das Kennwort ist nicht komplex genug und erfüllt daher nicht die Anforderungen der Windows-Richtlinie.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-130">The password does not meet policy requirements because it is not complex enough.</span></span>|  
|<span data-ttu-id="ee1e9-131">18467</span><span class="sxs-lookup"><span data-stu-id="ee1e9-131">18467</span></span>|<span data-ttu-id="ee1e9-132">Fehler bei der Anmeldung für den Benutzer '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-132">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="ee1e9-133">Ursache: Fehler bei der Kennwortänderung.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-133">Reason: Password change failed.</span></span> <span data-ttu-id="ee1e9-134">Das Kennwort erfüllt nicht die Anforderungen der Kennwortfilter-DLL.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-134">The password does not meet the requirements of the password filter DLL.</span></span>|  
|<span data-ttu-id="ee1e9-135">18468</span><span class="sxs-lookup"><span data-stu-id="ee1e9-135">18468</span></span>|<span data-ttu-id="ee1e9-136">Fehler bei der Anmeldung für den Benutzer '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-136">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="ee1e9-137">Ursache: Fehler bei der Kennwortänderung.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-137">Reason: Password change failed.</span></span> <span data-ttu-id="ee1e9-138">Unerwarteter Fehler während der Kennwortüberprüfung.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-138">An unexpected error occurred during password validation.</span></span>|  
|<span data-ttu-id="ee1e9-139">18487</span><span class="sxs-lookup"><span data-stu-id="ee1e9-139">18487</span></span>|<span data-ttu-id="ee1e9-140">Fehler bei der Anmeldung für den Benutzer '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-140">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="ee1e9-141">Ursache: Das Kennwort des Kontos ist abgelaufen.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-141">Reason: The password of the account has expired.</span></span>|  
|<span data-ttu-id="ee1e9-142">18488</span><span class="sxs-lookup"><span data-stu-id="ee1e9-142">18488</span></span>|<span data-ttu-id="ee1e9-143">Fehler bei der Anmeldung für den Benutzer '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-143">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="ee1e9-144">Ursache: Das Kennwort des Kontos muss geändert werden.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-144">Reason: The password of the account must be changed.</span></span>|  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="ee1e9-145">SQL Server Native Client OLE DB-Anbieter</span><span class="sxs-lookup"><span data-stu-id="ee1e9-145">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="ee1e9-146">Der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter unterstützt das Ablaufen von Kenn Wörtern über eine Benutzeroberfläche und Programm gesteuert.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-146">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports password expiration though a user interface and programmatically.</span></span>  
  
### <a name="ole-db-user-interface-password-expiration"></a><span data-ttu-id="ee1e9-147">OLE DB-Benutzeroberfläche für abgelaufene Kennwörter</span><span class="sxs-lookup"><span data-stu-id="ee1e9-147">OLE DB User Interface Password Expiration</span></span>  
 <span data-ttu-id="ee1e9-148">Der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter unterstützt das Ablaufen von Kenn Wörtern durch Änderungen an den Dialogfeldern **SQL Server Anmeldung** .</span><span class="sxs-lookup"><span data-stu-id="ee1e9-148">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports password expiration through changes made to the **SQL Server Login** dialog boxes.</span></span> <span data-ttu-id="ee1e9-149">Wenn der Wert DBPROP_INIT_PROMPT auf DBPROMPT_NOPROMPT festgelegt wird, schlägt der erste Verbindungsversuch fehl, wenn das Kennwort abgelaufen ist.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-149">If the value of DBPROP_INIT_PROMPT is set to DBPROMPT_NOPROMPT, the initial connection attempt will fail if the password has expired.</span></span>  
  
 <span data-ttu-id="ee1e9-150">Wenn für DBPROP_INIT_PROMPT ein beliebiger anderer Wert festgelegt wurde, wird dem Benutzer ein Dialogfeld zur **SQL Server-Anmeldung** angezeigt, unabhängig davon, ob das Kennwort abgelaufen ist oder nicht.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-150">If DBPROP_INIT_PROMPT has been set to any other value, the user sees the **SQL Server Login** dialog, regardless of whether or not the password has expired.</span></span> <span data-ttu-id="ee1e9-151">Der Benutzer kann dann auf die Schaltfläche **Optionen** klicken und **Kennwort ändern** aktivieren, um das Kennwort zu ändern.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-151">The user can click on the **Options** button and check **Change Password** to change the password.</span></span>  
  
 <span data-ttu-id="ee1e9-152">Wenn der Benutzer auf OK klickt, und das Kennwort abgelaufen war, fordert [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ihn dazu auf, im Dialogfeld **SQL Server-Kennwort ändern** ein neues Kennwort einzugeben und zu bestätigen.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-152">If the user clicks OK and the password has expired, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] prompts the user to enter and confirm a new password using the **Change SQL Server Password** dialog.</span></span>  
  
#### <a name="ole-db-prompt-behavior-and-locked-accounts"></a><span data-ttu-id="ee1e9-153">OLE DB-Eingabeaufforderungsverhalten und gesperrte Konten</span><span class="sxs-lookup"><span data-stu-id="ee1e9-153">OLE DB Prompt Behavior and Locked Accounts</span></span>  
 <span data-ttu-id="ee1e9-154">Verbindungsversuche schlagen möglicherweise fehl, weil das Konto gesperrt wurde.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-154">Connection attempts may fail due to the account being locked.</span></span> <span data-ttu-id="ee1e9-155">Falls dies nach der Anzeige des Dialogfelds **SQL Server-Anmeldung** geschieht, wird dem Benutzer die entsprechende Fehlermeldung des Servers ausgegeben, und die Verbindung wird abgebrochen.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-155">If this occurs following the display of the **SQL Server Login** dialog, the server error message is displayed to the user and the connection attempt is aborted.</span></span> <span data-ttu-id="ee1e9-156">Dies geschieht unter Umständen auch nach der Anzeige des Dialogfelds **SQL Server-Kennwort ändern**, falls der Benutzer einen falschen Wert für das alte Kennwort eingibt.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-156">It may also occur following the display of the **Change SQL Server Password** dialog if the user enters a bad value for the old password.</span></span> <span data-ttu-id="ee1e9-157">In diesem Fall wird dieselbe Fehlermeldung angezeigt, und der Verbindungsversuch wird abgebrochen.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-157">In this case the same error message is displayed, and the connection attempt is aborted.</span></span>  
  
#### <a name="ole-db-connection-pooling-password-expiration-and-locked-accounts"></a><span data-ttu-id="ee1e9-158">OLE DB-Verbindungspooling, Ablauf von Kennwörtern und gesperrte Konten</span><span class="sxs-lookup"><span data-stu-id="ee1e9-158">OLE DB Connection Pooling, Password Expiration, and Locked Accounts</span></span>  
 <span data-ttu-id="ee1e9-159">Ein Konto kann gesperrt werden oder das dazugehörige Kennwort ablaufen, solange die Verbindung noch in einem Verbindungspool aktiv ist.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-159">An account may be locked or its password may expire while the connection is still active in a connection pool.</span></span> <span data-ttu-id="ee1e9-160">Der Server überprüft bei zwei Gelegenheiten auf abgelaufene Kennwörter und gesperrte Konten.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-160">The server checks for expired passwords and locked accounts on two occasions.</span></span> <span data-ttu-id="ee1e9-161">Zunächst findet eine Überprüfung statt, wenn eine Verbindung hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-161">The first is when a connection is first created.</span></span> <span data-ttu-id="ee1e9-162">Die zweite Überprüfung wird nach dem Zurücksetzen einer Verbindung ausgeführt, wenn die Verbindung aus dem Verbindungspool entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-162">The second occasion is upon connection reset, when the connection is taken from the pool.</span></span>  
  
 <span data-ttu-id="ee1e9-163">Falls der Zurücksetzungsversuch fehlschlägt, wird die Verbindung aus dem Pool entfernt, und ein Fehler wird zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-163">When the reset attempt fails, the connection is removed from the pool and an error is returned.</span></span>  
  
### <a name="ole-db-programmatic-password-expiration"></a><span data-ttu-id="ee1e9-164">Programmgesteuerter Ablauf von Kennwörtern in OLE DB</span><span class="sxs-lookup"><span data-stu-id="ee1e9-164">OLE DB Programmatic Password Expiration</span></span>  
 <span data-ttu-id="ee1e9-165">Der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter unterstützt den Ablauf von Kenn Wörtern durch Hinzufügen der Eigenschaft SSPROP_AUTH_OLD_PASSWORD (Type VT_BSTR), die dem DBPROPSET_SQLSERVERDBINIT Eigenschaften Satz hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-165">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports password expiration through the addition of the SSPROP_AUTH_OLD_PASSWORD (type VT_BSTR) property that has been added to the DBPROPSET_SQLSERVERDBINIT property set.</span></span>  
  
 <span data-ttu-id="ee1e9-166">Die vorhandene Password-Eigenschaft verweist auf DBPROP_AUTH_PASSWORD und wird verwendet, um das neue Kennwort zu speichern.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-166">The existing "Password" property refers to DBPROP_AUTH_PASSWORD and is used to store the new password.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ee1e9-167">In der Verbindungszeichenfolge legt die "Old Password"-Eigenschaft SSPROP_AUTH_OLD_PASSWORD fest. Dies entspricht dem aktuellen (möglicherweise abgelaufenen) Kennwort, das nicht über eine Anbieterzeichenfolgen-Eigenschaft verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-167">In the connection string, the "Old Password" property sets SSPROP_AUTH_OLD_PASSWORD, which is the current (possibly expired) password that is not available via a provider string property.</span></span>  
  
 <span data-ttu-id="ee1e9-168">Der Anbieter speichert den Wert dieser Eigenschaft nicht persistent.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-168">The provider does not persist the value of this property.</span></span> <span data-ttu-id="ee1e9-169">Wenn diese Eigenschaft festgelegt ist, verwendet der Anbieter nicht den Verbindungspool für die erste Verbindung, da eine neue Verbindung hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-169">When this property is set, the provider does not use the connection pool for the first connection because a new connection will occur.</span></span> <span data-ttu-id="ee1e9-170">Wenn die Kennwortänderung ordnungsgemäß vorgenommen werden konnte, kann die aktuelle Verbindung nicht wiederverwendet werden, da sie weiterhin das alte Kennwort verwendet, das nach der Kennwortänderung ungültig wird.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-170">If the password change is successful, the current connection cannot be reused since it still contains the old password, which will be invalid after the password change.</span></span> <span data-ttu-id="ee1e9-171">Wenn die Anmeldung erfolgreich ist, löscht der Anbieter zudem diese Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-171">Also, if the login succeeds, the provider clears this property.</span></span> <span data-ttu-id="ee1e9-172">Bei späteren Versuchen, das alte Kennwort abzurufen, wird VT_EMPTY zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-172">Subsequent attempts to retrieve the old password return VT_EMPTY.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ee1e9-173">SSPROP_AUTH_OLD_PASSWORD sollte nie persistent gespeichert werden, da es nur verwendet wird, wenn ein Kennwort abgelaufen ist.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-173">SSPROP_AUTH_OLD_PASSWORD should never be persisted since it is only used when a password has expired.</span></span>  
  
 <span data-ttu-id="ee1e9-174">Beachten Sie, dass der Anbieter jedes Mal, wenn die Old Password-Eigenschaft festgelegt ist, davon ausgeht, dass versucht wird, das Kennwort zu ändern, es sei denn, es ist auch die Windows-Authentifizierung angegeben, die immer Vorrang hat.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-174">Note that whenever the "Old Password" property is set, the provider assumes that an attempt to change the password is being made, unless Windows Authentication is also specified, in which case it always takes precedence.</span></span>  
  
 <span data-ttu-id="ee1e9-175">Wird die Windows-Authentifizierung verwendet, führt die Angabe des alten Kennworts entweder zu DB_E_ERRORSOCCURRED oder zu DB_S_ERRORSOCCURRED, abhängig davon, ob das alte Kennwort als REQUIRED (im ersten Fall) oder als OPTIONAL (im zweiten Fall) angegeben war. Der Statuswert von DBPROPSTATUS_CONFLICTINGBADVALUE wird in *dwStatus* zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-175">If Windows Authentication is used, specifying the old password results in either DB_E_ERRORSOCCURRED or DB_S_ERRORSOCCURRED depending on whether the old password was specified as REQUIRED or OPTIONAL respectively, and the status value of DBPROPSTATUS_CONFLICTINGBADVALUE is returned in *dwStatus*.</span></span> <span data-ttu-id="ee1e9-176">Dies wird erkannt, wenn **IDBInitialize::Initialize** aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-176">This is detected when **IDBInitialize::Initialize** is called.</span></span>  
  
 <span data-ttu-id="ee1e9-177">Wenn ein Versuch, das Kennwort zu ändern, unerwartet fehlschlägt, gibt der Server den Fehlercode 18468 zurück.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-177">If an attempt to change the password fails unexpectedly, the server returns error code 18468.</span></span> <span data-ttu-id="ee1e9-178">Für den Verbindungsversuch wird ein Standard-OLEDB-Fehler zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-178">A standard OLEDB error is returned from the connection attempt.</span></span>  
  
 <span data-ttu-id="ee1e9-179">Weitere Informationen zum DBPROPSET_SQLSERVERDBINIT-Eigenschaftensatz finden Sie unter [Initialisierungs- und Autorisierungseigenschaften](../../native-client-ole-db-data-source-objects/initialization-and-authorization-properties.md).</span><span class="sxs-lookup"><span data-stu-id="ee1e9-179">For more information about the DBPROPSET_SQLSERVERDBINIT property set, see [Initialization and Authorization Properties](../../native-client-ole-db-data-source-objects/initialization-and-authorization-properties.md).</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="ee1e9-180">ODBC-Treiber für SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="ee1e9-180">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="ee1e9-181">Der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter unterstützt das Ablaufen von Kenn Wörtern über eine Benutzeroberfläche und Programm gesteuert.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-181">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports password expiration though a user interface and programmatically.</span></span>  
  
### <a name="odbc-user-interface-password-expiration"></a><span data-ttu-id="ee1e9-182">ODBC-Benutzeroberfläche für abgelaufene Kennwörter</span><span class="sxs-lookup"><span data-stu-id="ee1e9-182">ODBC User Interface Password Expiration</span></span>  
 <span data-ttu-id="ee1e9-183">Der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client-ODBC-Treiber unterstützt den Ablauf von Kenn Wörtern durch Änderungen, die an den Dialogfeldern **SQL Server Anmeldung** vorgenommen wurden</span><span class="sxs-lookup"><span data-stu-id="ee1e9-183">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports password expiration through changes made to the **SQL Server Login** dialog boxes.</span></span>  
  
 <span data-ttu-id="ee1e9-184">Wenn [SQLDriverConnect](../../native-client-odbc-api/sqldriverconnect.md) aufgerufen wird und der Wert von **DriverCompletion** auf SQL_DRIVER_NOPROMPT festgelegt ist, schlägt der anfängliche Verbindungsversuch fehl, wenn das Kennwort abgelaufen ist.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-184">If [SQLDriverConnect](../../native-client-odbc-api/sqldriverconnect.md) is called and the value of **DriverCompletion** is set to SQL_DRIVER_NOPROMPT, the initial connection attempt fails if the password has expired.</span></span> <span data-ttu-id="ee1e9-185">Der SQLSTATE-Wert 28000 und der Native Fehler Codewert 18487 werden durch nachfolgende Aufrufe von **SQLError** oder **SQLGetDiagRec**zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-185">The SQLSTATE value 28000 and the native error code value 18487 are returned by subsequent calls to **SQLError** or **SQLGetDiagRec**.</span></span>  
  
 <span data-ttu-id="ee1e9-186">Wenn für " **DriverCompletion** " ein beliebiger anderer Wert festgelegt wurde, wird dem Benutzer das **SQL Server Anmelde** Dialogfeld angezeigt, unabhängig davon, ob das Kennwort abgelaufen ist.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-186">If **DriverCompletion** has been set to any other value, the user sees the **SQL Server Login** dialog, regardless of whether or not the password has expired.</span></span> <span data-ttu-id="ee1e9-187">Der Benutzer kann dann auf die Schaltfläche **Optionen** klicken und **Kennwort ändern** aktivieren, um das Kennwort zu ändern.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-187">The user can click on the **Options** button and check **Change Password** to change the password.</span></span>  
  
 <span data-ttu-id="ee1e9-188">Wenn der Benutzer auf OK klickt und das Kennwort abgelaufen ist, werden Sie [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] zur Eingabe und Bestätigung eines neuen Kennworts mithilfe des Dialog Felds **SQL Server Kennwort ändern** aufgefordert.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-188">If the user clicks OK and the password has expired, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] prompts to enter and confirm a new password using the **Change SQL Server Password** dialog.</span></span>  
  
#### <a name="odbc-prompt-behavior-and-locked-accounts"></a><span data-ttu-id="ee1e9-189">ODBC-Eingabeaufforderungsverhalten und gesperrte Konten</span><span class="sxs-lookup"><span data-stu-id="ee1e9-189">ODBC Prompt Behavior and Locked Accounts</span></span>  
 <span data-ttu-id="ee1e9-190">Verbindungsversuche schlagen möglicherweise fehl, weil das Konto gesperrt wurde.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-190">Connection attempts may fail due to the account being locked.</span></span> <span data-ttu-id="ee1e9-191">Falls dies nach der Anzeige des Dialogfelds **SQL Server-Anmeldung** geschieht, wird dem Benutzer die entsprechende Fehlermeldung des Servers ausgegeben, und die Verbindung wird abgebrochen.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-191">If this occurs following the display of the **SQL Server Login** dialog, the server error message is displayed to the user and the connection attempt is aborted.</span></span> <span data-ttu-id="ee1e9-192">Dies geschieht unter Umständen auch nach der Anzeige des Dialogfelds **SQL Server-Kennwort ändern**, falls der Benutzer einen falschen Wert für das alte Kennwort eingibt.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-192">It may also occur following the display of the **Change SQL Server Password** dialog if the user enters a bad value for the old password.</span></span> <span data-ttu-id="ee1e9-193">In diesem Fall wird dieselbe Fehlermeldung angezeigt, und der Verbindungsversuch wird abgebrochen.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-193">In this case the same error message is displayed, and the connection attempt is aborted.</span></span>  
  
#### <a name="odbc-connection-pooling-password-expiry-and-locked-accounts"></a><span data-ttu-id="ee1e9-194">ODBC-Verbindungspooling, Ablauf von Kennwörtern und gesperrte Konten</span><span class="sxs-lookup"><span data-stu-id="ee1e9-194">ODBC Connection Pooling, Password Expiry, and Locked Accounts</span></span>  
 <span data-ttu-id="ee1e9-195">Ein Konto kann gesperrt werden oder das dazugehörige Kennwort ablaufen, solange die Verbindung noch in einem Verbindungspool aktiv ist.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-195">An account may be locked or its password may expire while the connection is still active in a connection pool.</span></span> <span data-ttu-id="ee1e9-196">Der Server überprüft bei zwei Gelegenheiten auf abgelaufene Kennwörter und gesperrte Konten.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-196">The server checks for expired passwords and locked accounts on two occasions.</span></span> <span data-ttu-id="ee1e9-197">Zunächst findet eine Überprüfung statt, wenn eine Verbindung hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-197">The first is when a connection is first created.</span></span> <span data-ttu-id="ee1e9-198">Die zweite Überprüfung wird nach dem Zurücksetzen einer Verbindung ausgeführt, wenn die Verbindung aus dem Verbindungspool entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-198">The second occasion is upon connection reset, when the connection is taken from the pool.</span></span>  
  
 <span data-ttu-id="ee1e9-199">Falls der Zurücksetzungsversuch fehlschlägt, wird die Verbindung aus dem Pool entfernt, und ein Fehler wird zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-199">When the reset attempt fails, the connection is removed from the pool and an error is returned.</span></span>  
  
### <a name="odbc-programmatic-password-expiration"></a><span data-ttu-id="ee1e9-200">Programmgesteuerter Ablauf von Kennwörtern in ODBC</span><span class="sxs-lookup"><span data-stu-id="ee1e9-200">ODBC Programmatic Password Expiration</span></span>  
 <span data-ttu-id="ee1e9-201">Der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC-Treiber unterstützt den Ablauf von Kenn Wörtern durch das Hinzufügen des SQL_COPT_SS_OLDPWD Attributs, das festgelegt wird, bevor eine Verbindung mit dem Server mithilfe der [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) -Funktion hergestellt</span><span class="sxs-lookup"><span data-stu-id="ee1e9-201">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports password expiration through the addition of the SQL_COPT_SS_OLDPWD attribute which is set before connecting to the server using the [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) function.</span></span>  
  
 <span data-ttu-id="ee1e9-202">Das SQL_COPT_SS_OLDPWD-Attribut des Verbindungshandles verweist auf das abgelaufene Kennwort.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-202">The SQL_COPT_SS_OLDPWD attribute of the connection handle refers to the expired password.</span></span> <span data-ttu-id="ee1e9-203">Es gibt kein Verbindungszeichenfolgenattribut für dieses Attribut, da dies mit dem Verbindungspooling nicht übereinstimmen würde.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-203">There is no connection string attribute for this attribute, as this would interfere with connection pooling.</span></span> <span data-ttu-id="ee1e9-204">Wenn die Anmeldung erfolgreich ist, löscht der Treiber zudem dieses Attribut.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-204">If the login succeeds, the driver clears this attribute.</span></span>  
  
 <span data-ttu-id="ee1e9-205">Der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client-ODBC-Treiber gibt SQL_ERROR in vier Fällen für dieses Feature zurück: Kenn Wort Ablauf, Kenn Wort Richtlinien Konflikt, Kontosperrung und Zeitpunkt der Festlegung der alten Kenn Wort Eigenschaft bei Verwendung der Windows-Authentifizierung.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-205">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver returns SQL_ERROR in four cases for this feature: password expiration, password policy conflict, account lockout, and when the old password property is set while using Windows Authentication.</span></span> <span data-ttu-id="ee1e9-206">Der Treiber gibt die entsprechenden Fehlermeldungen an den Benutzer zurück, wenn [SQLGetDiagField](../../native-client-odbc-api/sqlgetdiagfield.md) aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="ee1e9-206">The driver returns the appropriate error messages to the user when [SQLGetDiagField](../../native-client-odbc-api/sqlgetdiagfield.md) is invoked.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ee1e9-207">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="ee1e9-207">See Also</span></span>  
 [<span data-ttu-id="ee1e9-208">SQL Server Native Client-Funktionen</span><span class="sxs-lookup"><span data-stu-id="ee1e9-208">SQL Server Native Client Features</span></span>](sql-server-native-client-features.md)  
  
  

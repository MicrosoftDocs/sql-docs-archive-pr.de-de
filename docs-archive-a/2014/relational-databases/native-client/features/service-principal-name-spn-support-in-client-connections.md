---
title: Unterstützung von Dienstprinzipalnamen (SPN) in Clientverbindungen | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- SQL Server Native Client, SPNs
- ODBC, SPNs
- OLE DB, SPNs
- SPNs [SQL Server]
ms.assetid: 96598c69-ce9a-4090-aacb-d546591e8af7
author: rothja
ms.author: jroth
ms.openlocfilehash: 10a64baa17bd070d9354beaf6ff8c2e460682318
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87609866"
---
# <a name="service-principal-name-spn-support-in-client-connections"></a><span data-ttu-id="fcd34-102">Unterstützung von Dienstprinzipalnamen (SPN) in Clientverbindungen</span><span class="sxs-lookup"><span data-stu-id="fcd34-102">Service Principal Name (SPN) Support in Client Connections</span></span>
  <span data-ttu-id="fcd34-103">Ab [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] wurde die Unterstützung für Dienstprinzipalnamen (Service Principal Names, SPNs) erweitert und die gegenseitige Authentifizierung über alle Protokolle hinweg aktiviert.</span><span class="sxs-lookup"><span data-stu-id="fcd34-103">Beginning with [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)], support for service principal names (SPNs) has been extended to enable mutual authentication across all protocols.</span></span> <span data-ttu-id="fcd34-104">In vorherigen Versionen von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] wurden SPNs nur für Kerberos statt TCP unterstützt, wenn der Standard-SPN der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-Instanz in Active Directory registriert wurde.</span><span class="sxs-lookup"><span data-stu-id="fcd34-104">In previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], SPNs were only supported for Kerberos over TCP when the default SPN for the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance was registered with Active Directory.</span></span>  
  
 <span data-ttu-id="fcd34-105">SPNs werden vom Authentifizierungsprotokoll verwendet, um das Konto zu bestimmen, in dem eine [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-Instanz ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="fcd34-105">SPNs are used by the authentication protocol to determine the account in which a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance runs.</span></span> <span data-ttu-id="fcd34-106">Ist das Konto der Instanz bekannt, kann mithilfe der Kerberos-Authentifizierung die gegenseitige Authentifizierung von Client und Server durchgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="fcd34-106">If the instance account is known, Kerberos authentication can be used to provide mutual authentication by the client and server.</span></span> <span data-ttu-id="fcd34-107">Ist das Konto der Instanz nicht bekannt, wird die NTML-Authentifizierung verwendet, die nur die Authentifizierung des Clients durch den Server durchführt.</span><span class="sxs-lookup"><span data-stu-id="fcd34-107">If the instance account is not known, NTLM authentication, which only provides authentication of the client by the server, is used.</span></span> <span data-ttu-id="fcd34-108">Die Authentifizierungssuche wird derzeit vom [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ausgeführt. Der SPN wird vom Instanznamen und den Netzwerkverbindungseigenschaften abgeleitet.</span><span class="sxs-lookup"><span data-stu-id="fcd34-108">Currently, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client performs the authentication lookup, deriving the SPN from the instance name and network connection properties.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="fcd34-109">-Instanzen versuchen, SPNs beim Start zu registrieren, oder sie können manuell registriert werden.</span><span class="sxs-lookup"><span data-stu-id="fcd34-109">instances will attempt to register SPNs on startup, or they can be registered manually.</span></span> <span data-ttu-id="fcd34-110">Die Registrierung schlägt jedoch fehl, wenn das Konto, dass die Registrierung der SPNs vornimmt, nicht über ausreichende Zugriffsrechte verfügt.</span><span class="sxs-lookup"><span data-stu-id="fcd34-110">However, registration will fail if there are insufficient access rights for the account that attempts to register the SPNs.</span></span>  
  
 <span data-ttu-id="fcd34-111">Domänen- und Computerkonten werden automatisch in Active Directory registriert.</span><span class="sxs-lookup"><span data-stu-id="fcd34-111">Domain and computer accounts are registered automatically in Active Directory.</span></span> <span data-ttu-id="fcd34-112">Diese können als SPNs verwendet werden, oder Administratoren können ihre eigenen SPNs definieren.</span><span class="sxs-lookup"><span data-stu-id="fcd34-112">These can be used as SPNs, or administators can define their own SPNs.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="fcd34-113">ist einfacher zu verwalten und auch zuverlässiger, da Clients direkt den zu verwendenden SPN festlegen können.</span><span class="sxs-lookup"><span data-stu-id="fcd34-113">makes secure authentication more manageable and reliable by allowing clients to directly specify the SPN to use.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fcd34-114">Ein von einer Clientanwendung festgelegter SPN wird nur verwendet, wenn eine Verbindung mit integrierten Sicherheitsfunktionen von Windows hergestellt wird.</span><span class="sxs-lookup"><span data-stu-id="fcd34-114">An SPN specified by a client application is only used when a connection is made with Windows integrated security.</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="fcd34-115">**[!INCLUDE[msCoName](../../../includes/msconame-md.md)] Kerberos-Konfigurations-Manager für [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]** ist ein Diagnosetool zur Behebung Kerberos-bezogener Verbindungsprobleme bei [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fcd34-115">**[!INCLUDE[msCoName](../../../includes/msconame-md.md)] Kerberos Configuration Manager for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]** is a diagnostic tool that helps troubleshoot Kerberos related connectivity issues with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="fcd34-116">Weitere Informationen finden Sie unter [Microsoft Kerberos-Konfigurations-Manager für SQL Server](https://www.microsoft.com/download/details.aspx?id=39046).</span><span class="sxs-lookup"><span data-stu-id="fcd34-116">For more information, see [Microsoft Kerberos Configuration Manager for SQL Server](https://www.microsoft.com/download/details.aspx?id=39046).</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="fcd34-117">**[!INCLUDE[msCoName](../../../includes/msconame-md.md)] Kerberos-Konfigurations-Manager für [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]** ist ein Diagnosetool zur Behebung Kerberos-bezogener Verbindungsprobleme bei [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fcd34-117">**[!INCLUDE[msCoName](../../../includes/msconame-md.md)] Kerberos Configuration Manager for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]** is a diagnostic tool that helps troubleshoot Kerberos related connectivity issues with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="fcd34-118">Weitere Informationen finden Sie unter [Microsoft Kerberos-Konfigurations-Manager für SQL Server](https://www.microsoft.com/download/details.aspx?id=39046).</span><span class="sxs-lookup"><span data-stu-id="fcd34-118">For more information, see [Microsoft Kerberos Configuration Manager for SQL Server](https://www.microsoft.com/download/details.aspx?id=39046).</span></span>  
  
 <span data-ttu-id="fcd34-119">Weitere Informationen zu Kerberos finden Sie in den folgenden Artikeln:</span><span class="sxs-lookup"><span data-stu-id="fcd34-119">For more information about Kerberos, see the following articles:</span></span>  
  
-   [<span data-ttu-id="fcd34-120">Kerberos – Technische Ergänzungfür Windows</span><span class="sxs-lookup"><span data-stu-id="fcd34-120">Kerberos Technical Supplement for Windows</span></span>](https://go.microsoft.com/fwlink/?LinkId=101449)  
  
-   [<span data-ttu-id="fcd34-121">Microsoft Kerberos</span><span class="sxs-lookup"><span data-stu-id="fcd34-121">Microsoft Kerberos</span></span>](https://go.microsoft.com/fwlink/?LinkID=100758)  
  
## <a name="usage"></a><span data-ttu-id="fcd34-122">Verwendung</span><span class="sxs-lookup"><span data-stu-id="fcd34-122">Usage</span></span>  
 <span data-ttu-id="fcd34-123">In der folgenden Tabelle werden die häufigsten Szenarien beschrieben, in denen Clientanwendungen die sichere Authentifizierung aktivieren können.</span><span class="sxs-lookup"><span data-stu-id="fcd34-123">The following table describes the most common scenarios in which client applications can enable secure authentication.</span></span>  
  
|<span data-ttu-id="fcd34-124">Szenario</span><span class="sxs-lookup"><span data-stu-id="fcd34-124">Scenario</span></span>|<span data-ttu-id="fcd34-125">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="fcd34-125">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="fcd34-126">Eine ältere Anwendung gibt keinen SPN an.</span><span class="sxs-lookup"><span data-stu-id="fcd34-126">A legacy application does not specify an SPN.</span></span>|<span data-ttu-id="fcd34-127">Dieses Kompatibilitätsszenario stellt sicher, dass sich das Verhalten von Anwendungen, die für frühere Versionen von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]entwickelt wurden, nicht verändert.</span><span class="sxs-lookup"><span data-stu-id="fcd34-127">This compatibility scenario guarantees that there will be no behavior change for applications developed for previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="fcd34-128">Wenn kein SPN angegeben wurde, verwendet die Anwendung generierte SPNs und erkennt nicht, welche Methode zur Authentifizierung verwendet wurde.</span><span class="sxs-lookup"><span data-stu-id="fcd34-128">If no SPN is specified, the application relies on generated SPNs and has no knowledge of which authentication method is used.</span></span>|  
|<span data-ttu-id="fcd34-129">Eine Clientanwendung, die die aktuelle Version von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client verwendet, gibt in der Verbindungszeichenfolge einen SPN als Domänenbenutzerkonto oder Computerkonto, als instanzabhängigen SPN oder als benutzerdefinierte Zeichenfolge an.</span><span class="sxs-lookup"><span data-stu-id="fcd34-129">A client application using the current version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client specifies an SPN in the connection string as a domain user or computer account, as an instance-specific SPN, or as a user-defined string.</span></span>|<span data-ttu-id="fcd34-130">Das `ServerSPN`-Schlüsselwort kann von einem Anbieter, einer Initialisierung oder einer Verbindungszeichenfolge zu folgenden Zwecken verwendet werden:</span><span class="sxs-lookup"><span data-stu-id="fcd34-130">The `ServerSPN` keyword can be used in a provider, initialization, or connection string to do the following:</span></span><br /><br /> <span data-ttu-id="fcd34-131">-Geben Sie das Konto an, das von der- [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Instanz für eine Verbindung verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="fcd34-131">-   Specify the account used by the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance for a connection.</span></span> <span data-ttu-id="fcd34-132">Dies vereinfacht den Zugriff auf die Kerberos-Authentifizierung.</span><span class="sxs-lookup"><span data-stu-id="fcd34-132">This simplifies access to Kerberos authentication.</span></span> <span data-ttu-id="fcd34-133">Wenn ein Kerberos-Schlüsselverteilungscenter (Key Distribution Center, KDC) vorhanden ist und das richtige Konto angegeben wurde, wird wahrscheinlich die Kerberos- anstatt der NTLM-Authentifizierung durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="fcd34-133">If a Kerberos Key Distribution Center (KDC) is present and the correct account is specified, Kerberos authentication is more likely to be used than NTLM.</span></span> <span data-ttu-id="fcd34-134">Das KDC befindet sich normalerweise auf dem gleichen Computer wie der Domänencontroller.</span><span class="sxs-lookup"><span data-stu-id="fcd34-134">The KDC usually resides on the same computer as the domain controller.</span></span><br /><span data-ttu-id="fcd34-135">-Geben Sie einen SPN an, um das Dienst Konto für die Instanz zu suchen [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="fcd34-135">-   Specify an SPN to look up the service account for the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance.</span></span> <span data-ttu-id="fcd34-136">Für jede [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-Instanz werden zwei Standard-SPNs generiert, die für diesen Zweck verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="fcd34-136">For every [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance, two default SPNs are generated that can be used for this purpose.</span></span> <span data-ttu-id="fcd34-137">Diese Schlüssel sind jedoch nicht unbedingt in Active Directory vorhanden. Daher ist in dieser Situation die Kerberos-Authentifizierung nicht gewährleistet.</span><span class="sxs-lookup"><span data-stu-id="fcd34-137">These keys are not guaranteed to be present in Active Directory, however, so in this situation Kerberos authentication is not guaranteed.</span></span><br /><span data-ttu-id="fcd34-138">-Geben Sie einen SPN an, der verwendet wird, um das Dienst Konto für die Instanz zu suchen [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="fcd34-138">-   Specify an SPN that will be used to look up the service account for the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance.</span></span> <span data-ttu-id="fcd34-139">Dies kann eine beliebige benutzerdefinierte Zeichenfolge sein, die dem Dienstkonto zugeordnet wird.</span><span class="sxs-lookup"><span data-stu-id="fcd34-139">This can be any user-defined string that maps to the service account.</span></span> <span data-ttu-id="fcd34-140">In diesem Fall muss der Schlüssel im KDC manuell registriert werden und den Richtlinien für einen benutzerdefinierten SPN entsprechen.</span><span class="sxs-lookup"><span data-stu-id="fcd34-140">In this case, the key must be registered manually in the KDC and must satisfy the rules for a user-defined SPN.</span></span><br /><br /> <span data-ttu-id="fcd34-141">Das `FailoverPartnerSPN`-Schlüsselwort kann verwendet werden, um den SPN für den Failoverpartnerserver anzugeben.</span><span class="sxs-lookup"><span data-stu-id="fcd34-141">The `FailoverPartnerSPN` keyword can be used to specify the SPN for the failover partner server.</span></span> <span data-ttu-id="fcd34-142">Der Wertebereich des Kontos und des Active Directory-Schlüssels entspricht den Werten, die Sie für den Prinzipalserver angeben können.</span><span class="sxs-lookup"><span data-stu-id="fcd34-142">The range of account and Active Directory key values is the same as the values you can specify for the principal server.</span></span>|  
|<span data-ttu-id="fcd34-143">Eine ODBC-Anwendung legt einen SPN als Verbindungsattribut für den Prinzipalserver oder Failoverpartnerserver fest.</span><span class="sxs-lookup"><span data-stu-id="fcd34-143">An ODBC application specifies an SPN as a connection attribute for the principal server or failover partner server.</span></span>|<span data-ttu-id="fcd34-144">Das Verbindungsattribut `SQL_COPT_SS_SERVER_SPN` kann zur Festlegung des SPN für eine Verbindung zum Prinzipalserver verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="fcd34-144">The connection attribute `SQL_COPT_SS_SERVER_SPN` can be used to specify the SPN for a connection to the principal server.</span></span><br /><br /> <span data-ttu-id="fcd34-145">Das Verbindungsattribut `SQL_COPT_SS_FAILOVER_PARTNER_SPN` kann zur Festlegung des SPN für eine Verbindung zum Failoverpartnerserver verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="fcd34-145">The connection attribute `SQL_COPT_SS_FAILOVER_PARTNER_SPN` can be used to specify the SPN for the failover partner server.</span></span>|  
|<span data-ttu-id="fcd34-146">Eine OLE DB-Anwendung legt einen SPN als Initialisierungseigenschaft der Datenquelle für den Prinzipalserver oder einen Failoverpartnerserver fest.</span><span class="sxs-lookup"><span data-stu-id="fcd34-146">An OLE DB application specifies an SPN as a data source initialization property for the principal server or for a failover partner server.</span></span>|<span data-ttu-id="fcd34-147">Die Verbindungseigenschaft `SSPROP_INIT_SERVER_SPN` im `DBPROPSET_SQLSERVERDBINIT`-Eigenschaftensatz kann zur Festlegung des SPN für eine Verbindung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="fcd34-147">The connection property `SSPROP_INIT_SERVER_SPN` in the `DBPROPSET_SQLSERVERDBINIT` property set can be used to specify the SPN for a connection.</span></span><br /><br /> <span data-ttu-id="fcd34-148">Die Verbindungseigenschaft `SSPROP_INIT_FAILOVER_PARTNER_SPN` in `DBPROPSET_SQLSERVERDBINIT` kann zur Festlegung des SPN für eine Verbindung zum Failoverpartnerserver verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="fcd34-148">The connection property `SSPROP_INIT_FAILOVER_PARTNER_SPN` in the `DBPROPSET_SQLSERVERDBINIT` can be used to specify the SPN for the failover partner server.</span></span>|  
|<span data-ttu-id="fcd34-149">Ein Benutzer legt einen SPN für einen Server oder Failoverpartnerserver in einem ODBC-Datenquellenamen (Data Source Name, DSN) fest.</span><span class="sxs-lookup"><span data-stu-id="fcd34-149">A user specifies an SPN for a server or failover partner server in an ODBC data source name (DSN).</span></span>|<span data-ttu-id="fcd34-150">Der SPN kann in einem ODBC DSN durch die DSN-Setupdialogfelder angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="fcd34-150">The SPN can be specified in an ODBC DSN through the DSN setup dialog boxes.</span></span>|  
|<span data-ttu-id="fcd34-151">Der Benutzer legt einen SPN für einen Server oder Failoverpartnerserver in den OLE DB-Dialogfeldern **Datenlink** oder **Anmeldung** fest.</span><span class="sxs-lookup"><span data-stu-id="fcd34-151">The user specifies an SPN for a server or failover partner server in an OLE DB **Data Link** or **Login** dialog box.</span></span>|<span data-ttu-id="fcd34-152">Der SPN kann im Dialogfeld **Datenlinks** oder **Anmeldung** angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="fcd34-152">The SPN can be specified in a **Data Link** or **Login** dialog box.</span></span> <span data-ttu-id="fcd34-153">Das Dialogfeld **Anmeldung** kann mit entweder ODBC oder OLE DB verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="fcd34-153">The **Login** dialog box can be used with either ODBC or OLE DB.</span></span>|  
|<span data-ttu-id="fcd34-154">Eine ODBC-Anwendung bestimmt die Authentifizierungsmethode, die zum Herstellen einer Verbindung verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="fcd34-154">An ODBC application determines the authentication method used to establish a connection.</span></span>|<span data-ttu-id="fcd34-155">Wenn eine Verbindung erfolgreich hergestellt wurde, kann eine Anwendung das Verbindungsattribut `SQL_COPT_SS_INTEGRATED_AUTHENTICATION_METHOD` abfragen, um festzustellen, welche Authentifizierungsmethode verwendet wurde.</span><span class="sxs-lookup"><span data-stu-id="fcd34-155">When a connection has been opened successfully, an application can query the connection attribute `SQL_COPT_SS_INTEGRATED_AUTHENTICATION_METHOD` to determine which authentication method was used.</span></span> <span data-ttu-id="fcd34-156">Die Werte enthalten unter anderem `NTLM` und `Kerberos`.</span><span class="sxs-lookup"><span data-stu-id="fcd34-156">The values will include, but are not limited to, `NTLM` and `Kerberos`.</span></span>|  
|<span data-ttu-id="fcd34-157">Eine OLE DB-Anwendung bestimmt die Authentifizierungsmethode, die zum Herstellen einer Verbindung verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="fcd34-157">An OLE DB application determines the authentication method used to establish a connection.</span></span>|<span data-ttu-id="fcd34-158">Wenn eine Verbindung erfolgreich hergestellt wurde, kann eine Anwendung die Verbindungseigenschaft `SSPROP_AUTHENTICATION_METHOD` im `DBPROPSET_SQLSERVERDATASOURCEINFO`-Eigenschaftensatz abfragen, um festzustellen, welche Authentifizierungsmethode verwendet wurde.</span><span class="sxs-lookup"><span data-stu-id="fcd34-158">When a connection has been opened successfully, an application can query the connection property `SSPROP_AUTHENTICATION_METHOD` in the `DBPROPSET_SQLSERVERDATASOURCEINFO` property set to determine which authentication method was used.</span></span> <span data-ttu-id="fcd34-159">Die Werte enthalten unter anderem `NTLM` und `Kerberos`.</span><span class="sxs-lookup"><span data-stu-id="fcd34-159">The values will include, but are not limited to, `NTLM` and `Kerberos`.</span></span>|  
  
## <a name="failover"></a><span data-ttu-id="fcd34-160">Failover</span><span class="sxs-lookup"><span data-stu-id="fcd34-160">Failover</span></span>  
 <span data-ttu-id="fcd34-161">SPNs werden nicht im Failovercache gespeichert und daher nicht zwischen Verbindungen übergeben.</span><span class="sxs-lookup"><span data-stu-id="fcd34-161">SPNs are not stored in the failover cache and therefore cannot be passed between connections.</span></span> <span data-ttu-id="fcd34-162">SPNs werden bei allen Verbindungsversuchen mit dem Prinzipal und dem Partner verwendet, wenn Sie in der Verbindungszeichenfolge oder in den Verbindungsattributen angegeben sind.</span><span class="sxs-lookup"><span data-stu-id="fcd34-162">SPNs will be used on all connection attempts to the principal and partner when specified in the connection string or connection attributes.</span></span>  
  
## <a name="connection-pooling"></a><span data-ttu-id="fcd34-163">Verbindungspooling</span><span class="sxs-lookup"><span data-stu-id="fcd34-163">Connection Pooling</span></span>  
 <span data-ttu-id="fcd34-164">Wenn SPNs nur in einigen, aber nicht in allen Verbindungszeichenfolgen angegeben werden, kann dies zur Poolfragmentierung führen.</span><span class="sxs-lookup"><span data-stu-id="fcd34-164">Applications should be aware that specifying SPNs in some but not all connection strings can contribute to pool fragmentation.</span></span>  
  
 <span data-ttu-id="fcd34-165">Anwendungen können SPNs programmgesteuert als Verbindungsattribute festlegen, anstatt Schlüsselwörter für Verbindungszeichenfolgen anzugeben.</span><span class="sxs-lookup"><span data-stu-id="fcd34-165">Applications can programmatically specify SPNs as connection attributes, instead of specifying connection string keywords.</span></span> <span data-ttu-id="fcd34-166">Dadurch kann die Fragmentierung beim Verbindungspooling besser gesteuert werden.</span><span class="sxs-lookup"><span data-stu-id="fcd34-166">This can help manage connection pool fragmentation.</span></span>  
  
 <span data-ttu-id="fcd34-167">SPNs in Verbindungszeichenfolgen können durch Festlegen der entsprechenden Verbindungsattribute überschrieben werden, aber Verbindungszeichenfolgen, die vom Verbindungspooling verwendet werden, verwenden die Verbindungszeichenfolgenwerte für Poolingzwecke.</span><span class="sxs-lookup"><span data-stu-id="fcd34-167">Applications should be aware that SPNs in connection strings can be overridden by setting the corresponding connection attributes, but connection strings used by connection pooling will use the connection string values for pooling purposes.</span></span>  
  
## <a name="down-level-server-behavior"></a><span data-ttu-id="fcd34-168">Downlevelserver-Verhalten</span><span class="sxs-lookup"><span data-stu-id="fcd34-168">Down-Level Server Behavior</span></span>  
 <span data-ttu-id="fcd34-169">Das neue Verbindungsverhalten ist clientseitig implementiert und daher kein spezifisches Verhalten von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fcd34-169">The new connection behavior is implemented by the client; therefore, it is not specific to a version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
## <a name="linked-servers-and-delegation"></a><span data-ttu-id="fcd34-170">Verbindungsserver und Delegierung</span><span class="sxs-lookup"><span data-stu-id="fcd34-170">Linked Servers and Delegation</span></span>  
 <span data-ttu-id="fcd34-171">Beim Einrichten von Verbindungsservern wird der Parameter `@provstr` von [sp_addlinkedserver](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) verwendet, um den SPN für den Server und Failoverpartner festzulegen.</span><span class="sxs-lookup"><span data-stu-id="fcd34-171">When linked servers are created, the `@provstr` parameter of [sp_addlinkedserver](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) can be used to specify the server and failover partner SPNs.</span></span> <span data-ttu-id="fcd34-172">Diese Vorgehensweise hat den gleichen Vorteil wie das Festlegen von SPNs in Clientverbindungszeichenfolgen: Es ist einfacher und zuverlässiger, Verbindungen mit Kerberos-Authentifizierung herzustellen.</span><span class="sxs-lookup"><span data-stu-id="fcd34-172">The benefits of doing this are the same as specifying SPNs in client connection strings: It is simpler and more reliable to establish connections that use Kerberos authentication.</span></span>  
  
 <span data-ttu-id="fcd34-173">Delegierung über Verbindungsserver erfordert die Kerberos-Authentifizierung.</span><span class="sxs-lookup"><span data-stu-id="fcd34-173">Delegation with linked servers requires Kerberos authentication.</span></span>  
  
## <a name="management-aspects-of-spns-specified-by-applications"></a><span data-ttu-id="fcd34-174">Verwaltungsaspekte von SPNs, die von Anwendungen angegeben werden</span><span class="sxs-lookup"><span data-stu-id="fcd34-174">Management Aspects of SPNs Specified by Applications</span></span>  
 <span data-ttu-id="fcd34-175">Berücksichtigen Sie die folgenden Faktoren bei der Entscheidung, ob SPNs in einer Anwendung (über Verbindungszeichenfolgen) oder programmgesteuert über Verbindungseigenschaften (anstatt sich auf den standardmäßig vom Anbieter erstellten SPN zu verlassen) angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="fcd34-175">When choosing whether to specify SPNs in an application (through connection strings) or programmatically through connection properties (rather than relying on the defalt provider generated SPNs), consider the following factors:</span></span>  
  
-   <span data-ttu-id="fcd34-176">Sicherheit: Legt der angegebene SPN geschützte Informationen offen?</span><span class="sxs-lookup"><span data-stu-id="fcd34-176">Security: Does the specified SPN disclose information that is protected?</span></span>  
  
-   <span data-ttu-id="fcd34-177">Zuverlässigkeit: Zur Aktivierung von Standard-SPNs muss das Dienstkonto der Instanz von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] über ausreichende Privilegien zum Update von Active Directory auf dem Schlüsselverteilungscenter verfügen.</span><span class="sxs-lookup"><span data-stu-id="fcd34-177">Reliability: To enable the use of default SPNs, the service account in which the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance runs must have sufficient privileges to update the Active Directory on the KDC.</span></span>  
  
-   <span data-ttu-id="fcd34-178">Benutzerfreundlichkeit und Speicherorttransparenz: Wie wirkt es sich auf die SPNs einer Anwendung aus, wenn die Datenbank in eine andere Instanz von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] verschoben wird?</span><span class="sxs-lookup"><span data-stu-id="fcd34-178">Convenience and location transparency: How will an application's SPNs be affected if its database moves to a different [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance?</span></span> <span data-ttu-id="fcd34-179">Dies gilt für sowohl den Prinzipalserver als auch seinen Failoverpartner, wenn Sie die Datenbankspiegelung verwenden.</span><span class="sxs-lookup"><span data-stu-id="fcd34-179">This applies to both the principal server and its failover partner if you use database mirroring.</span></span> <span data-ttu-id="fcd34-180">Wie wirkt es sich auf Anwendungen aus, wenn eine Serveränderung bedeutet, dass SPNs geändert werden müssen?</span><span class="sxs-lookup"><span data-stu-id="fcd34-180">If a server change means that SPNs must be changed, how will this affect applications?</span></span> <span data-ttu-id="fcd34-181">Werden die Änderungen verwaltet?</span><span class="sxs-lookup"><span data-stu-id="fcd34-181">Will any changes be managed?</span></span>  
  
## <a name="specifying-the-spn"></a><span data-ttu-id="fcd34-182">Angeben des SPN</span><span class="sxs-lookup"><span data-stu-id="fcd34-182">Specifying the SPN</span></span>  
 <span data-ttu-id="fcd34-183">Sie können einen SPN in Dialogfeldern und Code angeben.</span><span class="sxs-lookup"><span data-stu-id="fcd34-183">You can specify an SPN in dialog boxes and in code.</span></span> <span data-ttu-id="fcd34-184">In diesem Abschnitt wird erläutert, wie Sie einen SPN angeben können.</span><span class="sxs-lookup"><span data-stu-id="fcd34-184">This section discusses how you can specify an SPN.</span></span>  
  
 <span data-ttu-id="fcd34-185">Die maximale Länge für einen SPN beträgt 260 Zeichen.</span><span class="sxs-lookup"><span data-stu-id="fcd34-185">The maximum length for an SPN is 260 characters.</span></span>  
  
 <span data-ttu-id="fcd34-186">Die Syntax, die SPNs in Attributen für Verbindungszeichenfolgen und Verbindungen verwenden, lautet wie folgt:</span><span class="sxs-lookup"><span data-stu-id="fcd34-186">The syntax that SPNs use in connection string or connection attributes is as follows:</span></span>  
  
|<span data-ttu-id="fcd34-187">Syntax</span><span class="sxs-lookup"><span data-stu-id="fcd34-187">Syntax</span></span>|<span data-ttu-id="fcd34-188">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="fcd34-188">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="fcd34-189">MSSQLSvc/*voll* ständig verfügbar</span><span class="sxs-lookup"><span data-stu-id="fcd34-189">MSSQLSvc/*fqdn*</span></span>|<span data-ttu-id="fcd34-190">Der vom Anbieter erstellte Standard-SPN für eine Standardinstanz, wenn ein anderes Protokoll als TCP verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="fcd34-190">The provider-generated, default SPN for a default instance when a protocol other than TCP is used.</span></span><br /><br /> <span data-ttu-id="fcd34-191">*FQDN* ist ein voll qualifizierter Domänen Name.</span><span class="sxs-lookup"><span data-stu-id="fcd34-191">*fqdn* is a fully-qualified domain name.</span></span>|  
|<span data-ttu-id="fcd34-192">MSSQLSvc/*fqdn*:*port*</span><span class="sxs-lookup"><span data-stu-id="fcd34-192">MSSQLSvc/*fqdn*:*port*</span></span>|<span data-ttu-id="fcd34-193">Der vom Anbieter erstellte Standard-SPN, wenn TCP verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="fcd34-193">The provider-generated, default SPN when TCP is used.</span></span><br /><br /> <span data-ttu-id="fcd34-194">*port* ist eine TCP-Portnummer.</span><span class="sxs-lookup"><span data-stu-id="fcd34-194">*port* is a TCP port number.</span></span>|  
|<span data-ttu-id="fcd34-195">MSSQLSvc/*FQDN*:*instanceName*</span><span class="sxs-lookup"><span data-stu-id="fcd34-195">MSSQLSvc/*fqdn*:*InstanceName*</span></span>|<span data-ttu-id="fcd34-196">Der vom Anbieter erstellte Standard-SPN für eine benannte Instanz, wenn ein anderes Protokoll als TCP verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="fcd34-196">The provider-generated, default SPN for a named instance when a protocol other than TCP is used.</span></span><br /><br /> <span data-ttu-id="fcd34-197">*InstanceName* ist ein Instanzname von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fcd34-197">*InstanceName* is a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance name.</span></span>|  
|<span data-ttu-id="fcd34-198">HOST/*fqdn*</span><span class="sxs-lookup"><span data-stu-id="fcd34-198">HOST/*fqdn*</span></span><br /><br /> <span data-ttu-id="fcd34-199">HOST/*MachineName*</span><span class="sxs-lookup"><span data-stu-id="fcd34-199">HOST/*MachineName*</span></span>|<span data-ttu-id="fcd34-200">Der SPN, der integrierten Computerkonten zugeordnet wird, die automatisch von Windows registriert werden.</span><span class="sxs-lookup"><span data-stu-id="fcd34-200">The SPN that maps to built-in computer accounts that are automatically registered by Windows.</span></span>|  
|<span data-ttu-id="fcd34-201">*Benutzername* @ *Domäne*</span><span class="sxs-lookup"><span data-stu-id="fcd34-201">*Username*@*Domain*</span></span>|<span data-ttu-id="fcd34-202">Direkte Spezifikation eines Domänenkontos.</span><span class="sxs-lookup"><span data-stu-id="fcd34-202">Direct specification of a domain account.</span></span><br /><br /> <span data-ttu-id="fcd34-203">*Username* ist der Name des Windows-Benutzerkontos.</span><span class="sxs-lookup"><span data-stu-id="fcd34-203">*Username* is a Windows user account name.</span></span><br /><br /> <span data-ttu-id="fcd34-204">*Domain* ist ein Windows-Domänenname oder ein vollqualifizierter Domänenname.</span><span class="sxs-lookup"><span data-stu-id="fcd34-204">*Domain* is a Windows domain name or fully-qualified domain name.</span></span>|  
|<span data-ttu-id="fcd34-205">*MachineName* $@ *Domäne*</span><span class="sxs-lookup"><span data-stu-id="fcd34-205">*MachineName*$@*Domain*</span></span>|<span data-ttu-id="fcd34-206">Ein Computerkonto wird direkt angegeben.</span><span class="sxs-lookup"><span data-stu-id="fcd34-206">Direct specification of a computer account.</span></span><br /><br /> <span data-ttu-id="fcd34-207">(Wenn der Server, mit dem Sie eine Verbindung herstellen, unter "Lokales System" oder Netzwerkdienst Konto ausgeführt wird, kann zum erhalten der Kerberos-Authentifizierung `ServerSPN` das Domänen Format " *MachineName*" aufweisen $@ *Domain* .)</span><span class="sxs-lookup"><span data-stu-id="fcd34-207">(If the server you are connecting to is running under LOCAL SYSTEM or NETWORK SERVICE accounts, to get Kerberos authentication, `ServerSPN` can be in the *MachineName*$@*Domain* format.)</span></span>|  
|<span data-ttu-id="fcd34-208">*KDCKey* / *MachineName*</span><span class="sxs-lookup"><span data-stu-id="fcd34-208">*KDCKey*/*MachineName*</span></span>|<span data-ttu-id="fcd34-209">Ein vom Benutzer angegebener SPN.</span><span class="sxs-lookup"><span data-stu-id="fcd34-209">A user-specified SPN.</span></span><br /><br /> <span data-ttu-id="fcd34-210">*KDCKey* ist eine alphanumerische Zeichenfolge, die den Regeln für einen KDC-Schlüssel entspricht.</span><span class="sxs-lookup"><span data-stu-id="fcd34-210">*KDCKey* is an alphanumeric string that conforms to the rules for a KDC key.</span></span>|  
  
## <a name="odbc-and-ole-db-syntax-supporting-spns"></a><span data-ttu-id="fcd34-211">SPNs, die ODBC und OLE DB-Syntax unterstützen</span><span class="sxs-lookup"><span data-stu-id="fcd34-211">ODBC and OLE DB Syntax Supporting SPNs</span></span>  
 <span data-ttu-id="fcd34-212">Informationen zur Syntax finden Sie in den folgenden Themen:</span><span class="sxs-lookup"><span data-stu-id="fcd34-212">For syntax-specific information, see the following topics:</span></span>  
  
-   [<span data-ttu-id="fcd34-213">Dienstprinzipalnamen (SPN) in Clientverbindungen (ODBC)</span><span class="sxs-lookup"><span data-stu-id="fcd34-213">Service Principal Names &#40;SPNs&#41; in Client Connections &#40;ODBC&#41;</span></span>](../odbc/service-principal-names-spns-in-client-connections-odbc.md)  
  
-   [<span data-ttu-id="fcd34-214">Dienstprinzipalnamen (SPN) in Clientverbindungen (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="fcd34-214">Service Principal Names &#40;SPNs&#41; in Client Connections &#40;OLE DB&#41;</span></span>](../ole-db/service-principal-names-spns-in-client-connections-ole-db.md)  
  
 <span data-ttu-id="fcd34-215">Informationen zu Beispielanwendungen, die diese Funktion veranschaulichen, finden Sie unter [Beispiele zur Programmierbarkeit von SQL Server-Daten](https://msftdpprodsamples.codeplex.com/).</span><span class="sxs-lookup"><span data-stu-id="fcd34-215">For information about sample applications that demonstrate this feature, see [SQL Server Data Programmability Samples](https://msftdpprodsamples.codeplex.com/).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fcd34-216">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="fcd34-216">See Also</span></span>  
 [<span data-ttu-id="fcd34-217">SQL Server Native Client-Funktionen</span><span class="sxs-lookup"><span data-stu-id="fcd34-217">SQL Server Native Client Features</span></span>](sql-server-native-client-features.md)  
  

---
title: Verwenden der Momentaufnahmenisolation | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- data access [SQL Server Native Client], snapshot isolation
- SQLNCLI, snapshot isolation
- isolation levels [SQL Server], snapshot
- DBPROPSET_SESSION property set
- DBDROPSET_DATASOURCEINFO property set
- snapshot isolation [SQL Server Native Client]
- SQL Server Native Client OLE DB provider, snapshot isolation
- SQL Server Native Client ODBC driver, snapshot isolation
- SQL Server Native Client, snapshot isolation
- SQLGetInfo function
- concurrency [SQL Server Native Client]
- SQLSetConnectAttr function
ms.assetid: 39e87eb1-677e-45dd-bc61-83a4025a7756
author: rothja
ms.author: jroth
ms.openlocfilehash: 242d054a5fd2ad12a8811bebc834d423f547a499
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87620305"
---
# <a name="working-with-snapshot-isolation"></a><span data-ttu-id="df81e-102">Arbeiten mit Momentaufnahmeisolation</span><span class="sxs-lookup"><span data-stu-id="df81e-102">Working with Snapshot Isolation</span></span>
  <span data-ttu-id="df81e-103">In [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] wurde eine neue Momentaufnahmenisolationsstufe eingeführt, die die Parallelität für OLTP-Anwendungen (Online Transaction Processing, Onlinetransaktionsverarbeitung) verbessern soll.</span><span class="sxs-lookup"><span data-stu-id="df81e-103">[!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] introduced a new "snapshot" isolation level that is intended to enhance concurrency for online transaction processing (OLTP) applications.</span></span> <span data-ttu-id="df81e-104">In früheren Versionen von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] basierte die Parallelität ausschließlich auf dem Sperren, was zu Blockierungs- und Deadlockproblemen bei einigen Anwendungen führen konnte.</span><span class="sxs-lookup"><span data-stu-id="df81e-104">In earlier versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], concurrency was based solely on locking, which can cause blocking and deadlocking problems for some applications.</span></span> <span data-ttu-id="df81e-105">Die Momentaufnahmenisolation hängt von Verbesserungen der Zeilenversionsverwaltung ab und soll die Leistung durch Vermeidung von Leser-/Schreiberblockierungsszenarien erhöhen.</span><span class="sxs-lookup"><span data-stu-id="df81e-105">Snapshot isolation depends on enhancements to row versioning and is intended to improve performance by avoiding reader-writer blocking scenarios.</span></span>  
  
 <span data-ttu-id="df81e-106">Transaktionen, die mit der Momentaufnahmenisolation gestartet werden, lesen eine Datenbankmomentaufnahme zu dem Zeitpunkt, an dem die Transaktion gestartet wird.</span><span class="sxs-lookup"><span data-stu-id="df81e-106">Transactions that start under snapshot isolation read a database snapshot as of the time when the transaction starts.</span></span> <span data-ttu-id="df81e-107">Eine Folge davon ist, dass sich keysetgesteuerte, dynamische und statische Servercursor, wenn sie innerhalb eines Momentaufnahmentransaktionskontexts geöffnet werden, ähnlich verhalten wie statische Cursor, die innerhalb serialisierbarer Transaktionen geöffnet werden.</span><span class="sxs-lookup"><span data-stu-id="df81e-107">One result of this is that keyset, dynamic and static server cursors, when opened within a snapshot transaction context, behave much like static cursors opened within serializable transactions.</span></span> <span data-ttu-id="df81e-108">Wenn die Cursor unter der Momentaufnahmenisolationsstufe geöffnet werden, werden jedoch keine Sperren angenommen, was sich positiv auf die Blockierung des Servers auswirken kann.</span><span class="sxs-lookup"><span data-stu-id="df81e-108">However, when the cursors are opened under the snapshot isolation level locks are not taken, which can reduce blocking on the server.</span></span>  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="df81e-109">SQL Server Native Client OLE DB-Anbieter</span><span class="sxs-lookup"><span data-stu-id="df81e-109">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="df81e-110">Der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter verfügt über Erweiterungen, die die in eingeführte Snapshot-Isolation nutzen [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="df81e-110">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider has enhancements that take advantage of the snapshot isolation introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="df81e-111">Diese Erweiterungen schließen Änderungen an den DBPROPSET_DATASOURCEINFO und DBPROPSET_SESSION-Eigenschaftsgruppen ein.</span><span class="sxs-lookup"><span data-stu-id="df81e-111">These enhancements include changes to the DBPROPSET_DATASOURCEINFO and DBPROPSET_SESSION property sets.</span></span>  
  
### <a name="dbpropset_datasourceinfo"></a><span data-ttu-id="df81e-112">DBPROPSET_DATASOURCEINFO</span><span class="sxs-lookup"><span data-stu-id="df81e-112">DBPROPSET_DATASOURCEINFO</span></span>  
 <span data-ttu-id="df81e-113">Die DBPROPSET_DATASOURCEINFO-Eigenschaftsgruppe wurde geändert, um anzugeben, dass die Momentaufnahmenisolationsstufe vom hinzugefügten DBPROPVAL_TI_SNAPSHOT-Wert unterstützt wird, der in der DBPROP_SUPPORTEDTXNISOLEVELS-Eigenschaft verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="df81e-113">The DBPROPSET_DATASOURCEINFO property set has been changed to indicate that the snapshot isolation level is supported by the addition of the DBPROPVAL_TI_SNAPSHOT value that is used in the DBPROP_SUPPORTEDTXNISOLEVELS property.</span></span> <span data-ttu-id="df81e-114">Dieser neue Wert gibt an, dass die Momentaufnahmenisolationsstufe unabhängig davon unterstützt wird, ob die Versionsverwaltung für die Datenbank aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="df81e-114">This new value indicates that the snapshot isolation level is supported whether or not versioning has been enabled on the database.</span></span> <span data-ttu-id="df81e-115">Im Folgenden sind die DBPROP_SUPPORTEDTXNISOLEVELS-Werte aufgeführt:</span><span class="sxs-lookup"><span data-stu-id="df81e-115">The following is a list of the DBPROP_SUPPORTEDTXNISOLEVELS values:</span></span>  
  
|<span data-ttu-id="df81e-116">Eigenschafts-ID</span><span class="sxs-lookup"><span data-stu-id="df81e-116">Property ID</span></span>|<span data-ttu-id="df81e-117">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="df81e-117">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="df81e-118">DBPROP_SUPPORTEDTXNISOLEVELS</span><span class="sxs-lookup"><span data-stu-id="df81e-118">DBPROP_SUPPORTEDTXNISOLEVELS</span></span>|<span data-ttu-id="df81e-119">Typ: VT_I4</span><span class="sxs-lookup"><span data-stu-id="df81e-119">Type: VT_I4</span></span><br /><br /> <span data-ttu-id="df81e-120">R/W: Schreibgeschützt</span><span class="sxs-lookup"><span data-stu-id="df81e-120">R/W: Read only</span></span><br /><br /> <span data-ttu-id="df81e-121">Beschreibung: Eine Bitmaske, die die unterstützten Transaktionsisolationsstufen angibt.</span><span class="sxs-lookup"><span data-stu-id="df81e-121">Description: A bitmask specifying the supported transaction isolation levels.</span></span> <span data-ttu-id="df81e-122">Eine Kombination von null oder mehreren der folgenden Werte:</span><span class="sxs-lookup"><span data-stu-id="df81e-122">A combination of zero or more of the following:</span></span><br /><br /> <span data-ttu-id="df81e-123">-DBPROPVAL_TI_CHAOS</span><span class="sxs-lookup"><span data-stu-id="df81e-123">-   DBPROPVAL_TI_CHAOS</span></span><br /><span data-ttu-id="df81e-124">-DBPROPVAL_TI_READUNCOMMITTED</span><span class="sxs-lookup"><span data-stu-id="df81e-124">-   DBPROPVAL_TI_READUNCOMMITTED</span></span><br /><span data-ttu-id="df81e-125">-DBPROPVAL_TI_BROWSE</span><span class="sxs-lookup"><span data-stu-id="df81e-125">-   DBPROPVAL_TI_BROWSE</span></span><br /><span data-ttu-id="df81e-126">-DBPROPVAL_TI_CURSORSTABILITY</span><span class="sxs-lookup"><span data-stu-id="df81e-126">-   DBPROPVAL_TI_CURSORSTABILITY</span></span><br /><span data-ttu-id="df81e-127">-DBPROPVAL_TI_READCOMMITTED</span><span class="sxs-lookup"><span data-stu-id="df81e-127">-   DBPROPVAL_TI_READCOMMITTED</span></span><br /><span data-ttu-id="df81e-128">-DBPROPVAL_TI_REPEATABLEREAD</span><span class="sxs-lookup"><span data-stu-id="df81e-128">-   DBPROPVAL_TI_REPEATABLEREAD</span></span><br /><span data-ttu-id="df81e-129">-DBPROPVAL_TI_SERIALIZABLE</span><span class="sxs-lookup"><span data-stu-id="df81e-129">-   DBPROPVAL_TI_SERIALIZABLE</span></span><br /><span data-ttu-id="df81e-130">-DBPROPVAL_TI_ISOLATED</span><span class="sxs-lookup"><span data-stu-id="df81e-130">-   DBPROPVAL_TI_ISOLATED</span></span><br /><span data-ttu-id="df81e-131">-DBPROPVAL_TI_SNAPSHOT</span><span class="sxs-lookup"><span data-stu-id="df81e-131">-   DBPROPVAL_TI_SNAPSHOT</span></span>|  
  
### <a name="dbpropset_session"></a><span data-ttu-id="df81e-132">DBPROPSET_SESSION</span><span class="sxs-lookup"><span data-stu-id="df81e-132">DBPROPSET_SESSION</span></span>  
 <span data-ttu-id="df81e-133">Die DBPROPSET_SESSION-Eigenschaftsgruppe wurde geändert, um anzugeben, dass die Momentaufnahmenisolationsstufe vom hinzugefügten DBPROPVAL_TI_SNAPSHOT-Wert unterstützt wird, der in der DBPROP_SESS_AUTOCOMMITISOLEVELS-Eigenschaft verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="df81e-133">The DBPROPSET_SESSION property set has been changed to indicate that the snapshot isolation level is supported by the addition of the DBPROPVAL_TI_SNAPSHOT value that is used in the DBPROP_SESS_AUTOCOMMITISOLEVELS property.</span></span> <span data-ttu-id="df81e-134">Dieser neue Wert gibt an, dass die Momentaufnahmenisolationsstufe unabhängig davon unterstützt wird, ob die Versionsverwaltung für die Datenbank aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="df81e-134">This new value indicates that the snapshot isolation level is supported whether or not versioning has been enabled on the database.</span></span> <span data-ttu-id="df81e-135">Im Folgenden sind die DBPROP_SESS_AUTOCOMMITISOLEVELS-Werte aufgeführt:</span><span class="sxs-lookup"><span data-stu-id="df81e-135">The following is a list of the DBPROP_SESS_AUTOCOMMITISOLEVELS values:</span></span>  
  
|<span data-ttu-id="df81e-136">Eigenschafts-ID</span><span class="sxs-lookup"><span data-stu-id="df81e-136">Property ID</span></span>|<span data-ttu-id="df81e-137">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="df81e-137">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="df81e-138">DBPROP_SESS_AUTOCOMMITISOLEVELS</span><span class="sxs-lookup"><span data-stu-id="df81e-138">DBPROP_SESS_AUTOCOMMITISOLEVELS</span></span>|<span data-ttu-id="df81e-139">Typ: VT_I4</span><span class="sxs-lookup"><span data-stu-id="df81e-139">Type: VT_I4</span></span><br /><br /> <span data-ttu-id="df81e-140">R/W: Schreibgeschützt</span><span class="sxs-lookup"><span data-stu-id="df81e-140">R/W: Read only</span></span><br /><br /> <span data-ttu-id="df81e-141">Beschreibung: Legt eine Bitmaske fest, die die Transaktionsisolationsstufe im Autocommit-Modus angibt.</span><span class="sxs-lookup"><span data-stu-id="df81e-141">Description: Specifies a bitmask that indicates the transaction isolation level while in auto-commit mode.</span></span> <span data-ttu-id="df81e-142">Die Werte, die in dieser Bitmaske festgelegt werden können, entsprechen den für DBPROP_SUPPORTEDTXNISOLEVELS möglichen Werten.</span><span class="sxs-lookup"><span data-stu-id="df81e-142">The values that can be set in this bitmask are the same as those that can be set for DBPROP_SUPPORTEDTXNISOLEVELS.</span></span>|  
  
> [!NOTE]  
>  <span data-ttu-id="df81e-143">Der Fehler DB_S_ERRORSOCCURRED oder DB_E_ERRORSOCCURRED tritt auf, wenn DBPROPVAL_TI_SNAPSHOT in Versionen von [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] vor [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="df81e-143">The errors DB_S_ERRORSOCCURRED or DB_E_ERRORSOCCURRED will occur if DBPROPVAL_TI_SNAPSHOT is set when using versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] earlier than [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span>  
  
 <span data-ttu-id="df81e-144">Weitere Informationen dazu, wie die Momentaufnahmenisolation in Transaktionen unterstützt wird, finden Sie unter [Unterstützen lokaler Transaktionen](../../native-client-ole-db-transactions/transactions.md).</span><span class="sxs-lookup"><span data-stu-id="df81e-144">For information about how snapshot isolation is supported in transactions, see [Supporting Local Transactions](../../native-client-ole-db-transactions/transactions.md).</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="df81e-145">ODBC-Treiber für SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="df81e-145">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="df81e-146">Der [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client-ODBC-Treiber bietet Unterstützung für die Momentaufnahme Isolation, wobei jedoch Erweiterungen an den Funktionen [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) und [SQLGetInfo](../../native-client-odbc-api/sqlgetinfo.md) vorgenommen werden.</span><span class="sxs-lookup"><span data-stu-id="df81e-146">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver provides support for snapshot isolation though enhancements made to the [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) and [SQLGetInfo](../../native-client-odbc-api/sqlgetinfo.md) functions.</span></span>  
  
### <a name="sqlsetconnectattr"></a><span data-ttu-id="df81e-147">SQLSetConnectAttr</span><span class="sxs-lookup"><span data-stu-id="df81e-147">SQLSetConnectAttr</span></span>  
 <span data-ttu-id="df81e-148">Die **SQLSetConnectAttr** -Funktion unterstützt jetzt die Verwendung des SQL_COPT_SS_TXN_ISOLATION-Attributs.</span><span class="sxs-lookup"><span data-stu-id="df81e-148">The **SQLSetConnectAttr** function now supports the use of the SQL_COPT_SS_TXN_ISOLATION attribute.</span></span> <span data-ttu-id="df81e-149">Durch Festlegen von SQL_COPT_SS_TXN_ISOLATION auf SQL_TXN_SS_SNAPSHOT wird angegeben, dass die Transaktion unter der Momentaufnahmeisolationsstufe ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="df81e-149">Setting SQL_COPT_SS_TXN_ISOLATION to SQL_TXN_SS_SNAPSHOT indicates that the transaction will take place under the snapshot isolation level.</span></span>  
  
### <a name="sqlgetinfo"></a><span data-ttu-id="df81e-150">SQLGetInfo</span><span class="sxs-lookup"><span data-stu-id="df81e-150">SQLGetInfo</span></span>  
 <span data-ttu-id="df81e-151">Die [SQLGetInfo](../../native-client-odbc-api/sqlgetinfo.md) -Funktion unterstützt jetzt den SQL_TXN_SS_SNAPSHOT Wert, der dem SQL_TXN_ISOLATION_OPTION Infotyp hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="df81e-151">The [SQLGetInfo](../../native-client-odbc-api/sqlgetinfo.md) function now supports the SQL_TXN_SS_SNAPSHOT value that has been added to the SQL_TXN_ISOLATION_OPTION info type.</span></span>  
  
 <span data-ttu-id="df81e-152">Informationen zur Unterstützung von Snapshot-Isolation in Transaktionen finden Sie unter [Cursor Transaktions Isolationsstufe](../../native-client-odbc-cursors/properties/cursor-transaction-isolation-level.md).</span><span class="sxs-lookup"><span data-stu-id="df81e-152">For information about how snapshot isolation is supported in transactions, see [Cursor Transaction Isolation Level](../../native-client-odbc-cursors/properties/cursor-transaction-isolation-level.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="df81e-153">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="df81e-153">See Also</span></span>  
 <span data-ttu-id="df81e-154">[SQL Server Native Client-Funktionen](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="df81e-154">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 [<span data-ttu-id="df81e-155">Eigenschaften und Verhaltensweisen von Rowsets</span><span class="sxs-lookup"><span data-stu-id="df81e-155">Rowset Properties and Behaviors</span></span>](../../native-client-ole-db-rowsets/rowset-properties-and-behaviors.md)  
  
  

---
title: Aktualisieren von Daten in SQL Server-Cursorn | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- updating data [SQL Server]
- isolation levels [SQL Server]
- delayed update mode [OLE DB]
- immediate update mode [OLE DB]
- cursors [OLE DB]
- data updates [SQL Server], OLE DB
ms.assetid: 732dafee-f2d5-4aef-aad7-3a8bf3b1e876
author: rothja
ms.author: jroth
ms.openlocfilehash: 42e6221a85c30e3adb97df3a11c9cbdc49216b4d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87615371"
---
# <a name="updating-data-in-sql-server-cursors"></a><span data-ttu-id="f7c2e-102">Aktualisieren von Daten in SQL Server-Cursorn</span><span class="sxs-lookup"><span data-stu-id="f7c2e-102">Updating Data in SQL Server Cursors</span></span>
  <span data-ttu-id="f7c2e-103">Beim Abrufen und aktualisieren [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] von Daten mittels Cursorn [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] wird die Consumeranwendung eines Native Client OLE DB Anbieters durch die gleichen Überlegungen und Einschränkungen gebunden, die für jede andere Client Anwendung gelten.</span><span class="sxs-lookup"><span data-stu-id="f7c2e-103">When fetching and updating data through [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cursors, a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer application is bound by the same considerations and constraints that apply to any other client application.</span></span>  
  
 <span data-ttu-id="f7c2e-104">Nur Zeilen in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-Cursorn nehmen an der gleichzeitigen Datenzugriffssteuerung teil.</span><span class="sxs-lookup"><span data-stu-id="f7c2e-104">Only rows in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cursors participate in concurrent data-access control.</span></span> <span data-ttu-id="f7c2e-105">Wenn der Consumer ein änderbares Rowset anfordert, wird die Parallelitätssteuerung von DBPROP_LOCKMODE kontrolliert.</span><span class="sxs-lookup"><span data-stu-id="f7c2e-105">When the consumer requests a modifiable rowset, the concurrency control is controlled by DBPROP_LOCKMODE.</span></span> <span data-ttu-id="f7c2e-106">Um die Steuerungsebene für den gleichzeitigen Zugriff zu ändern, legt der Consumer die DBPROP_LOCKMODE-Eigenschaft vor dem Öffnen des Rowsets fest.</span><span class="sxs-lookup"><span data-stu-id="f7c2e-106">To modify the level of concurrent access control, the consumer sets the DBPROP_LOCKMODE property before opening the rowset.</span></span>  
  
 <span data-ttu-id="f7c2e-107">Transaktionsisolationsstufen können zu beträchtlichen Verzögerungen bei der Zeilenpositionierung führen, wenn Transaktionen aufgrund des Designs der Clientanwendung über längere Zeit geöffnet bleiben.</span><span class="sxs-lookup"><span data-stu-id="f7c2e-107">Transaction isolation levels can cause significant lags in row positioning if client application design lets transactions remain open for long periods of time.</span></span> <span data-ttu-id="f7c2e-108">Standardmäßig verwendet der [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client-OLE DB Anbieter die durch DBPROPVAL_TI_READCOMMITTED angegebene Isolationsstufe mit Leseberechtigung.</span><span class="sxs-lookup"><span data-stu-id="f7c2e-108">By default, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider uses the read-committed isolation level specified by DBPROPVAL_TI_READCOMMITTED.</span></span> <span data-ttu-id="f7c2e-109">Der [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter unterstützt Dirty Read Isolation, wenn die Rowsetparallelität schreibgeschützt ist.</span><span class="sxs-lookup"><span data-stu-id="f7c2e-109">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports dirty read isolation when the rowset concurrency is read-only.</span></span> <span data-ttu-id="f7c2e-110">Daher kann der Consumer in einem änderbaren Rowset eine höhere Isolationsstufe jedoch keine niedrigere Stufe erfolgreich anfordern.</span><span class="sxs-lookup"><span data-stu-id="f7c2e-110">Therefore, the consumer can request a higher level of isolation in a modifiable rowset but cannot request any lower level successfully.</span></span>  
  
## <a name="immediate-and-delayed-update-modes"></a><span data-ttu-id="f7c2e-111">Unmittelbarer und verzögerter Updatemodus</span><span class="sxs-lookup"><span data-stu-id="f7c2e-111">Immediate and Delayed Update Modes</span></span>  
 <span data-ttu-id="f7c2e-112">Im Sofortupdatemodus verursacht jeder Aufruf von **IRowsetChange::SetData** einen Roundtrip zu [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f7c2e-112">In immediate update mode, each call to **IRowsetChange::SetData** causes a round trip to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="f7c2e-113">Wenn der Consumer mehrere Änderungen an einer einzelnen Zeile vornimmt, ist es effizienter, alle Änderungen mit einem einzigen **SetData**-Aufruf zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="f7c2e-113">If the consumer makes multiple changes to a single row, it is more efficient to submit all changes with a single **SetData** call.</span></span>  
  
 <span data-ttu-id="f7c2e-114">Im verzögerten Updatemodus wird für jede im *cRows*-Parameter und *rghRows*-Parameter von **IRowsetUpdate::Update** angegebene Zeile ein Roundtrip zu [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="f7c2e-114">In delayed update mode, a roundtrip is made to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] for each row indicated in the *cRows* and *rghRows* parameters of **IRowsetUpdate::Update**.</span></span>  
  
 <span data-ttu-id="f7c2e-115">In beiden Modi stellt ein Roundtrip eine separate Transaktion dar, wenn kein Transaktionsobjekt für das Rowset geöffnet ist.</span><span class="sxs-lookup"><span data-stu-id="f7c2e-115">In either mode, a roundtrip represents a distinct transaction when no transaction object is open for the rowset.</span></span>  
  
 <span data-ttu-id="f7c2e-116">Wenn Sie **IRowsetUpdate:: Update**verwenden, versucht der [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter, jede bestimmte Zeile zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="f7c2e-116">When you are using **IRowsetUpdate::Update**, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider tries to process each indicated row.</span></span> <span data-ttu-id="f7c2e-117">Aufgrund ungültiger Daten-, Längen-oder Statuswerte für eine Zeile wird die [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Verarbeitung von Native Client OLE DB-Anbietern nicht beendet.</span><span class="sxs-lookup"><span data-stu-id="f7c2e-117">An error occurring because of invalid data, length, or status values for any row does not stop [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider processing.</span></span> <span data-ttu-id="f7c2e-118">Es können nur alle oder keine der anderen am Update beteiligten Zeilen geändert werden.</span><span class="sxs-lookup"><span data-stu-id="f7c2e-118">All or none of the other rows participating in the update may be modified.</span></span> <span data-ttu-id="f7c2e-119">Der Consumer muss das zurückgegebene *prgRowStatus* -Array untersuchen, um den Fehler für eine bestimmte Zeile zu ermitteln, wenn der [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter DB_S_ERRORSOCCURRED zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="f7c2e-119">The consumer must examine the returned *prgRowStatus* array to determine failure for any specific row when the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED.</span></span>  
  
 <span data-ttu-id="f7c2e-120">Ein Consumer darf nicht davon ausgehen, dass Zeilen in einer bestimmten Reihenfolge verarbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="f7c2e-120">A consumer should not assume that rows are processed in any specific order.</span></span> <span data-ttu-id="f7c2e-121">Wenn ein Consumer es erfordert, dass die Verarbeitung von Datenänderungen in mehr als einer Zeile in einer bestimmten Reihenfolge durchgeführt wird, muss der Consumer diese Reihenfolge in der Anwendungslogik festlegen und eine Transaktion öffnen, um den Prozess darin einzuschließen.</span><span class="sxs-lookup"><span data-stu-id="f7c2e-121">If a consumer requires ordered processing of data modification over more than a single row, the consumer should establish that order in the application logic and open a transaction to enclose the process.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f7c2e-122">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="f7c2e-122">See Also</span></span>  
 [<span data-ttu-id="f7c2e-123">Aktualisieren von Daten in Rowsets</span><span class="sxs-lookup"><span data-stu-id="f7c2e-123">Updating Data in Rowsets</span></span>](updating-data-in-rowsets.md)  
  
  

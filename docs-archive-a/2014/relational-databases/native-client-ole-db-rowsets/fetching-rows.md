---
title: Fetchen von Zeilen | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- fetching rows
- OLE DB rowsets, fetching
- rowsets [OLE DB], fetching
- IRowset interface
- SQL Server Native Client OLE DB provider, fetching
ms.assetid: 5e6dbe36-b682-464d-adfa-8e886f9bd452
author: rothja
ms.author: jroth
ms.openlocfilehash: 435e1d705091814b2544c75772f20882caddf942
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87609869"
---
# <a name="fetching-rows"></a><span data-ttu-id="8bda9-102">Abrufen von Zeilen</span><span class="sxs-lookup"><span data-stu-id="8bda9-102">Fetching Rows</span></span>
  <span data-ttu-id="8bda9-103">Die **IRowset**-Schnittstelle ist die grundlegende Rowset-Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="8bda9-103">The **IRowset** interface is the base rowset interface.</span></span> <span data-ttu-id="8bda9-104">Die **IRowset**-Schnittstelle stellt Methoden zum sequenziellen Abrufen von Zeilen, zum Kopieren der Daten aus diesen Zeilen und zum Verwalten der Zeilen bereit.</span><span class="sxs-lookup"><span data-stu-id="8bda9-104">The **IRowset** interface provides methods for fetching rows sequentially, getting the data from those rows, and managing rows.</span></span> <span data-ttu-id="8bda9-105">Consumer verwenden die Methoden in **IRowset** für alle grundlegenden Rowsetvorgänge.</span><span class="sxs-lookup"><span data-stu-id="8bda9-105">Consumers use the methods in **IRowset** for all basic rowset operations.</span></span> <span data-ttu-id="8bda9-106">Dazu gehört das Abrufen und erneute Freigeben von Zeilen und das Einlesen von Spaltenwerten.</span><span class="sxs-lookup"><span data-stu-id="8bda9-106">This includes fetching and releasing rows and getting column values.</span></span>  
  
 <span data-ttu-id="8bda9-107">Wenn ein Consumer einen Schnittstellenzeiger für ein Rowset erhält, besteht der erste Schritt normalerweise darin, mithilfe der Methode **IRowsetInfo::GetProperties** die Funktionen des Rowsets zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="8bda9-107">When a consumer obtains an interface pointer on a rowset, the first step is ordinarily to determine the capabilities of the rowset by using the **IRowsetInfo::GetProperties** method.</span></span> <span data-ttu-id="8bda9-108">Auf diese Weise werden Informationen über die durch das Rowset verfügbar gemachten Schnittstellen zurückgegeben sowie über andere Möglichkeiten des Rowsets, die nicht als eigentliche Schnittstellen zu betrachten sind, wie beispielsweise die maximale Anzahl aktiver Zeilen und die Anzahl der Zeilen, die gleichzeitig ausstehende Updates aufweisen können.</span><span class="sxs-lookup"><span data-stu-id="8bda9-108">This returns information about the interfaces exposed by the rowset and also capabilities of the rowset that do not show up as distinct interfaces, such as the maximum number of active rows and the number of rows that can have pending updates at the same time.</span></span>  
  
 <span data-ttu-id="8bda9-109">Der nächste, vom Consumer auszuführende Schritt besteht darin, die Charakteristika – oder Metadaten – der Spalten im Rowset zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="8bda9-109">The next step for consumers is to determine the characteristics, or metadata, of the columns in the rowset.</span></span> <span data-ttu-id="8bda9-110">Dafür verwendet er die Methode **IColumnsInfo** zum Abrufen einfacher Informationen über die Spalten oder die Methode **IColumnsRowset** für ausführlichere Informationen.</span><span class="sxs-lookup"><span data-stu-id="8bda9-110">For this they use the **IColumnsInfo** method for simple column information or the **IColumnsRowset** method for extended column information.</span></span> <span data-ttu-id="8bda9-111">Die Methode **GetColumnInfo** gibt die folgenden Informationen zurück:</span><span class="sxs-lookup"><span data-stu-id="8bda9-111">The **GetColumnInfo** method returns the following information:</span></span>  
  
-   <span data-ttu-id="8bda9-112">Die Anzahl der Spalten im Resultset.</span><span class="sxs-lookup"><span data-stu-id="8bda9-112">The number of columns in the result set.</span></span>  
  
-   <span data-ttu-id="8bda9-113">Ein Array von DBCOLUMNINFO-Strukturen; eines pro Spalte.</span><span class="sxs-lookup"><span data-stu-id="8bda9-113">An array of DBCOLUMNINFO structures, one per column.</span></span>  
  
     <span data-ttu-id="8bda9-114">Die Reihenfolge der Strukturen entspricht der Reihenfolge, in der die Spalten im Rowset erscheinen.</span><span class="sxs-lookup"><span data-stu-id="8bda9-114">The order of the structures is the order in which the columns appear in the rowset.</span></span> <span data-ttu-id="8bda9-115">Jede DBCOLUMNINFO-Struktur enthält Spaltenmetadaten wie den Spaltennamen, die Ordnungszahl der Spalte, maximal mögliche Länge eines Werts in der Spalte, Datentyp, Genauigkeit und Länge der Spalte.</span><span class="sxs-lookup"><span data-stu-id="8bda9-115">Each DBCOLUMNINFO structure includes column metadata, such as column name, ordinal of the column, maximum possible length of a value in the column, data type of the column, precision, and length.</span></span>  
  
-   <span data-ttu-id="8bda9-116">Den Zeiger auf einen Speicher für alle Zeichenfolgenwerte innerhalb eines einzelnen Zuordnungsblocks.</span><span class="sxs-lookup"><span data-stu-id="8bda9-116">The pointer to a storage for all string values within a single allocation block.</span></span>  
  
 <span data-ttu-id="8bda9-117">Der Consumer bestimmt, welche Spalten erforderlich sind, entweder auf der Grundlage der Metadaten oder basierend auf den Textbefehl, mit dem das Rowset generiert wurde.</span><span class="sxs-lookup"><span data-stu-id="8bda9-117">The consumer determines which columns it needs either from the metadata or based on the text command that generated the rowset.</span></span> <span data-ttu-id="8bda9-118">Die Ordnungszahlen der benötigten Spalten werden dabei entweder über die Reihenfolge der von **IColumnsInfo** zurückgegebenen Spalteninformationen oder ausgehend von den Ordnungszahlen in dem von **IColumnsRowset** zurückgegebenen Spaltenmetadatenrowset bestimmt.</span><span class="sxs-lookup"><span data-stu-id="8bda9-118">It determines the ordinals of the needed columns from the ordering of the column information returned by **IColumnsInfo** or from the ordinals in the column metadata rowset returned by **IColumnsRowset**.</span></span>  
  
 <span data-ttu-id="8bda9-119">Die **IColumnsInfo**-Schnittstelle und die **IColumnsRowset**-Schnittstelle werden verwendet, um Informationen über die Spalten im Rowset zu extrahieren.</span><span class="sxs-lookup"><span data-stu-id="8bda9-119">The **IColumnsInfo** and **IColumnsRowset** interfaces are used to extract information about the columns in the rowset.</span></span> <span data-ttu-id="8bda9-120">Die **IColumnsInfo**-Schnittstelle gibt eine beschränkte Menge von Informationen zurück, während **IColumnsRowset** alle Metadaten bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="8bda9-120">The **IColumnsInfo** interface returns a limited set of information, whereas **IColumnsRowset** provides all the metadata.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8bda9-121">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Version 7.0 und niedriger gibt die optionale Metadatenspalte DBCOLUMN_COMPUTEMODE, die von **IColumnsInfo::GetColumnsInfo** zurückgegeben wird, DBSTATUS_S_ISNULL an (anstelle der Werte, die angeben, ob die Spalte berechnet ist), da nicht ermittelt werden kann, ob die zugrunde liegende Spalte berechnet ist.</span><span class="sxs-lookup"><span data-stu-id="8bda9-121">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] version 7.0 and earlier, the optional metadata column DBCOLUMN_COMPUTEMODE returned by **IColumnsInfo::GetColumnsInfo** returns DBSTATUS_S_ISNULL (instead of the values describing whether the column is computed) because it cannot be determined whether the underlying column is computed.</span></span>  
  
 <span data-ttu-id="8bda9-122">Die Ordnungszahlen werden verwendet, um eine Bindung an eine Spalte anzugeben.</span><span class="sxs-lookup"><span data-stu-id="8bda9-122">The ordinals are used to specify a binding to a column.</span></span> <span data-ttu-id="8bda9-123">Eine Bindung ist eine Struktur, die einer Spalte ein Element der Struktur des Consumers zuordnet.</span><span class="sxs-lookup"><span data-stu-id="8bda9-123">A binding is a structure that associates an element of the consumer's structure with a column.</span></span> <span data-ttu-id="8bda9-124">Die Bindung kann den Datenwert, die Länge und den Statuswert der Spalte binden.</span><span class="sxs-lookup"><span data-stu-id="8bda9-124">The binding can bind the data value, length, and status value of the column.</span></span>  
  
 <span data-ttu-id="8bda9-125">Ein Satz von Bindungen wird zusammen in einem Accessor erfasst.</span><span class="sxs-lookup"><span data-stu-id="8bda9-125">A set of bindings is gathered together in an accessor.</span></span> <span data-ttu-id="8bda9-126">Dieser wird mit der Methode **IAccessor::CreateAccessor** erstellt.</span><span class="sxs-lookup"><span data-stu-id="8bda9-126">This is created by using the **IAccessor::CreateAccessor** method.</span></span> <span data-ttu-id="8bda9-127">Ein Accessor kann mehrere Bindungen enthalten, sodass die Daten für mehrere Spalten durch einen einzigen Aufruf abgerufen oder festgelegt werden können.</span><span class="sxs-lookup"><span data-stu-id="8bda9-127">An accessor can contain multiple bindings so that the data for multiple columns can be retrieved or set in a single call.</span></span> <span data-ttu-id="8bda9-128">Der Consumer kann mehrere Accessoren erstellen, um in verschiedenen Teilen der Anwendung auf verschiedene Verwendungsmuster zu antworten.</span><span class="sxs-lookup"><span data-stu-id="8bda9-128">The consumer can create several accessors to match different usage patterns in different parts of the application.</span></span> <span data-ttu-id="8bda9-129">Er kann Accessoren erstellen und freigeben, solange das Rowset besteht.</span><span class="sxs-lookup"><span data-stu-id="8bda9-129">It can create and release accessors while the rowset remains in existence.</span></span>  
  
 <span data-ttu-id="8bda9-130">Um Zeilen aus der Datenbank abzurufen, ruft der Consumer eine Methode auf, z.B. **IRowset::GetNextRows** oder **IRowsetLocate::GetRowsAt**.</span><span class="sxs-lookup"><span data-stu-id="8bda9-130">To fetch rows from the database, the consumer calls a method, such as **IRowset::GetNextRows** or **IRowsetLocate::GetRowsAt**.</span></span> <span data-ttu-id="8bda9-131">Diese Abrufvorgänge platzieren Zeilendaten vom Server in den Zeilenpuffer des Anbieters.</span><span class="sxs-lookup"><span data-stu-id="8bda9-131">These fetch operations put row data from the server into the row buffer of the provider.</span></span> <span data-ttu-id="8bda9-132">Der Consumer hat keinen Direktzugriff auf den Zeilenpuffer des Anbieters.</span><span class="sxs-lookup"><span data-stu-id="8bda9-132">The consumer does not have direct access to the row buffer of the provider.</span></span> <span data-ttu-id="8bda9-133">Der Consumer verwendet **IRowset::GetData**, um die Daten vom Puffer des Anbieters in den Consumerpuffer zu kopieren, und kopiert dann mithilfe von **IRowsetChange::SetData** Änderungen an den Daten vom Consumerpuffer in den Anbieterpuffer zurück.</span><span class="sxs-lookup"><span data-stu-id="8bda9-133">The consumer uses **IRowset::GetData** to copy data from the buffer of the provider to the consumer buffer and **IRowsetChange::SetData** to copy data changes from the consumer buffer to the provider buffer.</span></span>  
  
 <span data-ttu-id="8bda9-134">Der Consumer ruft die Methode **GetData** auf und übergibt das Handle für eine Zeile, das Handle für einen Accessor und einen Zeiger auf den vom Consumer zugeordneten Puffer.</span><span class="sxs-lookup"><span data-stu-id="8bda9-134">The consumer calls the **GetData** method and passes the handle to a row, the handle to an accessor, and a pointer to a consumer-allocated buffer.</span></span> <span data-ttu-id="8bda9-135">**GetData** konvertiert die Daten und gibt die Spalten zurück, wie in den zum Erstellen des Accessors verwendeten Bindungen angegeben.</span><span class="sxs-lookup"><span data-stu-id="8bda9-135">**GetData** converts the data and returns the columns as specified in the bindings used to create the accessor.</span></span> <span data-ttu-id="8bda9-136">Der Consumer kann **GetData** mehrere Male für eine Zeile aufrufen und dabei verschiedene Accessoren und Puffer verwenden. Daher kann der Consumer mehrere Kopien derselben Daten erhalten.</span><span class="sxs-lookup"><span data-stu-id="8bda9-136">The consumer can call **GetData** more than one time for a row, using different accessors and buffers and therefore the consumer can obtain multiple copies of the same data.</span></span>  
  
 <span data-ttu-id="8bda9-137">Daten aus Spalten variabler Länge können auf mehrere Arten behandelt werden.</span><span class="sxs-lookup"><span data-stu-id="8bda9-137">Data from variable-length columns can be treated several ways.</span></span> <span data-ttu-id="8bda9-138">Zunächst können solche Spalten an einen endlichen Abschnitt der Struktur des Consumers gebunden werden.</span><span class="sxs-lookup"><span data-stu-id="8bda9-138">First, such columns can be bound to a finite section of the consumer's structure.</span></span> <span data-ttu-id="8bda9-139">Dies verursacht das Abschneiden von Daten, wenn die Länge der Daten die Länge des Puffers überschreitet.</span><span class="sxs-lookup"><span data-stu-id="8bda9-139">This causes truncation when the length of the data exceeds the length of the buffer.</span></span> <span data-ttu-id="8bda9-140">Der Consumer kann ermitteln, dass Daten abgeschnitten wurden, indem er den Status DBSTATUS_S_TRUNCATED überprüft.</span><span class="sxs-lookup"><span data-stu-id="8bda9-140">The consumer can determine that truncation has occurred by checking for the status DBSTATUS_S_TRUNCATED.</span></span> <span data-ttu-id="8bda9-141">Die zurückgegebene Länge ist immer die wirkliche Länge in Byte, sodass der Consumer auch bestimmen kann, wie viele Daten abgeschnitten wurden.</span><span class="sxs-lookup"><span data-stu-id="8bda9-141">The returned length is always the true length in bytes, so that the consumer also can determine how much data was truncated.</span></span>  
  
 <span data-ttu-id="8bda9-142">Wenn der Consumer das Abrufen oder Aktualisieren der Zeilen abgeschlossen hat, gibt er sie mit der Methode **ReleaseRows** wieder frei.</span><span class="sxs-lookup"><span data-stu-id="8bda9-142">When the consumer has finished fetching or updating rows, it releases them with the **ReleaseRows** method.</span></span> <span data-ttu-id="8bda9-143">Auf diese Weise werden Ressourcen von der Kopie der Zeilen im Rowset frei, und es wird Platz für neue Zeilen geschaffen.</span><span class="sxs-lookup"><span data-stu-id="8bda9-143">This releases resources from the copy of the rows in the rowset and makes room for new rows.</span></span> <span data-ttu-id="8bda9-144">Der Consumer kann den Zyklus des Abrufens oder Erstellens von Zeilen sowie des Zugreifens auf Daten in den Zeilen beliebig wiederholen.</span><span class="sxs-lookup"><span data-stu-id="8bda9-144">The consumer can then repeat its cycle of fetching or creating rows and accessing the data in them.</span></span>  
  
 <span data-ttu-id="8bda9-145">Wenn der Consumer mit dem Rowset fertig ist, ruft er die Methode **IAccessor::ReleaseAccessor** auf, um, falls nötig, Accessoren freizugeben.</span><span class="sxs-lookup"><span data-stu-id="8bda9-145">When the consumer is finished with the rowset, it calls the **IAccessor::ReleaseAccessor** method to release any accessor.</span></span> <span data-ttu-id="8bda9-146">Er ruft die Methode **IUnknown::Release** auf allen Schnittstellen auf, die vom Rowset verfügbar gemacht worden sind, um das Rowset wieder freizugeben.</span><span class="sxs-lookup"><span data-stu-id="8bda9-146">It calls the **IUnknown::Release** method on all interfaces exposed by the rowset to release the rowset.</span></span> <span data-ttu-id="8bda9-147">Sobald das Rowset freigegeben ist, wird die Freigabe aller verbleibender Zeilen oder vom Consumer verwendeten Accessoren erzwungen.</span><span class="sxs-lookup"><span data-stu-id="8bda9-147">When the rowset is released, it forces the release of any remaining rows or accessors the consumer may hold.</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="8bda9-148">In diesem Abschnitt</span><span class="sxs-lookup"><span data-stu-id="8bda9-148">In This Section</span></span>  
  
-   [<span data-ttu-id="8bda9-149">Nächste Abrufposition</span><span class="sxs-lookup"><span data-stu-id="8bda9-149">Next Fetch Position</span></span>](fetching-rows-next-fetch-position.md)  
  
## <a name="see-also"></a><span data-ttu-id="8bda9-150">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="8bda9-150">See Also</span></span>  
 [<span data-ttu-id="8bda9-151">Rowsets</span><span class="sxs-lookup"><span data-stu-id="8bda9-151">Rowsets</span></span>](rowsets.md)  
  
  

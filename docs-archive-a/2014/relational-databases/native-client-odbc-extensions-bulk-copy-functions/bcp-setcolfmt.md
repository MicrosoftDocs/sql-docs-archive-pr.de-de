---
title: bcp_setcolfmt | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
api_name:
- bcp_setcolfmt
api_location:
- sqlncli11.dll
topic_type:
- apiref
helpviewer_keywords:
- bcp_setcolfmt function
ms.assetid: afb47987-39e7-4079-ad66-e0abf4d4c72b
author: rothja
ms.author: jroth
ms.openlocfilehash: bb3b1da62ab4e98ed4497dd11fcc20163025058b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87619099"
---
# <a name="bcp_setcolfmt"></a><span data-ttu-id="63bad-102">bcp_setcolfmt</span><span class="sxs-lookup"><span data-stu-id="63bad-102">bcp_setcolfmt</span></span>
  <span data-ttu-id="63bad-103">Die **bcp_setcolfmt** -Funktion ersetzt die [bcp_colfmt](bcp-colfmt.md).</span><span class="sxs-lookup"><span data-stu-id="63bad-103">The **bcp_setcolfmt** function supersedes the [bcp_colfmt](bcp-colfmt.md).</span></span> <span data-ttu-id="63bad-104">Beim Angeben der Spalten Sortierung muss die **bcp_setcolfmt** -Funktion verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="63bad-104">In specifying the column collation, the **bcp_setcolfmt** function must be used.</span></span> <span data-ttu-id="63bad-105">[bcp_setbulkmode](bcp-setbulkmode.md) kann verwendet werden, um mehr als ein Spalten Format anzugeben.</span><span class="sxs-lookup"><span data-stu-id="63bad-105">[bcp_setbulkmode](bcp-setbulkmode.md) can be used to specify more than one column format.</span></span>  
  
 <span data-ttu-id="63bad-106">Diese Funktion bietet einen flexiblen Ansatz für das Angeben des Spaltenformats in einem Massenkopiervorgang.</span><span class="sxs-lookup"><span data-stu-id="63bad-106">This function provides a flexible approach to specifying the column format in a bulk copy operation.</span></span> <span data-ttu-id="63bad-107">Sie wird verwendet, um einzelne Spaltenformatattribute festzulegen.</span><span class="sxs-lookup"><span data-stu-id="63bad-107">It is used to set individual column format attributes.</span></span> <span data-ttu-id="63bad-108">Jeder **bcp_setcolfmt** -Aufrufsatz legt ein Spalten Format Attribut fest.</span><span class="sxs-lookup"><span data-stu-id="63bad-108">Each call to **bcp_setcolfmt** sets one column format attribute.</span></span>  
  
 <span data-ttu-id="63bad-109">Die **bcp_setcolfmt** -Funktion gibt das Quell-oder Zielformat der Daten in einer Benutzerdatei an.</span><span class="sxs-lookup"><span data-stu-id="63bad-109">The **bcp_setcolfmt** function specifies the source or target format of the data in a user file.</span></span> <span data-ttu-id="63bad-110">Bei Verwendung als Quellformat gibt **bcp_setcolfmt** das Format einer vorhandenen Datendatei an, die als Datenquelle für Daten in einem Massen Kopiervorgang in eine Tabelle in verwendet wird [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="63bad-110">When used as a source format, **bcp_setcolfmt** specifies the format of an existing data file used as a data source of data in a bulk copy to a table in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="63bad-111">Bei Verwendung als Zielformat wird die Datendatei mithilfe der mit **bcp_setcolfmt**angegebenen Spalten Formate erstellt.</span><span class="sxs-lookup"><span data-stu-id="63bad-111">When used as a target format, the data file is created using the column formats specified with **bcp_setcolfmt**.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="63bad-112">Syntax</span><span class="sxs-lookup"><span data-stu-id="63bad-112">Syntax</span></span>  
  
```  
  
RETCODE bcp_setcolfmt (  
HDBC   
hdbc  
,  
INT   
field  
,  
INT   
property  
,  
void*   
pValue  
,  
INT   
cbValue  
);  
  
```  
  
## <a name="arguments"></a><span data-ttu-id="63bad-113">Argumente</span><span class="sxs-lookup"><span data-stu-id="63bad-113">Arguments</span></span>  
 <span data-ttu-id="63bad-114">*hdbc*</span><span class="sxs-lookup"><span data-stu-id="63bad-114">*hdbc*</span></span>  
 <span data-ttu-id="63bad-115">Das für den Massenkopiervorgang aktivierte ODBC-Verbindungshandle.</span><span class="sxs-lookup"><span data-stu-id="63bad-115">Is the bulk copy-enabled ODBC connection handle.</span></span>  
  
 <span data-ttu-id="63bad-116">*Flächen*</span><span class="sxs-lookup"><span data-stu-id="63bad-116">*field*</span></span>  
 <span data-ttu-id="63bad-117">Die Spaltenordnungszahl, für die die Eigenschaft festgelegt wird</span><span class="sxs-lookup"><span data-stu-id="63bad-117">Is the ordinal column number for which the property is being set.</span></span>  
  
 <span data-ttu-id="63bad-118">*property*</span><span class="sxs-lookup"><span data-stu-id="63bad-118">*property*</span></span>  
 <span data-ttu-id="63bad-119">Eine der Eigenschaftskonstanten.</span><span class="sxs-lookup"><span data-stu-id="63bad-119">Is one of the property constants.</span></span> <span data-ttu-id="63bad-120">Eigenschaftskonstanten werden in dieser Tabelle definiert.</span><span class="sxs-lookup"><span data-stu-id="63bad-120">Property constants are defined in this table.</span></span>  
  
|<span data-ttu-id="63bad-121">Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="63bad-121">Property</span></span>|<span data-ttu-id="63bad-122">Wert</span><span class="sxs-lookup"><span data-stu-id="63bad-122">Value</span></span>|<span data-ttu-id="63bad-123">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="63bad-123">Description</span></span>|  
|--------------|-----------|-----------------|  
|<span data-ttu-id="63bad-124">BCP_FMT_TYPE</span><span class="sxs-lookup"><span data-stu-id="63bad-124">BCP_FMT_TYPE</span></span>|<span data-ttu-id="63bad-125">BYTE</span><span class="sxs-lookup"><span data-stu-id="63bad-125">BYTE</span></span>|<span data-ttu-id="63bad-126">Der Datentyp dieser Spalte in der Benutzerdatei.</span><span class="sxs-lookup"><span data-stu-id="63bad-126">Is the data type of this column in the user file.</span></span> <span data-ttu-id="63bad-127">Wenn die Daten nicht mit dem Datentyp der entsprechenden Spalte in der Datenbanktabelle übereinstimmen, werden die Daten, wenn möglich, durch das Massenkopieren konvertiert.</span><span class="sxs-lookup"><span data-stu-id="63bad-127">If different from the data type of the corresponding column in the database table, bulk copy converts the data if possible.</span></span><br /><br /> <span data-ttu-id="63bad-128">Der BCP_FMT_TYPE-Parameter wird von den SQL Server-Datentyptoken in sqlncli.h anstelle der ODBC C-Datentypenumeratoren aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="63bad-128">The BCP_FMT_TYPE parameter is enumerated by the SQL Server data type tokens in sqlncli.h, rather than the ODBC C data type enumerators.</span></span> <span data-ttu-id="63bad-129">Sie können beispielsweise eine Zeichenfolge, ODBC-Typ SQL_C_CHAR, mithilfe des [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-spezifischen SQLCHARACTER-Typs angeben.</span><span class="sxs-lookup"><span data-stu-id="63bad-129">For example, you can specify a character string, ODBC type SQL_C_CHAR, using the SQLCHARACTER type specific to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span><br /><br /> <span data-ttu-id="63bad-130">Um die Standarddatendarstellung für den [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-Datentyp anzugeben, legen Sie diesen Parameter auf 0 fest.</span><span class="sxs-lookup"><span data-stu-id="63bad-130">To specify the default data representation for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type, set this parameter to 0.</span></span><br /><br /> <span data-ttu-id="63bad-131">Für einen Massenkopiervorgang aus SQL Server in eine Datei, wenn BCP_FMT_TYPE auf SQLDECIMAL oder SQLNUMERIC festgelegt ist:</span><span class="sxs-lookup"><span data-stu-id="63bad-131">For a bulk copy out of SQL Server into a file, when BCP_FMT_TYPE is SQLDECIMAL or SQLNUMERIC:</span></span><br /><br /> <span data-ttu-id="63bad-132">Wenn die Quell Spalte nicht **Dezimal** oder **numerisch**ist, werden die Standardgenauigkeit und die Standardskala verwendet.</span><span class="sxs-lookup"><span data-stu-id="63bad-132">-   If the source column is not **decimal** or **numeric**, the default precision and scale are used.</span></span><br /><span data-ttu-id="63bad-133">Wenn die Quell Spalte **Dezimal** oder **numerisch**ist, werden die Genauigkeit und die Dezimalstellen der Quell Spalte verwendet.</span><span class="sxs-lookup"><span data-stu-id="63bad-133">-   If the source column is **decimal** or **numeric**, the precision and scale of the source column are used.</span></span>|  
|<span data-ttu-id="63bad-134">BCP_FMT_INDICATOR_LEN</span><span class="sxs-lookup"><span data-stu-id="63bad-134">BCP_FMT_INDICATOR_LEN</span></span>|<span data-ttu-id="63bad-135">INT</span><span class="sxs-lookup"><span data-stu-id="63bad-135">INT</span></span>|<span data-ttu-id="63bad-136">Die Länge des Indikators (Präfix) in Bytes</span><span class="sxs-lookup"><span data-stu-id="63bad-136">Is the length in bytes of the indicator (prefix).</span></span><br /><br /> <span data-ttu-id="63bad-137">Die Länge eines Längen-/NULL-Indikators innerhalb der Spaltendaten in Bytes.</span><span class="sxs-lookup"><span data-stu-id="63bad-137">It is the length, in bytes, of a length/null indicator within the column data.</span></span> <span data-ttu-id="63bad-138">Gültige Indikatorlängenwerte sind 0 (wenn kein Indikator verwendet wird), 1, 2 oder 4.</span><span class="sxs-lookup"><span data-stu-id="63bad-138">Valid indicator length values are 0 (when using no indicator), 1, 2, or 4.</span></span><br /><br /> <span data-ttu-id="63bad-139">Legen Sie diesen Parameter auf SQL_VARLEN_DATA fest, um die Verwendung eines standardmäßigen Massenkopierindikators anzugeben.</span><span class="sxs-lookup"><span data-stu-id="63bad-139">To specify default bulk copy indicator usage, set this parameter to SQL_VARLEN_DATA.</span></span><br /><br /> <span data-ttu-id="63bad-140">Indikatoren werden im Speicher direkt vor allen anderen Daten angezeigt. In der Datendatei werden sie direkt vor den Daten, auf die sie sich beziehen, angezeigt.</span><span class="sxs-lookup"><span data-stu-id="63bad-140">Indicators appear in memory directly before any data, and in the data file directly before the data to which they apply.</span></span><br /><br /> <span data-ttu-id="63bad-141">Wird mehr als eine Methode zur Angabe der Länge der Datendateispalte verwendet (z. B. ein Indikator und eine maximale Spaltenlänge oder ein Indikator und eine Abschlusszeichensequenz), wird beim Massenkopieren die Methode ausgewählt, die zu der kleineren zu kopierenden Datenmenge führt.</span><span class="sxs-lookup"><span data-stu-id="63bad-141">If more than one means of specifying a data file column length is used (such as an indicator and a maximum column length, or an indicator and a terminator sequence), bulk copy chooses the one that results in the least amount of data being copied.</span></span><br /><br /> <span data-ttu-id="63bad-142">Datendateien, die durch Massenkopieren generiert wurden, wobei das Datenformat nicht durch Benutzereingriff angepasst wird, enthalten Indikatoren, wenn die Spaltendaten eine unterschiedliche Länge haben oder die Spalte NULL als Wert akzeptieren kann.</span><span class="sxs-lookup"><span data-stu-id="63bad-142">Data files generated by bulk copy when no user intervention adjusts the format of the data contain indicators when the column data can vary in length or the column can accept NULL as a value.</span></span>|  
|<span data-ttu-id="63bad-143">BCP_FMT_DATA_LEN</span><span class="sxs-lookup"><span data-stu-id="63bad-143">BCP_FMT_DATA_LEN</span></span>|<span data-ttu-id="63bad-144">DBINT</span><span class="sxs-lookup"><span data-stu-id="63bad-144">DBINT</span></span>|<span data-ttu-id="63bad-145">Die Länge der Daten (Spaltenlänge) in Bytes</span><span class="sxs-lookup"><span data-stu-id="63bad-145">Is the length in bytes of the data (column length)</span></span><br /><br /> <span data-ttu-id="63bad-146">Dies ist die maximale Länge (in Bytes) der Daten dieser Spalte in der Benutzerdatei, ohne die Länge eines Längenindikators oder Abschlusszeichens.</span><span class="sxs-lookup"><span data-stu-id="63bad-146">It is the maximum length, in bytes, of this column's data in the user file, not including the length of any length indicator or terminator.</span></span><br /><br /> <span data-ttu-id="63bad-147">Durch Festlegen von BCP_FMT_DATA_LEN auf SQL_NULL_DATA wird angegeben, dass alle Werte in der Datendateispalte auf NULL festgelegt sind oder sein sollten.</span><span class="sxs-lookup"><span data-stu-id="63bad-147">Setting BCP_FMT_DATA_LEN to SQL_NULL_DATA indicates that all values in the data file column are, or should be set to, NULL.</span></span><br /><br /> <span data-ttu-id="63bad-148">Wird BCP_FMT_DATA_LEN auf SQL_VARLEN_DATA festgelegt, bedeutet dies, dass das System die Länge der Daten für jede Spalte bestimmen soll.</span><span class="sxs-lookup"><span data-stu-id="63bad-148">Setting BCP_FMT_DATA_LEN to SQL_VARLEN_DATA indicates that the system should determine the length of data in each column.</span></span> <span data-ttu-id="63bad-149">Für einige Spalten könnte dies bedeuten, dass ein Längen-/NULL-Indikator generiert wird, der den Daten in einer Kopie von [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] vorangestellt wird, oder dass der Indikator in Daten, die in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] kopiert werden, erwartet wird.</span><span class="sxs-lookup"><span data-stu-id="63bad-149">For some columns, this could mean that a length/null indicator is generated to precede data on a copy from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], or that the indicator is expected in data copied to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span><br /><br /> <span data-ttu-id="63bad-150">BCP_FMT_DATA_LEN kann für [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-Zeichen und Binärdatentypen BCP_LENGTH_VARIABLE, BCP_LENGTH_NULL, 0 oder ein positiver Wert sein.</span><span class="sxs-lookup"><span data-stu-id="63bad-150">For [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] character and binary data types, BCP_FMT_DATA_LEN can be SQL_VARLEN_DATA, SQL_NULL_DATA, 0, or some positive value.</span></span> <span data-ttu-id="63bad-151">Wenn BCP_FMT_DATA_LEN auf SQL_VARLEN_DATA festgelegt ist, verwendet das System entweder den Längenindikator, sofern vorhanden, oder eine Abschlusszeichensequenz, um die Länge der Daten zu bestimmen.</span><span class="sxs-lookup"><span data-stu-id="63bad-151">If BCP_FMT_DATA_LEN is SQL_VARLEN_DATA, the system uses either the length indicator, if present, or a terminator sequence to determine the length of the data.</span></span> <span data-ttu-id="63bad-152">Wenn sowohl ein Längenindikator als auch eine Abschlusszeichensequenz angegeben sind, wird beim Massenkopieren der Wert verwendet, der zu der kleineren zu kopierenden Datenmenge führt.</span><span class="sxs-lookup"><span data-stu-id="63bad-152">If both a length indicator and a terminator sequence are supplied, bulk copy uses the one that results in the least amount of data being copied.</span></span> <span data-ttu-id="63bad-153">Ist BCP_FMT_DATA_LEN auf SQL_VARLEN_DATA festgelegt, ist der Datentyp ein [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-Zeichen oder -Binärtyp. Ist weder ein Längenindikator noch eine Abschlusszeichensequenz angegeben, gibt das System eine Fehlermeldung zurück.</span><span class="sxs-lookup"><span data-stu-id="63bad-153">If BCP_FMT_DATA_LEN is SQL_VARLEN_DATA, the data type is an [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] character or binary type, and neither a length indicator nor a terminator sequence is specified, the system returns an error message.</span></span><br /><br /> <span data-ttu-id="63bad-154">Wenn BCP_FMT_DATA_LEN 0 oder ein positiver Wert ist, verwendet das System BCP_FMT_DATA_LEN als maximale Datenlänge.</span><span class="sxs-lookup"><span data-stu-id="63bad-154">If BCP_FMT_DATA_LEN is 0 or a positive value, the system uses BCP_FMT_DATA_LEN as the maximum data length.</span></span> <span data-ttu-id="63bad-155">Wenn jedoch zusätzlich zu einem positiven BCP_FMT_DATA_LEN-Wert ein Längenindikator oder eine Abschlusszeichensequenz angegeben ist, bestimmt das System die Datenlänge mithilfe der Methode, die zu der kleineren zu kopierenden Datenmenge führt.</span><span class="sxs-lookup"><span data-stu-id="63bad-155">However, if, in addition to a positive BCP_FMT_DATA_LEN, a length indicator or terminator sequence is provided, the system determines the data length by using the method that results in the least amount of data being copied.</span></span><br /><br /> <span data-ttu-id="63bad-156">Der BCP_FMT_DATA_LEN-Wert stellt die Anzahl der Datenbytes dar.</span><span class="sxs-lookup"><span data-stu-id="63bad-156">The BCP_FMT_DATA_LEN value represents the count of bytes of data.</span></span> <span data-ttu-id="63bad-157">Werden Zeichendaten durch Unicode-Zeichen dargestellt, repräsentiert ein positiver BCP_FMT_DATA_LEN-Parameterwert die Anzahl der Zeichen multipliziert mit der Größe (in Bytes) der einzelnen Zeichen.</span><span class="sxs-lookup"><span data-stu-id="63bad-157">If character data is represented by Unicode wide characters, then a positive BCP_FMT_DATA_LEN parameter value represents the number of characters multiplied by the size, in bytes, of each character.</span></span>|  
|<span data-ttu-id="63bad-158">BCP_FMT_TERMINATOR</span><span class="sxs-lookup"><span data-stu-id="63bad-158">BCP_FMT_TERMINATOR</span></span>|<span data-ttu-id="63bad-159">LPCBYTE</span><span class="sxs-lookup"><span data-stu-id="63bad-159">LPCBYTE</span></span>|<span data-ttu-id="63bad-160">Zeiger auf die Abschlusszeichensequenz (entweder ANSI oder Unicode), die für diese Spalte verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="63bad-160">Pointer to the terminator sequence (either ANSI or Unicode as appropriate) to be used for this column.</span></span> <span data-ttu-id="63bad-161">Dieser Parameter ist in erster Linie für Zeichendatentypen nützlich, da alle anderen Typen eine feste Länge besitzen oder, im Falle von Binärdaten, einen Indikator für die Länge erfordern, um die Anzahl der vorhandenen Bytes präzise zu erfassen.</span><span class="sxs-lookup"><span data-stu-id="63bad-161">This parameter is useful mainly for character data types because all other types are of fixed length or, in the case of binary data, require an indicator of length to accurately record the number of bytes present.</span></span><br /><br /> <span data-ttu-id="63bad-162">Legen Sie diesen Parameter auf NULL fest, um zu vermeiden, dass extrahierte Daten terminiert werden, oder um anzugeben, dass Daten in einer Benutzerdatei nicht terminiert werden.</span><span class="sxs-lookup"><span data-stu-id="63bad-162">To avoid terminating extracted data, or to indicate that data in a user file is not terminated, set this parameter to NULL.</span></span><br /><br /> <span data-ttu-id="63bad-163">Wird mehr als eine Methode zur Angabe der Länge der Benutzerdateispalte verwendet (z. B. ein Abschlusszeichen und ein Längenindikator oder ein Abschlusszeichen und eine maximale Spaltenlänge), wird beim Massenkopieren die Methode ausgewählt, die zu der kleineren zu kopierenden Datenmenge führt.</span><span class="sxs-lookup"><span data-stu-id="63bad-163">If more than one means of specifying a user-file column length is used (such as a terminator and a length indicator, or a terminator and a maximum column length), bulk copy chooses the one that results in the least amount of data being copied.</span></span><br /><br /> <span data-ttu-id="63bad-164">Die API für das Massenkopieren führt nach Bedarf eine Zeichenkonvertierung von Unicode in MBCS aus.</span><span class="sxs-lookup"><span data-stu-id="63bad-164">The bulk copy API performs Unicode-to-MBCS character conversion as required.</span></span> <span data-ttu-id="63bad-165">Stellen Sie unbedingt sicher, dass sowohl die Bytezeichenfolge des Abschlusszeichens und die Länge der Bytezeichenfolge richtig festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="63bad-165">Care must be taken to ensure that both the terminator byte string and the length of the byte string are set correctly.</span></span>|  
|<span data-ttu-id="63bad-166">BCP_FMT_SERVER_COL</span><span class="sxs-lookup"><span data-stu-id="63bad-166">BCP_FMT_SERVER_COL</span></span>|<span data-ttu-id="63bad-167">INT</span><span class="sxs-lookup"><span data-stu-id="63bad-167">INT</span></span>|<span data-ttu-id="63bad-168">Die Position einer Spalte innerhalb der Datenbank</span><span class="sxs-lookup"><span data-stu-id="63bad-168">Ordinal position of the column in the database</span></span>|  
|<span data-ttu-id="63bad-169">BCP_FMT_COLLATION</span><span class="sxs-lookup"><span data-stu-id="63bad-169">BCP_FMT_COLLATION</span></span>|<span data-ttu-id="63bad-170">LPCSTR</span><span class="sxs-lookup"><span data-stu-id="63bad-170">LPCSTR</span></span>|<span data-ttu-id="63bad-171">Sortierungsname.</span><span class="sxs-lookup"><span data-stu-id="63bad-171">Collation name.</span></span>|  
  
 <span data-ttu-id="63bad-172">*pValue*</span><span class="sxs-lookup"><span data-stu-id="63bad-172">*pValue*</span></span>  
 <span data-ttu-id="63bad-173">Der Zeiger auf den Wert, der der *Eigenschaft*zugeordnet werden soll.</span><span class="sxs-lookup"><span data-stu-id="63bad-173">Is the pointer to the value to associate to the *property*.</span></span> <span data-ttu-id="63bad-174">Er ermöglicht es, jede Spaltenformateigenschaft einzeln festzulegen.</span><span class="sxs-lookup"><span data-stu-id="63bad-174">It allows each column format property to be set individually.</span></span>  
  
 <span data-ttu-id="63bad-175">*cbValue*</span><span class="sxs-lookup"><span data-stu-id="63bad-175">*cbvalue*</span></span>  
 <span data-ttu-id="63bad-176">Die Länge des Puffers der Eigenschaft in Bytes.</span><span class="sxs-lookup"><span data-stu-id="63bad-176">Is the length of the property buffer in bytes.</span></span>  
  
## <a name="returns"></a><span data-ttu-id="63bad-177">Gibt zurück</span><span class="sxs-lookup"><span data-stu-id="63bad-177">Returns</span></span>  
 <span data-ttu-id="63bad-178">SUCCEED oder FAIL.</span><span class="sxs-lookup"><span data-stu-id="63bad-178">SUCCEED or FAIL.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="63bad-179">Bemerkungen</span><span class="sxs-lookup"><span data-stu-id="63bad-179">Remarks</span></span>  
 <span data-ttu-id="63bad-180">Diese Funktion löst die **bcp_colfmt** -Funktion aus.</span><span class="sxs-lookup"><span data-stu-id="63bad-180">This function supersedes the **bcp_colfmt** function.</span></span> <span data-ttu-id="63bad-181">Die gesamte Funktionalität von **bcp_colfmt** wird in **bcp_setcolfmt** Funktion bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="63bad-181">All the functionality of **bcp_colfmt** is provided in **bcp_setcolfmt** function.</span></span> <span data-ttu-id="63bad-182">Zusätzlich wird auch Unterstützung für Spaltensortierung bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="63bad-182">In addition, support for column collation is also provided.</span></span> <span data-ttu-id="63bad-183">Es wird empfohlen, die folgenden Spaltenformatattribute in der unten gegebenen Reihenfolge festzulegen:</span><span class="sxs-lookup"><span data-stu-id="63bad-183">It is recommended that the following column format attributes be set in the order given below:</span></span>  
  
 <span data-ttu-id="63bad-184">BCP_FMT_SERVER_COL</span><span class="sxs-lookup"><span data-stu-id="63bad-184">BCP_FMT_SERVER_COL</span></span>  
  
 <span data-ttu-id="63bad-185">BCP_FMT_DATA_LEN</span><span class="sxs-lookup"><span data-stu-id="63bad-185">BCP_FMT_DATA_LEN</span></span>  
  
 <span data-ttu-id="63bad-186">BCP_FMT_TYPE</span><span class="sxs-lookup"><span data-stu-id="63bad-186">BCP_FMT_TYPE</span></span>  
  
 <span data-ttu-id="63bad-187">Mit der **bcp_setcolfmt** -Funktion können Sie das Benutzerdatei Format für Massen Kopien angeben.</span><span class="sxs-lookup"><span data-stu-id="63bad-187">The **bcp_setcolfmt** function allows you to specify the user-file format for bulk copies.</span></span> <span data-ttu-id="63bad-188">Für Massenkopieren besteht ein Format aus folgenden Bestandteilen:</span><span class="sxs-lookup"><span data-stu-id="63bad-188">For bulk copy, a format contains the following parts:</span></span>  
  
-   <span data-ttu-id="63bad-189">Eine Zuordnung von Benutzerdateispalten zu Datenbankspalten</span><span class="sxs-lookup"><span data-stu-id="63bad-189">A mapping from user-file columns to database columns.</span></span>  
  
-   <span data-ttu-id="63bad-190">Der Datentyp der einzelnen Benutzerdateispalten</span><span class="sxs-lookup"><span data-stu-id="63bad-190">The data type of each user-file column.</span></span>  
  
-   <span data-ttu-id="63bad-191">Die Länge des optionalen Indikators für jede Spalte</span><span class="sxs-lookup"><span data-stu-id="63bad-191">The length of the optional indicator for each column.</span></span>  
  
-   <span data-ttu-id="63bad-192">Die maximale Länge der Daten pro Benutzerdateispalte</span><span class="sxs-lookup"><span data-stu-id="63bad-192">The maximum length of data per user-file column.</span></span>  
  
-   <span data-ttu-id="63bad-193">Die optionale abschließende Bytesequenz für jede Spalte</span><span class="sxs-lookup"><span data-stu-id="63bad-193">The optional terminating byte sequence for each column.</span></span>  
  
-   <span data-ttu-id="63bad-194">Die Länge der optionalen abschließenden Bytesequenz</span><span class="sxs-lookup"><span data-stu-id="63bad-194">The length of the optional terminating byte sequence.</span></span>  
  
 <span data-ttu-id="63bad-195">Jeder **bcp_setcolfmt** Aufrufe gibt das Format für eine Benutzerdatei Spalte an.</span><span class="sxs-lookup"><span data-stu-id="63bad-195">Each call to **bcp_setcolfmt** specifies the format for one user-file column.</span></span> <span data-ttu-id="63bad-196">Wenn Sie z. b. die Standardeinstellungen für drei Spalten in einer Benutzer Datendatei mit fünf Spalten ändern möchten, rufen Sie zuerst [bcp_columns](bcp-columns.md)**(5)** auf, und rufen Sie dann **bcp_setcolfmt** fünfmal auf, wobei drei dieser Aufrufe Ihr benutzerdefiniertes Format festlegen.</span><span class="sxs-lookup"><span data-stu-id="63bad-196">For example, to change the default settings for three columns in a five-column user data file, first call [bcp_columns](bcp-columns.md)**(5)**, and then call **bcp_setcolfmt** five times, with three of those calls setting your custom format.</span></span> <span data-ttu-id="63bad-197">Legen Sie für die verbleibenden zwei Aufrufe BCP_FMT_TYPE auf 0 fest, und legen Sie BCP_FMT_INDICATOR_LENGTH, BCP_FMT_DATA_LEN und *cbValue* auf 0, SQL_VARLEN_DATA bzw. 0 fest.</span><span class="sxs-lookup"><span data-stu-id="63bad-197">For the remaining two calls, set BCP_FMT_TYPE to 0, and set BCP_FMT_INDICATOR_LENGTH, BCP_FMT_DATA_LEN, and *cbValue* to 0, SQL_VARLEN_DATA, and 0 respectively.</span></span> <span data-ttu-id="63bad-198">Mit diesem Verfahren werden alle fünf Spalten kopiert, drei mit dem benutzerdefinierten Format und zwei mit dem Standardformat.</span><span class="sxs-lookup"><span data-stu-id="63bad-198">This procedure copies all five columns, three with your customized format and two with the default format.</span></span>  
  
 <span data-ttu-id="63bad-199">Die **bcp_columns** -Funktion muss aufgerufen werden, bevor **bcp_setcolfmt**aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="63bad-199">The **bcp_columns** function must be called before calling **bcp_setcolfmt**.</span></span>  
  
 <span data-ttu-id="63bad-200">Sie müssen **bcp_setcolfmt** einmal für jede Eigenschaft jeder Spalte in der Benutzerdatei abrufen.</span><span class="sxs-lookup"><span data-stu-id="63bad-200">You must call **bcp_setcolfmt** once for each property of each column in the user file.</span></span>  
  
 <span data-ttu-id="63bad-201">Sie müssen nicht alle Daten in einer Benutzerdatei in eine SQL Server-Tabelle kopieren.</span><span class="sxs-lookup"><span data-stu-id="63bad-201">You do not need to copy all data in a user file to the SQL Server table.</span></span> <span data-ttu-id="63bad-202">Um eine Spalte zu überspringen, geben Sie das Format der Daten für die Spalte an, indem Sie den BCP_FMT_SERVER_COL-Parameter auf 0 festlegen.</span><span class="sxs-lookup"><span data-stu-id="63bad-202">To skip a column, specify the format of the data for the column, setting the BCP_FMT_SERVER_COL parameter to 0.</span></span> <span data-ttu-id="63bad-203">Wenn Sie eine Spalte überspringen möchten, müssen Sie ihren Typ angeben.</span><span class="sxs-lookup"><span data-stu-id="63bad-203">If you want to skip a column, you must specify its type.</span></span>  
  
 <span data-ttu-id="63bad-204">Die [bcp_writefmt](bcp-writefmt.md) -Funktion kann verwendet werden, um die Format Spezifikation beizubehalten.</span><span class="sxs-lookup"><span data-stu-id="63bad-204">The [bcp_writefmt](bcp-writefmt.md) function can be used to persist the format specification.</span></span>  
  
## <a name="bcp_setcolfmt-support-for-enhanced-date-and-time-features"></a><span data-ttu-id="63bad-205">bcp_setcolfmt-Unterstützung für erweiterte Funktionen für Datum und Uhrzeit</span><span class="sxs-lookup"><span data-stu-id="63bad-205">bcp_setcolfmt Support for Enhanced Date and Time Features</span></span>  
 <span data-ttu-id="63bad-206">Die Typen, die mit der BCP_FMT_TYPE-Eigenschaft für Datums-/Uhrzeittypen verwendet werden, sind wie in [Massen Kopier Änderungen für verbesserte Datums-und Uhrzeit Typen &#40;OLE DB und ODBC-&#41;](../native-client-odbc-date-time/bulk-copy-changes-for-enhanced-date-and-time-types-ole-db-and-odbc.md)angegeben.</span><span class="sxs-lookup"><span data-stu-id="63bad-206">The types used with the BCP_FMT_TYPE property for date/time types are as specified in [Bulk Copy Changes for Enhanced Date and Time Types &#40;OLE DB and ODBC&#41;](../native-client-odbc-date-time/bulk-copy-changes-for-enhanced-date-and-time-types-ole-db-and-odbc.md).</span></span>  
  
 <span data-ttu-id="63bad-207">Weitere Informationen finden Sie unter [Verbesserungen bei Datum und Uhrzeit &#40;ODBC-&#41;](../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="63bad-207">For more information, see [Date and Time Improvements &#40;ODBC&#41;](../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="63bad-208">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="63bad-208">See Also</span></span>  
 [<span data-ttu-id="63bad-209">Bulk Copy Functions</span><span class="sxs-lookup"><span data-stu-id="63bad-209">Bulk Copy Functions</span></span>](sql-server-driver-extensions-bulk-copy-functions.md)  
  
  

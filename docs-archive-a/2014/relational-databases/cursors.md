---
title: Cursors | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- results [SQL Server], cursors
- Transact-SQL cursors, about cursors
- cursors [SQL Server]
- data access [SQL Server], cursors
- result sets [SQL Server], cursors
- requesting cursors
- cursors [SQL Server], about cursors
ms.assetid: e668b40c-bd4d-4415-850d-20fc4872ee72
author: rothja
ms.author: jroth
ms.openlocfilehash: 055482a8cf64527f58ed983b449121a99960f566
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87622683"
---
# <a name="cursors"></a><span data-ttu-id="9eab2-102">Cursor</span><span class="sxs-lookup"><span data-stu-id="9eab2-102">Cursors</span></span>
  <span data-ttu-id="9eab2-103">Vorgänge in einer relationalen Datenbank beziehen sich immer auf eine vollständige Gruppe von Zeilen.</span><span class="sxs-lookup"><span data-stu-id="9eab2-103">Operations in a relational database act on a complete set of rows.</span></span> <span data-ttu-id="9eab2-104">Beispielsweise besteht der Zeilensatz, der von einer SELECT-Anweisung zurückgegeben wird, aus allen Zeilen, die die Bedingungen der WHERE-Klausel der Anweisung erfüllen.</span><span class="sxs-lookup"><span data-stu-id="9eab2-104">For example, the set of rows returned by a SELECT statement consists of all the rows that satisfy the conditions in the WHERE clause of the statement.</span></span> <span data-ttu-id="9eab2-105">Diese vollständige Gruppe von Zeilen, die von der Anweisung zurückgegeben wird, wird als Resultset bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="9eab2-105">This complete set of rows returned by the statement is known as the result set.</span></span> <span data-ttu-id="9eab2-106">Anwendungen, vor allem interaktive Onlineanwendungen, sind nicht immer effektiv, wenn das gesamte Resultset als eine Einheit bearbeitet wird.</span><span class="sxs-lookup"><span data-stu-id="9eab2-106">Applications, especially interactive online applications, cannot always work effectively with the entire result set as a unit.</span></span> <span data-ttu-id="9eab2-107">Diese Anwendungen benötigen einen Mechanismus, um jeweils eine Zeile oder einen kleinen Zeilenblock zu bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="9eab2-107">These applications need a mechanism to work with one row or a small block of rows at a time.</span></span> <span data-ttu-id="9eab2-108">Cursor sind eine Erweiterung zu Resultsets und stellen diesen Mechanismus bereit.</span><span class="sxs-lookup"><span data-stu-id="9eab2-108">Cursors are an extension to result sets that provide that mechanism.</span></span>  
  
 <span data-ttu-id="9eab2-109">Cursor erweitern die Verarbeitung von Ergebnissen folgendermaßen:</span><span class="sxs-lookup"><span data-stu-id="9eab2-109">Cursors extend result processing by:</span></span>  
  
-   <span data-ttu-id="9eab2-110">Ermöglichen der Positionierung an bestimmten Zeilen des Resultsets.</span><span class="sxs-lookup"><span data-stu-id="9eab2-110">Allowing positioning at specific rows of the result set.</span></span>  
  
-   <span data-ttu-id="9eab2-111">Abrufen einer Zeile oder eines ZeilenBlocks von der aktuellen Position im Resultset.</span><span class="sxs-lookup"><span data-stu-id="9eab2-111">Retrieving one row or block of rows from the current position in the result set.</span></span>  
  
-   <span data-ttu-id="9eab2-112">Unterstützen von Datenänderungen in den Zeilen an der aktuellen Position im Resultset.</span><span class="sxs-lookup"><span data-stu-id="9eab2-112">Supporting data modifications to the rows at the current position in the result set.</span></span>  
  
-   <span data-ttu-id="9eab2-113">Unterstützen von unterschiedlichen Sichtbarkeitsebenen bei Änderungen, die von anderen Benutzern an den Datenbankdaten, die im Resultset dargestellt werden, ausgeführt wurden.</span><span class="sxs-lookup"><span data-stu-id="9eab2-113">Supporting different levels of visibility to changes made by other users to the database data that is presented in the result set.</span></span>  
  
-   <span data-ttu-id="9eab2-114">Bereitstellen des Zugriffs auf Daten in einem Resultset für [!INCLUDE[tsql](../includes/tsql-md.md)] -Anweisungen in Skripts, gespeicherte Prozeduren und Trigger.</span><span class="sxs-lookup"><span data-stu-id="9eab2-114">Providing [!INCLUDE[tsql](../includes/tsql-md.md)] statements in scripts, stored procedures, and triggers access to the data in a result set.</span></span>  
  
## <a name="concepts"></a><span data-ttu-id="9eab2-115">Konzepte</span><span class="sxs-lookup"><span data-stu-id="9eab2-115">Concepts</span></span>  
 <span data-ttu-id="9eab2-116">Cursorimplementierungen</span><span class="sxs-lookup"><span data-stu-id="9eab2-116">Cursor Implementations</span></span>  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="9eab2-117">unterstützt drei Cursorimplementierungen.</span><span class="sxs-lookup"><span data-stu-id="9eab2-117">supports three cursor implementations.</span></span>  
  
 <span data-ttu-id="9eab2-118">Transact-SQL-Cursor</span><span class="sxs-lookup"><span data-stu-id="9eab2-118">Transact-SQL cursors</span></span>  
 <span data-ttu-id="9eab2-119">Basieren auf der DECLARE CURSOR-Syntax und werden hauptsächlich in [!INCLUDE[tsql](../includes/tsql-md.md)] -Skripts, gespeicherten Prozeduren und Triggern verwendet.</span><span class="sxs-lookup"><span data-stu-id="9eab2-119">Are based on the DECLARE CURSOR syntax and are used mainly in [!INCLUDE[tsql](../includes/tsql-md.md)] scripts, stored procedures, and triggers.</span></span> [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="9eab2-120">-Cursor werden auf dem Server implementiert und mithilfe von [!INCLUDE[tsql](../includes/tsql-md.md)] -Anweisungen verwaltet, die vom Client an den Server gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="9eab2-120">cursors are implemented on the server and are managed by [!INCLUDE[tsql](../includes/tsql-md.md)] statements sent from the client to the server.</span></span> <span data-ttu-id="9eab2-121">Sie können auch in Batches, gespeicherten Prozeduren oder Triggern enthalten sein.</span><span class="sxs-lookup"><span data-stu-id="9eab2-121">They may also be contained in batches, stored procedures, or triggers.</span></span>  
  
 <span data-ttu-id="9eab2-122">API-Servercursor (Application Programming Interface, Schnittstelle für Anwendungsprogrammierung)</span><span class="sxs-lookup"><span data-stu-id="9eab2-122">Application programming interface (API) server cursors</span></span>  
 <span data-ttu-id="9eab2-123">Diese unterstützen die API-Cursorfunktionen in OLE DB und ODBC.</span><span class="sxs-lookup"><span data-stu-id="9eab2-123">Support the API cursor functions in OLE DB and ODBC.</span></span> <span data-ttu-id="9eab2-124">API-Servercursor werden auf dem Server implementiert.</span><span class="sxs-lookup"><span data-stu-id="9eab2-124">API server cursors are implemented on the server.</span></span> <span data-ttu-id="9eab2-125">Wenn eine Clientanwendung eine API-Cursorfunktion aufruft, überträgt der [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter oder der ODBC-Treiber die Anforderung an den Server, damit Maßnahmen für den API-Servercursor ergriffen werden.</span><span class="sxs-lookup"><span data-stu-id="9eab2-125">Each time a client application calls an API cursor function, the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client OLE DB provider or ODBC driver transmits the request to the server for action against the API server cursor.</span></span>  
  
 <span data-ttu-id="9eab2-126">Clientcursor</span><span class="sxs-lookup"><span data-stu-id="9eab2-126">Client cursors</span></span>  
 <span data-ttu-id="9eab2-127">Sie werden intern vom [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client-ODBC-Treiber und der DLL implementiert, die die ADO-API implementiert.</span><span class="sxs-lookup"><span data-stu-id="9eab2-127">Are implemented internally by the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client ODBC driver and by the DLL that implements the ADO API.</span></span> <span data-ttu-id="9eab2-128">Clientcursor werden durch Zwischenspeichern aller Resultsetzeilen auf dem Client implementiert.</span><span class="sxs-lookup"><span data-stu-id="9eab2-128">Client cursors are implemented by caching all the result set rows on the client.</span></span> <span data-ttu-id="9eab2-129">Wenn eine Clientanwendung eine API-Cursorfunktion aufruft, führen der [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native ODBC-Treiber oder die ADO-DLL die Cursoroperation auf den im Client zwischengespeicherten Resultsetzeilen aus.</span><span class="sxs-lookup"><span data-stu-id="9eab2-129">Each time a client application calls an API cursor function, the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client ODBC driver or the ADO DLL performs the cursor operation on the result set rows cached on the client.</span></span>  
  
 <span data-ttu-id="9eab2-130">Cursortypen</span><span class="sxs-lookup"><span data-stu-id="9eab2-130">Type of Cursors</span></span>  
 <span data-ttu-id="9eab2-131">Vorwärtscursor</span><span class="sxs-lookup"><span data-stu-id="9eab2-131">Forward-only</span></span>  
 <span data-ttu-id="9eab2-132">Ein Vorwärtscursor unterstützt keine Bildläufe, sondern ausschließlich das serielle Abrufen von Zeilen vom Anfang bis zum Ende des Cursors.</span><span class="sxs-lookup"><span data-stu-id="9eab2-132">A forward-only cursor does not support scrolling; it supports only fetching the rows serially from the start to the end of the cursor.</span></span> <span data-ttu-id="9eab2-133">Die Zeilen werden erst dann aus der Datenbank abgerufen, wenn der Abrufvorgang ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="9eab2-133">The rows are not retrieved from the database until they are fetched.</span></span> <span data-ttu-id="9eab2-134">Die Auswirkungen aller INSERT-, UPDATE- und DELETE-Anweisungen, die der aktuelle Benutzer ausführt oder für die von anderen Benutzern ein Commit ausgeführt wurde und die sich auf Zeilen im Resultset auswirken, werden dann sichtbar, wenn die Zeilen aus dem Cursor abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="9eab2-134">The effects of all INSERT, UPDATE, and DELETE statements made by the current user or committed by other users that affect rows in the result set are visible as the rows are fetched from the cursor.</span></span>  
  
 <span data-ttu-id="9eab2-135">Da mit dem Cursor kein Bildlauf rückwärts durchgeführt werden kann, sind die meisten Änderungen, die an Zeilen in der Datenbank vorgenommen wurden, nachdem die jeweilige Zeile abgerufen wurde, über den Cursor nicht sichtbar.</span><span class="sxs-lookup"><span data-stu-id="9eab2-135">Because the cursor cannot be scrolled backward, most changes made to rows in the database after the row was fetched are not visible through the cursor.</span></span> <span data-ttu-id="9eab2-136">In Fällen, in denen ein Wert, der zum Ermitteln der Zeilenposition im Resultset verwendet wird, geändert wird, z. B. durch Aktualisieren einer von einem gruppierten Index abgedeckten Spalte, ist der geänderte Wert über den Cursor sichtbar.</span><span class="sxs-lookup"><span data-stu-id="9eab2-136">In cases where a value used to determine the location of the row within the result set is modified, such as updating a column covered by a clustered index, the modified value is visible through the cursor.</span></span>  
  
 <span data-ttu-id="9eab2-137">Obwohl die Datenbank-API-Cursormodelle einen Vorwärtscursor als unterschiedlichen Cursortyp betrachten, gilt dies nicht für [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="9eab2-137">Although the database API cursor models consider a forward-only cursor to be a distinct type of cursor, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] does not.</span></span> [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="9eab2-138">betrachtet sowohl die Vorwärts- als auch Bildlauffunktion als Optionen, die für statische, keysetgesteuerte und dynamische Cursor übernommen werden können.</span><span class="sxs-lookup"><span data-stu-id="9eab2-138">considers both forward-only and scroll as options that can be applied to static, keyset-driven, and dynamic cursors.</span></span> [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="9eab2-139">-Cursor unterstützen statische Vorwärtscursor sowie keysetgesteuerte und dynamische Cursor.</span><span class="sxs-lookup"><span data-stu-id="9eab2-139">cursors support forward-only static, keyset-driven, and dynamic cursors.</span></span> <span data-ttu-id="9eab2-140">Die Datenbank-API-Cursormodelle gehen davon aus, dass statische, keysetgesteuerte und dynamische Cursor immer bildlauffähig sind.</span><span class="sxs-lookup"><span data-stu-id="9eab2-140">The database API cursor models assume that static, keyset-driven, and dynamic cursors are always scrollable.</span></span> <span data-ttu-id="9eab2-141">Wenn das Cursorattribut oder die Cursoreigenschaft einer Datenbank-API auf FORWARD_ONLY festgelegt ist, wird dies von [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] als dynamischer Vorwärtscursor implementiert.</span><span class="sxs-lookup"><span data-stu-id="9eab2-141">When a database API cursor attribute or property is set to forward-only, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] implements this as a forward-only dynamic cursor.</span></span>  
  
 <span data-ttu-id="9eab2-142">statischen</span><span class="sxs-lookup"><span data-stu-id="9eab2-142">Static</span></span>  
 <span data-ttu-id="9eab2-143">Das vollständige Resultset eines statischen Cursors wird in **tempdb** erstellt, wenn der Cursor geöffnet wird.</span><span class="sxs-lookup"><span data-stu-id="9eab2-143">The complete result set of a static cursor is built in **tempdb** when the cursor is opened.</span></span> <span data-ttu-id="9eab2-144">Ein statischer Cursor zeigt das Resultset immer so an, wie es zur Verfügung stand, als der Cursor geöffnet wurde.</span><span class="sxs-lookup"><span data-stu-id="9eab2-144">A static cursor always displays the result set as it was when the cursor was opened.</span></span> <span data-ttu-id="9eab2-145">Statische Cursor erkennen wenige oder keine Änderungen, beanspruchen beim Durchführen eines Bildlaufs jedoch relativ wenig Ressourcen.</span><span class="sxs-lookup"><span data-stu-id="9eab2-145">Static cursors detect few or no changes, but consume relatively few resources while scrolling.</span></span>  
  
 <span data-ttu-id="9eab2-146">Der Cursor spiegelt jedoch keinerlei Änderungen wider, die in der Datenbank ausgeführt wurden und die sich entweder auf die Mitgliedschaft des Resultsets oder auf Änderungen an den Werten in den Spalten der Zeilen beziehen, aus denen das Resultset besteht.</span><span class="sxs-lookup"><span data-stu-id="9eab2-146">The cursor does not reflect any changes made in the database that affect either the membership of the result set or changes to the values in the columns of the rows that make up the result set.</span></span> <span data-ttu-id="9eab2-147">Ein statischer Cursor zeigt neue Zeilen, die nach dem Öffnen des Cursors in die Datenbank eingefügt wurden, nicht an, selbst wenn sie die Suchbedingungen der SELECT-Anweisung des Cursors erfüllen.</span><span class="sxs-lookup"><span data-stu-id="9eab2-147">A static cursor does not display new rows inserted in the database after the cursor was opened, even if they match the search conditions of the cursor SELECT statement.</span></span> <span data-ttu-id="9eab2-148">Wenn Zeilen, aus denen sich das Resultset zusammensetzt, von anderen Benutzern aktualisiert werden, werden die neuen Datenwerte im statischen Cursor nicht angezeigt.</span><span class="sxs-lookup"><span data-stu-id="9eab2-148">If rows making up the result set are updated by other users, the new data values are not displayed in the static cursor.</span></span> <span data-ttu-id="9eab2-149">Der statische Cursor zeigt Zeilen an, die nach dem Öffnen des Cursors aus der Datenbank entfernt wurden.</span><span class="sxs-lookup"><span data-stu-id="9eab2-149">The static cursor displays rows deleted from the database after the cursor was opened.</span></span> <span data-ttu-id="9eab2-150">Die Operationen UPDATE, INSERT oder DELETE werden in einem statischen Cursor nicht widergespiegelt (es sei denn, der Cursor wird geschlossen und wieder geöffnet). Selbst Änderungen, die mithilfe derselben Verbindung, die den Cursor öffnete, durchgeführt wurden, sind nicht enthalten.</span><span class="sxs-lookup"><span data-stu-id="9eab2-150">No UPDATE, INSERT, or DELETE operations are reflected in a static cursor (unless the cursor is closed and reopened), not even modifications made using the same connection that opened the cursor.</span></span>  
  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="9eab2-151">: Statische Cursor sind immer schreibgeschützt.</span><span class="sxs-lookup"><span data-stu-id="9eab2-151">static cursors are always read-only.</span></span>  
  
 <span data-ttu-id="9eab2-152">Da das Resultset eines statischen Cursors in einer Arbeitstabelle in **tempdb**gespeichert wird, darf die Größe der Zeilen im Resultset die maximale Zeilengröße einer [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] -Tabelle nicht überschreiten.</span><span class="sxs-lookup"><span data-stu-id="9eab2-152">Because the result set of a static cursor is stored in a work table in **tempdb**, the size of the rows in the result set cannot exceed the maximum row size for a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] table.</span></span>  
  
 [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="9eab2-153">werden statische Cursor als Insensitivcursor bezeichnet, also Cursor, bei denen keine Unterscheidung gemacht wird.</span><span class="sxs-lookup"><span data-stu-id="9eab2-153">uses the term insensitive for static cursors.</span></span> <span data-ttu-id="9eab2-154">Von einigen Datenbank-Anwendungsprogrammierschnittstellen (APIs, Application Programming Interfaces) werden sie als Momentaufnahmecursor bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="9eab2-154">Some database APIs identify them as snapshot cursors.</span></span>  
  
 <span data-ttu-id="9eab2-155">Keyset</span><span class="sxs-lookup"><span data-stu-id="9eab2-155">Keyset</span></span>  
 <span data-ttu-id="9eab2-156">Die Mitgliedschaft und Reihenfolge der Zeilen in einem keysetgesteuerten Cursor werden beim Öffnen des Cursors festgelegt.</span><span class="sxs-lookup"><span data-stu-id="9eab2-156">The membership and order of rows in a keyset-driven cursor are fixed when the cursor is opened.</span></span> <span data-ttu-id="9eab2-157">Keysetgesteuerte Cursor werden von einer Reihe von eindeutigen Bezeichnern (Schlüssel) gesteuert, die als das Keyset bezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="9eab2-157">Keyset-driven cursors are controlled by a set of unique identifiers, keys, known as the keyset.</span></span> <span data-ttu-id="9eab2-158">Die Schlüssel werden anhand einer Reihe von Spalten erstellt, die die Zeilen im Resultset eindeutig identifizieren.</span><span class="sxs-lookup"><span data-stu-id="9eab2-158">The keys are built from a set of columns that uniquely identify the rows in the result set.</span></span> <span data-ttu-id="9eab2-159">Das Keyset ist die Menge der Schlüsselwerte aus allen Zeilen, die zum Zeitpunkt des Öffnens des Cursors die Kriterien der SELECT-Anweisung erfüllten.</span><span class="sxs-lookup"><span data-stu-id="9eab2-159">The keyset is the set of the key values from all the rows that qualified for the SELECT statement at the time the cursor was opened.</span></span> <span data-ttu-id="9eab2-160">Das Keyset eines keysetgesteuerten Cursors wird in **tempdb** erstellt, wenn der Cursor geöffnet wird.</span><span class="sxs-lookup"><span data-stu-id="9eab2-160">The keyset for a keyset-driven cursor is built in **tempdb** when the cursor is opened.</span></span>  
  
 <span data-ttu-id="9eab2-161">Dynamisch</span><span class="sxs-lookup"><span data-stu-id="9eab2-161">Dynamic</span></span>  
 <span data-ttu-id="9eab2-162">Dynamische Cursor sind das Gegenteil von statischen Cursorn.</span><span class="sxs-lookup"><span data-stu-id="9eab2-162">Dynamic cursors are the opposite of static cursors.</span></span> <span data-ttu-id="9eab2-163">Dynamische Cursor spiegeln alle Änderungen an den Zeilen in den Resultsets beim Durchführen eines Bildlaufs durch den Cursor wider.</span><span class="sxs-lookup"><span data-stu-id="9eab2-163">Dynamic cursors reflect all changes made to the rows in their result set when scrolling through the cursor.</span></span> <span data-ttu-id="9eab2-164">Die Datenwerte, Reihenfolge und Mitgliedschaft der Zeilen im Resultset können sich bei jedem Abrufvorgang ändern.</span><span class="sxs-lookup"><span data-stu-id="9eab2-164">The data values, order, and membership of the rows in the result set can change on each fetch.</span></span> <span data-ttu-id="9eab2-165">Jede UPDATE-, INSERT- und DELETE-Anweisung, die von einem Benutzer ausgeführt wurde, ist über den Cursor sichtbar.</span><span class="sxs-lookup"><span data-stu-id="9eab2-165">All UPDATE, INSERT, and DELETE statements made by all users are visible through the cursor.</span></span> <span data-ttu-id="9eab2-166">Updates sind sofort sichtbar, wenn sie über den Cursor mithilfe einer API-Funktion, wie z. B. **SQLSetPos** , oder der WHERE CURRENT OF-Klausel von [!INCLUDE[tsql](../includes/tsql-md.md)] ausgeführt wurden.</span><span class="sxs-lookup"><span data-stu-id="9eab2-166">Updates are visible immediately if they are made through the cursor using either an API function such as **SQLSetPos** or the [!INCLUDE[tsql](../includes/tsql-md.md)] WHERE CURRENT OF clause.</span></span> <span data-ttu-id="9eab2-167">Updates, die außerhalb des Cursors ausgeführt werden, sind nur dann sichtbar, wenn ein Commit für sie ausgeführt wurde, es sei denn, die Transaktionsisolationsstufe des Cursors wurde so festgelegt, dass ein Commit vor dem Lesevorgang nicht ausgeführt sein muss.</span><span class="sxs-lookup"><span data-stu-id="9eab2-167">Updates made outside the cursor are not visible until they are committed, unless the cursor transaction isolation level is set to read uncommitted.</span></span> <span data-ttu-id="9eab2-168">Für dynamische Cursorpläne werden nie räumliche Indizes verwendet.</span><span class="sxs-lookup"><span data-stu-id="9eab2-168">Dynamic cursor plans never use spatial indexes.</span></span>  
  
## <a name="requesting-a-cursor"></a><span data-ttu-id="9eab2-169">Anfordern eines Cursors</span><span class="sxs-lookup"><span data-stu-id="9eab2-169">Requesting a Cursor</span></span>  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="9eab2-170">unterstützt zwei Methoden zum Anfordern eines Cursors:</span><span class="sxs-lookup"><span data-stu-id="9eab2-170">supports two methods for requesting a cursor:</span></span>  
  
-   [!INCLUDE[tsql](../includes/tsql-md.md)]  
  
     <span data-ttu-id="9eab2-171">Die [!INCLUDE[tsql](../includes/tsql-md.md)] -Sprache unterstützt eine Syntax für das Verwenden von Cursorn, die sich an der Syntax von ISO-Cursorn orientiert.</span><span class="sxs-lookup"><span data-stu-id="9eab2-171">The [!INCLUDE[tsql](../includes/tsql-md.md)] language supports a syntax for using cursors modeled after the ISO cursor syntax.</span></span>  
  
-   <span data-ttu-id="9eab2-172">Cursorfunktionen über Datenbank-APIs (Application Programming Interface, Schnittstelle für Anwendungsprogrammierung)</span><span class="sxs-lookup"><span data-stu-id="9eab2-172">Database application programming interface (API) cursor functions</span></span>  
  
     [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="9eab2-173">unterstützt die Cursorfunktionen der folgenden Datenbank-APIs:</span><span class="sxs-lookup"><span data-stu-id="9eab2-173">supports the cursor functionality of these database APIs:</span></span>  
  
    -   <span data-ttu-id="9eab2-174">ADO ([!INCLUDE[msCoName](../includes/msconame-md.md)] ActiveX-Datenobjekt)</span><span class="sxs-lookup"><span data-stu-id="9eab2-174">ADO ([!INCLUDE[msCoName](../includes/msconame-md.md)] ActiveX Data Object)</span></span>  
  
    -   <span data-ttu-id="9eab2-175">OLE DB</span><span class="sxs-lookup"><span data-stu-id="9eab2-175">OLE DB</span></span>  
  
    -   <span data-ttu-id="9eab2-176">ODBC (Open Database Connectivity)</span><span class="sxs-lookup"><span data-stu-id="9eab2-176">ODBC (Open Database Connectivity)</span></span>  
  
 <span data-ttu-id="9eab2-177">Eine Anwendung sollte niemals diese zwei Methoden für das Anfordern eines Cursors mischen.</span><span class="sxs-lookup"><span data-stu-id="9eab2-177">An application should never mix these two methods of requesting a cursor.</span></span> <span data-ttu-id="9eab2-178">Eine Anwendung, die die API zum Angeben des Cursorverhaltens verwendet hat, sollte nicht anschließend eine DECLARE CURSOR-Anweisung von [!INCLUDE[tsql](../includes/tsql-md.md)] ausführen, um auch einen [!INCLUDE[tsql](../includes/tsql-md.md)] -Cursor anzufordern.</span><span class="sxs-lookup"><span data-stu-id="9eab2-178">An application that has used the API to specify cursor behaviors should not then execute a [!INCLUDE[tsql](../includes/tsql-md.md)] DECLARE CURSOR statement to also request a [!INCLUDE[tsql](../includes/tsql-md.md)] cursor.</span></span> <span data-ttu-id="9eab2-179">Die Anwendung sollte nur dann DECLARE CURSOR ausführen, wenn alle API-Cursorattribute auf die entsprechenden Standardeinstellungen zurückgesetzt wurden.</span><span class="sxs-lookup"><span data-stu-id="9eab2-179">An application should only execute DECLARE CURSOR if it has set all the API cursor attributes back to their defaults.</span></span>  
  
 <span data-ttu-id="9eab2-180">Wenn weder ein [!INCLUDE[tsql](../includes/tsql-md.md)] -Cursor noch ein API-Cursor angefordert wurde, gibt [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] standardmäßig ein vollständiges Resultset, das als Standardresultset bezeichnet wird, an die Anwendung zurück.</span><span class="sxs-lookup"><span data-stu-id="9eab2-180">If neither a [!INCLUDE[tsql](../includes/tsql-md.md)] nor API cursor has been requested, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] defaults to returning a complete result set, known as a default result set, to the application.</span></span>  
  
## <a name="cursor-process"></a><span data-ttu-id="9eab2-181">Cursorprozesse</span><span class="sxs-lookup"><span data-stu-id="9eab2-181">Cursor Process</span></span>  
 [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="9eab2-182">-Cursor und API-Cursor verfügen über eine unterschiedliche Syntax. Es wird jedoch der folgende allgemeine Prozess bei allen [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] -Cursorn verwendet:</span><span class="sxs-lookup"><span data-stu-id="9eab2-182">cursors and API cursors have different syntax, but the following general process is used with all [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cursors:</span></span>  
  
1.  <span data-ttu-id="9eab2-183">Verbinden Sie einen Cursor mit dem Resultset einer [!INCLUDE[tsql](../includes/tsql-md.md)] -Anweisung, und definieren Sie die Eigenschaften des Cursors (z. B., ob die Zeilen im Cursor aktualisiert werden können).</span><span class="sxs-lookup"><span data-stu-id="9eab2-183">Associate a cursor with the result set of a [!INCLUDE[tsql](../includes/tsql-md.md)] statement, and define characteristics of the cursor, such as whether the rows in the cursor can be updated.</span></span>  
  
2.  <span data-ttu-id="9eab2-184">Führen Sie die [!INCLUDE[tsql](../includes/tsql-md.md)] -Anweisung aus, um den Cursor aufzufüllen.</span><span class="sxs-lookup"><span data-stu-id="9eab2-184">Execute the [!INCLUDE[tsql](../includes/tsql-md.md)] statement to populate the cursor.</span></span>  
  
3.  <span data-ttu-id="9eab2-185">Rufen Sie die Zeilen in den Cursor ab, die Sie anzeigen möchten.</span><span class="sxs-lookup"><span data-stu-id="9eab2-185">Retrieve the rows in the cursor you want to see.</span></span> <span data-ttu-id="9eab2-186">Der Vorgang, durch die eine Zeile oder ein Zeilenblock von einem Cursor abgerufen wird, wird als Abrufvorgang bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="9eab2-186">The operation to retrieve one row or one block of rows from a cursor is called a fetch.</span></span> <span data-ttu-id="9eab2-187">Wird eine Folge von Abrufvorgängen vorwärts oder rückwärts ausgeführt, wird dies als Durchführen eines Bildlaufs bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="9eab2-187">Performing a series of fetches to retrieve rows in either a forward or backward direction is called scrolling.</span></span>  
  
4.  <span data-ttu-id="9eab2-188">Führen Sie optional Änderungsvorgänge (Aktualisieren oder Löschen) in der Zeile an der aktuellen Position im Cursor aus.</span><span class="sxs-lookup"><span data-stu-id="9eab2-188">Optionally, perform modification operations (update or delete) on the row at the current position in the cursor.</span></span>  
  
5.  <span data-ttu-id="9eab2-189">Schließen Sie den Cursor.</span><span class="sxs-lookup"><span data-stu-id="9eab2-189">Close the cursor.</span></span>  
  
## <a name="related-content"></a><span data-ttu-id="9eab2-190">Verwandte Inhalte</span><span class="sxs-lookup"><span data-stu-id="9eab2-190">Related Content</span></span>  
 <span data-ttu-id="9eab2-191">[Cursorverhalten](native-client-odbc-cursors/cursor-behaviors.md) [Implementieren von Cursorn](native-client-odbc-cursors/implementation/how-cursors-are-implemented.md)</span><span class="sxs-lookup"><span data-stu-id="9eab2-191">[Cursor Behaviors](native-client-odbc-cursors/cursor-behaviors.md) [How Cursors Are Implemented](native-client-odbc-cursors/implementation/how-cursors-are-implemented.md)</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9eab2-192">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="9eab2-192">See Also</span></span>  
 <span data-ttu-id="9eab2-193">[DECLARE CURSOR &#40;Transact-SQL-&#41;](/sql/t-sql/language-elements/declare-cursor-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="9eab2-193">[DECLARE CURSOR &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/declare-cursor-transact-sql) </span></span>  
 <span data-ttu-id="9eab2-194">[Cursors &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/cursors-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="9eab2-194">[Cursors &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/cursors-transact-sql) </span></span>  
 <span data-ttu-id="9eab2-195">[Cursor Funktionen &#40;Transact-SQL-&#41;](/sql/t-sql/functions/cursor-functions-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="9eab2-195">[Cursor Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/cursor-functions-transact-sql) </span></span>  
 [<span data-ttu-id="9eab2-196">Gespeicherte Cursorprozeduren &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="9eab2-196">Cursor Stored Procedures &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/cursor-stored-procedures-transact-sql)  
  
  

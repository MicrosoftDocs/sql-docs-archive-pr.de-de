---
title: Grundlegendes zum WMI-Anbieter für Server Ereignisse | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: wmi
ms.topic: reference
helpviewer_keywords:
- architecture [WMI]
- SQL Server Agent [WMI]
- WMI Provider for Server Events, about WMI Provider for Server Events
ms.assetid: 8fd7bd18-76d0-4b28-8fee-8ad861441ab2
author: CarlRabeler
ms.author: carlrab
ms.openlocfilehash: ef583d479e473b6f5e71fef59f2221697248b45f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87723653"
---
# <a name="understanding-the-wmi-provider-for-server-events"></a><span data-ttu-id="69fee-102">Grundlegendes zum WMI-Anbieter für Serverereignisse</span><span class="sxs-lookup"><span data-stu-id="69fee-102">Understanding the WMI Provider for Server Events</span></span>
  <span data-ttu-id="69fee-103">Über den WMI-Anbieter für Serverereignisse können Sie Ereignisse in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]mithilfe von WMI (Windows Management Instrumentation) überwachen.</span><span class="sxs-lookup"><span data-stu-id="69fee-103">The WMI Provider for Server Events lets you use the Windows Management Instrumentation (WMI) to monitor events in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="69fee-104">Der Anbieter wandelt [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] in ein verwaltetes WMI-Objekt um.</span><span class="sxs-lookup"><span data-stu-id="69fee-104">The provider works by turning [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] into a managed WMI object.</span></span> <span data-ttu-id="69fee-105">Jedes Ereignis, das eine Ereignisbenachrichtigung in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] generieren kann, kann mithilfe dieses Anbieters von WMI verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="69fee-105">Any event that can generate an event notification in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] can be leveraged by the WMI by using this provider.</span></span> <span data-ttu-id="69fee-106">Darüber hinaus kann der [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Agent als eine mit WMI interagierende Verwaltungsanwendung auf diese Ereignisse reagieren. Dadurch wird der durch den [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Agent abgedeckte Ereignisbereich im Gegensatz zu früheren Versionen erweitert.</span><span class="sxs-lookup"><span data-stu-id="69fee-106">Additionally, as a management application that interacts with the WMI, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent can respond to these events, increasing the scope of events covered by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent over earlier releases.</span></span>

 <span data-ttu-id="69fee-107">Verwaltungsanwendungen wie der [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Agent können über den WMI-Anbieter für Serverereignisse auf [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] zugreifen, indem sie WQL-Anweisungen (WMI Query Language) ausgeben.</span><span class="sxs-lookup"><span data-stu-id="69fee-107">Management applications such as [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent can access [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] events using the WMI Provider for Server Events by issuing WMI Query Language (WQL) statements.</span></span> <span data-ttu-id="69fee-108">WQL ist eine vereinfachte Teilmenge von Structured Query Language (SQL) mit einigen WMI-spezifischen Erweiterungen.</span><span class="sxs-lookup"><span data-stu-id="69fee-108">WQL is a simplified subset of structured query language (SQL), with some WMI-specific extensions.</span></span> <span data-ttu-id="69fee-109">Bei Verwendung von WQL ruft eine Anwendung einen Ereignistyp für eine bestimmte Datenbank oder ein bestimmtes Datenbankobjekt ab.</span><span class="sxs-lookup"><span data-stu-id="69fee-109">In using WQL, an application retrieves an event type against a specific database or database object.</span></span> <span data-ttu-id="69fee-110">Der WMI-Anbieter für Serverereignisse übersetzt die Abfrage in eine Ereignisbenachrichtigung und erstellt dadurch auf effektive Weise eine Ereignisbenachrichtigung in der Zieldatenbank.</span><span class="sxs-lookup"><span data-stu-id="69fee-110">The WMI Provider for Server Events translates the query into an event notification, effectively creating an event notification in the target database.</span></span> <span data-ttu-id="69fee-111">Weitere Informationen zur Funktionsweise von Ereignisbenachrichtigungen in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]finden Sie unter [Konzepte des WMI-Anbieters für Serverereignisse](https://technet.microsoft.com/library/ms180560.aspx).</span><span class="sxs-lookup"><span data-stu-id="69fee-111">For more information about how event notifications work in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], see [WMI Provider for Server Events Concepts](https://technet.microsoft.com/library/ms180560.aspx).</span></span> <span data-ttu-id="69fee-112">Die Ereignisse, die abgefragt werden können, sind in [Klassen und Eigenschaften für WMI-Anbieter für Serverereignisse](../../relational-databases/wmi-provider-server-events/wmi-provider-for-server-events-classes-and-properties.md)aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="69fee-112">The events that can be queried are listed in [WMI Provider for Server Events Classes and Properties](../../relational-databases/wmi-provider-server-events/wmi-provider-for-server-events-classes-and-properties.md).</span></span>

 <span data-ttu-id="69fee-113">Wenn ein Ereignis auftritt, das die Ereignisbenachrichtigungsfunktion zum Senden einer Meldung veranlasst, wird die Benachrichtigung an einen vordefinierten Zieldienst in **msdb** mit dem Namen **SQL/Notifications/ProcessWMIEventProviderNotification/v1.0**übermittelt.</span><span class="sxs-lookup"><span data-stu-id="69fee-113">When an event occurs that triggers the event notification to send a message, the message goes to a predefined target service in **msdb** that is named **SQL/Notifications/ProcessWMIEventProviderNotification/v1.0**.</span></span> <span data-ttu-id="69fee-114">Der Zieldienst fügt das Ereignis in eine vordefinierte Warteschlange in **msdb** ein. Ihr Name ist **WMIEventProviderNotificationQueue**.</span><span class="sxs-lookup"><span data-stu-id="69fee-114">The service puts the event into a predefined queue in **msdb** that is named **WMIEventProviderNotificationQueue**.</span></span> <span data-ttu-id="69fee-115">(Sowohl der Dienst als auch die Warteschlange werden vom Anbieter dynamisch erstellt, wenn er zum ersten Mal eine Verbindung mit herstellt [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .) Der Anbieter liest dann die Ereignisdaten aus dieser Warteschlange und wandelt sie in das Managed Object Format (MOF) um, bevor Sie an die Anwendung zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="69fee-115">(Both the service and the queue are created dynamically by the provider when it first connects to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].) The provider then reads the event data from this queue and transforms it into managed object format (MOF) before returning it to the application.</span></span> <span data-ttu-id="69fee-116">Die folgende Abbildung veranschaulicht diesen Prozess.</span><span class="sxs-lookup"><span data-stu-id="69fee-116">The following illustration shows this process.</span></span>

 <span data-ttu-id="69fee-117">![Flussdiagramm des WMI-Anbieters für Serverereignisse](../../../2014/database-engine/dev-guide/media/wmi-provider-functional-spec.gif "Flussdiagramm des WMI-Anbieters für Serverereignisse")</span><span class="sxs-lookup"><span data-stu-id="69fee-117">![Flow diagram of the WMI Provider for Server Events](../../../2014/database-engine/dev-guide/media/wmi-provider-functional-spec.gif "Flow diagram of the WMI Provider for Server Events")</span></span>

 <span data-ttu-id="69fee-118">Betrachten Sie beispielsweise folgende WQL-Abfrage:</span><span class="sxs-lookup"><span data-stu-id="69fee-118">For example, consider the following WQL Query:</span></span>

```
SELECT * FROM DDL_DATABASE_LEVEL_EVENTS
WHERE DatabaseName = 'AdventureWorks'
```

 <span data-ttu-id="69fee-119">Als Reaktion auf diese Abfrage erstellt der WMI-Anbieter für Serverereignisse die entsprechende Ereignisbenachrichtigung in der Zieldatenbank:</span><span class="sxs-lookup"><span data-stu-id="69fee-119">In response to this query, the WMI Provider for Server Events creates the equivalent event notification in the target database:</span></span>

```
USE AdventureWorks ;
GO
CREATE EVENT NOTIFICATION SQLWEP_76CF38C1_18BB_42DD_A7DC_C8820155B0E9
    ON DATABASE
    WITH FAN_IN
    FOR DDL_DATABASE_LEVEL_EVENTS
    TO SERVICE
        'SQL/Notifications/ProcessWMIEventProviderNotification/v1.0', 
        'A7E5521A-1CA6-4741-865D-826F804E5135';
GO
```

 <span data-ttu-id="69fee-120">In diesem Beispiel ist `SQLWEP_76CF38C1_18BB_42DD_A7DC_C8820155B0E9` ein [!INCLUDE[tsql](../../includes/tsql-md.md)] -Bezeichner, der aus dem Präfix `SQLWEP_` und einer GUID besteht.</span><span class="sxs-lookup"><span data-stu-id="69fee-120">In this example, `SQLWEP_76CF38C1_18BB_42DD_A7DC_C8820155B0E9` is a [!INCLUDE[tsql](../../includes/tsql-md.md)] identifier that is made up of the prefix `SQLWEP_` and a GUID.</span></span> <span data-ttu-id="69fee-121">`SQLWEP`erstellt eine neue GUID für jeden Bezeichner.</span><span class="sxs-lookup"><span data-stu-id="69fee-121">`SQLWEP` creates a new GUID for each identifier.</span></span> <span data-ttu-id="69fee-122">Der Wert `A7E5521A-1CA6-4741-865D-826F804E5135` in der `TO SERVICE` -Klausel ist der GUID, der die Broker-Instanz in der **msdb** -Datenbank identifiziert.</span><span class="sxs-lookup"><span data-stu-id="69fee-122">The value `A7E5521A-1CA6-4741-865D-826F804E5135` in the `TO SERVICE` clause is the GUID that identifies the broker instance in the **msdb** database.</span></span>

 <span data-ttu-id="69fee-123">Weitere Informationen zur Arbeit mit WQL finden Sie unter [Verwenden von WQL mit dem WMI-Anbieter für Serverereignisse](https://technet.microsoft.com/library/ms180524\(v=sql.105\).aspx).</span><span class="sxs-lookup"><span data-stu-id="69fee-123">For more information about how to work with WQL, see [Using WQL with the WMI Provider for Server Events](https://technet.microsoft.com/library/ms180524\(v=sql.105\).aspx).</span></span>

 <span data-ttu-id="69fee-124">Verwaltungsanwendungen verweisen den WMI-Anbieter für Serverereignisse an eine Instanz von [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , indem sie eine Verbindung zu einem vom Anbieter definierten WMI-Namespace herstellen.</span><span class="sxs-lookup"><span data-stu-id="69fee-124">Management applications direct the WMI Provider for Server Events to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] by connecting to a WMI namespace that is defined by the provider.</span></span> <span data-ttu-id="69fee-125">Der WMI-Dienst ordnet der Anbieter-DLL Sqlwep.dll diesen Namespace zu und lädt sie in den Arbeitsspeicher.</span><span class="sxs-lookup"><span data-stu-id="69fee-125">The Windows WMI service maps this namespace to the provider DLL, Sqlwep.dll, and loads it into memory.</span></span> <span data-ttu-id="69fee-126">Der Anbieter verwaltet für jede Instanz von einen WMI-Namespace für Server Ereignisse [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , und das Format lautet: \\ \\ . \\ *root*\microsoft\sqlserver\serverevents \\ *instance_name*, wobei *instance_name* standardmäßig auf MSSQLSERVER festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="69fee-126">The provider manages a WMI namespace for Server Events for each instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], and the format is: \\\\.\\*root*\Microsoft\SqlServer\ServerEvents\\*instance_name*, where *instance_name* defaults to MSSQLSERVER.</span></span> <span data-ttu-id="69fee-127">Weitere Informationen dazu, wie eine Verbindung mit einem WMI-Namespace für eine [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-Instanz hergestellt wird, finden Sie unter [Verwenden von WQL mit dem WMI-Anbieter für Serverereignisse](https://technet.microsoft.com/library/ms180524\(v=sql.105\).aspx).</span><span class="sxs-lookup"><span data-stu-id="69fee-127">For more information about how to connect to a WMI namespace for an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], see [Using WQL with the WMI Provider for Server Events](https://technet.microsoft.com/library/ms180524\(v=sql.105\).aspx).</span></span>

 <span data-ttu-id="69fee-128">Die Anbieter-DLL, Sqlwep.dll, wird nur einmal in den WMI-Hostdienst des Serverbetriebssystems geladen, dabei ist es irrelevant, wie viele Instanzen von [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] sich auf dem Server befinden.</span><span class="sxs-lookup"><span data-stu-id="69fee-128">The provider DLL, Sqlwep.dll, is loaded only one time into the WMI host service of the operating system of the server, regardless of how many instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] are on the server.</span></span>

 <span data-ttu-id="69fee-129">Ein Beispiel für eine [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Agent-Verwaltungsanwendung, die den WMI-Anbieter für Serverereignisse verwendet, finden Sie unter [Beispiel: Erstellen einer SQL Server-Agent-Warnung mit dem WMI-Anbieter für Serverereignisse](https://technet.microsoft.com/library/ms186385.aspx).</span><span class="sxs-lookup"><span data-stu-id="69fee-129">For an example of a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent management application that uses the WMI Provider for Server Events, see [Sample: Creating a SQL Server Agent Alert Using the WMI Provider for Server Events](https://technet.microsoft.com/library/ms186385.aspx).</span></span> <span data-ttu-id="69fee-130">Ein Beispiel für eine Verwaltungsanwendung, die den WMI-Anbieter für Serverereignisse in verwaltetem Code verwendet, finden Sie unter [Beispiel: Verwenden des WMI-Ereignisanbieters in verwaltetem Code](https://technet.microsoft.com/library/ms179315.aspx).</span><span class="sxs-lookup"><span data-stu-id="69fee-130">For an example of a management application that uses the WMI Provider for Server Events in managed code, see [Sample: Using the WMI Event Provider in Managed Code](https://technet.microsoft.com/library/ms179315.aspx).</span></span> <span data-ttu-id="69fee-131">Weitere Informationen finden Sie auch unter WMI im [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] SDK.</span><span class="sxs-lookup"><span data-stu-id="69fee-131">More information is also available about WMI in the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] SDK.</span></span>

## <a name="see-also"></a><span data-ttu-id="69fee-132">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="69fee-132">See Also</span></span>
 [<span data-ttu-id="69fee-133">Konzepte des WMI-Anbieters für Serverereignisse</span><span class="sxs-lookup"><span data-stu-id="69fee-133">WMI Provider for Server Events Concepts</span></span>](https://technet.microsoft.com/library/ms180560.aspx)



---
title: Tabellenwertparameter für die Rowseterstellung | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters, rowset creation
ms.assetid: ffe213ca-cc0e-465e-b31c-a8272324c4fe
author: rothja
ms.author: jroth
ms.openlocfilehash: a22ccbd583d95c41daa0a113363985828cf1e9d6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87616022"
---
# <a name="table-valued-parameter-rowset-creation"></a><span data-ttu-id="15044-102">Tabellenwertparameter-Rowseterstellung</span><span class="sxs-lookup"><span data-stu-id="15044-102">Table-Valued Parameter Rowset Creation</span></span>
  <span data-ttu-id="15044-103">Consumer können zwar ein beliebiges Rowsetobjekt für Tabellenwertparameter bereitstellen, typische Rowsetobjekte werden jedoch mit Back-End-Datenspeichern implementiert und bieten somit nur eine eingeschränkte Leistung.</span><span class="sxs-lookup"><span data-stu-id="15044-103">Although consumers can provide any rowset object for table-valued parameters, typical rowset objects are implemented against back-end data stores, and therefore provide limited performance.</span></span> <span data-ttu-id="15044-104">Der [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter ermöglicht es somit Consumern, ein spezielles Rowsetobjekt auf speicherinternen Daten zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="15044-104">For this reason, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB Provider enables consumers to create a specialized rowset object on top of in-memory data.</span></span> <span data-ttu-id="15044-105">Dieses spezielle, in-Memory-Rowsetobjekt ist ein neues COM-Objekt, das als Tabellenwert Parameter-Rowset bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="15044-105">This special, in-memory rowset object is a new COM object called a table-valued parameter rowset .</span></span> <span data-ttu-id="15044-106">Es bietet ähnliche Funktionen wie Parametersätze.</span><span class="sxs-lookup"><span data-stu-id="15044-106">It provides functionality similar to parameter sets.</span></span>  
  
 <span data-ttu-id="15044-107">Tabellenwertparameter-Rowsetobjekte werden explizit vom Consumer für Eingabeparameter durch mehrere Schnittstellen auf Sitzungsebene erstellt.</span><span class="sxs-lookup"><span data-stu-id="15044-107">Table-valued parameter rowset objects are created explicitly by the consumer for input parameters through multiple session-level interfaces.</span></span> <span data-ttu-id="15044-108">Es steht eine Instanz des Tabellenwertparameter-Rowsetobjekts pro Tabellenwertparameter zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="15044-108">There is one instance of a table-valued parameter rowset object per table-valued parameter.</span></span> <span data-ttu-id="15044-109">Der Consumer kann die Tabellenwertparameter-Rowsetobjekte entweder durch Bereitstellen der Metadateninformationen, die bereits bekannt sind (statisches Szenario), oder durch Ermitteln über Anbieterschnittstellen (dynamisches Szenario) erstellen.</span><span class="sxs-lookup"><span data-stu-id="15044-109">The consumer can create the table-valued parameter rowset objects either by providing metadata information that is already known (static scenario), or by discovering it through provider interfaces (dynamic scenario).</span></span> <span data-ttu-id="15044-110">In den folgenden Abschnitten werden diese beiden Szenarien beschrieben.</span><span class="sxs-lookup"><span data-stu-id="15044-110">The following sections describe these two scenarios.</span></span>  
  
## <a name="static-scenario"></a><span data-ttu-id="15044-111">Statisches Szenario</span><span class="sxs-lookup"><span data-stu-id="15044-111">Static Scenario</span></span>  
 <span data-ttu-id="15044-112">Wenn die Typinformationen bekannt sind, verwendet der Consumer ITableDefinitionWithConstraints::CreateTableWithConstraints, um einen Tabellenwertparameter für Rowsetobjekte zu instanziieren, die einem Tabellenwertparameter entsprechen.</span><span class="sxs-lookup"><span data-stu-id="15044-112">When the type information is known, the consumer uses ITableDefinitionWithConstraints::CreateTableWithConstraints to instantiate a table-valued parameter rowset object that corresponds to a table-valued parameter.</span></span>  
  
 <span data-ttu-id="15044-113">Das *guid*-Feld (*pTableID*-Parameter) enthält die besondere GUID (CLSID_ROWSET_TVP).</span><span class="sxs-lookup"><span data-stu-id="15044-113">The *guid* field (*pTableID* parameter) contains the special GUID (CLSID_ROWSET_TVP).</span></span> <span data-ttu-id="15044-114">Das Element *pwszName* enthält den Namen des Tabellenwertparameter-Typs, den der Consumer instanziieren möchte.</span><span class="sxs-lookup"><span data-stu-id="15044-114">The *pwszName* member contains the name of the table-valued parameter type that the consumer wants to instantiate.</span></span> <span data-ttu-id="15044-115">Das Feld *eKin* wird auf DBKIND_GUID_NAME festgelegt.</span><span class="sxs-lookup"><span data-stu-id="15044-115">The *eKind* field will be set to DBKIND_GUID_NAME.</span></span> <span data-ttu-id="15044-116">Der Name ist erforderlich, wenn es sich um eine Ad-hoc-SQL-Anweisung handelt; bei einem Prozeduraufruf ist die Angabe des Namens optional.</span><span class="sxs-lookup"><span data-stu-id="15044-116">This name is required when the statement is ad hoc SQL; the name is optional if it is a procedure call.</span></span>  
  
 <span data-ttu-id="15044-117">Bei der Aggregation übergibt der Consumer den *pUnkOuter*-Parameter mit dem kontrollierenden IUnknown-Element.</span><span class="sxs-lookup"><span data-stu-id="15044-117">For aggregation, the consumer passes the *pUnkOuter* parameter with the controlling IUnknown.</span></span>  
  
 <span data-ttu-id="15044-118">Die Eigenschaften des Tabellenwert Parameter-Rowsetobjekts sind schreibgeschützt, sodass der Consumer keine Eigenschaften in *rgPropertySets*festlegen soll.</span><span class="sxs-lookup"><span data-stu-id="15044-118">The table-valued parameter rowset object properties are read only, so the consumer is not expected to set any properties in *rgPropertySets*.</span></span>  
  
 <span data-ttu-id="15044-119">Für das Element *rgPropertySets* jeder DBCOLUMNDESC-Struktur kann der Consumer zusätzliche Eigenschaften für jede Spalte angeben.</span><span class="sxs-lookup"><span data-stu-id="15044-119">For the *rgPropertySets* member of each DBCOLUMNDESC structure, the consumer can specify additional properties for each column.</span></span> <span data-ttu-id="15044-120">Diese Eigenschaften gehören zum DBPROPSET_SQLSERVERCOLUMN-Eigenschaftensatz.</span><span class="sxs-lookup"><span data-stu-id="15044-120">These properties belong to the DBPROPSET_SQLSERVERCOLUMN property set.</span></span> <span data-ttu-id="15044-121">Sie ermöglichen es Ihnen, berechnete und standardmäßige Einstellungen für jede Spalte anzugeben.</span><span class="sxs-lookup"><span data-stu-id="15044-121">They enable you to specify computed and default settings for each column.</span></span> <span data-ttu-id="15044-122">Sie unterstützen auch vorhandene Spalteneigenschaften, z. B. NULL-Zulässigkeit und Identität.</span><span class="sxs-lookup"><span data-stu-id="15044-122">They also support existing column properties, such as nullability and identity.</span></span>  
  
 <span data-ttu-id="15044-123">Um entsprechende Informationen aus einem Tabellenwertparameter-Rowsetobjekt abzurufen, verwendet der Consumer IRowsetInfo::GetProperties.</span><span class="sxs-lookup"><span data-stu-id="15044-123">To retrieve corresponding information from a table-valued parameter rowset object, the consumer uses IRowsetInfo::GetProperties.</span></span>  
  
 <span data-ttu-id="15044-124">Zum Abrufen von Informationen über den NULL-, eindeutigen, berechneten und Update Status der einzelnen Spalten verwendet der Consumer IColumnsRowset:: GetColumnsRowset oder IColumnsInfo:: GetColumnInfo.</span><span class="sxs-lookup"><span data-stu-id="15044-124">To retrieve information about the null, unique, computed, and update status of each column, the consumer use IColumnsRowset::GetColumnsRowset or IColumnsInfo::GetColumnInfo.</span></span> <span data-ttu-id="15044-125">Diese Methoden stellen ausführliche Informationen über jede Tabellenwertparameter-Rowsetspalte bereit.</span><span class="sxs-lookup"><span data-stu-id="15044-125">These methods provide detailed information about each table-valued parameter rowset column.</span></span>  
  
 <span data-ttu-id="15044-126">Der Consumer gibt den Typ jeder Spalte des Tabellenwertparameters an.</span><span class="sxs-lookup"><span data-stu-id="15044-126">The consumer specifies the type of each column of the table-valued parameter.</span></span> <span data-ttu-id="15044-127">Dies ähnelt der Angabe von Spalten, wenn in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] eine Tabelle erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="15044-127">This is similar to how columns are specified when a table is created in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="15044-128">Der Consumer erhält ein Tabellenwert Parameter-Rowsetobjekt vom [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter über den *ppRowset* -Ausgabeparameter.</span><span class="sxs-lookup"><span data-stu-id="15044-128">The consumer obtains a table-valued parameter rowset object from the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB Provider through the *ppRowset* output parameter.</span></span>  
  
## <a name="dynamic-scenario"></a><span data-ttu-id="15044-129">Dynamisches Szenario</span><span class="sxs-lookup"><span data-stu-id="15044-129">Dynamic Scenario</span></span>  
 <span data-ttu-id="15044-130">Wenn der Consumer keine Typinformationen hat, sollte er IOpenRowset:: OPENROWSET verwenden, um Tabellenwert Parameter-Rowsetobjekte zu instanziieren.</span><span class="sxs-lookup"><span data-stu-id="15044-130">When the consumer does not have type information, it should use IOpenRowset::OpenRowset to instantiate table-valued parameter rowset objects.</span></span> <span data-ttu-id="15044-131">Der Consumer muss dem Anbieter somit nur den Typnamen zur Verfügung stellen.</span><span class="sxs-lookup"><span data-stu-id="15044-131">All the consumer has to provide to the provider is the type name.</span></span>  
  
 <span data-ttu-id="15044-132">In diesem Szenario erhält der Anbieter im Namen des Consumers Typinformationen zu einem Tabellenwertparameter-Rowsetobjekt vom Server.</span><span class="sxs-lookup"><span data-stu-id="15044-132">In this scenario, the provider obtains type information about a table-valued parameter rowset object from the server on behalf of the consumer.</span></span>  
  
 <span data-ttu-id="15044-133">Die Parameter *pTableID* und *pUnkOuter* sollten wie im statischen Szenario festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="15044-133">The *pTableID* and *pUnkOuter* parameters should be set as in the static scenario.</span></span> <span data-ttu-id="15044-134">Der [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB-Anbieter ruft dann die Typinformationen (Spalten Informationen und Einschränkungen) vom Server ab und gibt ein Tabellenwert Parameter-Rowsetobjekt über den *ppRowset* -Parameter zurück.</span><span class="sxs-lookup"><span data-stu-id="15044-134">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB Provider then obtains the type information (column information and constraints) from the server, and return a table-valued parameter rowset object through the *ppRowset* parameter.</span></span> <span data-ttu-id="15044-135">Für diesen Vorgang ist eine Kommunikation mit dem Server notwendig, sodass die Leistung nicht so gut ist wie beim statischen Szenario.</span><span class="sxs-lookup"><span data-stu-id="15044-135">This operation requires communication with the server, and therefore does not perform as well as the static scenario.</span></span> <span data-ttu-id="15044-136">Das dynamische Szenario funktioniert nur mit parametrisierten Prozeduraufrufen.</span><span class="sxs-lookup"><span data-stu-id="15044-136">The dynamic scenario works only with parameterized procedure calls.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="15044-137">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="15044-137">See Also</span></span>  
 <span data-ttu-id="15044-138">[Tabellenwert Parameter &#40;OLE DB&#41;](table-valued-parameters-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="15044-138">[Table-Valued Parameters &#40;OLE DB&#41;](table-valued-parameters-ole-db.md) </span></span>  
 [<span data-ttu-id="15044-139">Verwenden von Tabellenwertparametern &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="15044-139">Use Table-Valued Parameters &#40;OLE DB&#41;</span></span>](../native-client-ole-db-how-to/use-table-valued-parameters-ole-db.md)  
  
  

---
title: Ausführen von Befehlen, die Tabellenwertparameter enthalten | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters, executing commands containing
ms.assetid: 7ecba6f6-fe7a-462a-9aa3-d5115b6d4529
author: rothja
ms.author: jroth
ms.openlocfilehash: e3f616b2b9f95ae558e444bcbdae50eae123fa4c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87615370"
---
# <a name="executing-commands-containing-table-valued-parameters"></a><span data-ttu-id="375dc-102">Ausführen von Befehlen, die Tabellenwertparameter enthalten</span><span class="sxs-lookup"><span data-stu-id="375dc-102">Executing Commands Containing Table-Valued Parameters</span></span>
  <span data-ttu-id="375dc-103">Die Ausführung eines Befehls, der Tabellenwertparameter enthält, erfordert zwei Phasen:</span><span class="sxs-lookup"><span data-stu-id="375dc-103">Executing a command that contains table-valued parameters requires two phases:</span></span>  
  
1.  <span data-ttu-id="375dc-104">Angeben der Parametertypen</span><span class="sxs-lookup"><span data-stu-id="375dc-104">Specify the parameter types.</span></span>  
  
2.  <span data-ttu-id="375dc-105">Binden der Parameterdaten</span><span class="sxs-lookup"><span data-stu-id="375dc-105">Bind the parameter data.</span></span>  
  
## <a name="table-valued-parameter-specification"></a><span data-ttu-id="375dc-106">Tabellenwertparameter-Spezifikation</span><span class="sxs-lookup"><span data-stu-id="375dc-106">Table-Valued Parameter Specification</span></span>  
 <span data-ttu-id="375dc-107">Der Consumer kann den Typ des Tabellenwertparameters angeben.</span><span class="sxs-lookup"><span data-stu-id="375dc-107">The consumer can specify the type of the table-valued parameter.</span></span> <span data-ttu-id="375dc-108">Diese Angabe enthält den Typnamen des Tabellenwertparameters.</span><span class="sxs-lookup"><span data-stu-id="375dc-108">This information includes the table-valued parameter type name.</span></span> <span data-ttu-id="375dc-109">Sie umfasst auch den Schemanamen, wenn der benutzerdefinierte Tabellentyp für den Tabellenwertparameter nicht im aktuellen Standardschema für die Verbindung enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="375dc-109">It also includes the schema name, if the user-defined table type for the table-valued parameter is not in the current default schema for the connection.</span></span> <span data-ttu-id="375dc-110">Je nach Serverunterstützung kann der Consumer auch optionale Metadateninformationen angeben, wie beispielsweise die Sortierreihenfolge der Spalten. Zudem kann er angeben, dass alle Zeilen für bestimmte Spalten Standardwerte aufweisen sollen.</span><span class="sxs-lookup"><span data-stu-id="375dc-110">Depending on server support, the consumer can also specify optional metadata information, such as ordering of columns, and can specify that all rows for particular columns have the default values.</span></span>  
  
 <span data-ttu-id="375dc-111">Der Consumer ruft ISSCommandWithParameter::SetParameterInfo oder optional ISSCommandWithParameters::SetParameterProperties ab, um einen Tabellenwertparameter anzugeben.</span><span class="sxs-lookup"><span data-stu-id="375dc-111">To specify a table-valued parameter, the consumer calls ISSCommandWithParameter::SetParameterInfo, and optionally calls ISSCommandWithParameters::SetParameterProperties.</span></span> <span data-ttu-id="375dc-112">Für einen Tabellenwertparameter verfügt das *pwszDataSourceType*-Feld in der DBPARAMBINDINFO-Struktur über den Wert DBTYPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="375dc-112">For a table-valued parameter, the *pwszDataSourceType* field in the DBPARAMBINDINFO structure has a value of DBTYPE_TABLE.</span></span> <span data-ttu-id="375dc-113">Das *ulParamSize*-Feld wird auf ~0 festgelegt, um anzugeben, dass die Länge unbekannt ist.</span><span class="sxs-lookup"><span data-stu-id="375dc-113">The *ulParamSize* field is set to ~0 to indicate that length is unknown.</span></span> <span data-ttu-id="375dc-114">Spezielle Eigenschaften für Tabellenwertparameter, wie z. B. Schemaname, Typname, Spaltenreihenfolge und Standardspalten, können mit ISSCommandWithParameters::SetParameterProperties festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="375dc-114">Particular properties for table-valued parameters, such as schema name, type name, column order, and default columns, can be set through ISSCommandWithParameters::SetParameterProperties.</span></span>  
  
## <a name="table-valued-parameter-binding"></a><span data-ttu-id="375dc-115">Tabellenwertparameter-Bindung</span><span class="sxs-lookup"><span data-stu-id="375dc-115">Table-Valued Parameter Binding</span></span>  
 <span data-ttu-id="375dc-116">Ein Tabellenwertparameter kann ein beliebiges Rowsetobjekt sein.</span><span class="sxs-lookup"><span data-stu-id="375dc-116">A table-valued parameter can be any rowset object.</span></span> <span data-ttu-id="375dc-117">Während der Ausführung liest der Anbieter beim Senden von Tabellenwertparametern an den Server aus diesem Objekt.</span><span class="sxs-lookup"><span data-stu-id="375dc-117">The provider reads from this object while sending table-valued parameters to the server during execution.</span></span>  
  
 <span data-ttu-id="375dc-118">Der Consumer ruft IAccessor::CreateAccessor auf, um den Tabellenwertparameter zu binden.</span><span class="sxs-lookup"><span data-stu-id="375dc-118">To bind the table-valued parameter, the consumer calls IAccessor::CreateAccessor.</span></span> <span data-ttu-id="375dc-119">Das *wType*-Feld der DBBINDING-Struktur für den Tabellenwertparameter wird auf DBTYPE_TABLE festgelegt.</span><span class="sxs-lookup"><span data-stu-id="375dc-119">The *wType* field of the DBBINDING structure for the table-valued parameter is set to DBTYPE_TABLE.</span></span> <span data-ttu-id="375dc-120">Das *pObject*-Element der DBBINDING-Struktur ist nicht NULL, und das *iid*-Element von *pObject* wird auf IID_IRowset oder jede beliebige andere Rowsetobjekt-Schnittstelle für Tabellenwertparameter festgelegt.</span><span class="sxs-lookup"><span data-stu-id="375dc-120">The *pObject* member of the DBBINDING structure is non-NULL, and the *pObject*'s *iid* member is set to IID_IRowset or any other table-valued parameter rowset object interfaces.</span></span> <span data-ttu-id="375dc-121">Die verbleibenden Felder in der DBBINDING-Struktur können in der gleichen Weise festgelegt werden wie für gestreamte BLOBs.</span><span class="sxs-lookup"><span data-stu-id="375dc-121">The remaining fields in the DBBINDING structure should be set the same way they are set for streamed BLOBs.</span></span>  
  
 <span data-ttu-id="375dc-122">Für die Bindungen des Tabellenwertparameters und des einem Tabellenwertparameter zugeordneten Rowsetobjekts gelten die folgenden Einschränkungen:</span><span class="sxs-lookup"><span data-stu-id="375dc-122">In the bindings for the table-valued parameter and the rowset object associated with a table-valued parameter, the following restrictions apply:</span></span>  
  
-   <span data-ttu-id="375dc-123">Die einzigen Statuswerte, die für Rowsetspaltendaten von Tabellenwertparametern zulässig sind, lauten DBSTATUS_S_ISNULL und DBSTATUS_S_OK.</span><span class="sxs-lookup"><span data-stu-id="375dc-123">The only status values allowed for table-valued parameter rowset column data are DBSTATUS_S_ISNULL and DBSTATUS_S_OK.</span></span> <span data-ttu-id="375dc-124">DBSTATUS_S_DEFAULT führt zu einem Fehler, und der gebundene Statuswert wird auf DBSTATUS_E_BADSTATUS festgelegt.</span><span class="sxs-lookup"><span data-stu-id="375dc-124">DBSTATUS_S_DEFAULT will result in a failure, and the bound status value will be set to DBSTATUS_E_BADSTATUS.</span></span>  
  
-   <span data-ttu-id="375dc-125">Ein Tabellenwertparameter kann mit dem Status DBSTATUS_S_DEFAULT markiert werden.</span><span class="sxs-lookup"><span data-stu-id="375dc-125">A table-valued parameter can be marked with the status DBSTATUS_S_DEFAULT.</span></span> <span data-ttu-id="375dc-126">Die einzigen gültigen Werte sind DBSTATUS_S_DEFAULT und DBSTATUS_S_OK.</span><span class="sxs-lookup"><span data-stu-id="375dc-126">The only valid values are DBSTATUS_S_DEFAULT and DBSTATUS_S_OK.</span></span> <span data-ttu-id="375dc-127">Wenn der Status auf DBSTATUS_S_DEFAULT festgelegt ist, entspricht der Wert des Tabellenwertparameters einer leeren Tabelle.</span><span class="sxs-lookup"><span data-stu-id="375dc-127">When the status is set to DBSTATUS_S_DEFAULT, the value of the table-valued parameter corresponds to an empty table.</span></span>  
  
-   <span data-ttu-id="375dc-128">Schreibgeschützte Spalten in Tabellenwertparametern (Identitätsspalte und berechnete Spalte) müssen mit der SSPROP_PARAM_TABLE_DEFAULT_COLUMNS-Eigenschaft als Standard markiert werden.</span><span class="sxs-lookup"><span data-stu-id="375dc-128">Read-only columns in table-valued parameters (identity or computed columns) must be marked as default by using the SSPROP_PARAM_TABLE_DEFAULT_COLUMNS property.</span></span> <span data-ttu-id="375dc-129">Spalten, die einen Standardwert aufweisen, müssen ebenfalls mit der SSPROP_PARAM_TABLE_DEFAULT_COLUMNS-Eigenschaft als Standard markiert werden. Dann kann der Standardwert als Datenwert einer Spalte für einen bestimmten Tabellenwertparameter verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="375dc-129">Columns that have a default value must also be marked as default through SSPROP_PARAM_TABLE_DEFAULT_COLUMNS property to allow the default value to be used for the column's data values for a particular table-valued parameter.</span></span> <span data-ttu-id="375dc-130">Der Anbieter ignoriert die Datenwerte, die an als Standard markierte Spalten gebunden sind.</span><span class="sxs-lookup"><span data-stu-id="375dc-130">The provider will ignore the data values bound for the columns marked as default.</span></span>  
  
-   <span data-ttu-id="375dc-131">Für Spalten mit DBPROP_COL_AUTOINCREMENT oder SSPROP_COL_COMPUTED werden Daten an den Server gesendet, sofern nicht auch SSPROP_PARAM_TABLE_DEFAULT festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="375dc-131">Data will be sent to the server for columns with DBPROP_COL_AUTOINCREMENT or SSPROP_COL_COMPUTED, unless SSPROP_PARAM_TABLE_DEFAULT is also set.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="375dc-132">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="375dc-132">See Also</span></span>  
 <span data-ttu-id="375dc-133">[Tabellenwert Parameter &#40;OLE DB&#41;](table-valued-parameters-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="375dc-133">[Table-Valued Parameters &#40;OLE DB&#41;](table-valued-parameters-ole-db.md) </span></span>  
 [<span data-ttu-id="375dc-134">Verwenden von Tabellenwertparametern &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="375dc-134">Use Table-Valued Parameters &#40;OLE DB&#41;</span></span>](../native-client-ole-db-how-to/use-table-valued-parameters-ole-db.md)  
  
  

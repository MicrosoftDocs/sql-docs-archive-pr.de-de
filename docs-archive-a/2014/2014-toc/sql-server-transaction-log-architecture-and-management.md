---
title: SQL Server 2014 Architektur und Verwaltung von Transaktions Protokollen | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
ms.assetid: 4d1a4f97-3fe4-44af-9d4f-f884a6eaa457
author: rothja
ms.author: jroth
ms.openlocfilehash: 8d32950d94bff22d6549c468e8fe8db3f30fd09a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87609556"
---
# <a name="sql-server-2014-transaction-log-architecture-and-management"></a><span data-ttu-id="4f105-102">SQL Server 2014 Architektur und Verwaltung von Transaktions Protokollen</span><span class="sxs-lookup"><span data-stu-id="4f105-102">SQL Server 2014 Transaction Log Architecture and Management</span></span>

<span data-ttu-id="4f105-103">**Gilt für:** SQL Server (beginnend mit 2008)</span><span class="sxs-lookup"><span data-stu-id="4f105-103">**Applies to:** SQL Server (starting with 2008)</span></span>

  <span data-ttu-id="4f105-104">Jede [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] -Datenbank verfügt über ein Transaktionsprotokoll, in dem alle Transaktionen und Datenbankänderungen aufgezeichnet werden, die von den einzelnen Transaktionen vorgenommen werden.</span><span class="sxs-lookup"><span data-stu-id="4f105-104">Every [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] database has a transaction log that records all transactions and the database modifications that are made by each transaction.</span></span> <span data-ttu-id="4f105-105">Das Transaktionsprotokoll ist eine wichtige Komponente der Datenbank und wird im Falle eines Systemfehlers ggf. benötigt, um einen konsistenten Status der Datenbank wiederherzustellen.</span><span class="sxs-lookup"><span data-stu-id="4f105-105">The transaction log is a critical component of the database and, if there is a system failure, the transaction log might be required to bring your database back to a consistent state.</span></span> <span data-ttu-id="4f105-106">Dieses Handbuch enthält Informationen zur physischen und logischen Architektur des Transaktionsprotokolls.</span><span class="sxs-lookup"><span data-stu-id="4f105-106">This guide provides information about the physical and logical architecture of the transaction log.</span></span> <span data-ttu-id="4f105-107">Eine gute Kenntnis der Architektur kann Ihnen dabei helfen, Transaktionsprotokolle effizienter zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="4f105-107">Understanding the architecture can improve your effectiveness in managing transaction logs.</span></span>  

  
##  <a name="transaction-log-logical-architecture"></a><a name="Logical_Arch"></a><span data-ttu-id="4f105-108">Logische Architektur des Transaktions Protokolls</span><span class="sxs-lookup"><span data-stu-id="4f105-108">Transaction Log Logical Architecture</span></span>  

 <span data-ttu-id="4f105-109">Das [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] -Transaktionsprotokoll wird logisch so verwendet, als handele es sich um eine Folge von Protokolleinträgen.</span><span class="sxs-lookup"><span data-stu-id="4f105-109">The [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] transaction log operates logically as if the transaction log is a string of log records.</span></span> <span data-ttu-id="4f105-110">Jeder Protokolleintrag wird durch eine Protokollsequenznummer (LSN, Log Sequence Number) gekennzeichnet.</span><span class="sxs-lookup"><span data-stu-id="4f105-110">Each log record is identified by a log sequence number (LSN).</span></span> <span data-ttu-id="4f105-111">Jeder neue Protokolleintrag wird an das logische Ende des Protokolls geschrieben und erhält eine LSN, die höher ist als die LSN des vorherigen Eintrags.</span><span class="sxs-lookup"><span data-stu-id="4f105-111">Each new log record is written to the logical end of the log with an LSN that is higher than the LSN of the record before it.</span></span> <span data-ttu-id="4f105-112">Protokolleinträge werden nacheinander in der Reihenfolge ihres Erstellens gespeichert.</span><span class="sxs-lookup"><span data-stu-id="4f105-112">Log records are stored in a serial sequence as they are created.</span></span> <span data-ttu-id="4f105-113">Jeder Protokolleintrag enthält die ID der Transaktion, zu der er gehört.</span><span class="sxs-lookup"><span data-stu-id="4f105-113">Each log record contains the ID of the transaction that it belongs to.</span></span> <span data-ttu-id="4f105-114">Für jede Transaktion werden alle Protokolleinträge, die mit dieser Transaktion verbunden sind, individuell zu einer Kette verknüpft. Dies erfolgt mithilfe von Rückwärtszeigern, durch die der Rollback der Transaktion beschleunigt wird.</span><span class="sxs-lookup"><span data-stu-id="4f105-114">For each transaction, all log records associated with the transaction are individually linked in a chain using backward pointers that speed the rollback of the transaction.</span></span>  
  
 <span data-ttu-id="4f105-115">Protokolleinträge für Datenänderungen zeichnen entweder die durchgeführte logische Operation oder die Anfangs- und Endimages der geänderten Daten auf.</span><span class="sxs-lookup"><span data-stu-id="4f105-115">Log records for data modifications record either the logical operation performed or they record the before and after images of the modified data.</span></span> <span data-ttu-id="4f105-116">Ein Anfangsimage ist eine Kopie der Daten vor der Durchführung der Operation. Ein Endimage ist eine Kopie der Daten, nachdem die Operation durchgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="4f105-116">The before image is a copy of the data before the operation is performed; the after image is a copy of the data after the operation has been performed.</span></span>  
  
 <span data-ttu-id="4f105-117">Die Schritte zum Wiederherstellen einer Operation hängen von der Art des Protokolleintrags ab:</span><span class="sxs-lookup"><span data-stu-id="4f105-117">The steps to recover an operation depend on the type of log record:</span></span>  
  
-   <span data-ttu-id="4f105-118">Protokollierung der logischen Operation</span><span class="sxs-lookup"><span data-stu-id="4f105-118">Logical operation logged</span></span>  
  
    -   <span data-ttu-id="4f105-119">Um einen Rollforward für die logische Operation auszuführen, wird sie erneut durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="4f105-119">To roll the logical operation forward, the operation is performed again.</span></span>  
  
    -   <span data-ttu-id="4f105-120">Um einen Rollback für die logische Operation auszuführen, wird der logische Umkehrvorgang durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="4f105-120">To roll the logical operation back, the reverse logical operation is performed.</span></span>  
  
-   <span data-ttu-id="4f105-121">Protokollierung der Anfangs- und Endimages</span><span class="sxs-lookup"><span data-stu-id="4f105-121">Before and after image logged</span></span>  
  
    -   <span data-ttu-id="4f105-122">Um einen Rollforward für die Operation auszuführen, wird das Endimage übernommen.</span><span class="sxs-lookup"><span data-stu-id="4f105-122">To roll the operation forward, the after image is applied.</span></span>  
  
    -   <span data-ttu-id="4f105-123">Um einen Rollback für die Operation auszuführen, wird das Anfangsimage übernommen.</span><span class="sxs-lookup"><span data-stu-id="4f105-123">To roll the operation back, the before image is applied.</span></span>  
  
 <span data-ttu-id="4f105-124">Im Transaktionsprotokoll werden viele Operationsarten aufgezeichnet.</span><span class="sxs-lookup"><span data-stu-id="4f105-124">Many types of operations are recorded in the transaction log.</span></span> <span data-ttu-id="4f105-125">Dazu zählen die Operationen:</span><span class="sxs-lookup"><span data-stu-id="4f105-125">These operations include:</span></span>  
  
-   <span data-ttu-id="4f105-126">Der Beginn und das Ende jeder Transaktion.</span><span class="sxs-lookup"><span data-stu-id="4f105-126">The start and end of each transaction.</span></span>  
  
-   <span data-ttu-id="4f105-127">Jede Datenänderung (Einfügung, Update oder Löschung).</span><span class="sxs-lookup"><span data-stu-id="4f105-127">Every data modification (insert, update, or delete).</span></span> <span data-ttu-id="4f105-128">Hierzu zählen auch Änderungen, die von gespeicherten Systemprozeduren oder DDL-Anweisungen (Data Definition Language, Datendefinitionssprache) an beliebigen Tabellen, einschließlich den Systemtabellen, vorgenommen werden.</span><span class="sxs-lookup"><span data-stu-id="4f105-128">This includes changes by system stored procedures or data definition language (DDL) statements to any table, including system tables.</span></span>  
  
-   <span data-ttu-id="4f105-129">Jede Zuordnung oder Zuordnungsaufhebung von Blöcken und Seiten</span><span class="sxs-lookup"><span data-stu-id="4f105-129">Every extent and page allocation or deallocation.</span></span>  
  
-   <span data-ttu-id="4f105-130">Erstellen oder Löschen einer Tabelle oder eines Indexes.</span><span class="sxs-lookup"><span data-stu-id="4f105-130">Creating or dropping a table or index.</span></span>  
  
 <span data-ttu-id="4f105-131">Rollback-Operationen werden ebenfalls protokolliert.</span><span class="sxs-lookup"><span data-stu-id="4f105-131">Rollback operations are also logged.</span></span> <span data-ttu-id="4f105-132">Jede Transaktion reserviert Speicherplatz im Transaktionsprotokoll, um sicherzustellen, dass ausreichend Speicherplatz vorhanden ist, um einen Rollback infolge einer expliziten Rollback-Anweisung oder im Falle eines Fehlers zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="4f105-132">Each transaction reserves space on the transaction log to make sure that enough log space exists to support a rollback that is caused by either an explicit rollback statement or if an error is encountered.</span></span> <span data-ttu-id="4f105-133">Die Menge des reservierten Speicherplatzes hängt von den in der Transaktion durchgeführten Vorgängen ab, entspricht jedoch im Allgemeinen dem Speicherplatz, der zum Protokollieren der einzelnen Vorgänge verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="4f105-133">The amount of space reserved depends on the operations performed in the transaction, but generally it is equal to the amount of space used to log each operation.</span></span> <span data-ttu-id="4f105-134">Dieser reservierte Speicherplatz wird freigegeben, sobald die Transaktion abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="4f105-134">This reserved space is freed when the transaction is completed.</span></span>  
  
 <span data-ttu-id="4f105-135"> Als aktiver Teil des Protokolls bzw. *aktives Protokoll* wird der Abschnitt der Protokolldatei aus dem ersten Protokolldatensatz bezeichnet, der für einen erfolgreichen Rollback der gesamten Datenbank auf den zuletzt geschriebenen Protokolldatensatz benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="4f105-135">The section of the log file from the first log record that must be present for a successful database-wide rollback to the last-written log record is called the active part of the log, or the *active log*.</span></span> <span data-ttu-id="4f105-136">Dies ist der Teil des Protokolls, der für eine vollständige Wiederherstellung der Datenbank erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="4f105-136">This is the section of the log required to a full recovery of the database.</span></span> <span data-ttu-id="4f105-137">Vom aktiven Teil des Protokolls kann niemals ein Teil abgeschnitten werden.</span><span class="sxs-lookup"><span data-stu-id="4f105-137">No part of the active log can ever be truncated.</span></span> <span data-ttu-id="4f105-138">Die Protokollfolgenummer (Log Sequence Number, LSN) des ersten Protokolldatensatzes wird als Mindestwiederherstellungs-LSN (*MinLSN*) bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="4f105-138">The log sequence number (LSN) of this first log record is known as the minimum recovery LSN (*MinLSN*).</span></span>  
  
##  <a name="transaction-log-physical-architecture"></a><a name="physical_arch"></a> <span data-ttu-id="4f105-139">Physische Architektur des Transaktionsprotokolls</span><span class="sxs-lookup"><span data-stu-id="4f105-139">Transaction Log Physical Architecture</span></span>  

 <span data-ttu-id="4f105-140">Das Transaktionsprotokoll in einer Datenbank erstreckt sich über eine oder mehrere physische Dateien.</span><span class="sxs-lookup"><span data-stu-id="4f105-140">The transaction log in a database maps over one or more physical files.</span></span> <span data-ttu-id="4f105-141">Konzeptionell ist die Protokolldatei eine Folge von Protokolldatensätzen.</span><span class="sxs-lookup"><span data-stu-id="4f105-141">Conceptually, the log file is a string of log records.</span></span> <span data-ttu-id="4f105-142">Physisch wird die Folge von Protokolldatensätzen effizient in dem Satz physischer Dateien gespeichert, die das Transaktionsprotokoll implementieren.</span><span class="sxs-lookup"><span data-stu-id="4f105-142">Physically, the sequence of log records is stored efficiently in the set of physical files that implement the transaction log.</span></span> <span data-ttu-id="4f105-143">Für jede Datenbank muss mindestens eine Protokolldatei vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="4f105-143">There must be at least one log file for each database.</span></span>  
  
 <span data-ttu-id="4f105-144">[!INCLUDE[ssDEnoversion](../includes/ssdenoversion-md.md)] teilt jede physische Protokolldatei intern in mehrere virtuelle Protokolldateien auf.</span><span class="sxs-lookup"><span data-stu-id="4f105-144">The [!INCLUDE[ssDEnoversion](../includes/ssdenoversion-md.md)] divides each physical log file internally into a number of virtual log files.</span></span> <span data-ttu-id="4f105-145">Virtuelle Protokolldateien haben keine feste Größe, und es gibt keine feststehende Anzahl virtueller Protokolldateien für eine physische Protokolldatei.</span><span class="sxs-lookup"><span data-stu-id="4f105-145">Virtual log files have no fixed size, and there is no fixed number of virtual log files for a physical log file.</span></span> <span data-ttu-id="4f105-146">[!INCLUDE[ssDE](../includes/ssde-md.md)] wählt die Größe der virtuellen Protokolldateien dynamisch beim Erstellen oder Erweitern von Protokolldateien aus.</span><span class="sxs-lookup"><span data-stu-id="4f105-146">The [!INCLUDE[ssDE](../includes/ssde-md.md)] chooses the size of the virtual log files dynamically while it is creating or extending log files.</span></span> <span data-ttu-id="4f105-147">[!INCLUDE[ssDE](../includes/ssde-md.md)] versucht, immer nur eine kleine Anzahl virtueller Dateien aufrechtzuerhalten.</span><span class="sxs-lookup"><span data-stu-id="4f105-147">The [!INCLUDE[ssDE](../includes/ssde-md.md)] tries to maintain a small number of virtual files.</span></span> <span data-ttu-id="4f105-148">Welche Größe die virtuellen Dateien haben, nachdem eine Protokolldatei erweitert wurde, hängt von der zusammengenommenen Größe des vorhandenen Protokolls und dem Umfang der Dateierweiterung ab.</span><span class="sxs-lookup"><span data-stu-id="4f105-148">The size of the virtual files after a log file has been extended is the sum of the size of the existing log and the size of the new file increment.</span></span> <span data-ttu-id="4f105-149">Die Größe oder Anzahl der virtuellen Protokolldateien kann nicht von Administratoren konfiguriert oder festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="4f105-149">The size or number of virtual log files cannot be configured or set by administrators.</span></span>  
  
 <span data-ttu-id="4f105-150">Virtuelle Protokolldateien wirken sich nur dann auf die Systemleistung aus, wenn die physischen Protokolldateien mit geringen Werten für *size* und *growth_increment* definiert sind.</span><span class="sxs-lookup"><span data-stu-id="4f105-150">The only time virtual log files affect system performance is if the physical log files are defined by small *size* and *growth_increment* values.</span></span> <span data-ttu-id="4f105-151">Der *size* -Wert entspricht der Anfangsgröße der Protokolldatei und der *growth_increment* -Wert der Menge von Speicherplatz, die der Datei immer dann hinzugefügt wird, wenn neuer Speicherplatz erforderlich wird.</span><span class="sxs-lookup"><span data-stu-id="4f105-151">The *size* value is the initial size for the log file and the *growth_increment* value is the amount of space added to the file every time new space is required.</span></span> <span data-ttu-id="4f105-152">Wenn die Protokolldateien durch viele kleine Schritte auf eine beträchtliche Größe anwachsen, enthalten sie zahlreiche virtuelle Protokolldateien.</span><span class="sxs-lookup"><span data-stu-id="4f105-152">If the log files grow to a large size because of many small increments, they will have many virtual log files.</span></span> <span data-ttu-id="4f105-153">Hierdurch werden möglicherweise das Starten der Datenbank sowie Protokollsicherungs- und -wiederherstellungsvorgänge verlangsamt.</span><span class="sxs-lookup"><span data-stu-id="4f105-153">This can slow down database startup and also log backup and restore operations.</span></span> <span data-ttu-id="4f105-154">Es wird empfohlen, den Protokolldateien einen *size*-Wert zuzuweisen, der ungefähr der endgültigen erforderlichen Größe entspricht, und darüber hinaus einen relativ hohen Wert für *growth_increment* festzulegen.</span><span class="sxs-lookup"><span data-stu-id="4f105-154">We recommend that you assign log files a *size* value close to the final size required, and also have a relatively large *growth_increment* value.</span></span> <span data-ttu-id="4f105-155">Weitere Informationen zu diesen Parametern finden Sie unter [ALTER DATABASE-Optionen für Dateien und Dateigruppen &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql-file-and-filegroup-options).</span><span class="sxs-lookup"><span data-stu-id="4f105-155">For more information about these parameters, see [ALTER DATABASE File and Filegroup Options &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql-file-and-filegroup-options).</span></span>  
  
 <span data-ttu-id="4f105-156">Das Transaktionsprotokoll ist eine umbrechende Protokolldatei.</span><span class="sxs-lookup"><span data-stu-id="4f105-156">The transaction log is a wrap-around file.</span></span> <span data-ttu-id="4f105-157">Nehmen Sie beispielsweise an, eine Datenbank verfügt über eine physische Protokolldatei, die in vier virtuelle Protokolldateien unterteilt ist.</span><span class="sxs-lookup"><span data-stu-id="4f105-157">For example, consider a database with one physical log file divided into four virtual log files.</span></span> <span data-ttu-id="4f105-158">Wenn die Datenbank erstellt wird, beginnt die logische Protokolldatei am Anfang der ersten physischen Protokolldatei.</span><span class="sxs-lookup"><span data-stu-id="4f105-158">When the database is created, the logical log file begins at the start of the physical log file.</span></span> <span data-ttu-id="4f105-159">Neue Protokolldatensätze werden am Ende des logischen Protokolls hinzugefügt, das in Richtung des Endes des physischen Protokolls erweitert wird.</span><span class="sxs-lookup"><span data-stu-id="4f105-159">New log records are added at the end of the logical log and expand toward the end of the physical log.</span></span> <span data-ttu-id="4f105-160">Beim Abschneiden eines Protokolls werden alle virtuellen Protokolle freigegeben, deren Datensätze sich ohne Ausnahme vor der Mindestwiederherstellungs-Protokollfolgenummer (Minimum Recovery Log Sequence Number, MinLSN) befinden.</span><span class="sxs-lookup"><span data-stu-id="4f105-160">Log truncation frees any virtual logs whose records all appear in front of the minimum recovery log sequence number (MinLSN).</span></span> <span data-ttu-id="4f105-161">*MinLSN* ist die Protokollfolgenummer des ältesten Protokolldatensatzes, der für einen erfolgreichen Rollback der gesamten Datenbank benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="4f105-161">The *MinLSN* is the log sequence number of the oldest log record that is required for a successful database-wide rollback.</span></span> <span data-ttu-id="4f105-162">Das Transaktionsprotokoll in der Beispieldatenbank würde in etwa so aussehen wie das Protokoll in der folgenden Abbildung.</span><span class="sxs-lookup"><span data-stu-id="4f105-162">The transaction log in the example database would look similar to the one in the following illustration.</span></span>  
  
 <span data-ttu-id="4f105-163">![Protokolldatei unterteilt in vier virtuelle Protokolldateien](media/tranlog3.gif "Protokolldatei unterteilt in vier virtuelle Protokolldateien")</span><span class="sxs-lookup"><span data-stu-id="4f105-163">![Log file divided into four virtual log files](media/tranlog3.gif "Log file divided into four virtual log files")</span></span>  
  
 <span data-ttu-id="4f105-164">Wenn das Ende des logischen Protokolls das Ende der physischen Protokolldatei erreicht, erfolgt ein Umbruch, und neue Protokolldatensätze werden nun wieder am Anfang der physischen Protokolldatei eingefügt.</span><span class="sxs-lookup"><span data-stu-id="4f105-164">When the end of the logical log reaches the end of the physical log file, the new log records wrap around to the start of the physical log file.</span></span>  
  
 <span data-ttu-id="4f105-165">![Protokolleinträge werden wieder am Anfang der Protokolldatei eingefügt](media/tranlog4.gif "Protokolleinträge werden wieder am Anfang der Protokolldatei eingefügt")</span><span class="sxs-lookup"><span data-stu-id="4f105-165">![Log records wrap around to start of log file](media/tranlog4.gif "Log records wrap around to start of log file")</span></span>  
  
 <span data-ttu-id="4f105-166">Solange das Ende des logischen Protokolls nicht den Anfang des logischen Protokolls erreicht, wird dieser Kreislauf endlos wiederholt.</span><span class="sxs-lookup"><span data-stu-id="4f105-166">This cycle repeats endlessly, as long as the end of the logical log never reaches the beginning of the logical log.</span></span> <span data-ttu-id="4f105-167">Wenn die alten Protokolldatensätze häufig genug abgeschnitten werden, um ausreichend Platz für alle neuen Protokolldatensätze freizugeben, die bis zum nächsten Prüfpunkt erstellt werden, wird das Protokoll nie vollständig aufgefüllt.</span><span class="sxs-lookup"><span data-stu-id="4f105-167">If the old log records are truncated frequently enough to always leave sufficient room for all the new log records created through the next checkpoint, the log never fills.</span></span> <span data-ttu-id="4f105-168">Wenn das Ende des logischen Protokolls jedoch den Anfang des logischen Protokolls erreicht, wird eine der beiden folgenden Aktionen eingeleitet:</span><span class="sxs-lookup"><span data-stu-id="4f105-168">However, if the end of the logical log does reach the start of the logical log, one of two things occurs:</span></span>  
  
-   <span data-ttu-id="4f105-169">Wenn die FILEGROWTH-Einstellung für das Protokoll aktiviert und auf dem Datenträger Speicherplatz verfügbar ist, wird die Datei um die Menge vergrößert, die im *growth_increment*-Parameter angegeben ist, und der Erweiterung werden neue Protokolldatensätze hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="4f105-169">If the FILEGROWTH setting is enabled for the log and space is available on the disk, the file is extended by the amount specified in the *growth_increment* parameter and the new log records are added to the extension.</span></span> <span data-ttu-id="4f105-170">Weitere Informationen zur FILEGROWTH-Einstellung finden Sie unter [ALTER DATABASE-Optionen für Dateien und Dateigruppen &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql-file-and-filegroup-options).</span><span class="sxs-lookup"><span data-stu-id="4f105-170">For more information about the FILEGROWTH setting, see [ALTER DATABASE File and Filegroup Options &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql-file-and-filegroup-options).</span></span>  
  
-   <span data-ttu-id="4f105-171">Wenn die FILEGROWTH-Einstellung nicht aktiviert ist oder der Datenträger mit der Protokolldatei über weniger freien Speicherplatz verfügt als in *growth_increment* angegeben, wird der Fehler 9002 generiert.</span><span class="sxs-lookup"><span data-stu-id="4f105-171">If the FILEGROWTH setting is not enabled, or the disk that is holding the log file has less free space than the amount specified in *growth_increment*, an 9002 error is generated.</span></span>  
  
 <span data-ttu-id="4f105-172">Wenn das Protokoll mehrere physische Protokolldateien enthält, durchläuft das logische Protokoll alle physischen Protokolldateien, bevor es umbricht und neue Einträge am Anfang der ersten physischen Protokolldatei einfügt.</span><span class="sxs-lookup"><span data-stu-id="4f105-172">If the log contains multiple physical log files, the logical log will move through all the physical log files before it wraps back to the start of the first physical log file.</span></span>  
  
### <a name="log-truncation"></a><span data-ttu-id="4f105-173">Protokollkürzung</span><span class="sxs-lookup"><span data-stu-id="4f105-173">Log Truncation</span></span>  

 <span data-ttu-id="4f105-174">Die Protokollkürzung ist wichtig, um ein Auffüllen des Protokolls verhindern zu können.</span><span class="sxs-lookup"><span data-stu-id="4f105-174">Log truncation is essential to keep the log from filling.</span></span> <span data-ttu-id="4f105-175">Durch die Protokollkürzung werden inaktive virtuelle Protokolldateien aus dem logischen Transaktionsprotokoll einer [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] -Datenbank gelöscht, wodurch Speicherplatz im logischen Protokoll zur Wiederverwendung durch das physische Transaktionsprotokoll freigegeben wird.</span><span class="sxs-lookup"><span data-stu-id="4f105-175">Log truncation deletes inactive virtual log files from the logical transaction log of a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] database, freeing space in the logical log for reuse by the physical transaction log.</span></span> <span data-ttu-id="4f105-176">Wird ein Transaktionsprotokoll nicht gekürzt, füllt sich dadurch möglicherweise der gesamte Speicherplatz des Datenträgers auf, der den zugehörigen physischen Protokolldateien zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="4f105-176">If a transaction log were never truncated, it would eventually fill all the disk space that is allocated to its physical log files.</span></span> <span data-ttu-id="4f105-177">Bevor das Protokoll jedoch gekürzt werden kann, ist ein Prüfpunktvorgang erforderlich.</span><span class="sxs-lookup"><span data-stu-id="4f105-177">However, before the log can be truncated, a checkpoint operation must occur.</span></span> <span data-ttu-id="4f105-178">Durch einen Prüfpunktvorgang werden die aktuellen, im Arbeitsspeicher geänderten Seiten (auch als modifizierte Seiten bezeichnet) sowie Transaktionsprotokollinformationen vom Arbeitsspeicher auf den Datenträger geschrieben.</span><span class="sxs-lookup"><span data-stu-id="4f105-178">A checkpoint writes the current in-memory modified pages (known as dirty pages) and transaction log information from memory to disk.</span></span> <span data-ttu-id="4f105-179">Beim Ausführen des Prüfpunkts wird der inaktive Teil des Transaktionsprotokolls als wiederverwendbar markiert.</span><span class="sxs-lookup"><span data-stu-id="4f105-179">When the checkpoint is performed, the inactive portion of the transaction log is marked as reusable.</span></span> <span data-ttu-id="4f105-180">Anschließend kann der inaktive Teil durch Abschneiden des Protokolls freigegeben werden.</span><span class="sxs-lookup"><span data-stu-id="4f105-180">Thereafter, the inactive portion can be freed by log truncation.</span></span> <span data-ttu-id="4f105-181">Weitere Informationen zu Prüfpunkten finden Sie unter [Datenbankprüfpunkte &#40;SQL Server&#41;](../relational-databases/logs/database-checkpoints-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="4f105-181">For more information about checkpoints, see [Database Checkpoints &#40;SQL Server&#41;](../relational-databases/logs/database-checkpoints-sql-server.md).</span></span>  
  
 <span data-ttu-id="4f105-182">Die folgenden Abbildungen zeigen ein Transaktionsprotokoll vor und nach dem Abschneiden.</span><span class="sxs-lookup"><span data-stu-id="4f105-182">The following illustrations show a transaction log before and after truncation.</span></span> <span data-ttu-id="4f105-183">In der ersten Abbildung wird ein Transaktionsprotokoll gezeigt, das noch nie abgeschnitten wurde.</span><span class="sxs-lookup"><span data-stu-id="4f105-183">The first illustration shows a transaction log that has never been truncated.</span></span> <span data-ttu-id="4f105-184">Aktuell verwendet das logische Protokoll vier virtuelle Protokolldateien.</span><span class="sxs-lookup"><span data-stu-id="4f105-184">Currently, four virtual log files are in use by the logical log.</span></span> <span data-ttu-id="4f105-185">Das logische Protokoll beginnt am Anfang der ersten virtuellen Protokolldatei und endet beim virtuellen Protokoll 4.</span><span class="sxs-lookup"><span data-stu-id="4f105-185">The logical log starts at the front of the first virtual log file and ends at virtual log 4.</span></span> <span data-ttu-id="4f105-186">Der MinLSN-Datensatz befindet sich im virtuellen Protokoll 3.</span><span class="sxs-lookup"><span data-stu-id="4f105-186">The MinLSN record is in virtual log 3.</span></span> <span data-ttu-id="4f105-187">Das virtuelle Protokoll 1 und das virtuelle Protokoll 2 enthalten nur inaktive Protokolldatensätze.</span><span class="sxs-lookup"><span data-stu-id="4f105-187">Virtual log 1 and virtual log 2 contain only inactive log records.</span></span> <span data-ttu-id="4f105-188">Diese Datensätze können abgeschnitten werden.</span><span class="sxs-lookup"><span data-stu-id="4f105-188">These records can be truncated.</span></span> <span data-ttu-id="4f105-189">Das virtuelle Protokoll 5 wurde noch nicht verwendet und ist nicht Teil des aktuellen logischen Protokolls.</span><span class="sxs-lookup"><span data-stu-id="4f105-189">Virtual log 5 is still unused and is not part of the current logical log.</span></span>  
  
 <span data-ttu-id="4f105-190">![Transaktionsprotokoll mit vier virtuellen Protokollen](media/tranlog2.gif "Transaktionsprotokoll mit vier virtuellen Protokollen")</span><span class="sxs-lookup"><span data-stu-id="4f105-190">![Transaction log with four virtual logs](media/tranlog2.gif "Transaction log with four virtual logs")</span></span>  
  
 <span data-ttu-id="4f105-191">Die zweite Abbildung zeigt das Protokoll, nachdem es abgeschnitten wurde.</span><span class="sxs-lookup"><span data-stu-id="4f105-191">The second illustration shows how the log appears after being truncated.</span></span> <span data-ttu-id="4f105-192">Die virtuellen Protokolle 1 und 2 wurden für die Wiederverwendung freigegeben.</span><span class="sxs-lookup"><span data-stu-id="4f105-192">Virtual log 1 and virtual log 2 have been freed for reuse.</span></span> <span data-ttu-id="4f105-193">Das logische Protokoll beginnt nun am Anfang des virtuellen Protokolls 3.</span><span class="sxs-lookup"><span data-stu-id="4f105-193">The logical log now starts at the beginning of virtual log 3.</span></span> <span data-ttu-id="4f105-194">Das virtuelle Protokoll 5 wurde noch nicht verwendet und ist nicht Teil des aktuellen logischen Protokolls.</span><span class="sxs-lookup"><span data-stu-id="4f105-194">Virtual log 5 is still unused, and it is not part of the current logical log.</span></span>  
  
 <span data-ttu-id="4f105-195">![Protokolldatei unterteilt in vier virtuelle Protokolldateien](media/tranlog3.gif "Protokolldatei unterteilt in vier virtuelle Protokolldateien")</span><span class="sxs-lookup"><span data-stu-id="4f105-195">![Log file divided into four virtual log files](media/tranlog3.gif "Log file divided into four virtual log files")</span></span>  
  
 <span data-ttu-id="4f105-196">Die Protokollkürzung erfolgt automatisch wie folgt, außer es tritt aus irgendeinem Grund eine Verzögerung auf:</span><span class="sxs-lookup"><span data-stu-id="4f105-196">Log truncation occurs automatically after the following events, except when delayed for some reason:</span></span>  
  
-   <span data-ttu-id="4f105-197">Unter dem einfachen Wiederherstellungsmodell, nach einem Prüfpunkt.</span><span class="sxs-lookup"><span data-stu-id="4f105-197">Under the simple recovery model, after a checkpoint.</span></span>  
  
-   <span data-ttu-id="4f105-198">Unter dem vollständigen oder massenprotokollierten Wiederherstellungsmodell, nach einer Protokollsicherung, wenn seit der vorherigen Sicherung ein Prüfpunkt aufgetreten ist.</span><span class="sxs-lookup"><span data-stu-id="4f105-198">Under the full recovery model or bulk-logged recovery model, after a log backup, if a checkpoint has occurred since the previous backup.</span></span>  
  
 <span data-ttu-id="4f105-199">Die Protokollkürzung kann durch verschiedene Faktoren verzögert werden.</span><span class="sxs-lookup"><span data-stu-id="4f105-199">Log truncation can be delayed by a variety of factors.</span></span> <span data-ttu-id="4f105-200">Im Falle einer langen Verzögerung der Protokollkürzung kann sich das Transaktionsprotokoll füllen.</span><span class="sxs-lookup"><span data-stu-id="4f105-200">In the event of a long delay in log truncation, the transaction log can fill up.</span></span> <span data-ttu-id="4f105-201">Weitere Informationen finden Sie unter [Faktoren, die das Abschneiden von Protokollen verzögern können](../relational-databases/logs/the-transaction-log-sql-server.md#FactorsThatDelayTruncation) und Problembehandlung für [ein vollständiges Transaktionsprotokoll &#40;SQL Server Fehler 9002&#41;](../relational-databases/logs/troubleshoot-a-full-transaction-log-sql-server-error-9002.md).</span><span class="sxs-lookup"><span data-stu-id="4f105-201">For information, see [Factors That Can Delay Log Truncation](../relational-databases/logs/the-transaction-log-sql-server.md#FactorsThatDelayTruncation) and [Troubleshoot a Full Transaction Log &#40;SQL Server Error 9002&#41;](../relational-databases/logs/troubleshoot-a-full-transaction-log-sql-server-error-9002.md).</span></span>  
  
##  <a name="write-ahead-transaction-log"></a><a name="WAL"></a><span data-ttu-id="4f105-202">Write-Ahead-Transaktionsprotokoll</span><span class="sxs-lookup"><span data-stu-id="4f105-202">Write-Ahead Transaction Log</span></span>  

 <span data-ttu-id="4f105-203">In diesem Abschnitt wird die Aufgabe des Write-Ahead-Transaktionsprotokolls beim Aufzeichnen von Datenänderungen auf dem Datenträger beschrieben.</span><span class="sxs-lookup"><span data-stu-id="4f105-203">This section describes the role of the write-ahead transaction log in recording data modifications to disk.</span></span> [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="4f105-204">verwendet ein Write-Ahead-Protokoll, durch das sichergestellt wird, dass Datenänderungen erst dann auf den Datenträger geschrieben werden, nachdem der entsprechende Protokolldatensatz auf den Datenträger geschrieben wurde.</span><span class="sxs-lookup"><span data-stu-id="4f105-204">uses a write-ahead log (WAL), which guarantees that no data modifications are written to disk before the associated log record is written to disk.</span></span> <span data-ttu-id="4f105-205">Dies schützt die ACID-Eigenschaften einer Transaktion.</span><span class="sxs-lookup"><span data-stu-id="4f105-205">This maintains the ACID properties for a transaction.</span></span>  
  
 <span data-ttu-id="4f105-206">Um die Funktionsweise des Write-Ahead-Protokolls zu verstehen, müssen Sie zunächst wissen, wie geänderte Daten auf den Datenträger geschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="4f105-206">To understand how the write-ahead log works, it is important for you to know how modified data is written to disk.</span></span> [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="4f105-207">verwaltet einen Puffercache, in den Datenseiten gelesen werden, wenn Daten abgerufen werden müssen.</span><span class="sxs-lookup"><span data-stu-id="4f105-207">maintains a buffer cache into which it reads data pages when data must be retrieved.</span></span> <span data-ttu-id="4f105-208">Wenn eine Seite im Puffer Cache geändert wird, wird Sie nicht sofort auf den Datenträger zurückgeschrieben. Stattdessen wird die *Seite als geändert*markiert.</span><span class="sxs-lookup"><span data-stu-id="4f105-208">When a page is modified in the buffer cache, it is not immediately written back to disk; instead, the page is marked as *dirty*.</span></span> <span data-ttu-id="4f105-209">Auf einer Datenseite können mehrere logische Schreibvorgänge ausgeführt werden, bevor sie physisch auf den Datenträger geschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="4f105-209">A data page can have more than one logical write made before it is physically written to disk.</span></span> <span data-ttu-id="4f105-210">Für jeden logischen Schreibvorgang wird ein Transaktionsprotokoll-Datensatz in den Protokollcache geschrieben, der die Änderung aufzeichnet.</span><span class="sxs-lookup"><span data-stu-id="4f105-210">For each logical write, a transaction log record is inserted in the log cache that records the modification.</span></span> <span data-ttu-id="4f105-211">Die Protokolldatensätze müssen auf den Datenträger geschrieben werden, bevor die zugehörige modifizierte Seite aus dem Puffercache entfernt und auf den Datenträger geschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="4f105-211">The log records must be written to disk before the associated dirty page is removed from the buffer cache and written to disk.</span></span> <span data-ttu-id="4f105-212">Mit dem Prüfpunktprozess (checkpoint) wird der Puffercache regelmäßig auf Puffer mit Seiten aus einer angegebenen Datenbank überprüft, und alle modifizierten Seiten werden auf den Datenträger geschrieben.</span><span class="sxs-lookup"><span data-stu-id="4f105-212">The checkpoint process periodically scans the buffer cache for buffers with pages from a specified database and writes all dirty pages to disk.</span></span> <span data-ttu-id="4f105-213">Durch Prüfpunkte kann bei einer späteren Wiederherstellung Zeit eingespart werden, da ein Punkt erstellt wird, an dem auf jeden Fall alle modifizierten Seiten auf den Datenträger geschrieben worden sind.</span><span class="sxs-lookup"><span data-stu-id="4f105-213">Checkpoints save time during a later recovery by creating a point at which all dirty pages are guaranteed to have been written to disk.</span></span>  
  
 <span data-ttu-id="4f105-214">Wird eine geänderte Datenseite aus dem Puffercache auf den Datenträger geschrieben, wird dies als Leeren der Seite bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="4f105-214">Writing a modified data page from the buffer cache to disk is called flushing the page.</span></span> [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="4f105-215">Durch die Logik von wird verhindert, dass eine geänderte Seite geleert wird, bevor der zugehörige Protokolldatensatz geschrieben wurde.</span><span class="sxs-lookup"><span data-stu-id="4f105-215">has logic that prevents a dirty page from being flushed before the associated log record is written.</span></span> <span data-ttu-id="4f105-216">Protokolldatensätze werden auf den Datenträger geschrieben, wenn ein Commit für die Transaktionen ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="4f105-216">Log records are written to disk when the transactions are committed.</span></span>  
  
##  <a name="transaction-log-backups"></a><a name="Backups"></a><span data-ttu-id="4f105-217">Transaktionsprotokoll Sicherungen</span><span class="sxs-lookup"><span data-stu-id="4f105-217">Transaction Log Backups</span></span>  

 <span data-ttu-id="4f105-218">In diesem Abschnitt werden Konzepte zum Sichern und Wiederherstellen (Anwenden) von Transaktionsprotokollen vorgestellt.</span><span class="sxs-lookup"><span data-stu-id="4f105-218">This section presents concepts about how to back up and restore (apply) transaction logs.</span></span> <span data-ttu-id="4f105-219">Beim vollständigen und beim massenprotokollierten Wiederherstellungsmodell müssen zur Wiederherstellung von Daten routinemäßige Sicherungen der Transaktionsprotokolle (*Protokollsicherungen*) ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="4f105-219">Under the full and bulk-logged recovery models, taking routine backups of transaction logs (*log backups*) is necessary for recovering data.</span></span> <span data-ttu-id="4f105-220">Sie können das Protokoll sichern, während eine vollständige Sicherung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="4f105-220">You can back up the log while any full backup is running.</span></span> <span data-ttu-id="4f105-221">Weitere Informationen zu Wiederherstellungsmodellen finden Sie unter [Sichern und Wiederherstellen von SQL Server-Datenbanken](../relational-databases/backup-restore/back-up-and-restore-of-sql-server-databases.md).</span><span class="sxs-lookup"><span data-stu-id="4f105-221">For more information about recovery models, see [Back Up and Restore of SQL Server Databases](../relational-databases/backup-restore/back-up-and-restore-of-sql-server-databases.md).</span></span>  
  
 <span data-ttu-id="4f105-222">Bevor Sie die erste Protokollsicherung erstellen können, müssen Sie eine vollständige Sicherung erstellen, z. B. eine Datenbanksicherung oder die erste von mehreren Dateisicherungen.</span><span class="sxs-lookup"><span data-stu-id="4f105-222">Before you can create the first log backup, you must create a full backup, such as a database backup or the first in a set of file backups.</span></span> <span data-ttu-id="4f105-223">Die Wiederherstellung einer Datenbank, für die nur Dateisicherungen verwendet werden, kann komplex werden.</span><span class="sxs-lookup"><span data-stu-id="4f105-223">Restoring a database by using only file backups can become complex.</span></span> <span data-ttu-id="4f105-224">Deshalb wird empfohlen, wenn möglich mit einer vollständigen Datenbanksicherung zu beginnen.</span><span class="sxs-lookup"><span data-stu-id="4f105-224">Therefore, we recommend that you start with a full database backup when you can.</span></span> <span data-ttu-id="4f105-225">Anschließend ist das regelmäßige Sichern des Transaktionsprotokolls erforderlich.</span><span class="sxs-lookup"><span data-stu-id="4f105-225">Thereafter, backing up the transaction log regularly is necessary.</span></span> <span data-ttu-id="4f105-226">Dadurch wird nicht nur die Gefahr von Datenverlusten minimiert, sondern es wird auch die Kürzung des Transaktionsprotokolls ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="4f105-226">This not only minimizes work-loss exposure but also enables truncation of the transaction log.</span></span> <span data-ttu-id="4f105-227">Üblicherweise wird das Transaktionsprotokoll nach jeder konventionellen Protokollsicherung abgeschnitten.</span><span class="sxs-lookup"><span data-stu-id="4f105-227">Typically, the transaction log is truncated after every conventional log backup.</span></span>  
  
 <span data-ttu-id="4f105-228">Es wird empfohlen, entsprechend Ihren Geschäftsanforderungen ausreichend häufige Protokollsicherungen auszuführen. Die Häufigkeit sollte sich danach richten, inwiefern Sie Datenverlust (beispielsweise durch ein beschädigtes Protokolllaufwerk) tolerieren können.</span><span class="sxs-lookup"><span data-stu-id="4f105-228">We recommend taking frequent enough log backups to support your business requirements, specifically your tolerance for work loss such as might be caused by a damaged log drive.</span></span> <span data-ttu-id="4f105-229">Beim Festlegen einer geeigneten Häufigkeit gilt es, einen Kompromiss aus Ihrer Toleranz gegenüber der Gefahr von Datenverlust und Ihrer Fähigkeit zum Speichern, Verwalten und zum möglichen Wiederherstellen von Protokollsicherungen zu finden.</span><span class="sxs-lookup"><span data-stu-id="4f105-229">The appropriate frequency for taking log backups depends on your tolerance for work-loss exposure balanced by how many log backups you can store, manage, and, potentially, restore.</span></span> <span data-ttu-id="4f105-230">Es kann ausreichen, alle 15 bis 30 Minuten eine Protokollsicherung auszuführen.</span><span class="sxs-lookup"><span data-stu-id="4f105-230">Taking a log backup every 15 to 30 minutes might be enough.</span></span> <span data-ttu-id="4f105-231">Wenn es für Ihr Geschäft erforderlich ist, die Gefahr des Datenverlusts zu minimieren, können Sie Protokollsicherungen häufiger ausführen.</span><span class="sxs-lookup"><span data-stu-id="4f105-231">If your business requires that you minimize work-loss exposure, consider taking log backups more frequently.</span></span> <span data-ttu-id="4f105-232">Häufigere Protokollsicherungen bieten zusätzlich den Vorteil, dass das Protokoll häufiger abgeschnitten wird, wodurch kleinere Protokolldateien entstehen.</span><span class="sxs-lookup"><span data-stu-id="4f105-232">More frequent log backups have the added advantage of increasing the frequency of log truncation, resulting in smaller log files.</span></span>  
  
 <span data-ttu-id="4f105-233">Um die Anzahl der zum Wiederherstellen benötigten Protokollsicherungen zu begrenzen, ist es wichtig, Daten regelmäßig zu sichern.</span><span class="sxs-lookup"><span data-stu-id="4f105-233">To limit the number of log backups that you need to restore, it is essential to routinely back up your data.</span></span> <span data-ttu-id="4f105-234">Beispielsweise können Sie eine wöchentliche vollständige Datenbanksicherung und tägliche differenzielle Datenbanksicherungen planen.</span><span class="sxs-lookup"><span data-stu-id="4f105-234">For example, you might schedule a weekly full database backup and daily differential database backups.</span></span>  
  
### <a name="the-log-chain"></a><span data-ttu-id="4f105-235">Die Protokollkette</span><span class="sxs-lookup"><span data-stu-id="4f105-235">The Log Chain</span></span>  

 <span data-ttu-id="4f105-236">Eine fortlaufende Sequenz von Protokoll Sicherungen wird als *Protokoll Kette*bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="4f105-236">A continuous sequence of log backups is called a *log chain*.</span></span> <span data-ttu-id="4f105-237">Eine Protokollkette beginnt mit einer vollständigen Sicherung der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="4f105-237">A log chain starts with a full backup of the database.</span></span> <span data-ttu-id="4f105-238">Gewöhnlich wird eine neue Protokollkette nur gestartet, wenn die Datenbank zum ersten Mal gesichert wird oder wenn vom einfachen zum vollständigen oder massenprotokollierten Wiederherstellungsmodell gewechselt wird.</span><span class="sxs-lookup"><span data-stu-id="4f105-238">Usually, a new log chain is only started when the database is backed up for the first time or after the recovery model is switched from simple recovery to full or bulk-logged recovery.</span></span> <span data-ttu-id="4f105-239">Die bestehende Protokollkette bleibt intakt, es sei denn, Sie überschreiben beim Erstellen einer vollständigen Datenbanksicherung bestehende Sicherungssätze.</span><span class="sxs-lookup"><span data-stu-id="4f105-239">Unless you choose to overwrite existing backup sets when creating a full database backup, the existing log chain remains intact.</span></span> <span data-ttu-id="4f105-240">Mit einer intakten Protokollkette können Sie Ihre Datenbank aus einer beliebigen vollständigen Datenbanksicherung im Mediensatz wiederherstellen, gefolgt von allen weiteren Protokollsicherungen bis zum Wiederherstellungspunkt.</span><span class="sxs-lookup"><span data-stu-id="4f105-240">With the log chain intact, you can restore your database from any full database backup in the media set, followed by all subsequent log backups up through your recovery point.</span></span> <span data-ttu-id="4f105-241">Der Wiederherstellungspunkt kann das Ende der letzten Protokollsicherung oder ein bestimmter Wiederherstellungspunkt in einer beliebigen Protokollsicherung sein.</span><span class="sxs-lookup"><span data-stu-id="4f105-241">The recovery point could be the end of the last log backup or a specific recovery point in any of the log backups.</span></span> <span data-ttu-id="4f105-242">Weitere Informationen finden Sie unter [Transaktionsprotokollsicherungen &#40;SQL Server&#41;](../relational-databases/backup-restore/transaction-log-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="4f105-242">For more information, see [Transaction Log Backups &#40;SQL Server&#41;](../relational-databases/backup-restore/transaction-log-backups-sql-server.md).</span></span>  
  
 <span data-ttu-id="4f105-243">Um eine Datenbank bis zu dem Punkt, an dem ein Fehler aufgetreten ist, wiederherzustellen, muss die Protokollkette intakt sein.</span><span class="sxs-lookup"><span data-stu-id="4f105-243">To restore a database up to the point of failure, the log chain must be intact.</span></span> <span data-ttu-id="4f105-244">Das heißt, eine ununterbrochene Sequenz von Transaktionsprotokollsicherungen muss sich bis zum Zeitpunkt des Fehlers erstrecken.</span><span class="sxs-lookup"><span data-stu-id="4f105-244">That is, an unbroken sequence of transaction log backups must extend up to the point of failure.</span></span> <span data-ttu-id="4f105-245">Wo diese Protokollsequenz anfangen muss, richtet sich nach dem Typ der Datensicherungen, die Sie wiederherstellen: Datenbank-, Teil- oder Dateisicherung.</span><span class="sxs-lookup"><span data-stu-id="4f105-245">Where this sequence of log must start depends on the type of data backups you are restoring: database, partial, or file.</span></span> <span data-ttu-id="4f105-246">Bei einer Datenbank- oder Teilsicherung muss die Sequenz der Protokollsicherungen am Ende einer Datenbank- oder Teilsicherung beginnen.</span><span class="sxs-lookup"><span data-stu-id="4f105-246">For a database or partial backup, the sequence of log backups must extend from the end of a database or partial backup.</span></span> <span data-ttu-id="4f105-247">Bei einer Gruppe von Dateisicherungen muss die Sequenz der Protokollsicherungen mit dem Anfang einer vollständigen Gruppe von Dateisicherungen beginnen.</span><span class="sxs-lookup"><span data-stu-id="4f105-247">For a set of file backups, the sequence of log backups must extend from the start of a full set of file backups.</span></span> <span data-ttu-id="4f105-248">Weitere Informationen finden Sie unter [Anwenden von Transaktionsprotokollsicherungen &#40;SQL Server&#41;](../relational-databases/backup-restore/apply-transaction-log-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="4f105-248">For more information, see [Apply Transaction Log Backups &#40;SQL Server&#41;](../relational-databases/backup-restore/apply-transaction-log-backups-sql-server.md).</span></span>  
  
### <a name="restore-log-backups"></a><span data-ttu-id="4f105-249">Wiederherstellen von Protokollsicherungen</span><span class="sxs-lookup"><span data-stu-id="4f105-249">Restore Log Backups</span></span>  

 <span data-ttu-id="4f105-250">Beim Wiederherstellen einer Protokollsicherung wird ein Rollforward für die im Transaktionsprotokoll aufgezeichneten Änderungen ausgeführt, um den genauen Zustand der Datenbank zu dem Zeitpunkt, als der Protokollsicherungsvorgang gestartet wurde, wiederherzustellen.</span><span class="sxs-lookup"><span data-stu-id="4f105-250">Restoring a log backup rolls forward the changes that were recorded in the transaction log to re-create the exact state of the database at the time the log backup operation started.</span></span> <span data-ttu-id="4f105-251">Wenn Sie eine Datenbank wiederherstellen, müssen Sie die Protokollsicherungen wiederherstellen, die nach der vollständigen Datenbanksicherung erstellt wurden, die Sie wiederherstellen, oder die Protokollsicherungen ab dem Start der ersten Dateisicherung, die Sie wiederherstellen.</span><span class="sxs-lookup"><span data-stu-id="4f105-251">When you restore a database, you will have to restore the log backups that were created after the full database backup that you restore, or from the start of the first file backup that you restore.</span></span> <span data-ttu-id="4f105-252">Nach dem Wiederherstellen der aktuellsten Daten oder der aktuellsten differenziellen Sicherung müssen Sie normalerweise eine Reihe von Protokollsicherungen wiederherstellen, bis Sie den Wiederherstellungspunkt erreichen.</span><span class="sxs-lookup"><span data-stu-id="4f105-252">Typically, after you restore the most recent data or differential backup, you must restore a series of log backups until you reach your recovery point.</span></span> <span data-ttu-id="4f105-253">Dann stellen Sie die Datenbank wieder her.</span><span class="sxs-lookup"><span data-stu-id="4f105-253">Then, you recover the database.</span></span> <span data-ttu-id="4f105-254">Dabei wird ein Rollback aller Transaktionen ausgeführt, die beim Start der Wiederherstellung unvollständig waren, und die Datenbank wird online geschaltet.</span><span class="sxs-lookup"><span data-stu-id="4f105-254">This rolls back all transactions that were incomplete when the recovery started and brings the database online.</span></span> <span data-ttu-id="4f105-255">Nach der Wiederherstellung der Datenbank können keine weiteren Sicherungen wiederhergestellt werden.</span><span class="sxs-lookup"><span data-stu-id="4f105-255">After the database has been recovered, you cannot restore any more backups.</span></span> <span data-ttu-id="4f105-256">Weitere Informationen finden Sie unter [Anwenden von Transaktionsprotokollsicherungen &#40;SQL Server&#41;](../relational-databases/backup-restore/apply-transaction-log-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="4f105-256">For more information, see [Apply Transaction Log Backups &#40;SQL Server&#41;](../relational-databases/backup-restore/apply-transaction-log-backups-sql-server.md).</span></span>  
  
## <a name="additional-reading"></a><span data-ttu-id="4f105-257">Weiterführende Lektüre</span><span class="sxs-lookup"><span data-stu-id="4f105-257">Additional Reading</span></span>  

 <span data-ttu-id="4f105-258">In den folgenden empfohlenen Artikeln und Büchern finden Sie zusätzliche Informationen zu Transaktionsprotokollen.</span><span class="sxs-lookup"><span data-stu-id="4f105-258">We recommend the following articles and books for additional information about the transaction log.</span></span>  
  
 [<span data-ttu-id="4f105-259">Grundlegendes zur Protokollierung und Wiederherstellung in SQL Server von Paul Randall</span><span class="sxs-lookup"><span data-stu-id="4f105-259">Understanding Logging and Recovery in SQL Server by Paul Randall</span></span>](https://technet.microsoft.com/magazine/2009.02.logging.aspx)  
  
 [<span data-ttu-id="4f105-260">Verwaltung von SQL Server-Transaktionsprotokollen von Tony Davis und Gail Shaw</span><span class="sxs-lookup"><span data-stu-id="4f105-260">SQL Server Transaction Log Management by Tony Davis and Gail Shaw</span></span>](http://www.simple-talk.com/books/sql-books/sql-server-transaction-log-management-by-tony-davis-and-gail-shaw/)  
  
  

---
title: Reduzieren von Zeilengruppen (Visual Database Tools) | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- group collapsing [SQL Server]
- collapsing rows
- row collapsing [SQL Server]
ms.assetid: 7338dad0-965d-44ba-8c1a-b993acb7156d
author: stevestein
ms.author: sstein
ms.openlocfilehash: f7ec2f3072f9fea7c96179934924421080e75821
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87616293"
---
# <a name="collapse-groups-of-rows-visual-database-tools"></a><span data-ttu-id="1a3b8-102">Reduzieren von Zeilengruppen (Visual Database Tools)</span><span class="sxs-lookup"><span data-stu-id="1a3b8-102">Collapse Groups of Rows (Visual Database Tools)</span></span>
  <span data-ttu-id="1a3b8-103">Sie können ein Abfrageergebnis erstellen, in dem jede Ergebniszeile einer kompletten Zeilengruppe aus den ursprünglichen Daten entspricht.</span><span class="sxs-lookup"><span data-stu-id="1a3b8-103">You can create a query result in which each result row corresponds to an entire group of rows from the original data.</span></span> <span data-ttu-id="1a3b8-104">Beim Reduzieren von Zeilengruppen sind folgende Punkte zu beachten:</span><span class="sxs-lookup"><span data-stu-id="1a3b8-104">When collapsing rows, there are several things to keep in mind:</span></span>  
  
-   <span data-ttu-id="1a3b8-105">**Sie können doppelte Zeilen entfernen.** Einige Abfragen erstellen Resultsets mit mehreren identischen Zeilen.</span><span class="sxs-lookup"><span data-stu-id="1a3b8-105">**You can eliminate duplicate rows** Some queries can create result sets in which multiple identical rows appear.</span></span> <span data-ttu-id="1a3b8-106">Sie können z.B. ein Resultset erstellen, in dem jede Zeile den Namen der Stadt und des Lands bzw. der Region für eine Stadt angibt, in der Autoren ansässig sind. Wenn jedoch mehrere Autoren in einer Stadt ansässig sind, werden mehrere identische Zeilen ausgegeben.</span><span class="sxs-lookup"><span data-stu-id="1a3b8-106">For example, you can create a result set in which each row contains the city and state name of a city containing an author - but if a city contains several authors, there will be several identical rows.</span></span> <span data-ttu-id="1a3b8-107">Hierfür kann folgende SQL-Anweisung formuliert werden:</span><span class="sxs-lookup"><span data-stu-id="1a3b8-107">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state  
    FROM authors  
    ```  
  
     <span data-ttu-id="1a3b8-108">Das von der oben stehenden Abfrage generierte Resultset ist nicht sehr sinnvoll.</span><span class="sxs-lookup"><span data-stu-id="1a3b8-108">The result set generated by the preceding query is not very useful.</span></span> <span data-ttu-id="1a3b8-109">Wenn in einer Stadt vier Autoren ansässig sind, enthält das Resultset vier identische Zeilen.</span><span class="sxs-lookup"><span data-stu-id="1a3b8-109">If a city contains four authors, the result set will include four identical rows.</span></span> <span data-ttu-id="1a3b8-110">Da das Resultset nur Spalten für die Stadt und das Land bzw. die Region enthält, können die identischen Zeilen nicht voneinander unterschieden werden.</span><span class="sxs-lookup"><span data-stu-id="1a3b8-110">Since the result set does not include any columns other than city and state, there is no way to distinguish the identical rows from each other.</span></span> <span data-ttu-id="1a3b8-111">Ein Verfahren zur Vermeidung solcher doppelten Zeilen ist das Einbinden zusätzlicher Spalten, durch die die Zeilen eindeutig werden.</span><span class="sxs-lookup"><span data-stu-id="1a3b8-111">One way to avoid such duplicate rows is to include additional columns that can make the rows different.</span></span> <span data-ttu-id="1a3b8-112">Wenn Sie z. B. die Namen der Autoren aufnehmen, ergeben sich eindeutige Zeilen (vorausgesetzt, dass nicht mehrere Autoren mit demselben Namen in einer Stadt leben).</span><span class="sxs-lookup"><span data-stu-id="1a3b8-112">For example, if you include author name, each row will be different (provided no two like-named authors live within any one city).</span></span> <span data-ttu-id="1a3b8-113">Hierfür kann folgende SQL-Anweisung formuliert werden:</span><span class="sxs-lookup"><span data-stu-id="1a3b8-113">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state, fname, minit, lname  
    FROM authors  
  
    ```  
  
     <span data-ttu-id="1a3b8-114">Diese Abfrage umgeht zwar das Problem, löst es jedoch nicht.</span><span class="sxs-lookup"><span data-stu-id="1a3b8-114">Of course, the preceding query eliminates the symptom, but does not really solve the problem.</span></span> <span data-ttu-id="1a3b8-115">Das Resultset enthält keine Duplikate, es handelt sich aber auch nicht mehr um ein Resultset, das Aussagen zu Städten liefert.</span><span class="sxs-lookup"><span data-stu-id="1a3b8-115">That is, the result set has no duplicates, but it is no longer a result set about cities.</span></span> <span data-ttu-id="1a3b8-116">Um sowohl die Duplikate im ursprünglichen Resultset zu entfernen als auch Informationen über Städte zu erhalten, können Sie eine Abfrage erstellen, die ausschließlich eindeutige Zeilen zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="1a3b8-116">To eliminate duplicates in the original result set, and still have each row describe a city, you can create a query returning only distinct rows.</span></span> <span data-ttu-id="1a3b8-117">Hierfür kann folgende SQL-Anweisung formuliert werden:</span><span class="sxs-lookup"><span data-stu-id="1a3b8-117">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT DISTINCT city, state  
    FROM authors  
  
    ```  
  
     <span data-ttu-id="1a3b8-118">Ausführliche Informationen zum Ausschließen von Duplikaten finden Sie unter [Ausschließen doppelter Zeilen &#40;Visual Database Tools&#41;](visual-database-tools.md).</span><span class="sxs-lookup"><span data-stu-id="1a3b8-118">For details about eliminating duplicates, see [Exclude Duplicate Rows &#40;Visual Database Tools&#41;](visual-database-tools.md).</span></span>  
  
-   <span data-ttu-id="1a3b8-119">**Sie können Berechnungen für Zeilengruppen durchführen.** Das heißt, Sie können Informationen in Zeilengruppen zusammenfassen.</span><span class="sxs-lookup"><span data-stu-id="1a3b8-119">**You can calculate on groups of rows** That is, you can summarize information in groups of rows.</span></span> <span data-ttu-id="1a3b8-120">Sie können z. B. ein Resultset erstellen, in dem jede Zeile die Stadt, das Land bzw. die Region für die Stadt sowie einen in dieser Stadt ansässigen Autoren enthält sowie zusätzlich die Anzahl der in dieser Stadt lebenden Autoren.</span><span class="sxs-lookup"><span data-stu-id="1a3b8-120">For example, you can create a result set in which each row contains the city and state name of a city containing an author, plus a count of the number of authors contained in that city.</span></span> <span data-ttu-id="1a3b8-121">Hierfür kann folgende SQL-Anweisung formuliert werden:</span><span class="sxs-lookup"><span data-stu-id="1a3b8-121">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state, COUNT(*)  
    FROM authors  
    GROUP BY city, state  
  
    ```  
  
     <span data-ttu-id="1a3b8-122">Ausführliche Informationen zum Berechnen von Gruppen von Zeilen finden Sie unter [Zusammenfassen von Abfrageergebnissen &#40;Visual Database Tools&#41;](summarize-query-results-visual-database-tools.md) und [Sortieren und Gruppieren von Abfrageergebnissen &#40;Visual Database Tools&#41;](sort-and-group-query-results-visual-database-tools.md).</span><span class="sxs-lookup"><span data-stu-id="1a3b8-122">For details about calculating on groups of rows, see [Summarize Query Results &#40;Visual Database Tools&#41;](summarize-query-results-visual-database-tools.md) and [Sort and Group Query Results &#40;Visual Database Tools&#41;](sort-and-group-query-results-visual-database-tools.md).</span></span>  
  
-   <span data-ttu-id="1a3b8-123">**Sie können Auswahlkriterien verwenden, um Gruppen von Zeilen aufzunehmen.** Sie können z. B. ein Resultset erstellen, in dem jede Zeile eine Stadt enthält, in der mehrere Autoren ansässig sind, außerdem das Land bzw. die Region für diese Stadt und zusätzlich die Anzahl der in dieser Stadt ansässigen Autoren.</span><span class="sxs-lookup"><span data-stu-id="1a3b8-123">**You can use selection criteria to include groups of rows** For example, you can create a result set in which each row contains the city and state name of a city containing several authors, plus a count of the number of authors contained in that city.</span></span> <span data-ttu-id="1a3b8-124">Hierfür kann folgende SQL-Anweisung formuliert werden:</span><span class="sxs-lookup"><span data-stu-id="1a3b8-124">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state, COUNT(*)  
    FROM authors  
    GROUP BY city, state  
    HAVING COUNT(*) > 1  
  
    ```  
  
     <span data-ttu-id="1a3b8-125">Ausführliche Informationen zum Anwenden von Auswahlkriterien auf Zeilengruppen finden Sie unter [Angeben von Bedingungen für Gruppen &#40;Visual Database Tools&#41;](specify-conditions-for-groups-visual-database-tools.md) und [Verwenden von HAVING- und WHERE-Klauseln in derselben Abfrage &#40;Visual Database Tools&#41;](use-having-and-where-clauses-in-the-same-query-visual-database-tools.md).</span><span class="sxs-lookup"><span data-stu-id="1a3b8-125">For details about applying selection criteria on groups of rows, see [Specify Conditions for Groups &#40;Visual Database Tools&#41;](specify-conditions-for-groups-visual-database-tools.md) and [Use HAVING and WHERE Clauses in the Same Query &#40;Visual Database Tools&#41;](use-having-and-where-clauses-in-the-same-query-visual-database-tools.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1a3b8-126">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="1a3b8-126">See Also</span></span>  
 <span data-ttu-id="1a3b8-127">[Angeben von Suchkriterien &#40;Visual Database Tools&#41;](specify-search-criteria-visual-database-tools.md) </span><span class="sxs-lookup"><span data-stu-id="1a3b8-127">[Specify Search Criteria &#40;Visual Database Tools&#41;](specify-search-criteria-visual-database-tools.md) </span></span>  
 [<span data-ttu-id="1a3b8-128">Themen zur Vorgehensweise: Entwerfen von Abfragen und Sichten &#40;Visual Database Tools&#41;</span><span class="sxs-lookup"><span data-stu-id="1a3b8-128">Design Queries and Views How-to Topics &#40;Visual Database Tools&#41;</span></span>](design-queries-and-views-how-to-topics-visual-database-tools.md)  
  
  

---
title: Verwalten von Auftragsschritten | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- job steps [SQL Server replication]
- job steps [SQL Server Agent]
- jobs [SQL Server Agent], Integration Services package step
- executable programs as job steps
- operating systems [SQL Server], job steps
- Transact-SQL job step
- job steps [Transact-SQL]
- Integration Services packages, job steps
- replication job steps [SQL Server]
- logs [SQL Server], jobs
- SQL Server Agent jobs, job steps
- ActiveX scripting jobs [SQL Server]
- job steps [Analysis Services]
ms.assetid: 51352afc-a0a4-428b-8985-f9e58bb57c31
author: stevestein
ms.author: sstein
ms.openlocfilehash: 7362df13956e44b73d6984691e882bec2f39a1e4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87619538"
---
# <a name="manage-job-steps"></a><span data-ttu-id="8070e-102">Verwalten von Auftragsschritten</span><span class="sxs-lookup"><span data-stu-id="8070e-102">Manage Job Steps</span></span>
  <span data-ttu-id="8070e-103">Ein Auftragsschritt ist eine Aktion, die der Auftrag auf einer Datenbank oder einem Server ausführt.</span><span class="sxs-lookup"><span data-stu-id="8070e-103">A job step is an action that the job takes on a database or a server.</span></span> <span data-ttu-id="8070e-104">Jeder Auftrag muss mindestens einen Auftragsschritt aufweisen.</span><span class="sxs-lookup"><span data-stu-id="8070e-104">Every job must have at least one job step.</span></span> <span data-ttu-id="8070e-105">Folgende Auftragsschritte sind möglich:</span><span class="sxs-lookup"><span data-stu-id="8070e-105">Job steps can be:</span></span>  
  
-   <span data-ttu-id="8070e-106">Ausführbare Programme und Betriebssystembefehle.</span><span class="sxs-lookup"><span data-stu-id="8070e-106">Executable programs and operating system commands.</span></span>  
  
-   [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="8070e-107">Anweisungen, einschließlich gespeicherter Prozeduren und erweiterter gespeicherter Prozeduren.</span><span class="sxs-lookup"><span data-stu-id="8070e-107">statements, including stored procedures and extended stored procedures.</span></span>  
  
-   <span data-ttu-id="8070e-108">PowerShell-Skripts.</span><span class="sxs-lookup"><span data-stu-id="8070e-108">PowerShell scripts.</span></span>  
  
-   [!INCLUDE[msCoName](../../includes/msconame-md.md)] <span data-ttu-id="8070e-109">ActiveX-Skripts.</span><span class="sxs-lookup"><span data-stu-id="8070e-109">ActiveX scripts.</span></span>  
  
-   <span data-ttu-id="8070e-110">Replikationstasks.</span><span class="sxs-lookup"><span data-stu-id="8070e-110">Replication tasks.</span></span>  
  
-   [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="8070e-111">Aufgaben.</span><span class="sxs-lookup"><span data-stu-id="8070e-111">tasks.</span></span>  
  
-   [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] <span data-ttu-id="8070e-112">Pakete.</span><span class="sxs-lookup"><span data-stu-id="8070e-112">packages.</span></span>  
  
 <span data-ttu-id="8070e-113">Jeder Auftragsschritt wird in einem bestimmten Sicherheitskontext ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="8070e-113">Every job step runs in a specific security context.</span></span> <span data-ttu-id="8070e-114">Wenn der Auftragsschritt einen Proxy erfordert, wird er im Sicherheitskontext der Anmeldeinformationen des Proxys ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="8070e-114">If the job step specifies a proxy, the job step runs in the security context of the credential for the proxy.</span></span> <span data-ttu-id="8070e-115">Wenn ein Auftragsschritt keinen Proxy erfordert, wird er im Kontext des [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Agent-Dienstkontos ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="8070e-115">If a job step does not specify a proxy, the job step runs in the context of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account.</span></span> <span data-ttu-id="8070e-116">Nur Mitglieder der festen Serverrolle sysadmin können Aufträge erstellen, die nicht ausdrücklich einen Proxy angeben.</span><span class="sxs-lookup"><span data-stu-id="8070e-116">Only members of the sysadmin fixed server role can create jobs that do not explicitly specify a proxy.</span></span>  
  
 <span data-ttu-id="8070e-117">Weil Auftragsschritte im Kontext eines bestimmten [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows-Benutzers ausgeführt werden, muss dieser Benutzer über die Berechtigungen und Konfigurationen verfügen, die für die Ausführung des Auftragsschritts erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="8070e-117">Because job steps run in the context of a specific [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows user, that user must have the permissions and configuration necessary for the job step to execute.</span></span> <span data-ttu-id="8070e-118">Wenn Sie beispielsweise einen Auftrag erstellen, der einen Laufwerkbuchstaben oder einen UNC-Pfad (Universal Naming Convention) erfordert, können die Auftragsschritte unter Ihrem Windows-Benutzerkonto ausgeführt werden, während die Tasks getestet werden.</span><span class="sxs-lookup"><span data-stu-id="8070e-118">For example, if you create a job that requires a drive letter or a Universal Naming Convention (UNC) path, the job steps may run under your Windows user account while testing the tasks.</span></span> <span data-ttu-id="8070e-119">Allerdings muss der Windows-Benutzer für den Auftragsschritt auch über die notwendigen Berechtigungen, die Laufwerkbuchstabenkonfigurationen oder den Zugriff auf das erforderliche Laufwerk verfügen.</span><span class="sxs-lookup"><span data-stu-id="8070e-119">However, the Windows user for the job step must also have the necessary permissions, drive letter configurations, or access to the required drive.</span></span> <span data-ttu-id="8070e-120">Andernfalls erzeugt der Auftragsschritt einen Fehler.</span><span class="sxs-lookup"><span data-stu-id="8070e-120">Otherwise, the job step fails.</span></span> <span data-ttu-id="8070e-121">Um dieses Problem zu verhindern, stellen Sie sicher, dass der Proxy für jeden Auftragsschritt über die notwendigen Berechtigungen für den Task verfügt, von dem der Auftragsschritt ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="8070e-121">To prevent this problem, ensure that the proxy for each job step has the necessary permissions for the task that the job step performs.</span></span> <span data-ttu-id="8070e-122">Weitere Informationen finden Sie unter [Security Center für SQL Server Datenbank-Engine und Azure SQL-Datenbank](../../relational-databases/security/security-center-for-sql-server-database-engine-and-azure-sql-database.md).</span><span class="sxs-lookup"><span data-stu-id="8070e-122">For more information, see [Security Center for SQL Server Database Engine and Azure SQL Database](../../relational-databases/security/security-center-for-sql-server-database-engine-and-azure-sql-database.md).</span></span>  
  
## <a name="job-step-logs"></a><span data-ttu-id="8070e-123">Auftragsschrittprotokolle</span><span class="sxs-lookup"><span data-stu-id="8070e-123">Job Step Logs</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="8070e-124">Agent kann die Ausgabe bestimmter Auftragsschritte entweder in eine Betriebssystemdatei oder in die sysjobstepslogs-Tabelle der msdb-Datenbank schreiben.</span><span class="sxs-lookup"><span data-stu-id="8070e-124">Agent can write output from some job steps either to an operating system file or to the sysjobstepslogs table in the msdb database.</span></span> <span data-ttu-id="8070e-125">Von den folgenden Auftragsschritttypen können Ausgaben in beide Ziele geschrieben werden:</span><span class="sxs-lookup"><span data-stu-id="8070e-125">The following job step types can write output to both destinations:</span></span>  
  
-   <span data-ttu-id="8070e-126">Ausführbare Programme und Betriebssystembefehle.</span><span class="sxs-lookup"><span data-stu-id="8070e-126">Executable programs and operating system commands.</span></span>  
  
-   [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="8070e-127">-Anweisungen.</span><span class="sxs-lookup"><span data-stu-id="8070e-127">statements.</span></span>  
  
-   [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="8070e-128">Aufgaben.</span><span class="sxs-lookup"><span data-stu-id="8070e-128">tasks.</span></span>  
  
 <span data-ttu-id="8070e-129">Nur von Auftragsschritten, die von Benutzern ausgeführt werden, die Mitglieder der festen Serverrolle sysadmin sind, können Auftragsschrittausgaben in Betriebssystemdateien geschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="8070e-129">Only job steps that are executed by users who are members of the sysadmin fixed server role can write job step output to operating system files.</span></span> <span data-ttu-id="8070e-130">Wenn die Auftragsschritte von Benutzern ausgeführt werden, die Mitglieder der festen Datenbankrolle SQLAgentUserRole, SQLAgentReaderRole oder SQLAgentOperatorRole der msdb-Datenbank sind, kann die Ausgabe dieser Auftragsschritte nur in die sysjobstepslogs-Tabelle geschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="8070e-130">If job steps are executed by users who are members of the SQLAgentUserRole, SQLAgentReaderRole, or the SQLAgentOperatorRole fixed database roles in the msdb database, then the output from these job steps can be written only to the sysjobstepslogs table.</span></span>  
  
 <span data-ttu-id="8070e-131">Auftragsschritte werden automatisch gelöscht, wenn Aufträge oder Auftragsschritte gelöscht werden.</span><span class="sxs-lookup"><span data-stu-id="8070e-131">Job step logs are automatically deleted when jobs or job steps are deleted.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8070e-132">Das Protokollieren von Replikationstasks und [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] -Paketauftragsschritten wird vom jeweiligen Subsystem durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="8070e-132">Replication task and [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] package job step logging is handled by their respective subsystem.</span></span> <span data-ttu-id="8070e-133">Sie können zum Konfigurieren der Auftragsschrittprotokollierung nicht den [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Agent für diese Art von Auftragsschritten verwenden.</span><span class="sxs-lookup"><span data-stu-id="8070e-133">You cannot use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent to configure jog step logging for these types of job steps.</span></span>  
  
## <a name="executable-programs-and-operating-system-commands-as-job-steps"></a><span data-ttu-id="8070e-134">Ausführbare Programme und Betriebssystembefehle als Auftragsschritte</span><span class="sxs-lookup"><span data-stu-id="8070e-134">Executable Programs and Operating-System Commands As Job Steps</span></span>  
 <span data-ttu-id="8070e-135">Ausführbare Programme und Betriebssystembefehle können als Auftragsschritte verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="8070e-135">Executable programs and operating-system commands can be used as job steps.</span></span> <span data-ttu-id="8070e-136">Diese Dateien können die Dateierweiterungen BAT, CMD, COM oder EXE aufweisen.</span><span class="sxs-lookup"><span data-stu-id="8070e-136">These files may have .bat, .cmd, .com, or .exe file extensions.</span></span>  
  
 <span data-ttu-id="8070e-137">Wenn Sie ein ausführbares Programm oder einen Betriebssystembefehl als Auftragsschritt verwenden, müssen Sie Folgendes angeben:</span><span class="sxs-lookup"><span data-stu-id="8070e-137">When you use an executable program or an operating-system command as a job step, you must specify:</span></span>  
  
-   <span data-ttu-id="8070e-138">Den Prozessexitcode, der zurückgegeben wird, wenn der Befehl erfolgreich ausgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="8070e-138">The process exit code returned if the command was successful.</span></span>  
  
-   <span data-ttu-id="8070e-139">Den auszuführenden Befehl.</span><span class="sxs-lookup"><span data-stu-id="8070e-139">The command to execute.</span></span> <span data-ttu-id="8070e-140">Beim Ausführen eines Betriebssystembefehls handelt es sich hierbei einfach um den Befehl selbst.</span><span class="sxs-lookup"><span data-stu-id="8070e-140">To execute an operating system command, this is simply the command itself.</span></span> <span data-ttu-id="8070e-141">Bei einem externen Programm ist dies der Name des Programms und die Argumente für das Programm, z. B.: **C:\Programme\Microsoft SQL Server\100\Tools\Binn\sqlcmd.exe -e -q "sp_who"**.</span><span class="sxs-lookup"><span data-stu-id="8070e-141">For an external program, this is the name of the program and the arguments to the program, for example: **C:\Program Files\Microsoft SQL Server\100\Tools\Binn\sqlcmd.exe -e -q "sp_who"**</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="8070e-142">Sie müssen den vollständigen Pfad zur ausführbaren Datei angeben, wenn diese sich nicht in dem Verzeichnis befindet, das im Systempfad oder dem Pfad für den Benutzer angegeben ist, als der der Auftragsschritt ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="8070e-142">You must provide the full path to the executable if the executable is not located in a directory specified in the system path or the path for the user that the job step runs as.</span></span>  
  
## <a name="transact-sql-job-steps"></a><span data-ttu-id="8070e-143">Transact-SQL-Auftragsschritte</span><span class="sxs-lookup"><span data-stu-id="8070e-143">Transact-SQL Job Steps</span></span>  
 <span data-ttu-id="8070e-144">Beim Erstellen eines [!INCLUDE[tsql](../../includes/tsql-md.md)] -Auftragsschritts müssen Sie folgende Schritte durchführen:</span><span class="sxs-lookup"><span data-stu-id="8070e-144">When you create a [!INCLUDE[tsql](../../includes/tsql-md.md)] job step, you must:</span></span>  
  
-   <span data-ttu-id="8070e-145">Identifizieren der Datenbank, in der Sie den Auftrag ausführen.</span><span class="sxs-lookup"><span data-stu-id="8070e-145">Identify the database in which to run the job.</span></span>  
  
-   <span data-ttu-id="8070e-146">Eingeben der auszuführenden [!INCLUDE[tsql](../../includes/tsql-md.md)] -Anweisung.</span><span class="sxs-lookup"><span data-stu-id="8070e-146">Type the [!INCLUDE[tsql](../../includes/tsql-md.md)] statement to execute.</span></span> <span data-ttu-id="8070e-147">Von der Anweisung wird möglicherweise eine gespeicherte Prozedur oder eine erweiterte gespeicherte Prozedur aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="8070e-147">The statement may call a stored procedure or an extended stored procedure.</span></span>  
  
 <span data-ttu-id="8070e-148">Sie können auch eine vorhandene [!INCLUDE[tsql](../../includes/tsql-md.md)] -Datei als Befehl für den Auftragsschritt öffnen.</span><span class="sxs-lookup"><span data-stu-id="8070e-148">Optionally, you can open an existing [!INCLUDE[tsql](../../includes/tsql-md.md)] file as the command for the job step.</span></span>  
  
 [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="8070e-149">Auftragsschritte verwenden keine [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Agent-Proxys.</span><span class="sxs-lookup"><span data-stu-id="8070e-149">job steps do not use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent proxies.</span></span> <span data-ttu-id="8070e-150">Stattdessen wird der Auftragsschritt als Besitzer des Auftragsschritts bzw. als [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Agent-Dienstkonto ausgeführt, wenn der Besitzer des Auftragsschritts Mitglied der festen Serverrolle sysadmin ist.</span><span class="sxs-lookup"><span data-stu-id="8070e-150">Instead, the job step runs as the owner of the job step, or as the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account if the owner of the job step is a member of the sysadmin fixed server role.</span></span> <span data-ttu-id="8070e-151">Mitglieder der festen Serverrolle „sysadmin“ können auch angeben, dass [!INCLUDE[tsql](../../includes/tsql-md.md)] -Auftragsschritte unter dem Kontext eines anderen Benutzers ausgeführt werden, indem der *database_user_name* -Parameter der gespeicherten Prozedur „sp_add_jobstep“ verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="8070e-151">Members of the sysadmin fixed server role can also specify that [!INCLUDE[tsql](../../includes/tsql-md.md)] job steps run under the context of another user by using the *database_user_name* parameter of the sp_add_jobstep stored procedure.</span></span> <span data-ttu-id="8070e-152">Weitere Informationen finden Sie unter [sp_add_jobstep &#40;Transact-SQL-&#41;](/sql/relational-databases/system-stored-procedures/sp-add-jobstep-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="8070e-152">For more information, see [sp_add_jobstep &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-add-jobstep-transact-sql).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8070e-153">Ein einzelner [!INCLUDE[tsql](../../includes/tsql-md.md)] -Auftragsschritt kann mehrere Batches enthalten.</span><span class="sxs-lookup"><span data-stu-id="8070e-153">A single [!INCLUDE[tsql](../../includes/tsql-md.md)] job step can contain multiple batches.</span></span> [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="8070e-154">Auftragsschritte können mehrere eingebettete GO-Befehle enthalten.</span><span class="sxs-lookup"><span data-stu-id="8070e-154">job steps can contain embedded GO commands.</span></span>  
  
## <a name="powershell-scripting-job-steps"></a><span data-ttu-id="8070e-155">PowerShell-Skript-Auftragsschritte</span><span class="sxs-lookup"><span data-stu-id="8070e-155">PowerShell Scripting Job Steps</span></span>  
 <span data-ttu-id="8070e-156">Wenn Sie einen PowerShell-Skript-Auftragsschritt erstellen, müssen Sie eins von zwei Elementen als Befehl für den Schritt angeben:</span><span class="sxs-lookup"><span data-stu-id="8070e-156">When you create a PowerShell script job step, you must specify one of two things as the command for the step:</span></span>  
  
-   <span data-ttu-id="8070e-157">Den Text eines PowerShell-Skripts.</span><span class="sxs-lookup"><span data-stu-id="8070e-157">The text of a PowerShell script.</span></span>  
  
-   <span data-ttu-id="8070e-158">Eine vorhandene PowerShell-Skriptdatei, die geöffnet werden soll.</span><span class="sxs-lookup"><span data-stu-id="8070e-158">An existing PowerShell script file to be opened.</span></span>  
  
 <span data-ttu-id="8070e-159">Das [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell-Subsystem des Agents öffnet eine PowerShell-Sitzung und lädt die [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell-Snap-Ins. Das PowerShell-Skript, das als Auftrags Schritt Befehl verwendet wird, kann auf den [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell-Anbieter und die Cmdlets verweisen.</span><span class="sxs-lookup"><span data-stu-id="8070e-159">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent PowerShell subsystem opens a PowerShell session and loads the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell snap-ins. The PowerShell script used as the job step command can reference the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell provider and cmdlets.</span></span> <span data-ttu-id="8070e-160">Weitere Informationen über das Schreiben von PowerShell-Skripts mithilfe von [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell-Snap-Ins finden Sie unter [SQL Server PowerShell](../../powershell/sql-server-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="8070e-160">For more information about writing PowerShell scripts using the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell snap-ins, see the [SQL Server PowerShell](../../powershell/sql-server-powershell.md).</span></span>  
  
## <a name="activex-scripting-job-steps"></a><span data-ttu-id="8070e-161">ActiveX-Skript-Auftragsschritte</span><span class="sxs-lookup"><span data-stu-id="8070e-161">ActiveX Scripting Job Steps</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="8070e-162">Der ActiveX-Skript-Auftragsschritt wird in einer zukünftigen Version von [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] aus dem [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-Agent entfernt.</span><span class="sxs-lookup"><span data-stu-id="8070e-162">The ActiveX scripting job step will be removed from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent in a future version of [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="8070e-163">Nutzen Sie diese Funktionen bei Neuentwicklungen nicht mehr, und planen Sie die Änderung von Anwendungen, die diese Funktion zurzeit verwenden.</span><span class="sxs-lookup"><span data-stu-id="8070e-163">Avoid using this feature in new development work, and plan to modify applications that currently use this feature.</span></span>  
  
 <span data-ttu-id="8070e-164">Wenn Sie einen ActiveX-Skriptauftragsschritt erstellen, ist Folgendes notwendig:</span><span class="sxs-lookup"><span data-stu-id="8070e-164">When you create an ActiveX scripting job step, you must:</span></span>  
  
-   <span data-ttu-id="8070e-165">Identifizieren der Skriptsprache, in der der Auftragsschritt geschrieben ist.</span><span class="sxs-lookup"><span data-stu-id="8070e-165">Identify the scripting language in which the job step is written.</span></span>  
  
-   <span data-ttu-id="8070e-166">Erstellen des ActiveX-Skripts.</span><span class="sxs-lookup"><span data-stu-id="8070e-166">Write the ActiveX script.</span></span>  
  
 <span data-ttu-id="8070e-167">Sie können auch eine vorhandene ActiveX-Skriptdatei als Befehl für den Auftragsschritt öffnen.</span><span class="sxs-lookup"><span data-stu-id="8070e-167">You can also open an existing ActiveX script file as the command for the job step.</span></span> <span data-ttu-id="8070e-168">ActiveX-Skriptbefehle können alternativ auch extern (beispielsweise mithilfe von Microsoft Visual Basic) kompiliert und anschließend als ausführbare Programme ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="8070e-168">Alternatively, ActiveX script commands can be externally compiled (for example, using Microsoft Visual Basic) and then run as executable programs.</span></span>  
  
 <span data-ttu-id="8070e-169">Handelt es sich bei dem Befehl eines Auftragsschritts um ein ActiveX-Skript, können Sie das SQLActiveScriptHost-Objekt verwenden, um Ausgaben in das Verlaufsprotokoll des Auftragsschritts zu drucken oder COM-Objekte zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="8070e-169">When a job step command is an ActiveX script, you can use the SQLActiveScriptHost object to print output to the job step history log or create COM objects.</span></span> <span data-ttu-id="8070e-170">Bei SQLActiveScriptHost handelt es sich um ein globales Objekt, das vom Hostsystem des [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Agents in den Skriptnamensbereich eingefügt wird.</span><span class="sxs-lookup"><span data-stu-id="8070e-170">SQLActiveScriptHost is a global object that is introduced by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent hosting system into the script name space.</span></span> <span data-ttu-id="8070e-171">Das Objekt verfügt über zwei Methoden („Print“ und „CreateObject“).</span><span class="sxs-lookup"><span data-stu-id="8070e-171">The object has two methods (Print and CreateObject).</span></span> <span data-ttu-id="8070e-172">Das folgende Beispiel veranschaulicht, wie ActiveX-Skripts in Visual Basic Scripting Edition (VBScript) funktionieren.</span><span class="sxs-lookup"><span data-stu-id="8070e-172">The following example shows how ActiveX scripting works in Visual Basic Scripting Edition (VBScript).</span></span>  
  
```  
' VBScript example for ActiveX Scripting job step  
' Create a Dmo.Server object. The object connects to the  
' server on which the script is running.  
  
Set oServer = CreateObject("SQLDmo.SqlServer")  
oServer.LoginSecure = True  
oServer.Connect "(local)"  
'Disconnect and destroy the server object  
oServer.DisConnect  
Set oServer = nothing
```  
  
## <a name="replication-job-steps"></a><span data-ttu-id="8070e-173">Replikationsauftragsschritte</span><span class="sxs-lookup"><span data-stu-id="8070e-173">Replication Job Steps</span></span>  
 <span data-ttu-id="8070e-174">Wenn Sie Veröffentlichungen und Abonnements mithilfe der Replikation erstellen, werden standardmäßig Replikationsaufträge erstellt.</span><span class="sxs-lookup"><span data-stu-id="8070e-174">When you create publications and subscriptions using replication, replication jobs are created by default.</span></span> <span data-ttu-id="8070e-175">Der Typ der erstellten Aufträge wird durch den Typ der Replikation (Momentaufnahme, Transaktion oder Merge) und die verwendeten Optionen bestimmt.</span><span class="sxs-lookup"><span data-stu-id="8070e-175">The type of job created is determined by the type of replication (snapshot, transactional, or merge) and the options used.</span></span>  
  
 <span data-ttu-id="8070e-176">Replikationsauftragsschritte aktivieren einen dieser Replikations-Agents:</span><span class="sxs-lookup"><span data-stu-id="8070e-176">Replication job steps activate one of these replication agents:</span></span>  
  
-   <span data-ttu-id="8070e-177">Momentaufnahme-Agent (Momentaufnahmeauftrag)</span><span class="sxs-lookup"><span data-stu-id="8070e-177">Snapshot Agent (Snapshot job)</span></span>  
  
-   <span data-ttu-id="8070e-178">Protokolllese-Agent (Protokollleserauftrag)</span><span class="sxs-lookup"><span data-stu-id="8070e-178">Log Reader Agent (LogReader job)</span></span>  
  
-   <span data-ttu-id="8070e-179">Verteilungs-Agent (Verteilungsauftrag)</span><span class="sxs-lookup"><span data-stu-id="8070e-179">Distribution Agent (Distribution job)</span></span>  
  
-   <span data-ttu-id="8070e-180">Merge-Agent (Mergeauftrag)</span><span class="sxs-lookup"><span data-stu-id="8070e-180">Merge Agent (Merge job)</span></span>  
  
-   <span data-ttu-id="8070e-181">Warteschlangenlese-Agent (Warteschlangenleser-Auftrag)</span><span class="sxs-lookup"><span data-stu-id="8070e-181">Queue Reader Agent (QueueReader job)</span></span>  
  
 <span data-ttu-id="8070e-182">Beim Einrichten der Replikation können Sie zwischen drei Ausführungsarten für die Replikations-Agents wählen: immer nach dem Start des [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Agents, bei Bedarf oder gemäß einem Zeitplan.</span><span class="sxs-lookup"><span data-stu-id="8070e-182">When replication is set up, you can specify to run the replication agents in one of three ways: continuously after [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent is started, on demand, or according to a schedule.</span></span> <span data-ttu-id="8070e-183">Weitere Informationen zu Replikations-Agents finden Sie unter [Replikations-Agents (Übersicht)](../../relational-databases/replication/agents/replication-agents-overview.md).</span><span class="sxs-lookup"><span data-stu-id="8070e-183">For more information about replication agents, see [Replication Agents Overview](../../relational-databases/replication/agents/replication-agents-overview.md).</span></span>  
  
## <a name="analysis-services-job-steps"></a><span data-ttu-id="8070e-184">Analysis Services-Auftragsschritte</span><span class="sxs-lookup"><span data-stu-id="8070e-184">Analysis Services Job Steps</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="8070e-185">Agent unterstützt zwei unterschiedliche Typen von Analysis Services-Auftragsschritten: Befehlsauftragsschritte und Abfrageauftragsschritte.</span><span class="sxs-lookup"><span data-stu-id="8070e-185">Agent supports two distinct types of Analysis Services job steps, command job steps, and query job steps.</span></span>  
  
### <a name="analysis-services-command-job-steps"></a><span data-ttu-id="8070e-186">Analysis Services-Befehlsauftragsschritte</span><span class="sxs-lookup"><span data-stu-id="8070e-186">Analysis Services Command Job Steps</span></span>  
 <span data-ttu-id="8070e-187">Wenn Sie einen [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] -Befehlsauftragsschritt erstellen, müssen Sie folgende Schritte durchführen:</span><span class="sxs-lookup"><span data-stu-id="8070e-187">When you create an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] command job step, you must:</span></span>  
  
-   <span data-ttu-id="8070e-188">Identifizieren der OLAP-Datenbank, in der Sie den Auftragsschritt ausführen.</span><span class="sxs-lookup"><span data-stu-id="8070e-188">Identify the database OLAP server in which to run the job step.</span></span>  
  
-   <span data-ttu-id="8070e-189">Eingeben der auszuführenden Anweisung.</span><span class="sxs-lookup"><span data-stu-id="8070e-189">Type the statement to execute.</span></span> <span data-ttu-id="8070e-190">Bei der Anweisung muss es sich um XML-Code für die  **Execute**-Methode in [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] handeln.</span><span class="sxs-lookup"><span data-stu-id="8070e-190">The statement must be an XML for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] **Execute** method.</span></span> <span data-ttu-id="8070e-191">Die Anweisung darf keinen vollständigen SOAP-Umschlag oder XML-Code für eine  **Discover**-Methode für [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] enthalten.</span><span class="sxs-lookup"><span data-stu-id="8070e-191">The statement may not contain a complete SOAP envelope or an XML for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] **Discover** method.</span></span> <span data-ttu-id="8070e-192">Hinweis: Während [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] vollständige SOAP-Umschläge und die **Discover** -Methode unterstützt, ist das bei [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Agent-Auftragsschritten nicht der Fall.</span><span class="sxs-lookup"><span data-stu-id="8070e-192">Notice that, while [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] supports complete SOAP envelopes and the **Discover** method, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job steps do not.</span></span>  
  
### <a name="analysis-services-query-job-steps"></a><span data-ttu-id="8070e-193">Analysis Services-Abfrageauftragsschritte</span><span class="sxs-lookup"><span data-stu-id="8070e-193">Analysis Services Query Job Steps</span></span>  
 <span data-ttu-id="8070e-194">Wenn Sie einen [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] -Abfrageauftragsschritt erstellen, müssen Sie folgende Schritte durchführen:</span><span class="sxs-lookup"><span data-stu-id="8070e-194">When you create an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] query job step, you must:</span></span>  
  
-   <span data-ttu-id="8070e-195">Identifizieren der OLAP-Datenbank, in der Sie den Auftragsschritt ausführen.</span><span class="sxs-lookup"><span data-stu-id="8070e-195">Identify the database OLAP server in which to run the job step.</span></span>  
  
-   <span data-ttu-id="8070e-196">Eingeben der auszuführenden Anweisung.</span><span class="sxs-lookup"><span data-stu-id="8070e-196">Type the statement to execute.</span></span> <span data-ttu-id="8070e-197">Bei der Anweisung muss es sich um eine MDX-Abfrage handeln (Multidimensional Expressions, mehrdimensionale Ausdrücke).</span><span class="sxs-lookup"><span data-stu-id="8070e-197">The statement must be a multidimensional expressions (MDX) query.</span></span>  
  
 <span data-ttu-id="8070e-198">Weitere Informationen zu MDX finden Sie unter [Grundlegendes zu MDX-Abfragen &#40;Analysis Services&#41;](https://docs.microsoft.com/analysis-services/multidimensional-models/mdx/mdx-query-fundamentals-analysis-services).</span><span class="sxs-lookup"><span data-stu-id="8070e-198">For more information on MDX, see [MDX Query Fundamentals &#40;Analysis Services&#41;](https://docs.microsoft.com/analysis-services/multidimensional-models/mdx/mdx-query-fundamentals-analysis-services).</span></span>  
  
## <a name="integration-services-packages"></a><span data-ttu-id="8070e-199">Integration Services-Pakete</span><span class="sxs-lookup"><span data-stu-id="8070e-199">Integration Services Packages</span></span>  
 <span data-ttu-id="8070e-200">Wenn Sie einen [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] -Paketauftragsschritt erstellen, müssen Sie folgende Schritte durchführen:</span><span class="sxs-lookup"><span data-stu-id="8070e-200">When you create an [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] package job step, you must do the following:</span></span>  
  
-   <span data-ttu-id="8070e-201">Identifizieren der Paketquelle.</span><span class="sxs-lookup"><span data-stu-id="8070e-201">Identify the source of the package.</span></span>  
  
-   <span data-ttu-id="8070e-202">Identifizieren des Paketspeicherorts.</span><span class="sxs-lookup"><span data-stu-id="8070e-202">Identify the location of the package.</span></span>  
  
-   <span data-ttu-id="8070e-203">Identifizieren der Konfigurationsdateien, wenn diese für das Paket erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="8070e-203">If configuration files are required for the package, identify the configuration files.</span></span>  
  
-   <span data-ttu-id="8070e-204">Identifizieren der Befehlsdateien, wenn diese für das Paket erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="8070e-204">If command files are required for the package, identify the command files.</span></span>  
  
-   <span data-ttu-id="8070e-205">Identifizieren der für das Paket zu verwendenden Überprüfung.</span><span class="sxs-lookup"><span data-stu-id="8070e-205">Identify the verification to use for the package.</span></span> <span data-ttu-id="8070e-206">Sie können beispielsweise angeben, dass das Paket signiert werden oder eine bestimmte Paket-ID aufweisen muss.</span><span class="sxs-lookup"><span data-stu-id="8070e-206">For example, you can specify that the package must be signed, or that the package must have a specific package ID.</span></span>  
  
-   <span data-ttu-id="8070e-207">Identifizieren der Datenquellen für das Paket.</span><span class="sxs-lookup"><span data-stu-id="8070e-207">Identify the data sources for the package.</span></span>  
  
-   <span data-ttu-id="8070e-208">Identifizieren der Protokollanbieter für das Paket.</span><span class="sxs-lookup"><span data-stu-id="8070e-208">Identify the log providers for the package.</span></span>  
  
-   <span data-ttu-id="8070e-209">Angeben von Variablen und Werten, die vor dem Ausführen des Pakets festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="8070e-209">Specify variables and values to set before running the package.</span></span>  
  
-   <span data-ttu-id="8070e-210">Identifizieren von Ausführungsoptionen.</span><span class="sxs-lookup"><span data-stu-id="8070e-210">Identify execution options.</span></span>  
  
-   <span data-ttu-id="8070e-211">Hinzufügen oder Ändern von Befehlszeilenoptionen.</span><span class="sxs-lookup"><span data-stu-id="8070e-211">Add or modify command-line options.</span></span>  
  
 <span data-ttu-id="8070e-212">Hinweis: Wenn Sie das Paket im SSIS-Katalog bereitgestellt und Sie **SSIS-Katalog** als Paketquelle angegeben haben, werden viele dieser Konfigurationsinformationen automatisch vom Paket abgerufen.</span><span class="sxs-lookup"><span data-stu-id="8070e-212">Note that if you deployed the package to the SSIS Catalog and you specify **SSIS Catalog** as the package source, much of this configuration information is obtained automatically from the package.</span></span> <span data-ttu-id="8070e-213">Auf der Registerkarte **Konfiguration** können Sie die Umgebung, Parameterwerte, Verbindungs-Manager-Werte und Eigenschaftenüberschreibungen angeben und ob das Paket in einer 32-Bit-Laufzeitumgebung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="8070e-213">Under the **Configuration** tab you can specify the environment, parameter values, connection manager values, property overrides, and whether the package runs in a 32-bit runtime environment.</span></span>  
  
 <span data-ttu-id="8070e-214">Informationen zum Erstellen von Auftragsschritten, von denen [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] -Pakete ausgeführt werden, finden Sie unter [Aufträge des SQL Server-Agents für Pakete](../../integration-services/packages/sql-server-agent-jobs-for-packages.md).</span><span class="sxs-lookup"><span data-stu-id="8070e-214">For more information about creating job steps that run [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] packages, see [SQL Server Agent Jobs for Packages](../../integration-services/packages/sql-server-agent-jobs-for-packages.md).</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="8070e-215">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="8070e-215">Related Tasks</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="8070e-216">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="8070e-216">**Description**</span></span>|<span data-ttu-id="8070e-217">**Thema**</span><span class="sxs-lookup"><span data-stu-id="8070e-217">**Topic**</span></span>|  
|<span data-ttu-id="8070e-218">Beschreibt, wie ein Auftragsschritt mit einem ausführbaren Programm erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="8070e-218">Describes how to create a job step with an executable program.</span></span>|[<span data-ttu-id="8070e-219">Erstellen eines CmdExec-Auftragsschritts</span><span class="sxs-lookup"><span data-stu-id="8070e-219">Create a CmdExec Job Step</span></span>](create-a-cmdexec-job-step.md)|  
|<span data-ttu-id="8070e-220">Beschreibt, wie [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Agent-Berechtigungen zurückgesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="8070e-220">Describes how to reset [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent permissions.</span></span>|[<span data-ttu-id="8070e-221">Configure a User to Create and Manage SQL Server Agent Jobs</span><span class="sxs-lookup"><span data-stu-id="8070e-221">Configure a User to Create and Manage SQL Server Agent Jobs</span></span>](configure-a-user-to-create-and-manage-sql-server-agent-jobs.md)|  
|<span data-ttu-id="8070e-222">Beschreibt, wie ein [!INCLUDE[tsql](../../includes/tsql-md.md)] -Auftragsschritt erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="8070e-222">Describes how to create a [!INCLUDE[tsql](../../includes/tsql-md.md)] job step.</span></span>|[<span data-ttu-id="8070e-223">Erstellen eines Transact-SQL-Auftragsschritts</span><span class="sxs-lookup"><span data-stu-id="8070e-223">Create a Transact-SQL Job Step</span></span>](create-a-transact-sql-job-step.md)|  
|<span data-ttu-id="8070e-224">Beschreibt, wie Optionen für Transact-SQL-Auftragsschritte für den Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Agent erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="8070e-224">Describes how to define options for Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent Transact-SQL job steps.</span></span>|[<span data-ttu-id="8070e-225">Definieren von Optionen für Transact-SQL-Auftragsschritte</span><span class="sxs-lookup"><span data-stu-id="8070e-225">Define Transact-SQL Job Step Options</span></span>](define-transact-sql-job-step-options.md)|  
|<span data-ttu-id="8070e-226">Beschreibt, wie ein ActiveX-Skript-Auftragsschritt erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="8070e-226">Describes how to create an ActiveX script job step.</span></span>|[<span data-ttu-id="8070e-227">Create an ActiveX Script Job Step</span><span class="sxs-lookup"><span data-stu-id="8070e-227">Create an ActiveX Script Job Step</span></span>](create-an-activex-script-job-step.md)|  
|<span data-ttu-id="8070e-228">Beschreibt, wie [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Agent-Auftragsschritte erstellt und definiert werden, die [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Analysis Services-Befehle und -Abfragen ausführen.</span><span class="sxs-lookup"><span data-stu-id="8070e-228">Describes how to create and define [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job steps that execute [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Analysis Services commands and queries.</span></span>|[<span data-ttu-id="8070e-229">Erstellen eines Analysis Services-Auftragsschritts</span><span class="sxs-lookup"><span data-stu-id="8070e-229">Create an Analysis Services Job Step</span></span>](create-an-analysis-services-job-step.md)|  
|<span data-ttu-id="8070e-230">Beschreibt, welche Aktion [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ausführen sollte, wenn während der Auftragsausführung ein Fehler auftritt.</span><span class="sxs-lookup"><span data-stu-id="8070e-230">Describes what action [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] should take if a failure occurs during job execution.</span></span>|[<span data-ttu-id="8070e-231">Set Job Step Success or Failure Flow</span><span class="sxs-lookup"><span data-stu-id="8070e-231">Set Job Step Success or Failure Flow</span></span>](set-job-step-success-or-failure-flow.md)|  
|<span data-ttu-id="8070e-232">Beschreibt, wie Auftragsschrittdetails im Dialogfeld Auftragsschritt-Eigenschaften angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="8070e-232">Describes how to view job step details in the Job Step Properties dialog.</span></span>|[<span data-ttu-id="8070e-233">View Job Step Information</span><span class="sxs-lookup"><span data-stu-id="8070e-233">View Job Step Information</span></span>](view-job-step-information.md)|  
|<span data-ttu-id="8070e-234">Beschreibt, wie ein Auftragsschrittprotokoll des [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] -Agents gelöscht wird.</span><span class="sxs-lookup"><span data-stu-id="8070e-234">Describes how to delete a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job step log.</span></span>|[<span data-ttu-id="8070e-235">Löschen eines Auftragsschrittprotokolls</span><span class="sxs-lookup"><span data-stu-id="8070e-235">Delete a Job Step Log</span></span>](delete-a-job-step-log.md)|  
  
## <a name="see-also"></a><span data-ttu-id="8070e-236">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="8070e-236">See Also</span></span>  
 <span data-ttu-id="8070e-237">[dbo.sysjobstepslogs &#40;Transact-SQL-&#41;](/sql/relational-databases/system-tables/dbo-sysjobstepslogs-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8070e-237">[dbo.sysjobstepslogs &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/dbo-sysjobstepslogs-transact-sql) </span></span>  
 <span data-ttu-id="8070e-238">[Erstellen von Aufträgen](create-jobs.md) </span><span class="sxs-lookup"><span data-stu-id="8070e-238">[Create Jobs](create-jobs.md) </span></span>  
 [<span data-ttu-id="8070e-239">sp_add_job &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="8070e-239">sp_add_job &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-add-job-transact-sql)  

---
title: Erstellen einer asynchronen Transformation mit der Skriptkomponente | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
dev_langs:
- VB
helpviewer_keywords:
- asynchronous outputs [Integration Services]
- transformation components [Integration Services]
- Script component [Integration Services], transformation components
ms.assetid: 0d814404-21e4-4a68-894c-96fa47ab25ae
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 465c4a597b4a18d7bd956116cd5d7640a5393958
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87618773"
---
# <a name="creating-an-asynchronous-transformation-with-the-script-component"></a><span data-ttu-id="1d9eb-102">Erstellen einer asynchronen Transformation mit der Skriptkomponente</span><span class="sxs-lookup"><span data-stu-id="1d9eb-102">Creating an Asynchronous Transformation with the Script Component</span></span>
  <span data-ttu-id="1d9eb-103">Transformationskomponenten dienen im Datenfluss eines [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]-Pakets dazu, Daten auf dem Weg von der Quelle zum Ziel zu ändern und zu analysieren.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-103">You use a transformation component in the data flow of an [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] package to modify and analyze data as it passes from source to destination.</span></span> <span data-ttu-id="1d9eb-104">Eine Transformation mit synchronen Ausgaben verarbeitet jede eingegebene Zeile, während sie die Komponente durchläuft.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-104">A transformation with synchronous outputs processes each input row as it passes through the component.</span></span> <span data-ttu-id="1d9eb-105">Eine Transformation mit asynchronen Ausgaben kann die Fertigstellung ihrer Verarbeitung abwarten, bis die Transformation alle Eingabezeilen empfangen hat. Die Transformation kann bestimmte Zeilen auch ausgeben, bevor sie alle Eingabezeilen empfangen hat.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-105">A transformation with asynchronous outputs may wait to complete its processing until the transformation has received all input rows, or the transformation may output certain rows before it has received all input rows.</span></span> <span data-ttu-id="1d9eb-106">In diesem Thema wird eine asynchrone Transformation erläutert.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-106">This topic discusses an asynchronous transformation.</span></span> <span data-ttu-id="1d9eb-107">Wenn die Verarbeitung eine synchrone Transformation erfordert, finden Sie weitere Informationen unter [Creating a Synchronous Transformation with the Script Component (Erstellen einer synchronen Transformation mit der Skriptkomponente)](../data-flow/transformations/script-component.md).</span><span class="sxs-lookup"><span data-stu-id="1d9eb-107">If your processing requires a synchronous transformation, see [Creating a Synchronous Transformation with the Script Component](../data-flow/transformations/script-component.md).</span></span> <span data-ttu-id="1d9eb-108">Weitere Informationen zu den Unterschieden zwischen synchronen und asynchronen Komponenten finden Sie unter [Understanding Synchronous and Asynchronous Transformations (Grundlegendes zu synchronen und asynchronen Transformationen)](../understanding-synchronous-and-asynchronous-transformations.md).</span><span class="sxs-lookup"><span data-stu-id="1d9eb-108">For more information about the differences between synchronous and asynchronous components, see [Understanding Synchronous and Asynchronous Transformations](../understanding-synchronous-and-asynchronous-transformations.md).</span></span>

 <span data-ttu-id="1d9eb-109">Eine Übersicht der Skriptkomponenten finden Sie unter [Extending the Data Flow with the Script Component (Erweitern des Datenflusses mit der Skriptkomponente)](../extending-packages-scripting/data-flow-script-component/extending-the-data-flow-with-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="1d9eb-109">For an overview of the Script component, see [Extending the Data Flow with the Script Component](../extending-packages-scripting/data-flow-script-component/extending-the-data-flow-with-the-script-component.md).</span></span>

 <span data-ttu-id="1d9eb-110">Die Skriptkomponente und der Infrastrukturcode, den sie generiert, erleichtern den Prozess der Entwicklung von benutzerdefinierten Datenflusskomponenten.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-110">The Script component and the infrastructure code that it generates for you simplify the process of developing a custom data flow component.</span></span> <span data-ttu-id="1d9eb-111">Zum Verständnis der Funktionsweise dieser Skriptkomponente kann es jedoch hilfreich sein, sich mit den im Abschnitt [Developing a Custom Data Flow Component (Entwickeln einer benutzerdefinierten Datenflusskomponente)](../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md) beschriebenen Schritten vertraut zu machen, die Sie bei der Entwicklung einer benutzerdefinierten Datenflusskomponente ausführen müssen, und zwar insbesondere mit [Developing a Custom Transformation Component with Synchronous Outputs (Entwickeln einer benutzerdefinierten Transformationskomponente mit synchronen Ausgaben)](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-synchronous-outputs.md).</span><span class="sxs-lookup"><span data-stu-id="1d9eb-111">However, to understand how the Script component works, you may find it useful to read through the steps that you must follow in developing a custom data flow component in the [Developing a Custom Data Flow Component](../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md) section, and especially [Developing a Custom Transformation Component with Synchronous Outputs](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-synchronous-outputs.md).</span></span>

## <a name="getting-started-with-an-asynchronous-transformation-component"></a><span data-ttu-id="1d9eb-112">Erste Schritte mit einer asynchronen Transformationskomponente</span><span class="sxs-lookup"><span data-stu-id="1d9eb-112">Getting Started with an Asynchronous Transformation Component</span></span>
 <span data-ttu-id="1d9eb-113">Wenn Sie auf der Registerkarte „Datenfluss“ des [!INCLUDE[ssIS](../../includes/ssis-md.md)]-Designers eine Skriptkomponente hinzufügen, wird das Dialogfeld **Skriptkomponententyp auswählen** geöffnet, in dem Sie zur Vorkonfiguration der Komponente als Quelle, Transformation oder Ziel aufgefordert werden.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-113">When you add a Script component to the Data Flow tab of [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, the **Select Script Component Type** dialog box appears, prompting you to preconfigure the component as a source, transformation, or destination.</span></span> <span data-ttu-id="1d9eb-114">Wählen Sie in diesem Dialogfeld die Option **Transformation** aus.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-114">In this dialog box, select **Transformation**.</span></span>

## <a name="configuring-an-asynchronous-transformation-component-in-metadata-design-mode"></a><span data-ttu-id="1d9eb-115">Konfigurieren einer asynchronen Transformationskomponente im Metadatenentwurfsmodus</span><span class="sxs-lookup"><span data-stu-id="1d9eb-115">Configuring an Asynchronous Transformation Component in Metadata-Design Mode</span></span>
 <span data-ttu-id="1d9eb-116">Nachdem Sie die Option zur Erstellung einer Transformationskomponente ausgewählt haben, konfigurieren Sie die Komponente mit dem **Transformations-Editor für Skripterstellung**.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-116">After you select the option to create a transformation component, you configure the component by using the **Script Transformation Editor**.</span></span> <span data-ttu-id="1d9eb-117">Weitere Informationen finden Sie unter [Configuring the Script Component in the Script Component Editor (Konfigurieren der Skriptkomponente im Skriptkomponenten-Editor)](../extending-packages-scripting/data-flow-script-component/configuring-the-script-component-in-the-script-component-editor.md).</span><span class="sxs-lookup"><span data-stu-id="1d9eb-117">For more information, see [Configuring the Script Component in the Script Component Editor](../extending-packages-scripting/data-flow-script-component/configuring-the-script-component-in-the-script-component-editor.md).</span></span>

 <span data-ttu-id="1d9eb-118">Legen Sie die **ScriptLanguage**-Eigenschaft auf der Seite **Skript** im Dialogfeld **Transformations-Editor für Skripterstellung** fest, um die Skriptsprache auszuwählen, die die Skriptkomponente verwendet.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-118">To select the script language that the Script component will use, you set the **ScriptLanguage** property on the **Script** page of the **Script Transformation Editor** dialog box.</span></span>

> [!NOTE]
>  <span data-ttu-id="1d9eb-119">Verwenden Sie im Dialogfeld **Optionen** auf der Seite **Allgemein** die Option **Skriptsprache**, um die Standardskriptsprache für die Skriptkomponente festzulegen.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-119">To set the default scripting language for the Script component, use the **Scripting language** option on the **General** page of the **Options** dialog box.</span></span> <span data-ttu-id="1d9eb-120">Weitere Informationen finden Sie unter [General Page](../general-page-of-integration-services-designers-options.md).</span><span class="sxs-lookup"><span data-stu-id="1d9eb-120">For more information, see [General Page](../general-page-of-integration-services-designers-options.md).</span></span>

 <span data-ttu-id="1d9eb-121">Eine Datenfluss-Transformationskomponente verfügt über eine Eingabe und unterstützt eine oder mehrere Ausgaben.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-121">A data flow transformation component has one input and supports one or more outputs.</span></span> <span data-ttu-id="1d9eb-122">Die Konfiguration der Eingaben und Ausgaben der Komponente ist einer der Schritte, die Sie mithilfe des **Transformations-Editors für Skripterstellung** im Metadatenentwurfsmodus ausführen müssen, bevor Sie das benutzerdefinierte Skript schreiben.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-122">Configuring the input and outputs of your component is one of the steps that you must complete in metadata design mode, by using the **Script Transformation Editor**, before you write your custom script.</span></span>

### <a name="configuring-input-columns"></a><span data-ttu-id="1d9eb-123">Konfigurieren von Eingabespalten</span><span class="sxs-lookup"><span data-stu-id="1d9eb-123">Configuring Input Columns</span></span>
 <span data-ttu-id="1d9eb-124">Eine mit der Skriptkomponente erstellte Transformationskomponente verfügt über eine einzelne Eingabe.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-124">A transformation component created by using the Script component has a single input.</span></span>

 <span data-ttu-id="1d9eb-125">Die Spaltenliste auf der Seite **Eingabespalten** im **Transformations-Editor für Skripterstellung** zeigt die von der Ausgabe der Upstreamkomponente im Datenfluss verfügbaren Spalten.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-125">On the **Input Columns** page of the **Script Transformation Editor**, the columns list shows the available columns from the output of the upstream component in the data flow.</span></span> <span data-ttu-id="1d9eb-126">Markieren Sie die Spalten, die Sie transformieren oder durchlaufen möchten.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-126">Select the columns that you want to transform or pass through.</span></span> <span data-ttu-id="1d9eb-127">Markieren Sie alle Spalten, die Sie an Ort und Stelle transformieren möchten, als Lesen/Schreiben.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-127">Mark any columns that you want to transform in place as Read/Write.</span></span>

 <span data-ttu-id="1d9eb-128">Weitere Informationen über die Seite **Eingabespalten** im **Transformations-Editor für Skripterstellung** finden Sie unter [Script Transformation Editor (Input Columns Page) (Transformations-Editor für Skripterstellung (Seite „Eingabespalten“))](../script-transformation-editor-input-columns-page.md).</span><span class="sxs-lookup"><span data-stu-id="1d9eb-128">For more information about the **Input Columns** page of the **Script Transformation Editor**, see [Script Transformation Editor &#40;Input Columns Page&#41;](../script-transformation-editor-input-columns-page.md).</span></span>

### <a name="configuring-inputs-outputs-and-output-columns"></a><span data-ttu-id="1d9eb-129">Konfigurieren von Eingaben, Ausgaben und Ausgabespalten</span><span class="sxs-lookup"><span data-stu-id="1d9eb-129">Configuring Inputs, Outputs, and Output Columns</span></span>
 <span data-ttu-id="1d9eb-130">Eine Transformationskomponente unterstützt eine oder mehrere Ausgaben.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-130">A transformation component supports one or more outputs.</span></span>

 <span data-ttu-id="1d9eb-131">Häufig hat eine Transformation mit asynchronen Ausgaben zwei Ausgaben.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-131">Frequently a transformation with asynchronous outputs has two outputs.</span></span> <span data-ttu-id="1d9eb-132">Wenn Sie beispielsweise die Anzahl der Adressen in einer bestimmten Stadt zählen, sollten Sie die Adressdaten an einen Ausgang weitergeben, während Sie das Ergebnis der Aggregation an einen anderen Ausgang senden.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-132">For example, when you count the number of addresses located in a specific city, you may want to pass the address data through to one output, while sending the result of the aggregation to another output.</span></span> <span data-ttu-id="1d9eb-133">Die Aggregationsausgabe erfordert auch eine neue Ausgabespalte.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-133">The aggregation output also requires a new output column.</span></span>

 <span data-ttu-id="1d9eb-134">Auf der Seite **Eingaben und Ausgaben** im **Transformations-Editor für Skripterstellung** wird Ihnen angezeigt, dass standardmäßig eine Ausgabe, jedoch keine Ausgabespalten erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-134">On the **Inputs and Outputs** page of the **Script Transformation Editor**, you see that a single output has been created by default, but no output columns have been created.</span></span> <span data-ttu-id="1d9eb-135">Auf dieser Seite des Editors können Sie die folgenden Elemente konfigurieren:</span><span class="sxs-lookup"><span data-stu-id="1d9eb-135">On this page of the editor, you can configure the following items:</span></span>

-   <span data-ttu-id="1d9eb-136">Sie haben die Möglichkeit, eine oder mehrere zusätzliche Ausgaben zu erstellen, beispielsweise eine Ausgabe für das Ergebnis einer Aggregation.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-136">You may want to create one or more additional outputs, such as an output for the result of an aggregation.</span></span> <span data-ttu-id="1d9eb-137">Verwenden Sie die Schaltflächen **Ausgabe hinzufügen** und **Ausgabe entfernen**, um die Ausgaben der asynchronen Transformationskomponente zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-137">Use the **Add Output** and **Remove Output** buttons to manage the outputs of your asynchronous transformation component.</span></span> <span data-ttu-id="1d9eb-138">Legen Sie die `SynchronousInputID`-Eigenschaft jeder Ausgabe auf Null, um anzugeben, dass die Ausgabe nicht nur einfach Daten von einer Upstreamkomponente weitergibt oder sie an Ort und Stelle in den vorhandenen Zeilen und Spalten transformiert.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-138">Set the `SynchronousInputID` property of each output to zero to indicate that the output does not simply pass through data from an upstream component or transform it in place in the existing rows and columns.</span></span> <span data-ttu-id="1d9eb-139">Durch dies Einstellung werden die Ausgaben asynchron zur Eingabe.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-139">It is this setting that makes the outputs asynchronous to the input.</span></span>

-   <span data-ttu-id="1d9eb-140">Sie können der Eingabe und den Ausgaben einen beschreibenden Namen geben.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-140">You may want to assign a friendly name to the input and outputs.</span></span> <span data-ttu-id="1d9eb-141">In der Skriptkomponente werden diese Namen verwendet, um die typisierten Accessoreigenschaften zu erzeugen, mit denen Sie auf die Eingabe und die Ausgaben in Ihrem Skript verweisen.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-141">The Script component uses these names to generate the typed accessor properties that you will use to refer to the input and outputs in your script.</span></span>

-   <span data-ttu-id="1d9eb-142">Häufig werden durch eine asynchrone Transformation dem Datenfluss Spalten hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-142">Frequently an asynchronous transformation adds columns to the data flow.</span></span> <span data-ttu-id="1d9eb-143">Wenn die `SynchronousInputID`-Eigenschaft einer Ausgabe Null beträgt, was angibt, dass die Ausgabe nicht nur einfach Daten von einer Upstreamkomponente weitergibt oder sie an Ort und Stelle in den vorhandenen Zeilen und Spalten transformiert, müssen Sie in der Ausgabe explizit Ausgabespalten hinzufügen und diese konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-143">When the `SynchronousInputID` property of an output is zero, indicating that the output does not simply pass through data from an upstream component or transform it in place in the existing rows and columns, you must add and configure output columns explicitly on the output.</span></span> <span data-ttu-id="1d9eb-144">Ausgabespalten haben nicht dieselben Namen wie die Eingabespalten, denen sie zugeordnet sind.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-144">Output columns do not have to have the same names as the input columns to which they are mapped.</span></span>

-   <span data-ttu-id="1d9eb-145">Sie können weitere Spalten hinzufügen, um zusätzliche Informationen aufzunehmen.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-145">You may want to add more columns to contain additional information.</span></span> <span data-ttu-id="1d9eb-146">Sie müssen einen eigenen Code schreiben, um die zusätzlichen Spalten mit Daten aufzufüllen.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-146">You must write your own code to fill the additional columns with data.</span></span> <span data-ttu-id="1d9eb-147">Weitere Informationen über das Reproduzieren des Verhaltens einer Standardfehlerausgabe finden Sie unter [Simulating an Error Output for the Script Component (Simulieren einer Fehlerausgabe für die Skriptkomponente)](../extending-packages-scripting-data-flow-script-component-examples/simulating-an-error-output-for-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="1d9eb-147">For information about reproducing the behavior of a standard error output, see [Simulating an Error Output for the Script Component](../extending-packages-scripting-data-flow-script-component-examples/simulating-an-error-output-for-the-script-component.md).</span></span>

 <span data-ttu-id="1d9eb-148">Weitere Informationen über die Seite **Eingaben und Ausgaben** im **Transformations-Editor für Skripterstellung** finden Sie unter [Script Transformation Editor (Inputs and Outputs Page) (Transformations-Editor für Skripterstellung (Seite „Eingaben und Ausgaben“))](../script-transformation-editor-inputs-and-outputs-page.md).</span><span class="sxs-lookup"><span data-stu-id="1d9eb-148">For more information about the **Inputs and Outputs** page of the **Script Transformation Editor**, see [Script Transformation Editor &#40;Inputs and Outputs Page&#41;](../script-transformation-editor-inputs-and-outputs-page.md).</span></span>

### <a name="adding-variables"></a><span data-ttu-id="1d9eb-149">Hinzufügen von Variablen</span><span class="sxs-lookup"><span data-stu-id="1d9eb-149">Adding Variables</span></span>
 <span data-ttu-id="1d9eb-150">Wenn Sie die Werte von vorhandenen Variablen in Ihrem Skript verwenden möchten, können Sie diese in den Eigenschaftenfeldern „ReadOnlyVariables“ und „ReadWriteVariables“ auf der Seite **Skript** im **Transformations-Editor für Skripterstellung** hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-150">If there are any existing variables whose values you want to use in your script, you can add them in the ReadOnlyVariables and ReadWriteVariables property fields on the **Script** page of the **Script Transformation Editor**.</span></span>

 <span data-ttu-id="1d9eb-151">Wenn Sie mehrere Variablen in die Eigenschaftsfelder hinzufügen, trennen Sie die Variablennamen durch Kommas.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-151">When you add multiple variables in the property fields, separate the variable names by commas.</span></span> <span data-ttu-id="1d9eb-152">Sie können auch mehrere Variablen auswählen, indem Sie auf die Schaltfläche mit den Auslassungs Punkten (**...**) neben den `ReadOnlyVariables` `ReadWriteVariables` Eigenschaften Feldern und klicken und dann die Variablen im Dialogfeld **Variablen auswählen** auswählen.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-152">You can also select multiple variables by clicking the ellipsis (**...**) button next to the `ReadOnlyVariables` and `ReadWriteVariables` property fields, and then selecting the variables in the **Select variables** dialog box.</span></span>

 <span data-ttu-id="1d9eb-153">Allgemeine Informationen über das Verwenden von Variablen mit der Skriptkomponente finden Sie unter [Using Variables in the Script Component (Verwenden von Variablen in der Skriptkomponente)](../extending-packages-scripting/data-flow-script-component/using-variables-in-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="1d9eb-153">For general information about how to use variables with the Script component, see [Using Variables in the Script Component](../extending-packages-scripting/data-flow-script-component/using-variables-in-the-script-component.md).</span></span>

 <span data-ttu-id="1d9eb-154">Weitere Informationen über die Seite **Skript** im **Transformations-Editor für Skripterstellung** finden Sie unter [Script Transformation Editor (Script Page) (Transformations-Editor für Skripterstellung (Seite „Skript“))](../script-transformation-editor-script-page.md).</span><span class="sxs-lookup"><span data-stu-id="1d9eb-154">For more information about the **Script** page of the **Script Transformation Editor**, see [Script Transformation Editor &#40;Script Page&#41;](../script-transformation-editor-script-page.md).</span></span>

## <a name="scripting-an-asynchronous-transformation-component-in-code-design-mode"></a><span data-ttu-id="1d9eb-155">Skripterstellung für eine asynchrone Transformationskomponente im Codeentwurfsmodus</span><span class="sxs-lookup"><span data-stu-id="1d9eb-155">Scripting an Asynchronous Transformation Component in Code-Design Mode</span></span>
 <span data-ttu-id="1d9eb-156">Nachdem Sie alle Metadaten für Ihre Komponente konfiguriert haben, können Sie das benutzerdefinierte Skript schreiben.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-156">After you have configured all the metadata for your component, you can write your custom script.</span></span> <span data-ttu-id="1d9eb-157">Klicken Sie auf der Seite **Skript** im **Transformations-Editor für Skripterstellung** auf **Skript bearbeiten**, um die [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications-IDE (VSTA) zu öffnen und Ihr benutzerdefiniertes Skript hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-157">In the **Script Transformation Editor**, on the **Script** page, click **Edit Script** to open the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications (VSTA) IDE where you can add your custom script.</span></span> <span data-ttu-id="1d9eb-158">Welche Skriptsprache Sie verwenden, hängt davon ab, ob Sie auf der Seite **Skript**[!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic oder [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C# als Skriptsprache für die **ScriptLanguage**-Eigenschaft festgelegt haben.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-158">The scripting language that you use depends on whether you selected [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic or [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C# as the script language for the **ScriptLanguage** property on the **Script** page.</span></span>

 <span data-ttu-id="1d9eb-159">Wichtige Informationen, die alle Arten von Komponenten betreffen, die mithilfe der Skriptkomponente erstellt wurden, finden Sie unter [Coding and Debugging the Script Component (Codieren und Debuggen der Skriptkomponente)](../extending-packages-scripting/data-flow-script-component/coding-and-debugging-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="1d9eb-159">For important information that applies to all kinds of components created by using the Script component, see [Coding and Debugging the Script Component](../extending-packages-scripting/data-flow-script-component/coding-and-debugging-the-script-component.md).</span></span>

### <a name="understanding-the-auto-generated-code"></a><span data-ttu-id="1d9eb-160">Grundlegendes zum automatisch generierten Code</span><span class="sxs-lookup"><span data-stu-id="1d9eb-160">Understanding the Auto-generated Code</span></span>
 <span data-ttu-id="1d9eb-161">Wenn Sie nach der Erstellung und Konfiguration einer Transformations Komponente die VSTA-IDE öffnen, wird die bearbeitbare `ScriptMain` Klasse im Code-Editor mit stufstufstubweise für die Methoden ProcessInputRow und die Methode kreatenewoutputrows angezeigt.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-161">When you open the VSTA IDE after creating and configuring a transformation component, the editable `ScriptMain` class appears in the code editor with stubs for the ProcessInputRow and the CreateNewOutputRows methods.</span></span> <span data-ttu-id="1d9eb-162">Sie schreiben Ihren benutzerdefinierten Code in der ScriptMain-Klasse. „ProcessInputRow“ ist die wichtigste Methode in einer Transformationskomponente.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-162">The ScriptMain class is where you will write your custom code, and ProcessInputRow is the most important method in a transformation component.</span></span> <span data-ttu-id="1d9eb-163">Die `CreateNewOutputRows`-Methode wird eher in einer Quellkomponente verwendet, die insofern wie eine asynchrone Transformation funktioniert, dass beide Komponenten eigene Ausgabezeilen erstellen müssen.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-163">The `CreateNewOutputRows` method is more typically used in a source component, which is like an asynchronous transformation in that both components must create their own output rows.</span></span>

 <span data-ttu-id="1d9eb-164">Wenn Sie das Fenster VSTA- **Projekt-Explorer** öffnen, können Sie sehen, dass die Skript Komponente auch schreibgeschützte-und- `BufferWrapper` `ComponentWrapper` Projekt Elemente generiert hat.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-164">If you open the VSTA **Project Explorer** window, you can see that the Script component has also generated read-only `BufferWrapper` and `ComponentWrapper` project items.</span></span> <span data-ttu-id="1d9eb-165">Die ScriptMain-Klasse erbt von der UserComponent-Klasse im- `ComponentWrapper` Projekt Element.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-165">The ScriptMain class inherits from the UserComponent class in the `ComponentWrapper` project item.</span></span>

 <span data-ttu-id="1d9eb-166">Zur Laufzeit ruft die Datenfluss-Engine die PrimeOutput-Methode in der- `UserComponent` Klasse auf, die die- <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponentHost.PrimeOutput%2A> Methode der übergeordneten-Klasse überschreibt <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent> .</span><span class="sxs-lookup"><span data-stu-id="1d9eb-166">At run time, the data flow engine calls the PrimeOutput method in the `UserComponent` class, which overrides the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponentHost.PrimeOutput%2A> method of the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent> parent class.</span></span> <span data-ttu-id="1d9eb-167">Die PrimeOutput-Methode ruft wiederum die CreateNewOutputRows-Methode auf.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-167">The PrimeOutput method in turn calls the CreateNewOutputRows method.</span></span>

 <span data-ttu-id="1d9eb-168">Danach ruft die Datenfluss-Engine die ProcessInput-Methode in der UserComponent-Klasse auf, die die <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ProcessInput%2A>-Methode der übergeordneten <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent>-Klasse überschreibt.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-168">Next, the data flow engine invokes the ProcessInput method in the UserComponent class, which overrides the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ProcessInput%2A> method of the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent> parent class.</span></span> <span data-ttu-id="1d9eb-169">Die ProcessInput-Methode durchläuft die Zeilen im Eingabepuffer der Reihe nach und ruft für jede Zeile einmal die ProcessInputRow-Methode auf.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-169">The ProcessInput method in turn loops through the rows in the input buffer and calls the ProcessInputRow method one time for each row.</span></span>

### <a name="writing-your-custom-code"></a><span data-ttu-id="1d9eb-170">Schreiben von benutzerdefiniertem Code</span><span class="sxs-lookup"><span data-stu-id="1d9eb-170">Writing Your Custom Code</span></span>
 <span data-ttu-id="1d9eb-171">Sie müssen mit der überschriebenen ProcessInputRow-Methode die Daten in jeder Zeile des Eingabepuffers verarbeiten, um die Erstellung einer benutzerdefinierten asynchronen Transformationskomponente abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-171">To finish creating a custom asynchronous transformation component, you must use the overridden ProcessInputRow method to process the data in each row of the input buffer.</span></span> <span data-ttu-id="1d9eb-172">Weil die Ausgaben nicht mit der Eingabe synchron sind, müssen Sie Datenzeilen explizit in die Ausgaben schreiben.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-172">Because the outputs are not synchronous to the input, you must explicitly write rows of data to the outputs.</span></span>

 <span data-ttu-id="1d9eb-173">Bei einer asynchronen Transformation können Sie mit der AddRow-Methode der Ausgabe bei Bedarf Zeilen aus der Methode „ProcessInputRow“ oder „ProcessInput“ heraus hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-173">In an asynchronous transformation, you can use the AddRow method to add rows to the output as appropriate from within the ProcessInputRow or ProcessInput methods.</span></span> <span data-ttu-id="1d9eb-174">Sie müssen nicht die CreateNewOutputRows-Methode verwenden.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-174">You do not have to use the CreateNewOutputRows method.</span></span> <span data-ttu-id="1d9eb-175">Wenn Sie eine einzelne Ergebniszeile, z.B. Aggregationsergebnisse, in eine bestimmte Ausgabe schreiben, können Sie die Ausgabezeile vorher mithilfe der CreateNewOutputRows-Methode erstellen und ihre Werte später nach Verarbeitung aller Eingabezeilen auffüllen.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-175">If you are writing a single row of results, such as aggregation results, to a particular output, you can create the output row beforehand by using the CreateNewOutputRows method, and fill in its values later after processing all input rows.</span></span> <span data-ttu-id="1d9eb-176">Es ist jedoch nicht sinnvoll, in der CreateNewOutputRows-Methode mehrere Zeilen zu erstellen, weil mit der Skriptkomponente nur die aktuelle Zeile in einer Eingabe oder Ausgabe verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-176">However it is not useful to create multiple rows in the CreateNewOutputRows method, because the Script component only lets you use the current row in an input or output.</span></span> <span data-ttu-id="1d9eb-177">Die CreateNewOutputRows-Methode ist bei einer Quellkomponente wichtiger, bei der keine Eingabezeilen zu verarbeiten sind.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-177">The CreateNewOutputRows method is more important in a source component where there are no input rows to process.</span></span>

 <span data-ttu-id="1d9eb-178">Sie können auch die ProcessInput-Methode überschreiben, damit Sie zusätzliche vorbereitende oder abschließende Verarbeitungsvorgänge ausführen können, bevor oder nachdem Sie den Eingabepuffer durchlaufen und ProcessInputRow für jede Zeile aufrufen.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-178">You may also want to override the ProcessInput method itself, so that you can do additional preliminary or final processing before or after you loop through the input buffer and call ProcessInputRow for each row.</span></span> <span data-ttu-id="1d9eb-179">Eines der Codebeispiele in diesem Thema überschreibt z. b. ProcessInput, um die Anzahl der Adressen in einer bestimmten Stadt zu zählen, während ProcessInputRow durch Zeilen durchläuft `.` . im Beispiel wird der Zusammenfassungs Wert in die zweite Ausgabe geschrieben, nachdem alle Zeilen verarbeitet wurden.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-179">For example, one of the code examples in this topic overrides ProcessInput to count the number of addresses in a specific city as ProcessInputRow loops through rows`.` The example writes the summary value to the second output after all rows have been processed.</span></span> <span data-ttu-id="1d9eb-180">In diesem Beispiel wird die Ausgabe in ProcessInput abgeschlossen, weil die Ausgabepuffer nicht mehr verfügbar sind, wenn PostExecute aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-180">The example completes the output in ProcessInput because the output buffers are no longer available when PostExecute is called.</span></span>

 <span data-ttu-id="1d9eb-181">Je nach Anforderung können Sie auch Skript in den Methoden „PreExecute“ und „PostExecute“ schreiben, die in der ScriptMain-Klasse verfügbar sind, um vorbereitende oder abschließende Verarbeitungsvorgänge auszuführen.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-181">Depending on your requirements, you may also want to write script in the PreExecute and PostExecute methods available in the ScriptMain class to perform any preliminary or final processing.</span></span>

> [!NOTE]
>  <span data-ttu-id="1d9eb-182">Wenn Sie eine benutzerdefinierte Datenflusskomponente von Grund auf erstellen, ist es wichtig, die PrimeOutput-Methode zu überschreiben, um Verweise auf die Ausgabepuffer zwischenzuspeichern, damit Sie den Puffern später Datenzeilen hinzufügen können.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-182">If you were developing a custom data flow component from scratch, it would be important to override the PrimeOutput method to cache references to the output buffers so that you could add rows of data to the buffers later.</span></span> <span data-ttu-id="1d9eb-183">In der Skriptkomponenten ist das nicht notwendig, weil eine automatisch erzeugte Klasse jeden Ausgabepuffer im `BufferWrapper`-Projektelement erstellt.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-183">In the Script component, this is not necessary because you have an automatically generated class representing each output buffer in the `BufferWrapper` project item.</span></span>

## <a name="example"></a><span data-ttu-id="1d9eb-184">Beispiel</span><span class="sxs-lookup"><span data-stu-id="1d9eb-184">Example</span></span>
 <span data-ttu-id="1d9eb-185">In diesem Beispiel wird der benutzerdefinierte Code veranschaulicht, der in der ScriptMain-Klasse zur Erstellung einer asynchronen Transformationskomponente erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-185">This example demonstrates the custom code that is required in the ScriptMain class to create an asynchronous transformation component.</span></span>

> [!NOTE]
>  <span data-ttu-id="1d9eb-186">In diesen Beispielen werden die erste und die vierte Spalte der Tabelle **Person.Address** in der Beispieldatenbank **AdventureWorks** verwendet, und die Spalten **intAddressID** und **nvarchar(30)City** werden durch den Datenfluss weitergeleitet.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-186">These examples use the **Person.Address** table in the **AdventureWorks** sample database and pass its first and fourth columns, the **intAddressID** and **nvarchar(30)City** columns, through the data flow.</span></span> <span data-ttu-id="1d9eb-187">Die gleichen Daten werden in den Quellen-, Transformations- und Zielbeispielen in diesem Abschnitt verwendet.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-187">The same data is used in the source, transformation, and destination samples in this section.</span></span> <span data-ttu-id="1d9eb-188">Zusätzliche Voraussetzungen und Annahmen werden für jedes Beispiel dokumentiert.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-188">Additional prerequisites and assumptions are documented for each example.</span></span>

 <span data-ttu-id="1d9eb-189">Dieses Beispiel zeigt eine asynchrone Transformationskomponente mit zwei Ausgaben.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-189">This example demonstrates an asynchronous transformation component with two outputs.</span></span> <span data-ttu-id="1d9eb-190">Bei dieser Transformation werden die Spalten **AddressID** und **City** an eine Ausgabe übergeben. Gleichzeitig wird die Anzahl von Adressen in einer bestimmten Stadt (Redmond, Washington, USA) gezählt, und der resultierende Wert wird an einer zweite Ausgabe ausgegeben.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-190">This transformation passes through the **AddressID** and **City** columns to one output, while it counts the number of addresses located in a specific city (Redmond, Washington, U.S.A.), and then outputs the resulting value to a second output.</span></span>

 <span data-ttu-id="1d9eb-191">Wenn Sie den Beispielcode ausführen möchten, müssen Sie das Paket und die Komponente folgendermaßen konfigurieren:</span><span class="sxs-lookup"><span data-stu-id="1d9eb-191">If you want to run this sample code, you must configure the package and the component as follows:</span></span>

1.  <span data-ttu-id="1d9eb-192">Fügen Sie der Datenfluss-Designeroberfläche eine neue Skriptkomponente hinzu, und konfigurieren Sie sie als Transformation.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-192">Add a new Script component to the Data Flow designer surface and configure it as a transformation.</span></span>

2.  <span data-ttu-id="1d9eb-193">Verbinden Sie die Ausgabe einer Quelle einer anderen Transformation mit der neuen Transformation im Designer.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-193">Connect the output of a source or of another transformation to the new transformation component in the designer.</span></span> <span data-ttu-id="1d9eb-194">Diese Ausgabe sollte Daten aus der Tabelle **Person.Address** der Beispieldatenbank **AdventureWorks** bereitstellen, die mindestens die Spalten **AddressID** und **City** enthält.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-194">This output should provide data from the **Person.Address** table of the **AdventureWorks** sample database that contains at least the **AddressID** and **City** columns.</span></span>

3.  <span data-ttu-id="1d9eb-195">Öffnen Sie den **Transformations-Editor für Skripterstellung**.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-195">Open the **Script Transformation Editor**.</span></span> <span data-ttu-id="1d9eb-196">Wählen Sie auf der Seite **Eingabespalten** die Spalten **AddressID** und **City** aus.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-196">On the **Input Columns** page, select the **AddressID** and **City** columns.</span></span>

4.  <span data-ttu-id="1d9eb-197">Fügen Sie auf der Seite **Eingaben und Ausgaben** die Ausgabespalten **AddressID** und **City** hinzu, und konfigurieren Sie sie auf der ersten Ausgabe.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-197">On the **Inputs and Outputs** page, add and configure the **AddressID** and **City** output columns on the first output.</span></span> <span data-ttu-id="1d9eb-198">Fügen Sie eine zweite Ausgabe hinzu, und fügen Sie eine Ausgabespalte für den Zusammenfassungswert in der zweiten Ausgabe hinzu.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-198">Add a second output, and add an output column for the summary value on the second output.</span></span> <span data-ttu-id="1d9eb-199">Setzen Sie die SynchronousInputID-Eigenschaft der ersten Ausgabe auf 0, weil in diesem Beispiel jede Eingabezeile explizit in die erste Ausgabe kopiert wird.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-199">Set the SynchronousInputID property of the first output to 0, because this example copies each input row explicitly to the first output.</span></span> <span data-ttu-id="1d9eb-200">Die SynchronousInputID-Eigenschaft der neu erstellten Ausgabe ist bereits auf 0 gesetzt.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-200">The SynchronousInputID property of the newly-created output is already set to 0.</span></span>

5.  <span data-ttu-id="1d9eb-201">Benennen Sie die Eingabe, die Ausgaben und die neue Ausgabespalte um, um ihnen beschreibendere Namen zu geben.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-201">Rename the input, the outputs, and the new output column to give them more descriptive names.</span></span> <span data-ttu-id="1d9eb-202">Im Beispiel wird **MyAddressInput** als Name der Eingabe, **MyAddressOutput** und **MySummaryOutput** für die Ausgaben und **MyRedmondCount** für die Ausgabespalte in der zweiten Ausgabe verwendet.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-202">The example uses **MyAddressInput** as the name of the input, **MyAddressOutput** and **MySummaryOutput** for the outputs, and **MyRedmondCount** for the output column on the second output.</span></span>

6.  <span data-ttu-id="1d9eb-203">Klicken Sie auf der Seite **Skript** auf **Skript bearbeiten**, und geben Sie das folgende Skript ein.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-203">On the **Script** page, click **Edit Script** and enter the script that follows.</span></span> <span data-ttu-id="1d9eb-204">Schließen Sie anschließend die Skriptentwicklungsumgebung und den **Transformations-Editor für Skripterstellung**.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-204">Then close the script development environment and the **Script Transformation Editor**.</span></span>

7.  <span data-ttu-id="1d9eb-205">Erstellen und konfigurieren Sie eine Zielkomponente für die erste Ausgabe, die die Spalten **AddressID** und **City** erwartet, z.B. ein [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-Ziel, oder die Beispielzielkomponente, die unter [Creating a Destination with the Script Component (Erstellen eines Ziels mit der Skriptkomponente)](../extending-packages-scripting-data-flow-script-component-types/creating-a-destination-with-the-script-component.md) veranschaulicht wird.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-205">Create and configure a destination component for the first output that expects the **AddressID** and **City** columns, such as a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] destination, or the sample destination component demonstrated in [Creating a Destination with the Script Component](../extending-packages-scripting-data-flow-script-component-types/creating-a-destination-with-the-script-component.md), .</span></span> <span data-ttu-id="1d9eb-206">Verbinden Sie anschließend die erste Ausgabe der Transformation, **MyAddressOutput**, mit der Zielkomponente.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-206">Then connect the first output of the transformation, **MyAddressOutput**, to the destination component.</span></span> <span data-ttu-id="1d9eb-207">Sie können eine Zieltabelle erstellen, indem Sie den folgenden [!INCLUDE[tsql](../../includes/tsql-md.md)]-Befehl in der **AdventureWorks**-Datenbank ausführen:</span><span class="sxs-lookup"><span data-stu-id="1d9eb-207">You can create a destination table by running the following [!INCLUDE[tsql](../../includes/tsql-md.md)] command in the **AdventureWorks** database:</span></span>

    ```
    CREATE TABLE [Person].[Address2]([AddressID] [int] NOT NULL,
        [City] [nvarchar](30) NOT NULL)
    ```

8.  <span data-ttu-id="1d9eb-208">Erstellen Sie eine weitere Zielkomponente für die zweite Ausgabe, und konfigurieren Sie sie.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-208">Create and configure another destination component for the second output.</span></span> <span data-ttu-id="1d9eb-209">Verbinden Sie dann die zweite Ausgabe der Transformation, **MySummaryOutput**, mit der Zielkomponente.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-209">Then connect the second output of the transformation, **MySummaryOutput**, to the destination component.</span></span> <span data-ttu-id="1d9eb-210">Da in der zweiten Ausgabe eine einzelne Zeile mit nur einem Wert geschrieben wird, können Sie mit einem Verbindungs-Manager für Flatfiles, der eine Verbindung zu einer neuen Datei mit einer Spalte herstellt, einfach ein Ziel konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-210">Because the second output writes a single row with a single value, you can easily configure a destination with a Flat File connection manager that connects to a new file that has a single column.</span></span> <span data-ttu-id="1d9eb-211">Im Beispiel wird diese Zielspalte **MyRedmondCount** genannt.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-211">In the example, this destination column is named **MyRedmondCount**.</span></span>

9. <span data-ttu-id="1d9eb-212">Führen Sie das Beispiel aus.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-212">Run the sample.</span></span>

```vb
Public Class ScriptMain
    Inherits UserComponent

    Private myRedmondAddressCount As Integer

    Public Overrides Sub CreateNewOutputRows()

        MySummaryOutputBuffer.AddRow()

    End Sub

    Public Overrides Sub MyAddressInput_ProcessInput(ByVal Buffer As MyAddressInputBuffer)

        While Buffer.NextRow()
            MyAddressInput_ProcessInputRow(Buffer)
        End While

        If Buffer.EndOfRowset Then
            MyAddressOutputBuffer.SetEndOfRowset()
            MySummaryOutputBuffer.MyRedmondCount = myRedmondAddressCount
            MySummaryOutputBuffer.SetEndOfRowset()
        End If

    End Sub

    Public Overrides Sub MyAddressInput_ProcessInputRow(ByVal Row As MyAddressInputBuffer)

        With MyAddressOutputBuffer
            .AddRow()
            .AddressID = Row.AddressID
            .City = Row.City
        End With

        If Row.City.ToUpper = "REDMOND" Then
            myRedmondAddressCount += 1
        End If

    End Sub

End Class
```

```csharp
public class ScriptMain:
    UserComponent

{
    private int myRedmondAddressCount;

    public override void CreateNewOutputRows()
    {

        MySummaryOutputBuffer.AddRow();

    }

    public override void MyAddressInput_ProcessInput(MyAddressInputBuffer Buffer)
    {

        while (Buffer.NextRow())
        {
            MyAddressInput_ProcessInputRow(Buffer);
        }

        if (Buffer.EndOfRowset())
        {
            MyAddressOutputBuffer.SetEndOfRowset();
            MySummaryOutputBuffer.MyRedmondCount = myRedmondAddressCount;
            MySummaryOutputBuffer.SetEndOfRowset();
        }

    }

    public override void MyAddressInput_ProcessInputRow(MyAddressInputBuffer Row)
    {

        {
            MyAddressOutputBuffer.AddRow();
            MyAddressOutputBuffer.AddressID = Row.AddressID;
            MyAddressOutputBuffer.City = Row.City;
        }

        if (Row.City.ToUpper() == "REDMOND")
        {
            myRedmondAddressCount += 1;
        }

    }

}

```

<span data-ttu-id="1d9eb-213">![Integration Services Symbol (klein)](../media/dts-16.gif "Integration Services (kleines Symbol)")immer auf**dem neuesten Stand bleiben mit Integration Services**  </span><span class="sxs-lookup"><span data-stu-id="1d9eb-213">![Integration Services icon (small)](../media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="1d9eb-214">Die neuesten Downloads, Artikel, Beispiele und Videos von Microsoft sowie ausgewählte Lösungen aus der Community finden Sie auf MSDN auf der [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] -Seite:</span><span class="sxs-lookup"><span data-stu-id="1d9eb-214">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="1d9eb-215">Besuchen Sie die Integration Services-Seite auf MSDN</span><span class="sxs-lookup"><span data-stu-id="1d9eb-215">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="1d9eb-216">Abonnieren Sie die auf der Seite verfügbaren RSS-Feeds, um automatische Benachrichtigungen zu diesen Updates zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="1d9eb-216">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>

## <a name="see-also"></a><span data-ttu-id="1d9eb-217">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="1d9eb-217">See Also</span></span>
 <span data-ttu-id="1d9eb-218">Grundlegendes zu [synchronen und asynchronen Transformationen](../understanding-synchronous-and-asynchronous-transformations.md) [Erstellen einer synchronen Transformation mit der Skript Komponente](../extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md) [Entwickeln einer benutzerdefinierten Transformations Komponente mit asynchronen Ausgaben](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-asynchronous-outputs.md)</span><span class="sxs-lookup"><span data-stu-id="1d9eb-218">[Understanding Synchronous and Asynchronous Transformations](../understanding-synchronous-and-asynchronous-transformations.md) [Creating a Synchronous Transformation with the Script Component](../extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md) [Developing a Custom Transformation Component with Asynchronous Outputs](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-asynchronous-outputs.md)</span></span>



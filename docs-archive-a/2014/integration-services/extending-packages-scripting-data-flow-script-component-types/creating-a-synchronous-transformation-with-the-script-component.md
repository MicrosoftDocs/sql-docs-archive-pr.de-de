---
title: Erstellen einer synchronen Transformation mit der Skriptkomponente | Microsoft-Dokumentation
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
dev_langs:
- VB
helpviewer_keywords:
- synchronous outputs [Integration Services]
- transformation components [Integration Services]
- Script component [Integration Services], transformation components
ms.assetid: aa1bee1a-ab06-44d8-9944-4bff03d73016
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 34252f1caba4e2c1b3b99788d32527a33793b6ab
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87618774"
---
# <a name="creating-a-synchronous-transformation-with-the-script-component"></a><span data-ttu-id="7de91-102">Erstellen einer synchronen Transformation mit der Skriptkomponente</span><span class="sxs-lookup"><span data-stu-id="7de91-102">Creating a Synchronous Transformation with the Script Component</span></span>
  <span data-ttu-id="7de91-103">Transformationskomponenten dienen im Datenfluss eines [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]-Pakets dazu, Daten auf dem Weg von der Quelle zum Ziel zu ändern und zu analysieren.</span><span class="sxs-lookup"><span data-stu-id="7de91-103">You use a transformation component in the data flow of an [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] package to modify and analyze data as it passes from source to destination.</span></span> <span data-ttu-id="7de91-104">Eine Transformation mit synchronen Ausgaben verarbeitet jede eingegebene Zeile, während sie die Komponente durchläuft.</span><span class="sxs-lookup"><span data-stu-id="7de91-104">A transformation with synchronous outputs processes each input row as it passes through the component.</span></span> <span data-ttu-id="7de91-105">Eine Transformation mit asynchronen Ausgaben wartet, bis alle Eingabezeilen empfangen wurden, bevor die Verarbeitung abgeschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="7de91-105">A transformation with asynchronous outputs waits until it has received all input rows to complete its processing.</span></span> <span data-ttu-id="7de91-106">In diesem Thema wird eine synchrone Transformation erläutert.</span><span class="sxs-lookup"><span data-stu-id="7de91-106">This topic discusses a synchronous transformation.</span></span> <span data-ttu-id="7de91-107">Informationen zur asynchronen Transformation finden Sie unter [Creating an Asynchronous Transformation with the Script Component (Erstellen einer asynchronen Transformationen mit der Skriptkomponente)](../extending-packages-scripting-data-flow-script-component-types/creating-an-asynchronous-transformation-with-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="7de91-107">For information about asynchronous transformations, see [Creating an Asynchronous Transformation with the Script Component](../extending-packages-scripting-data-flow-script-component-types/creating-an-asynchronous-transformation-with-the-script-component.md).</span></span> <span data-ttu-id="7de91-108">Weitere Informationen zu den Unterschieden zwischen synchronen und asynchronen Komponenten finden Sie unter [Grundlegendes zu synchronen und asynchronen Transformationen](../understanding-synchronous-and-asynchronous-transformations.md).</span><span class="sxs-lookup"><span data-stu-id="7de91-108">For more information about the difference between synchronous and asynchronous components, see [Understanding Synchronous and Asynchronous Transformations](../understanding-synchronous-and-asynchronous-transformations.md).</span></span>

 <span data-ttu-id="7de91-109">Eine Übersicht der Skriptkomponenten finden Sie unter [Extending the Data Flow with the Script Component (Erweitern des Datenflusses mit der Skriptkomponente)](../extending-packages-scripting/data-flow-script-component/extending-the-data-flow-with-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="7de91-109">For an overview of the Script component, see [Extending the Data Flow with the Script Component](../extending-packages-scripting/data-flow-script-component/extending-the-data-flow-with-the-script-component.md).</span></span>

 <span data-ttu-id="7de91-110">Die Skriptkomponente und der Infrastrukturcode, den sie generieren, erleichtern Ihnen die Entwicklung benutzerdefinierter Datenflusskomponenten deutlich.</span><span class="sxs-lookup"><span data-stu-id="7de91-110">The Script component and the infrastructure code that it generates for you simplify significantly the process of developing a custom data flow component.</span></span> <span data-ttu-id="7de91-111">Um die Funktionsweise der Skriptkomponente zu verstehen, kann es jedoch hilfreich sein, sich mit den im Abschnitt [Developing a Custom Data Flow Component (Entwickeln einer benutzerdefinierten Datenflusskomponente)](../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md) beschriebenen Schritten vertraut zu machen, die Sie bei der Entwicklung einer benutzerdefinierten Datenflusskomponente durchführen müssen. Sehen Sie sich dabei insbesondere den Schritt [Developing a Custom Transformation Component with Synchronous Outputs (Entwickeln einer benutzerdefinierten Transformationskomponente mit synchronen Ausgaben)](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-synchronous-outputs.md) an.</span><span class="sxs-lookup"><span data-stu-id="7de91-111">However, to understand how the Script component works, you may find it useful to read the steps that you must follow in developing a custom data flow component in the section on [Developing a Custom Data Flow Component](../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md), and especially [Developing a Custom Transformation Component with Synchronous Outputs](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-synchronous-outputs.md).</span></span>

## <a name="getting-started-with-a-synchronous-transformation-component"></a><span data-ttu-id="7de91-112">Erste Schritte mit einer synchronen Transformationskomponente</span><span class="sxs-lookup"><span data-stu-id="7de91-112">Getting Started with a Synchronous Transformation Component</span></span>
 <span data-ttu-id="7de91-113">Wenn Sie im Bereich „Datenfluss“ des [!INCLUDE[ssIS](../../includes/ssis-md.md)]-Designers eine Skriptkomponente hinzufügen, wird das Dialogfeld **Skriptkomponententyp auswählen** geöffnet, und Sie werden zur Auswahl eines Quell-, Ziel- oder Transformationskomponententyps aufgefordert.</span><span class="sxs-lookup"><span data-stu-id="7de91-113">When you add a Script component to the Data Flow pane of [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, the **Select Script Component Type** dialog box opens and prompts you to select a Source, Destination, or Transformation component type.</span></span> <span data-ttu-id="7de91-114">Wählen Sie in diesem Dialogfeld die Option **Transformation** aus.</span><span class="sxs-lookup"><span data-stu-id="7de91-114">In this dialog box, select **Transformation**.</span></span>

## <a name="configuring-a-synchronous-transformation-component-in-metadata-design-mode"></a><span data-ttu-id="7de91-115">Konfigurieren einer synchronen Transformationskomponente im Metadatenentwurfsmodus</span><span class="sxs-lookup"><span data-stu-id="7de91-115">Configuring a Synchronous Transformation Component in Metadata-Design Mode</span></span>
 <span data-ttu-id="7de91-116">Nachdem Sie die Option zur Erstellung einer Transformationskomponente ausgewählt haben, konfigurieren Sie die Komponente mit dem **Transformations-Editor für Skripterstellung**.</span><span class="sxs-lookup"><span data-stu-id="7de91-116">After you select the option to create a transformation component, you configure the component by using the **Script Transformation Editor**.</span></span> <span data-ttu-id="7de91-117">Weitere Informationen finden Sie unter [Configuring the Script Component in the Script Component Editor (Konfigurieren der Skriptkomponente im Skriptkomponenten-Editor)](../extending-packages-scripting/data-flow-script-component/configuring-the-script-component-in-the-script-component-editor.md).</span><span class="sxs-lookup"><span data-stu-id="7de91-117">For more information, see [Configuring the Script Component in the Script Component Editor](../extending-packages-scripting/data-flow-script-component/configuring-the-script-component-in-the-script-component-editor.md).</span></span>

 <span data-ttu-id="7de91-118">Zum Bestimmen der Skriptsprache für die Skriptkomponente wird die **ScriptLanguage**-Eigenschaft auf der Seite **Skript** des **Transformations-Editors für Skripterstellung** festgelegt.</span><span class="sxs-lookup"><span data-stu-id="7de91-118">To set the script language for the Script component, you set the **ScriptLanguage** property on the **Script** page of the **Script Transformation Editor**.</span></span>

> [!NOTE]
>  <span data-ttu-id="7de91-119">Verwenden Sie im Dialogfeld **Optionen** auf der Seite **Allgemein** die Option **Skriptsprache**, um die Standardskriptsprache für die Skriptkomponente festzulegen.</span><span class="sxs-lookup"><span data-stu-id="7de91-119">To set the default scripting language for the Script component, use the **Scripting language** option on the **General** page of the **Options** dialog box.</span></span> <span data-ttu-id="7de91-120">Weitere Informationen finden Sie unter [General Page](../general-page-of-integration-services-designers-options.md).</span><span class="sxs-lookup"><span data-stu-id="7de91-120">For more information, see [General Page](../general-page-of-integration-services-designers-options.md).</span></span>

 <span data-ttu-id="7de91-121">Eine Datenfluss-Transformationskomponente verfügt über eine Eingabe und unterstützt mindestens eine Ausgabe.</span><span class="sxs-lookup"><span data-stu-id="7de91-121">A data flow transformation component has one input, and supports one or more outputs.</span></span> <span data-ttu-id="7de91-122">Die Konfiguration der Eingabe und der Ausgaben für die Komponente ist einer der Schritte, die Sie mithilfe des **Transformations-Editors für Skripterstellung** im Metadatenentwurfsmodus ausführen müssen, bevor Sie das benutzerdefinierte Skript schreiben.</span><span class="sxs-lookup"><span data-stu-id="7de91-122">Configuring the input and outputs for the component is one of the steps that you must complete in metadata design mode, by using the **Script Transformation Editor**, before you write your custom script.</span></span>

### <a name="configuring-input-columns"></a><span data-ttu-id="7de91-123">Konfigurieren von Eingabespalten</span><span class="sxs-lookup"><span data-stu-id="7de91-123">Configuring Input Columns</span></span>
 <span data-ttu-id="7de91-124">Eine Transformationskomponente verfügt über eine Eingabe.</span><span class="sxs-lookup"><span data-stu-id="7de91-124">A transformation component has one input.</span></span>

 <span data-ttu-id="7de91-125">Die Spaltenliste auf der Seite **Eingabespalten** im **Transformations-Editor für Skripterstellung** zeigt die von der Ausgabe der Upstreamkomponente im Datenfluss verfügbaren Spalten an.</span><span class="sxs-lookup"><span data-stu-id="7de91-125">On the **Input Columns** page of the **Script Transformation Editor,** the column list shows the available columns from the output of the upstream component in the data flow.</span></span> <span data-ttu-id="7de91-126">Markieren Sie die Spalten, die Sie transformieren oder durchlaufen möchten.</span><span class="sxs-lookup"><span data-stu-id="7de91-126">Select the columns that you want to transform or pass through.</span></span> <span data-ttu-id="7de91-127">Markieren Sie alle Spalten, die Sie an Ort und Stelle transformieren möchten, als Lesen/Schreiben.</span><span class="sxs-lookup"><span data-stu-id="7de91-127">Mark any columns that you want to transform in place as Read/Write.</span></span>

 <span data-ttu-id="7de91-128">Weitere Informationen über die Seite **Eingabespalten** im **Transformations-Editor für Skripterstellung** finden Sie unter [Script Transformation Editor (Input Columns Page) (Transformations-Editor für Skripterstellung (Seite „Eingabespalten“))](../script-transformation-editor-input-columns-page.md).</span><span class="sxs-lookup"><span data-stu-id="7de91-128">For more information about the **Input Columns** page of the **Script Transformation Editor**, see [Script Transformation Editor &#40;Input Columns Page&#41;](../script-transformation-editor-input-columns-page.md).</span></span>

### <a name="configuring-inputs-outputs-and-output-columns"></a><span data-ttu-id="7de91-129">Konfigurieren von Eingaben, Ausgaben und Ausgabespalten</span><span class="sxs-lookup"><span data-stu-id="7de91-129">Configuring Inputs, Outputs, and Output Columns</span></span>
 <span data-ttu-id="7de91-130">Eine Transformationskomponente unterstützt eine oder mehrere Ausgaben.</span><span class="sxs-lookup"><span data-stu-id="7de91-130">A transformation component supports one or more outputs.</span></span>

 <span data-ttu-id="7de91-131">Auf der Seite **Eingaben und Ausgaben** im **Transformations-Editor für Skripterstellung** können Sie erkennen, dass eine Ausgabe erstellt wurde. Spalten sind in der Ausgabe hingegen nicht vorhanden.</span><span class="sxs-lookup"><span data-stu-id="7de91-131">On the **Inputs and Outputs** page of the **Script Transformation Editor**, you can see that a single output has been created, but the output has no columns.</span></span> <span data-ttu-id="7de91-132">Auf dieser Seite des Editors haben Sie die Möglichkeit, die folgenden Elemente zu konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="7de91-132">On this page of the editor, you may need or want to configure the following items.</span></span>

-   <span data-ttu-id="7de91-133">Erstellen Sie eine oder mehrere zusätzliche Ausgaben, beispielsweise eine simulierte Fehlerausgabe für Zeilen, die unerwartete Werte aufweisen.</span><span class="sxs-lookup"><span data-stu-id="7de91-133">Create one or more additional outputs, such as a simulated error output for rows that contain unexpected values.</span></span> <span data-ttu-id="7de91-134">Verwenden Sie die Schaltflächen **Ausgabe hinzufügen** und **Ausgabe entfernen**, um die Ausgaben der synchronen Transformationskomponente zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="7de91-134">Use the **Add Output** and **Remove Output** buttons to manage the outputs of your synchronous transformation component.</span></span> <span data-ttu-id="7de91-135">Alle Eingabezeilen werden an alle verfügbaren Ausgaben weitergeleitet, außer Sie geben an, dass jede Zeile nur an eine der Ausgaben weitergeleitet werden soll.</span><span class="sxs-lookup"><span data-stu-id="7de91-135">All input rows are directed to all available outputs unless you indicate that you intend to redirect each row to one output or the other.</span></span> <span data-ttu-id="7de91-136">Die Umleitung von Zahlen wird durch das Angeben eines ganzzahligen Werts ungleich null für die `ExclusionGroup`-Eigenschaft der Ausgaben erreicht.</span><span class="sxs-lookup"><span data-stu-id="7de91-136">You indicate that you intend to redirect rows by specifying a non-zero integer value for the `ExclusionGroup` property on the outputs.</span></span> <span data-ttu-id="7de91-137">Der in `ExclusionGroup` eingegebene spezifische Ganzzahlwert zum Identifizieren der Ausgaben ist nicht von Bedeutung, es muss jedoch darauf geachtet werden, dass für die spezifische Ausgabegruppe durchgängig dieselbe ganze Zahl verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="7de91-137">The specific integer value entered in `ExclusionGroup` to identify the outputs is not significant, but you must use the same integer consistently for the specified group of outputs.</span></span>

    > [!NOTE]
    >  <span data-ttu-id="7de91-138">Sie können auch einen Wert ungleich Null für die `ExclusionGroup`-Eigenschaft für eine einzelne Ausgabe verwenden, wenn Sie nicht alle Zeilen ausgeben möchten.</span><span class="sxs-lookup"><span data-stu-id="7de91-138">You can also use a non-zero `ExclusionGroup` property value with a single output when you do not want to output all rows.</span></span> <span data-ttu-id="7de91-139">In diesem Fall müssen Sie jedoch für alle Zeilen, die an die Ausgabe gesendet werden sollen, explizit die Methode **DirectRowTo\<outputbuffer>** aufrufen.</span><span class="sxs-lookup"><span data-stu-id="7de91-139">However, in this case,  you must explicitly call the **DirectRowTo\<outputbuffer>** method for each row that you want to send to the output.</span></span>

-   <span data-ttu-id="7de91-140">Zuweisen eines aussagekräftigeren Namens für Eingabe und Ausgaben</span><span class="sxs-lookup"><span data-stu-id="7de91-140">Assign a more descriptive name to the input and outputs.</span></span> <span data-ttu-id="7de91-141">In der Skriptkomponente werden diese Namen verwendet, um die typisierten Accessoreigenschaften zu erzeugen, mit denen Sie auf die Eingabe und die Ausgaben in Ihrem Skript verweisen.</span><span class="sxs-lookup"><span data-stu-id="7de91-141">The Script component uses these names to generate the typed accessor properties that you will use to refer to the input and outputs in your script.</span></span>

-   <span data-ttu-id="7de91-142">Verändern Sie die Spalten für synchrone Transformationen nicht.</span><span class="sxs-lookup"><span data-stu-id="7de91-142">Leave columns as is for synchronous transformations.</span></span> <span data-ttu-id="7de91-143">Normalerweise werden bei einer synchronen Transformation dem Datenfluss keine Spalten hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="7de91-143">Typically a synchronous transformation does not add columns to the data flow.</span></span> <span data-ttu-id="7de91-144">Die Daten werden gleich im Puffer verändert, und der Puffer wird an die nächste Komponente im Datenfluss übergeben.</span><span class="sxs-lookup"><span data-stu-id="7de91-144">Data is modified in place in the buffer, and the buffer is passed on to the next component in the data flow.</span></span> <span data-ttu-id="7de91-145">Bei einer solchen Vorgehensweise müssen Sie den Transformationsausgaben keine Ausgabespalten explizit hinzufügen und diese dann konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="7de91-145">If this is the case, you do not have to add and configure output columns explicitly on the transformation's outputs.</span></span> <span data-ttu-id="7de91-146">Die Ausgaben werden ohne explizit definierte Spalten im Editor angezeigt.</span><span class="sxs-lookup"><span data-stu-id="7de91-146">The outputs appear in the editor without any explicitly defined columns.</span></span>

-   <span data-ttu-id="7de91-147">Fügen Sie simulierten Fehlerausgaben neue Spalten für Fehler auf Zeilenebene hinzu.</span><span class="sxs-lookup"><span data-stu-id="7de91-147">Add new columns to simulated error outputs for row-level errors.</span></span> <span data-ttu-id="7de91-148">Üblicherweise haben mehrere Ausgaben in der gleichen `ExclusionGroup` die gleiche Gruppe von Ausgabespalten.</span><span class="sxs-lookup"><span data-stu-id="7de91-148">Ordinarily multiple outputs in the same `ExclusionGroup` have the same set of output columns.</span></span> <span data-ttu-id="7de91-149">Falls Sie eine simulierte Fehlerausgabe erstellen, sollten Sie jedoch mehrere Spalten hinzufügen, um Fehlerinformationen zu speichern.</span><span class="sxs-lookup"><span data-stu-id="7de91-149">However, if you are creating a simulated error output, you may want to add more columns to contain error information.</span></span> <span data-ttu-id="7de91-150">Informationen dazu, wie die Datenfluss-Engine Fehlerzeilen verarbeitet, finden Sie unter [Using Error Outputs in a Data Flow Component (Verwenden von Fehlerausgaben in einer Datenflusskomponente)](../extending-packages-custom-objects/data-flow/using-error-outputs-in-a-data-flow-component.md).</span><span class="sxs-lookup"><span data-stu-id="7de91-150">For information about how the data flow engine processes error rows, see [Using Error Outputs in a Data Flow Component](../extending-packages-custom-objects/data-flow/using-error-outputs-in-a-data-flow-component.md).</span></span> <span data-ttu-id="7de91-151">Beachten Sie, dass Sie in der Skriptkomponente eigenen Code schreiben müssen, um geeignete Fehlerinformationen für die zusätzlichen Spalten zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="7de91-151">Note that in the Script component you must write your own code to fill the additional columns with appropriate error information.</span></span> <span data-ttu-id="7de91-152">Weitere Informationen finden Sie unter [Simulating an Error Output for the Script Component (Simulieren einer Fehlerausgabe für die Skriptkomponente)](../extending-packages-scripting-data-flow-script-component-examples/simulating-an-error-output-for-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="7de91-152">For more information, see [Simulating an Error Output for the Script Component](../extending-packages-scripting-data-flow-script-component-examples/simulating-an-error-output-for-the-script-component.md).</span></span>

 <span data-ttu-id="7de91-153">Weitere Informationen über die Seite **Eingaben und Ausgaben** im **Transformations-Editor für Skripterstellung** finden Sie unter [Script Transformation Editor (Inputs and Outputs Page) (Transformations-Editor für Skripterstellung (Seite „Eingaben und Ausgaben“))](../script-transformation-editor-inputs-and-outputs-page.md).</span><span class="sxs-lookup"><span data-stu-id="7de91-153">For more information about the **Inputs and Outputs** page of the **Script Transformation Editor**, see [Script Transformation Editor &#40;Inputs and Outputs Page&#41;](../script-transformation-editor-inputs-and-outputs-page.md).</span></span>

### <a name="adding-variables"></a><span data-ttu-id="7de91-154">Hinzufügen von Variablen</span><span class="sxs-lookup"><span data-stu-id="7de91-154">Adding Variables</span></span>
 <span data-ttu-id="7de91-155">Wenn Sie vorhandene Variablen in Ihrem Skript verwenden möchten, können Sie diese in den `ReadOnlyVariables` `ReadWriteVariables` Eigenschaften Feldern und auf der Seite **Skript** des Transformations- **Editors für Skript**Erstellung hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="7de91-155">If you want to use existing variables in your script, you can add them in the `ReadOnlyVariables` and `ReadWriteVariables` property fields on the **Script** page of the **Script Transformation Editor**.</span></span>

 <span data-ttu-id="7de91-156">Wenn Sie mehrere Variablen in die Eigenschaftsfelder hinzufügen, trennen Sie die Variablennamen durch Kommas.</span><span class="sxs-lookup"><span data-stu-id="7de91-156">When you add multiple variables in the property fields, separate the variable names by commas.</span></span> <span data-ttu-id="7de91-157">Sie können auch mehrere Variablen auswählen, indem Sie auf die Schaltfläche mit den Auslassungs Punkten (**...**) neben den `ReadOnlyVariables` `ReadWriteVariables` Eigenschaften Feldern und klicken und dann die Variablen im Dialogfeld **Variablen auswählen** auswählen.</span><span class="sxs-lookup"><span data-stu-id="7de91-157">You can also select multiple variables by clicking the ellipsis (**...**) button next to the `ReadOnlyVariables` and `ReadWriteVariables` property fields, and then selecting the variables in the **Select variables** dialog box.</span></span>

 <span data-ttu-id="7de91-158">Allgemeine Informationen über das Verwenden von Variablen mit der Skriptkomponente finden Sie unter [Using Variables in the Script Component (Verwenden von Variablen in der Skriptkomponente)](../extending-packages-scripting/data-flow-script-component/using-variables-in-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="7de91-158">For general information about how to use variables with the Script component, see [Using Variables in the Script Component](../extending-packages-scripting/data-flow-script-component/using-variables-in-the-script-component.md).</span></span>

 <span data-ttu-id="7de91-159">Weitere Informationen über die Seite **Skript** im **Transformations-Editor für Skripterstellung** finden Sie unter [Script Transformation Editor (Script Page) (Transformations-Editor für Skripterstellung (Seite „Skript“))](../script-transformation-editor-script-page.md).</span><span class="sxs-lookup"><span data-stu-id="7de91-159">For more information about the **Script** page of the **Script Transformation Editor**, see [Script Transformation Editor &#40;Script Page&#41;](../script-transformation-editor-script-page.md).</span></span>

## <a name="scripting-a-synchronous-transformation-component-in-code-design-mode"></a><span data-ttu-id="7de91-160">Skripterstellung für eine synchrone Transformationskomponente im Codeentwurfsmodus</span><span class="sxs-lookup"><span data-stu-id="7de91-160">Scripting a Synchronous Transformation Component in Code-Design Mode</span></span>
 <span data-ttu-id="7de91-161">Nachdem Sie die Metadaten für Ihre Komponente konfiguriert haben, können Sie das benutzerdefinierte Skript schreiben.</span><span class="sxs-lookup"><span data-stu-id="7de91-161">After you have configured the metadata for your component, you can write your custom script.</span></span> <span data-ttu-id="7de91-162">Klicken Sie auf der Seite **Skript** im **Transformations-Editor für Skripterstellung** auf **Skript bearbeiten**, um die [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications-IDE (VSTA) zu öffnen und Ihr benutzerdefiniertes Skript hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="7de91-162">In the **Script Transformation Editor**, on the **Script** page, click **Edit Script** to open the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications (VSTA) IDE where you can add your custom script.</span></span> <span data-ttu-id="7de91-163">Welche Skriptsprache Sie verwenden, hängt davon ab, ob Sie auf der Seite **Skript**[!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic oder [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C# als Skriptsprache für die **ScriptLanguage**-Eigenschaft festgelegt haben.</span><span class="sxs-lookup"><span data-stu-id="7de91-163">The scripting language that you use depends on whether you selected [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic or [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C# as the script language for the **ScriptLanguage** property on the **Script** page.</span></span>

 <span data-ttu-id="7de91-164">Wichtige Informationen, die alle Arten von Komponenten betreffen, die mithilfe der Skriptkomponente erstellt wurden, finden Sie unter [Coding and Debugging the Script Component (Codieren und Debuggen der Skriptkomponente)](../extending-packages-scripting/data-flow-script-component/using-variables-in-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="7de91-164">For important information that applies to all kinds of components created by using the Script component, see [Coding and Debugging the Script Component](../extending-packages-scripting/data-flow-script-component/using-variables-in-the-script-component.md).</span></span>

### <a name="understanding-the-auto-generated-code"></a><span data-ttu-id="7de91-165">Grundlegendes zum automatisch generierten Code</span><span class="sxs-lookup"><span data-stu-id="7de91-165">Understanding the Auto-generated Code</span></span>
 <span data-ttu-id="7de91-166">Wenn Sie nach der Erstellung und Konfiguration einer Transformationskomponente die VSTA-IDE öffnen, wird die bearbeitbare `ScriptMain`-Klasse im Code-Editor mit einem Stub für die `ProcessInputRow`-Methode angezeigt.</span><span class="sxs-lookup"><span data-stu-id="7de91-166">When you open the VSTA IDE after you create and configuring a transformation component, the editable `ScriptMain` class appears in the code editor with a stub for the `ProcessInputRow` method.</span></span> <span data-ttu-id="7de91-167">In der `ScriptMain`-Klasse schreiben Sie Ihren benutzerdefinierten Code, und `ProcessInputRow` ist die wichtigste Methode in einer Transformationskomponente.</span><span class="sxs-lookup"><span data-stu-id="7de91-167">The `ScriptMain` class is where you will write your custom code, and `ProcessInputRow` is the most important method in a transformation component.</span></span>

 <span data-ttu-id="7de91-168">Wenn Sie das Fenster **Projekt Explorer** in VSTA öffnen, können Sie sehen, dass die Skript Komponente auch schreibgeschützte- `BufferWrapper` und- `ComponentWrapper` Projekt Elemente generiert hat.</span><span class="sxs-lookup"><span data-stu-id="7de91-168">If you open the **Project Explorer** window in VSTA, you can see that the Script component has also generated read-only `BufferWrapper` and `ComponentWrapper` project items.</span></span> <span data-ttu-id="7de91-169">Die `ScriptMain`-Klasse erbt von der `UserComponent`-Klasse im `ComponentWrapper`-Projektelement.</span><span class="sxs-lookup"><span data-stu-id="7de91-169">The `ScriptMain` class inherits from the `UserComponent` class in the `ComponentWrapper` project item.</span></span>

 <span data-ttu-id="7de91-170">Zur Laufzeit ruft die Datenfluss-Engine die `ProcessInput`-Methode in der `UserComponent`-Klasse auf, die die <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ProcessInput%2A>-Methode der übergeordneten <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent>-Klasse überschreibt.</span><span class="sxs-lookup"><span data-stu-id="7de91-170">At run time, the data flow engine invokes the `ProcessInput` method in the `UserComponent` class, which overrides the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ProcessInput%2A> method of the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent> parent class.</span></span> <span data-ttu-id="7de91-171">Die `ProcessInput`-Methode durchläuft der Reihe nach in Schleifen die Zeilen im Eingabepuffer und ruft für jede Zeile einmal die `ProcessInputRow`-Methode auf.</span><span class="sxs-lookup"><span data-stu-id="7de91-171">The `ProcessInput` method in turn loops through the rows in the input buffer and calls the `ProcessInputRow` method one time for each row.</span></span>

### <a name="writing-your-custom-code"></a><span data-ttu-id="7de91-172">Schreiben von benutzerdefiniertem Code</span><span class="sxs-lookup"><span data-stu-id="7de91-172">Writing Your Custom Code</span></span>
 <span data-ttu-id="7de91-173">Eine Transformationskomponente mit synchronen Ausgaben ist die Datenflusskomponente, die am einfachsten geschrieben werden kann.</span><span class="sxs-lookup"><span data-stu-id="7de91-173">A transformation component with synchronous outputs is the simplest of all data flow components to write.</span></span> <span data-ttu-id="7de91-174">Zum Beispiel besteht das später in diesem Thema dargestellte Beispiel mit einer einzigen Ausgabe aus dem folgenden benutzerdefinierten Code:</span><span class="sxs-lookup"><span data-stu-id="7de91-174">For example, the single-output example shown later in this topic consists of the following custom code:</span></span>

```vb
Row.City = UCase(Row.City)
```

```csharp
Row.City = (Row.City).ToUpper();

```

 <span data-ttu-id="7de91-175">Um die Erstellung einer benutzerdefinierten synchronen Transformationskomponente abzuschließen, können Sie mit der überschriebenen `ProcessInputRow`-Methode die Daten in jeder Zeile des Eingabepuffers transformieren.</span><span class="sxs-lookup"><span data-stu-id="7de91-175">To finish creating a custom synchronous transformation component, you use the overridden `ProcessInputRow` method to transform the data in each row of the input buffer.</span></span> <span data-ttu-id="7de91-176">Die Datenfluss-Engine leitet diesen Puffer an die nächste Komponente im Datenfluss weiter, sobald er voll ist.</span><span class="sxs-lookup"><span data-stu-id="7de91-176">The data flow engine passes this buffer, when full, to the next component in the data flow.</span></span>

 <span data-ttu-id="7de91-177">Je nach Ihren Anforderungen können Sie auch Skript in der `PreExecute`-Methode und in der `PostExecute`-Methode schreiben, die in der `ScriptMain`-Klasse verfügbar sind, um vorbereitende oder abschließende Verarbeitungsvorgänge auszuführen.</span><span class="sxs-lookup"><span data-stu-id="7de91-177">Depending on your requirements, you may also want to write script in the `PreExecute` and `PostExecute` methods, available in the `ScriptMain` class, to perform preliminary or final processing.</span></span>

### <a name="working-with-multiple-outputs"></a><span data-ttu-id="7de91-178">Arbeiten mit mehreren Ausgaben</span><span class="sxs-lookup"><span data-stu-id="7de91-178">Working with Multiple Outputs</span></span>
 <span data-ttu-id="7de91-179">Die Umleitung von Eingabezeilen an eine von zwei oder mehreren möglichen Ausgaben erfordert nicht viel mehr benutzerdefinierten Code als das Szenario mit einer einzigen Ausgabe, das bereits erläutert wurde.</span><span class="sxs-lookup"><span data-stu-id="7de91-179">Directing input rows to one of two or more possible outputs does not require much more custom code than the single-output scenario discussed earlier.</span></span> <span data-ttu-id="7de91-180">Zum Beispiel besteht das später in diesem Thema dargestellte Beispiel mit zwei Ausgaben aus dem folgenden benutzerdefinierten Code:</span><span class="sxs-lookup"><span data-stu-id="7de91-180">For example, the two-output example shown later in this topic consists of the following custom code:</span></span>

```vb
Row.City = UCase(Row.City)
If Row.City = "REDMOND" Then
    Row.DirectRowToMyRedmondAddresses()
Else
    Row.DirectRowToMyOtherAddresses()
End If
```

```csharp
Row.City = (Row.City).ToUpper();

if (Row.City=="REDMOND")
{
    Row.DirectRowToMyRedmondAddresses();
}
else
{
    Row.DirectRowToMyOtherAddresses();
}
```

 <span data-ttu-id="7de91-181">In diesem Beispiel werden von der Skriptkomponente auf Grundlage der von Ihnen konfigurierten Ausgabenamen die **DirectRowTo\<OutputBufferX>** -Methoden für Sie erstellt.</span><span class="sxs-lookup"><span data-stu-id="7de91-181">In this example, the Script component generates the **DirectRowTo\<OutputBufferX>** methods for you, based on the names of the outputs that you configured.</span></span> <span data-ttu-id="7de91-182">Sie können ähnlichen Code verwenden, um Fehlerzeilen an eine simulierte Fehlerausgabe weiterzuleiten.</span><span class="sxs-lookup"><span data-stu-id="7de91-182">You can use similar code to direct error rows to a simulated error output.</span></span>

## <a name="examples"></a><span data-ttu-id="7de91-183">Beispiele</span><span class="sxs-lookup"><span data-stu-id="7de91-183">Examples</span></span>
 <span data-ttu-id="7de91-184">In diesem Beispiel wird der benutzerdefinierte Code veranschaulicht, der in der `ScriptMain`-Klasse zur Erstellung einer synchronen Transformationskomponente erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="7de91-184">The examples here demonstrate the custom code that is required in the `ScriptMain` class to create a synchronous transformation component.</span></span>

> [!NOTE]
>  <span data-ttu-id="7de91-185">In diesen Beispielen wird die **Person. Address** -Tabelle in der `AdventureWorks` -Beispieldatenbank verwendet, und die erste und vierte Spalte, die **intadressssid** -und **nvarchar (30) City** -Spalten, werden über den Datenfluss übergeben.</span><span class="sxs-lookup"><span data-stu-id="7de91-185">These examples use the **Person.Address** table in the `AdventureWorks` sample database and pass its first and fourth columns, the **intAddressID** and **nvarchar(30)City** columns, through the data flow.</span></span> <span data-ttu-id="7de91-186">Die gleichen Daten werden in den Quellen-, Transformations- und Zielbeispielen in diesem Abschnitt verwendet.</span><span class="sxs-lookup"><span data-stu-id="7de91-186">The same data is used in the source, transformation, and destination samples in this section.</span></span> <span data-ttu-id="7de91-187">Zusätzliche Voraussetzungen und Annahmen werden für jedes Beispiel dokumentiert.</span><span class="sxs-lookup"><span data-stu-id="7de91-187">Additional prerequisites and assumptions are documented for each example.</span></span>

### <a name="single-output-synchronous-transformation-example"></a><span data-ttu-id="7de91-188">Beispiel einer synchronen Transformation mit einer Ausgabe</span><span class="sxs-lookup"><span data-stu-id="7de91-188">Single Output Synchronous Transformation Example</span></span>
 <span data-ttu-id="7de91-189">Dieses Beispiel zeigt eine synchrone Transformationskomponente mit einer Ausgabe.</span><span class="sxs-lookup"><span data-stu-id="7de91-189">This example demonstrates a synchronous transformation component with a single output.</span></span> <span data-ttu-id="7de91-190">Diese Transformation durchläuft die Spalte **AddressID** und konvertiert die Spalte **City** in Großbuchstaben.</span><span class="sxs-lookup"><span data-stu-id="7de91-190">This transformation passes through the **AddressID** column and converts the **City** column to uppercase.</span></span>

 <span data-ttu-id="7de91-191">Wenn Sie den Beispielcode ausführen möchten, müssen Sie das Paket und die Komponente folgendermaßen konfigurieren:</span><span class="sxs-lookup"><span data-stu-id="7de91-191">If you want to run this sample code, you must configure the package and the component as follows:</span></span>

1.  <span data-ttu-id="7de91-192">Fügen Sie der Datenfluss-Designeroberfläche eine neue Skriptkomponente hinzu, und konfigurieren Sie sie als Transformation.</span><span class="sxs-lookup"><span data-stu-id="7de91-192">Add a new Script component to the Data Flow designer surface and configure it as a transformation.</span></span>

2.  <span data-ttu-id="7de91-193">Verbinden Sie die Ausgabe einer Quelle oder einer anderen Transformation mit der neuen Transformationskomponente im [!INCLUDE[ssIS](../../includes/ssis-md.md)]-Designer.</span><span class="sxs-lookup"><span data-stu-id="7de91-193">Connect the output of a source or of another transformation to the new transformation component in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer.</span></span> <span data-ttu-id="7de91-194">Diese Ausgabe sollte Daten aus der Tabelle **Person. Address** der `AdventureWorks` Beispieldatenbank bereitstellen, die die Spalten **adressssid** und **City** enthält.</span><span class="sxs-lookup"><span data-stu-id="7de91-194">This output should provide data from the **Person.Address** table of the `AdventureWorks` sample database that contains the **AddressID** and **City** columns.</span></span>

3.  <span data-ttu-id="7de91-195">Öffnen Sie den **Transformations-Editor für Skripterstellung**.</span><span class="sxs-lookup"><span data-stu-id="7de91-195">Open the **Script Transformation Editor**.</span></span> <span data-ttu-id="7de91-196">Wählen Sie auf der Seite **Eingabespalten** die Spalten **AddressID** und **City** aus.</span><span class="sxs-lookup"><span data-stu-id="7de91-196">On the **Input Columns** page, select the **AddressID** and **City** columns.</span></span> <span data-ttu-id="7de91-197">Markieren Sie die Spalte **City** als Lesen/Schreiben.</span><span class="sxs-lookup"><span data-stu-id="7de91-197">Mark the **City** column as Read/Write.</span></span>

4.  <span data-ttu-id="7de91-198">Geben Sie auf der Seite **Eingaben und Ausgaben** der Eingabe und der Ausgabe aussagekräftigere Namen, z.B. **MyAddressInput** und **MyAddressOutput**.</span><span class="sxs-lookup"><span data-stu-id="7de91-198">On the **Inputs and Outputs** page, rename the input and output with more descriptive names, such as **MyAddressInput** and **MyAddressOutput**.</span></span> <span data-ttu-id="7de91-199">Beachten Sie, dass `SynchronousInputID` der Ausgabe `ID` der Eingabe entspricht.</span><span class="sxs-lookup"><span data-stu-id="7de91-199">Notice that the `SynchronousInputID` of the output corresponds to the `ID` of the input.</span></span> <span data-ttu-id="7de91-200">Sie müssen deshalb keine Ausgabespalten hinzufügen und konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="7de91-200">Therefore you do not have to add and configure output columns.</span></span>

5.  <span data-ttu-id="7de91-201">Klicken Sie auf der Seite **Skript** auf **Skript bearbeiten**, und geben Sie das folgende Skript ein.</span><span class="sxs-lookup"><span data-stu-id="7de91-201">On the **Script** page, click **Edit Script** and enter the script that follows.</span></span> <span data-ttu-id="7de91-202">Schließen Sie anschließend die Skriptentwicklungsumgebung und den **Transformations-Editor für Skripterstellung**.</span><span class="sxs-lookup"><span data-stu-id="7de91-202">Then close the script development environment and the **Script Transformation Editor**.</span></span>

6.  <span data-ttu-id="7de91-203">Erstellen und konfigurieren Sie eine Zielkomponente, die die Spalten **AddressID** und **City** aufnimmt, z.B. ein [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-Ziel oder die Beispielzielkomponente, die unter [Creating a Destination with the Script Component (Erstellen eines Ziels mit der Skriptkomponente)](../extending-packages-scripting-data-flow-script-component-types/creating-a-destination-with-the-script-component.md) veranschaulicht wird.</span><span class="sxs-lookup"><span data-stu-id="7de91-203">Create and configure a destination component that expects the **AddressID** and **City** columns, such as a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] destination, or the sample destination component demonstrated in [Creating a Destination with the Script Component](../extending-packages-scripting-data-flow-script-component-types/creating-a-destination-with-the-script-component.md).</span></span> <span data-ttu-id="7de91-204">Verbinden Sie daraufhin die Ausgabe der Transformation mit der Zielkomponente.</span><span class="sxs-lookup"><span data-stu-id="7de91-204">Then connect the output of the transformation to the destination component.</span></span> <span data-ttu-id="7de91-205">Sie können eine Zieltabelle erstellen, indem Sie den folgenden [!INCLUDE[tsql](../../includes/tsql-md.md)]-Befehl in der `AdventureWorks`-Datenbank ausführen:</span><span class="sxs-lookup"><span data-stu-id="7de91-205">You can create a destination table by running the following [!INCLUDE[tsql](../../includes/tsql-md.md)] command in the `AdventureWorks` database:</span></span>

    ```
    CREATE TABLE [Person].[Address2]([AddressID] [int] NOT NULL,
        [City] [nvarchar](30) NOT NULL)
    ```

7.  <span data-ttu-id="7de91-206">Führen Sie das Beispiel aus.</span><span class="sxs-lookup"><span data-stu-id="7de91-206">Run the sample.</span></span>

```vb
Public Class ScriptMain
    Inherits UserComponent

    Public Overrides Sub MyAddressInput_ProcessInputRow(ByVal Row As MyAddressInputBuffer)

        Row.City = UCase(Row.City)

    End Sub

End Class
```

```csharp
public class ScriptMain:
    UserComponent

{
    public override void MyAddressInput_ProcessInputRow(MyAddressInputBuffer Row)
    {

        Row.City = (Row.City).ToUpper();

    }

}
```

### <a name="two-output-synchronous-transformation-example"></a><span data-ttu-id="7de91-207">Beispiel einer synchronen Transformation mit zwei Ausgaben</span><span class="sxs-lookup"><span data-stu-id="7de91-207">Two-Output Synchronous Transformation Example</span></span>
 <span data-ttu-id="7de91-208">Dieses Beispiel zeigt eine synchrone Transformationskomponente mit zwei Ausgaben.</span><span class="sxs-lookup"><span data-stu-id="7de91-208">This example demonstrates a synchronous transformation component with two outputs.</span></span> <span data-ttu-id="7de91-209">Diese Transformation durchläuft die Spalte **AddressID** und konvertiert die Spalte **City** in Großbuchstaben.</span><span class="sxs-lookup"><span data-stu-id="7de91-209">This transformation passes through the **AddressID** column and converts the **City** column to uppercase.</span></span> <span data-ttu-id="7de91-210">Wenn der Name der Stadt Redmond ist, wird die Zeile an eine bestimmte Ausgabe weitergeleitet, während alle anderen Zeilen zu einer anderen Ausgabe weitergeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="7de91-210">If the city name is Redmond, it directs the row to one output; it directs all other rows to another output.</span></span>

 <span data-ttu-id="7de91-211">Wenn Sie den Beispielcode ausführen möchten, müssen Sie das Paket und die Komponente folgendermaßen konfigurieren:</span><span class="sxs-lookup"><span data-stu-id="7de91-211">If you want to run this sample code, you must configure the package and the component as follows:</span></span>

1.  <span data-ttu-id="7de91-212">Fügen Sie der Datenfluss-Designeroberfläche eine neue Skriptkomponente hinzu, und konfigurieren Sie sie als Transformation.</span><span class="sxs-lookup"><span data-stu-id="7de91-212">Add a new Script component to the Data Flow designer surface and configure it as a transformation.</span></span>

2.  <span data-ttu-id="7de91-213">Verbinden Sie die Ausgabe einer Quelle oder einer anderen Transformation mit der neuen Transformationskomponente im [!INCLUDE[ssIS](../../includes/ssis-md.md)]-Designer.</span><span class="sxs-lookup"><span data-stu-id="7de91-213">Connect the output of a source or of another transformation to the new transformation component in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer.</span></span> <span data-ttu-id="7de91-214">Diese Ausgabe sollte Daten aus der Tabelle **Person. Address** der `AdventureWorks` Beispieldatenbank bereitstellen, die mindestens die Spalten **adressssid** und **City** enthält.</span><span class="sxs-lookup"><span data-stu-id="7de91-214">This output should provide data from the **Person.Address** table of the `AdventureWorks` sample database that contains at least the **AddressID** and **City** columns.</span></span>

3.  <span data-ttu-id="7de91-215">Öffnen Sie den **Transformations-Editor für Skripterstellung**.</span><span class="sxs-lookup"><span data-stu-id="7de91-215">Open the **Script Transformation Editor**.</span></span> <span data-ttu-id="7de91-216">Wählen Sie auf der Seite **Eingabespalten** die Spalten **AddressID** und **City** aus.</span><span class="sxs-lookup"><span data-stu-id="7de91-216">On the **Input Columns** page, select the **AddressID** and **City** columns.</span></span> <span data-ttu-id="7de91-217">Markieren Sie die Spalte **City** als Lesen/Schreiben.</span><span class="sxs-lookup"><span data-stu-id="7de91-217">Mark the **City** column as Read/Write.</span></span>

4.  <span data-ttu-id="7de91-218">Erstellen Sie auf der Seite **Eingaben und Ausgaben** eine zweite Ausgabe.</span><span class="sxs-lookup"><span data-stu-id="7de91-218">On the **Inputs and Outputs** page, create a second output.</span></span> <span data-ttu-id="7de91-219">Stellen Sie nach dem Hinzufügen der neuen Ausgabe sicher, dass die `SynchronousInputID` der Ausgabe als `ID` der Eingabe festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="7de91-219">After you add the new output, make sure that you set its `SynchronousInputID` to the `ID` of the input.</span></span> <span data-ttu-id="7de91-220">Diese Eigenschaft ist für die erste Ausgabe bereits festgelegt, die standardmäßig erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="7de91-220">This property is already set on the first output, which is created by default.</span></span> <span data-ttu-id="7de91-221">Legen Sie für jede Ausgabe die `ExclusionGroup`-Eigenschaft auf denselben Wert ungleich null fest, um anzugeben, dass die Eingabezeilen auf zwei sich gegenseitig ausschließende Ausgaben verteilt werden.</span><span class="sxs-lookup"><span data-stu-id="7de91-221">For each output, set the `ExclusionGroup` property to the same non-zero value to indicate that you will split the input rows between two mutually exclusive outputs.</span></span> <span data-ttu-id="7de91-222">Sie müssen den Ausgaben keine Ausgabezeilen hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="7de91-222">You do not have to add any output columns to the outputs.</span></span>

5.  <span data-ttu-id="7de91-223">Geben Sie der Eingabe und den Ausgaben aussagekräftigere Namen, z.B. **MyAddressInput**, **MyRedmondAddresses** und **MyOtherAddresses**.</span><span class="sxs-lookup"><span data-stu-id="7de91-223">Rename the input and outputs with more descriptive names, such as **MyAddressInput**, **MyRedmondAddresses**, and **MyOtherAddresses**.</span></span>

6.  <span data-ttu-id="7de91-224">Klicken Sie auf der Seite **Skript** auf **Skript bearbeiten**, und geben Sie das folgende Skript ein.</span><span class="sxs-lookup"><span data-stu-id="7de91-224">On the **Script** page, click **Edit Script** and enter the script that follows.</span></span> <span data-ttu-id="7de91-225">Schließen Sie anschließend die Skriptentwicklungsumgebung und den **Transformations-Editor für Skripterstellung**.</span><span class="sxs-lookup"><span data-stu-id="7de91-225">Then close the script development environment and the **Script Transformation Editor**.</span></span>

7.  <span data-ttu-id="7de91-226">Erstellen und konfigurieren Sie zwei Zielkomponenten für die Spalten **AddressID** und **City**, z.B. ein [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-Ziel, ein Flatfileziel oder die unter [Creating a Destination with the Script Component (Erstellen eines Ziels mit der Skriptkomponente)](../extending-packages-scripting-data-flow-script-component-types/creating-a-destination-with-the-script-component.md) erläuterte Beispielzielkomponente.</span><span class="sxs-lookup"><span data-stu-id="7de91-226">Create and configure two destination components that expect the **AddressID** and **City** columns, such as a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] destination, a Flat File destination, or the sample destination component demonstrated in [Creating a Destination with the Script Component](../extending-packages-scripting-data-flow-script-component-types/creating-a-destination-with-the-script-component.md).</span></span> <span data-ttu-id="7de91-227">Verbinden Sie daraufhin alle Ausgaben der Transformation mit einer der Zielkomponenten.</span><span class="sxs-lookup"><span data-stu-id="7de91-227">Then connect each of the outputs of the transformation to one of the destination components.</span></span> <span data-ttu-id="7de91-228">Sie können Zieltabellen erstellen, indem Sie einen [!INCLUDE[tsql](../../includes/tsql-md.md)]-Befehl ähnlich dem im Folgenden dargestellten Befehl (mit eindeutigen Tabellennamen) in der `AdventureWorks`-Datenbank ausführen:</span><span class="sxs-lookup"><span data-stu-id="7de91-228">You can create destination tables by running a [!INCLUDE[tsql](../../includes/tsql-md.md)] command similar to the following (with unique table names) in the `AdventureWorks` database:</span></span>

    ```
    CREATE TABLE [Person].[Address2](
        [AddressID] [int] NOT NULL,
        [City] [nvarchar](30) NOT NULL
    ```

8.  <span data-ttu-id="7de91-229">Führen Sie das Beispiel aus.</span><span class="sxs-lookup"><span data-stu-id="7de91-229">Run the sample.</span></span>

```vb
Public Class ScriptMain
    Inherits UserComponent

    Public Overrides Sub MyAddressInput_ProcessInputRow(ByVal Row As MyAddressInputBuffer)

        Row.City = UCase(Row.City)

        If Row.City = "REDMOND" Then
            Row.DirectRowToMyRedmondAddresses()
        Else
            Row.DirectRowToMyOtherAddresses()
        End If

    End Sub

End Class
```

```csharp
public class ScriptMain:
    UserComponent

public override void MyAddressInput_ProcessInputRow(MyAddressInputBuffer Row)
    {

        Row.City = (Row.City).ToUpper();

        if (Row.City == "REDMOND")
        {
            Row.DirectRowToMyRedmondAddresses();
        }
        else
        {
            Row.DirectRowToMyOtherAddresses();
        }

    }
}
```

<span data-ttu-id="7de91-230">|![](./media/creating-a-synchronous-transformation-with-the-script-component/dts-16.gif)  **Bleiben Sie auf dem neuesten Stand mit Integration Services**</span><span class="sxs-lookup"><span data-stu-id="7de91-230">|![](./media/creating-a-synchronous-transformation-with-the-script-component/dts-16.gif)  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="7de91-231">Die neuesten Downloads, Artikel, Beispiele und Videos von Microsoft sowie ausgewählte Lösungen aus der Community finden Sie auf MSDN auf der [!INCLUDE[ssISnoversion](../../includes/msconame-md.md)] -Seite:</span><span class="sxs-lookup"><span data-stu-id="7de91-231">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../../includes/msconame-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="7de91-232">Besuchen Sie die Integration Services-Seite auf MSDN</span><span class="sxs-lookup"><span data-stu-id="7de91-232">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="7de91-233">Abonnieren Sie die auf der Seite verfügbaren RSS-Feeds, um automatische Benachrichtigungen zu diesen Updates zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="7de91-233">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>

## <a name="see-also"></a><span data-ttu-id="7de91-234">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="7de91-234">See Also</span></span>
 <span data-ttu-id="7de91-235">Grundlegendes zu [synchronen und asynchronen Transformationen](../understanding-synchronous-and-asynchronous-transformations.md) [Erstellen einer asynchronen Transformation mit der Skript Komponente](../extending-packages-scripting-data-flow-script-component-types/creating-an-asynchronous-transformation-with-the-script-component.md) [Entwickeln einer benutzerdefinierten Transformations Komponente mit synchronen Ausgaben](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-synchronous-outputs.md)</span><span class="sxs-lookup"><span data-stu-id="7de91-235">[Understanding Synchronous and Asynchronous Transformations](../understanding-synchronous-and-asynchronous-transformations.md) [Creating an Asynchronous Transformation with the Script Component](../extending-packages-scripting-data-flow-script-component-types/creating-an-asynchronous-transformation-with-the-script-component.md) [Developing a Custom Transformation Component with Synchronous Outputs](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-synchronous-outputs.md)</span></span>



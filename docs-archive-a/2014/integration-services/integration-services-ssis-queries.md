---
title: Integration Services-Abfragen (SSIS) | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Query Builder [Integration Services]
- queries [Integration Services]
- statements [Integration Services]
- queries [Integration Services], about queries in packages
ms.assetid: 8822bd29-4575-46c8-92a0-1a39bc2604c1
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 5119ff27606ce4e43f65cc129f3caac764e78e0b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87618160"
---
# <a name="integration-services-ssis-queries"></a><span data-ttu-id="67bc8-102">Integration Services-Abfragen (SSIS)</span><span class="sxs-lookup"><span data-stu-id="67bc8-102">Integration Services (SSIS) Queries</span></span>
  <span data-ttu-id="67bc8-103">Der Task SQL ausführen, die OLE DB-Quelle, das OLE DB-Ziel und die Transformation für die Suche können SQL-Abfragen verwenden.</span><span class="sxs-lookup"><span data-stu-id="67bc8-103">The Execute SQL task, the OLE DB source, the OLE DB destination, and the Lookup transformation can use SQL queries.</span></span> <span data-ttu-id="67bc8-104">In dem Task SQL ausführen können von SQL-Anweisungen Datenbankobjekte und Daten erstellt, aktualisiert und gelöscht sowie gespeicherte Prozeduren und SELECT-Anweisungen ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="67bc8-104">In the Execute SQL task, the SQL statements can create, update, and delete database objects and data; run stored procedures; and perform SELECT statements.</span></span> <span data-ttu-id="67bc8-105">In der OLE DB-Quelle und der Nachschlagetransformation sind die SQL-Anweisungen normalerweise SELECT- oder ECEC-Anweisungen.</span><span class="sxs-lookup"><span data-stu-id="67bc8-105">In the OLE DB source and the Lookup transformation, the SQL statements are typically SELECT statements or EXEC statements.</span></span> <span data-ttu-id="67bc8-106">Von den letzteren werden am häufigsten gespeicherte Prozeduren ausgeführt, die Resultsets zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="67bc8-106">The latter most frequently run stored procedures that return result sets.</span></span>  
  
 <span data-ttu-id="67bc8-107">Eine Abfrage kann analysiert werden, um festzustellen, ob sie gültig ist.</span><span class="sxs-lookup"><span data-stu-id="67bc8-107">A query can be parsed to establish whether it is valid.</span></span> <span data-ttu-id="67bc8-108">Beim Analysieren einer Abfrage, die eine Verbindung mit [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]verwendet, wird die Abfrage analysiert, ausgeführt, und das Ausführungsergebnis (Erfolg oder Fehlgeschlagen) wird dem Analyseergebnis zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="67bc8-108">When parsing a query that uses a connection to [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the query is parsed, executed, and the execution outcome (success or failure) is assigned to the parsing outcome.</span></span> <span data-ttu-id="67bc8-109">Wenn die Abfrage eine Verbindung mit einer Datenquelle verwendet, die nicht zu [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]gehört, wird nur die Anweisung analysiert.</span><span class="sxs-lookup"><span data-stu-id="67bc8-109">If the query uses a connection to a data other than [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the statement is parsed only.</span></span>  
  
 <span data-ttu-id="67bc8-110">Die SQL-Anweisung kann entweder durch direktes Eingeben in den Designer oder durch Angeben einer Dateiverbindung oder einer Variable, die eine Anweisung enthält, definiert werden.</span><span class="sxs-lookup"><span data-stu-id="67bc8-110">The SQL statement can be defined either by entering it directly in the designer, or by specifying a file connection or a variable that contains the statement.</span></span>  
  
## <a name="direct-input-sql"></a><span data-ttu-id="67bc8-111">Direkteingabe-SQL</span><span class="sxs-lookup"><span data-stu-id="67bc8-111">Direct Input SQL</span></span>  
 <span data-ttu-id="67bc8-112">Der Query-Generator steht für den Task SQL ausführen, die OLE DB-Quelle, das OLE DB-Ziel und die Transformation für die Suche zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="67bc8-112">Query Builder is available in the user interface for the Execute SQL task, the OLE DB source, the OLE DB destination, and the Lookup transformation.</span></span> <span data-ttu-id="67bc8-113">Der Query-Generator bietet die folgenden Vorteile:</span><span class="sxs-lookup"><span data-stu-id="67bc8-113">Query Builder offers the following advantages:</span></span>  
  
-   <span data-ttu-id="67bc8-114">Visuell oder mit SQL-Befehlen arbeiten.</span><span class="sxs-lookup"><span data-stu-id="67bc8-114">Work visually or with SQL commands.</span></span>  
  
     <span data-ttu-id="67bc8-115">Der Abfrage-Generator enthält grafische Bereiche, die eine Abfrage visuell darstellen, und einen Textbereich, der den SQL-Text der jeweiligen Abfrage anzeigt.</span><span class="sxs-lookup"><span data-stu-id="67bc8-115">Query Builder includes graphical panes that compose your query visually and a text pane that displays the SQL text of your query.</span></span> <span data-ttu-id="67bc8-116">Sie können entweder in grafischen oder in Textbereichen arbeiten.</span><span class="sxs-lookup"><span data-stu-id="67bc8-116">You can work in either the graphical or text panes.</span></span> <span data-ttu-id="67bc8-117">Der Abfrage-Generator synchronisiert die Sichten, sodass der Abfragetext und die grafische Darstellung immer übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="67bc8-117">Query Builder synchronizes the views so that the query text and graphical representation always match.</span></span>  
  
-   <span data-ttu-id="67bc8-118">Verknüpfen von verbundenen Tabellen.</span><span class="sxs-lookup"><span data-stu-id="67bc8-118">Join related tables.</span></span>  
  
     <span data-ttu-id="67bc8-119">Wenn Sie der Abfrage mehrere Tabellen hinzufügen, bestimmt der Abfrage-Generator automatisch, wie die Tabellen miteinander in Beziehung stehen, und erstellt den geeigneten Joinbefehl.</span><span class="sxs-lookup"><span data-stu-id="67bc8-119">If you add more than one table to your query, Query Builder automatically determines how the tables are related and constructs the appropriate join command.</span></span>  
  
-   <span data-ttu-id="67bc8-120">Abfragen oder Aktualisieren von Datenbanken.</span><span class="sxs-lookup"><span data-stu-id="67bc8-120">Query or update databases.</span></span>  
  
     <span data-ttu-id="67bc8-121">Sie können den Abfrage-Generator verwenden, um mithilfe von SELECT-Anweisungen von Transact-SQL Daten zurückzugeben und um Abfragen zu erstellen, die Datensätze einer Datenbank aktualisieren, einer Datenbank hinzufügen oder aus einer Datenbank löschen.</span><span class="sxs-lookup"><span data-stu-id="67bc8-121">You can use Query Builder to return data using Transact-SQL SELECT statements, or to create queries that update, add, or delete records in a database.</span></span>  
  
-   <span data-ttu-id="67bc8-122">Sofortiges Anzeigen und Bearbeiten der Ergebnisse.</span><span class="sxs-lookup"><span data-stu-id="67bc8-122">View and edit results immediately.</span></span>  
  
     <span data-ttu-id="67bc8-123">Sie können die Abfrage ausführen und ein Recordset in einem Raster verwenden, das Ihnen das Durchführen eines Bildlaufs und Bearbeiten der Datensätze in der Datenbank ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="67bc8-123">You can execute your query and work with a recordset in a grid that lets you scroll through and edit records in the database.</span></span>  
  
 <span data-ttu-id="67bc8-124">Obwohl der Abfrage-Generator visuell auf das Erstellen von SELECT-Abfragen beschränkt ist, können Sie den SQL-Code für andere Typen von Anweisungen wie z. B. DELETE und UPDATE in den Textbereich eingeben.</span><span class="sxs-lookup"><span data-stu-id="67bc8-124">Although Query Builder is visually limited to creating SELECT queries, you can type the SQL for other types of statements such as DELETE and UPDATE statements in the text pane.</span></span> <span data-ttu-id="67bc8-125">Der grafische Bereich wird automatisch entsprechend der eingegebenen SQL-Anweisung aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="67bc8-125">The graphical pane is automatically updated to reflect the SQL statement that you typed.</span></span>  
  
 <span data-ttu-id="67bc8-126">Die Direkteingabe kann auch durch Eingeben der Abfrage in das Dialogfeld des Tasks oder der Datenflusskomponente oder in das Eigenschaften-Fenster erfolgen.</span><span class="sxs-lookup"><span data-stu-id="67bc8-126">You can also provide direct input by typing the query in the task or data flow component dialog box or the Properties window.</span></span>  
  
 <span data-ttu-id="67bc8-127">Weitere Informationen finden Sie unter [Query Builder](../../2014/integration-services/query-builder.md).</span><span class="sxs-lookup"><span data-stu-id="67bc8-127">For more information, see [Query Builder](../../2014/integration-services/query-builder.md).</span></span>  
  
## <a name="sql-in-files"></a><span data-ttu-id="67bc8-128">SQL in Dateien</span><span class="sxs-lookup"><span data-stu-id="67bc8-128">SQL in Files</span></span>  
 <span data-ttu-id="67bc8-129">Die SQL-Anweisung für den Task "SQL ausführen" kann sich auch in einer getrennten Datei befinden.</span><span class="sxs-lookup"><span data-stu-id="67bc8-129">The SQL statement for the Execute SQL task can also reside in a separate file.</span></span> <span data-ttu-id="67bc8-130">Sie können z. B. Abfragen mithilfe von Tools wie beispielsweise dem Abfrage-Editor in [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)]schreiben, die Abfrage in einer Datei speichern und dann die Abfrage aus dieser Datei auslesen, wenn ein Paket ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="67bc8-130">For example, you can write queries using tools such as the Query Editor in [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)], save the query to a file, and then read the query from the file when running a package.</span></span> <span data-ttu-id="67bc8-131">Die Datei darf nur die auszuführenden SQL-Anweisungen sowie Kommentare enthalten.</span><span class="sxs-lookup"><span data-stu-id="67bc8-131">The file can contain only the SQL statements to run and comments.</span></span> <span data-ttu-id="67bc8-132">Zum Verwenden einer in einer Datei gespeicherten SQL-Anweisung müssen Sie eine Dateiverbindung bereitstellen, die den Dateinamen und den Speicherort der Datei angibt.</span><span class="sxs-lookup"><span data-stu-id="67bc8-132">To use a SQL statement stored in a file, you must provide a file connection that specifies the file name and location.</span></span> <span data-ttu-id="67bc8-133">Weitere Informationen finden Sie unter [File Connection Manager](connection-manager/file-connection-manager.md).</span><span class="sxs-lookup"><span data-stu-id="67bc8-133">For more information, see [File Connection Manager](connection-manager/file-connection-manager.md).</span></span>  
  
## <a name="sql-in-variables"></a><span data-ttu-id="67bc8-134">SQL in Variablen</span><span class="sxs-lookup"><span data-stu-id="67bc8-134">SQL in Variables</span></span>  
 <span data-ttu-id="67bc8-135">Wenn die Quelle der SQL-Anweisung im Task "SQL ausführen" eine Variable ist, geben Sie den Namen der Variablen an, die die Abfrage enthält.</span><span class="sxs-lookup"><span data-stu-id="67bc8-135">If the source of the SQL statement in the Execute SQL task is a variable, you provide the name of the variable that contains the query.</span></span> <span data-ttu-id="67bc8-136">Die „Value“-Eigenschaft der Variablen enthält den Abfragetext.</span><span class="sxs-lookup"><span data-stu-id="67bc8-136">The Value property of the variable contains the query text.</span></span> <span data-ttu-id="67bc8-137">Sie legen die „ValueType“-Eigenschaft der Variablen auf einen Zeichenfolgendatentyp fest. Geben dann die SQL-Anweisung in die „Value“-Eigenschaft ein, oder kopieren Sie sie in die Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="67bc8-137">You set the ValueType property of the variable to a string data type and then type or copy the SQL statement into the Value property.</span></span> <span data-ttu-id="67bc8-138">Weitere Informationen finden Sie unter [Integration Services-Variablen &#40;SSIS&#41;](integration-services-ssis-variables.md) und [Verwenden von Variablen in Paketen](../../2014/integration-services/use-variables-in-packages.md).</span><span class="sxs-lookup"><span data-stu-id="67bc8-138">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md) and [Use Variables in Packages](../../2014/integration-services/use-variables-in-packages.md).</span></span>  
  
  

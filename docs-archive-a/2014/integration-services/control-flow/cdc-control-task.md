---
title: CDC-Steuerungstask | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.ssis.designer.cdccontroltask.f1
ms.assetid: 6404dc7f-550c-47cc-b901-c072742f430a
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 36f98a02842353fd5196432738f4ebd8b2efb46c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87617237"
---
# <a name="cdc-control-task"></a><span data-ttu-id="21885-102">CDC-Steuerungstask</span><span class="sxs-lookup"><span data-stu-id="21885-102">CDC Control Task</span></span>
  <span data-ttu-id="21885-103">Der CDC-Steuerungstask wird verwendet, um den Lebenszyklus von Change Data Capture-Paketen (CDC) zu steuern.</span><span class="sxs-lookup"><span data-stu-id="21885-103">The CDC Control task is used to control the life cycle of change data capture (CDC) packages.</span></span> <span data-ttu-id="21885-104">Er behandelt die CDC-Paketsynchronisierung mit dem Paket des erstmaligen Ladens, also die Verwaltung der Bereiche von Protokollfolgenummern (LSNs), die bei einer Ausführung eines CDC-Pakets verarbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="21885-104">It handles CDC package synchronization with the initial load package, the management of Log Sequence Number (LSN) ranges that are processed in a run of a CDC package.</span></span> <span data-ttu-id="21885-105">Außerdem wird der CDC-Steuerungstask für Fehlerszenarien und für die Wiederherstellung verwendet.</span><span class="sxs-lookup"><span data-stu-id="21885-105">In addition, the CDC Control task deals with error scenarios and recovery.</span></span>  
  
 <span data-ttu-id="21885-106">Der CDC-Steuerungstask verwaltet den Status des CDC-Pakets in einer SSIS-Paketvariablen und kann diesen auch in einer Datenbanktabelle dauerhaft speichern, damit der Status über Paketaktivierungen hinweg und zwischen mehreren Paketen beibehalten werden kann, die zusammen einen allgemeinen CDC-Prozess durchführen (ein Task kann z. B. für das erstmalige Laden und ein anderer Task für Trickle-Feed-Updates zuständig sein).</span><span class="sxs-lookup"><span data-stu-id="21885-106">The CDC Control task maintains the state of the CDC package in an SSIS package variable and it can also persist it in a database table so that the state is maintained across package activations and between multiple packages that together perform a common CDC process (for example, one task may be responsible for the initial loading and the other for the trickle-feed updates).</span></span>  
  
 <span data-ttu-id="21885-107">Der CDC-Steuerungstask unterstützt zwei Gruppen von Vorgängen.</span><span class="sxs-lookup"><span data-stu-id="21885-107">The CDC Control task supports two groups of operations.</span></span> <span data-ttu-id="21885-108">Eine Gruppe behandelt die Synchronisierung von erstmaligem Laden und Änderungsverarbeitung, und die andere Gruppe verwaltet den LSN-Bereich für die Änderungsverarbeitung zur Ausführung eines CDC-Pakets und verfolgt, welche Daten erfolgreich verarbeitet wurden.</span><span class="sxs-lookup"><span data-stu-id="21885-108">One group handles the synchronization of initial load and change processing, and the other manages the change-processing range of LSNs for a run of a CDC package and keeps track of what was processed successfully.</span></span>  
  
 <span data-ttu-id="21885-109">Die folgenden Vorgänge behandeln die Synchronisierung von erstmaligem Laden und Änderungsverarbeitung:</span><span class="sxs-lookup"><span data-stu-id="21885-109">The following operations handle the synchronization of initial load and change processing:</span></span>  
  
|<span data-ttu-id="21885-110">Vorgang</span><span class="sxs-lookup"><span data-stu-id="21885-110">Operation</span></span>|<span data-ttu-id="21885-111">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="21885-111">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="21885-112">ResetCdcState</span><span class="sxs-lookup"><span data-stu-id="21885-112">ResetCdcState</span></span>|<span data-ttu-id="21885-113">Dieser Vorgang wird verwendet, um den persistenten CDC-Status zurückzusetzen, der dem aktuellen CDC-Kontext zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="21885-113">This operation is used to reset the persistent CDC state associated with the current CDC context.</span></span> <span data-ttu-id="21885-114">Nachdem dieser Vorgang ausgeführt wurde, wird die aktuelle höchste LSN aus der LSN-Zeitstempeltabelle `sys.fn_cdc_get_max_lsn` zum Startpunkt für den nächsten Verarbeitungsbereich.</span><span class="sxs-lookup"><span data-stu-id="21885-114">After this operation is run, the current maximum LSN from the LSN-timestamp `sys.fn_cdc_get_max_lsn` table becomes the start of the range for the next processing range.</span></span> <span data-ttu-id="21885-115">Für diesen Vorgang ist eine Verbindung zur Quelldatenbank erforderlich.</span><span class="sxs-lookup"><span data-stu-id="21885-115">This operation requires a connection to the source database.</span></span>|  
|<span data-ttu-id="21885-116">MarkInitialLoadStart</span><span class="sxs-lookup"><span data-stu-id="21885-116">MarkInitialLoadStart</span></span>|<span data-ttu-id="21885-117">Dieser Vorgang wird zu Beginn eines Pakets für das erstmalige Laden verwendet, um die aktuelle LSN in der Quelldatenbank aufzuzeichnen, bevor das Paket für das erstmalige Laden mit dem Lesen der Quelltabellen beginnt.</span><span class="sxs-lookup"><span data-stu-id="21885-117">This operation is used at the beginning of an initial-load package to record the current LSN in the source database before the initial-load package starts reading the source tables.</span></span> <span data-ttu-id="21885-118">Dies erfordert eine Verbindung zur Quelldatenbank, damit `sys.fn_cdc_get_max_lsn`aufgerufen werden kann.</span><span class="sxs-lookup"><span data-stu-id="21885-118">This requires a connection to the source database to call `sys.fn_cdc_get_max_lsn`.</span></span><br /><br /> <span data-ttu-id="21885-119">Wenn Sie bei der Verwendung von CDC in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] (d.h. nicht in Oracle) die Option MarkInitialLoadStart auswählen, muss der im Verbindungs-Manager angegebene Benutzer über die Rolle db_owner oder sysadmin verfügen.</span><span class="sxs-lookup"><span data-stu-id="21885-119">If you select MarkInitialLoadStart when working on [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] CDC (that is, not Oracle) the user specified in the connection manager must be either  db_owner or sysadmin.</span></span>|  
|<span data-ttu-id="21885-120">MarkInitialLoadEnd</span><span class="sxs-lookup"><span data-stu-id="21885-120">MarkInitialLoadEnd</span></span>|<span data-ttu-id="21885-121">Dieser Vorgang wird am Ende eines Pakets zum erstmaligen Laden verwendet, um die aktuelle LSN in der Quelldatenbank aufzuzeichnen, nachdem das Paket für das erstmalige Laden das Lesen der Quelltabellen beendet hat.</span><span class="sxs-lookup"><span data-stu-id="21885-121">This operation is used at the end of an initial-load package to record the current LSN in the source database after the initial-load package finished reading the source tables.</span></span> <span data-ttu-id="21885-122">Diese LSN wird durch das Aufzeichnen des aktuellen Zeitpunkts, zu dem dieser Vorgang aufgetreten ist, und das anschließende Abfragen der Zuordnungstabelle `cdc.lsn_time_`in der CDC-Datenbank ermittelt. Dabei wird nach einer Änderung gesucht, die nach diesem Zeitpunkt aufgetreten ist.</span><span class="sxs-lookup"><span data-stu-id="21885-122">This LSN is determined by recording the current time when this operation occurred and then querying the `cdc.lsn_time_`mapping table in the CDC database looking for a change that occurred after that time.</span></span><br /><br /> <span data-ttu-id="21885-123">Wenn Sie bei der Verwendung von CDC in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] (d.h. nicht in Oracle) die Option MarkInitialLoadEnd auswählen, muss der im Verbindungs-Manager angegebene Benutzer über die Berechtigung db_owner oder sysadmin verfügen.</span><span class="sxs-lookup"><span data-stu-id="21885-123">If you select MarkInitialLoadEnd when working on [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] CDC (that is , not Oracle) the user specified in the connection manager must be either  db_owner or sysadmin.</span></span>|  
|<span data-ttu-id="21885-124">MarkCdcStart</span><span class="sxs-lookup"><span data-stu-id="21885-124">MarkCdcStart</span></span>|<span data-ttu-id="21885-125">Dieser Vorgang wird verwendet, wenn das erstmalige Laden basierend auf einer Momentaufnahmen-Datenbank erfolgt.</span><span class="sxs-lookup"><span data-stu-id="21885-125">This operation is used when then the initial load is made from a snapshot database.</span></span> <span data-ttu-id="21885-126">In diesem Fall sollte die Änderungsverarbeitung unmittelbar nach der Momentaufnahme-LSN starten.</span><span class="sxs-lookup"><span data-stu-id="21885-126">In this case, the change processing should start immediately after the snapshot LSN.</span></span> <span data-ttu-id="21885-127">Sie können den Namen der zu verwendenden Momentaufnahmen-Datenbank angeben. Der CDC-Steuerungstask fragt [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] dann nach der Momentaufnahme-LSN ab.</span><span class="sxs-lookup"><span data-stu-id="21885-127">You can specify the name of the snapshot database to use and the CDC Control task queries [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] for the snapshot LSN.</span></span> <span data-ttu-id="21885-128">Sie können die Momentaufnahme-LSN auch direkt angeben.</span><span class="sxs-lookup"><span data-stu-id="21885-128">You also have the option to directly specify the snapshot LSN.</span></span><br /><br /> <span data-ttu-id="21885-129">Wenn Sie bei der Verwendung von CDC in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] (d.h. nicht in Oracle) die Option MarkCdcStart auswählen, muss der im Verbindungs-Manager angegebene Benutzer über die Berechtigung db_owner oder sysadmin verfügen.</span><span class="sxs-lookup"><span data-stu-id="21885-129">If you select MarkCdcStart when working on [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] CDC (that is , not Oracle) the user specified in the connection manager must be either  db_owner or sysadmin.</span></span>|  
  
 <span data-ttu-id="21885-130">Die folgenden Vorgänge werden verwendet, um den Verarbeitungsbereich zu verwalten:</span><span class="sxs-lookup"><span data-stu-id="21885-130">The following operations are used to manage the processing range:</span></span>  
  
|<span data-ttu-id="21885-131">Vorgang</span><span class="sxs-lookup"><span data-stu-id="21885-131">Operation</span></span>|<span data-ttu-id="21885-132">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="21885-132">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="21885-133">GetProcessingRange</span><span class="sxs-lookup"><span data-stu-id="21885-133">GetProcessingRange</span></span>|<span data-ttu-id="21885-134">Dieser Vorgang wird vor dem Aufrufen des Datenflusses verwendet, der den CDC-Quelldatenfluss nutzt.</span><span class="sxs-lookup"><span data-stu-id="21885-134">This operation is used before invoking the data flow that uses the CDC Source data flow.</span></span> <span data-ttu-id="21885-135">Dabei wird ein Bereich von LSNs eingerichtet, der vom CDC-Quelldatenfluss nach dem Aufrufen gelesen wird.</span><span class="sxs-lookup"><span data-stu-id="21885-135">It establishes a range of LSNs that the CDC Source data flow reads when invoked.</span></span> <span data-ttu-id="21885-136">Der Bereich wird in einer SSIS-Paketvariablen gespeichert, die von der CDC-Quelle während der Datenflussverarbeitung verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="21885-136">The range is stored in an SSIS package variable that is used by the CDC Source during data-flow processing.</span></span><br /><br /> <span data-ttu-id="21885-137">Weitere Informationen zu den gespeicherten Status finden Sie unter [Definieren einer Statusvariablen](../data-flow/define-a-state-variable.md).</span><span class="sxs-lookup"><span data-stu-id="21885-137">For more information about the states that are stored, see [Define a State Variable](../data-flow/define-a-state-variable.md).</span></span>|  
|<span data-ttu-id="21885-138">MarkProcessedRange</span><span class="sxs-lookup"><span data-stu-id="21885-138">MarkProcessedRange</span></span>|<span data-ttu-id="21885-139">Dieser Vorgang wird nach jeder CDC-Ausführung ausgeführt (nachdem der CDC-Datenfluss erfolgreich abgeschlossen wurde), um die letzte LSN aufzuzeichnen, die bei der CDC-Ausführung vollständig verarbeitet wurde.</span><span class="sxs-lookup"><span data-stu-id="21885-139">: This operation is executed after each CDC run (after the CDC data flow is completed successfully) to record the last LSN that was fully processed in the CDC run.</span></span> <span data-ttu-id="21885-140">Bei der nächsten Ausführung von GetProcessingRange dient diese Position als Startpunkt für den Verarbeitungsbereich.</span><span class="sxs-lookup"><span data-stu-id="21885-140">The next time GetProcessingRange is executed, this position is the start of the processing range.</span></span>|  
  
## <a name="handling-cdc-state-persistency"></a><span data-ttu-id="21885-141">Behandeln von CDC-Statuspersistenz</span><span class="sxs-lookup"><span data-stu-id="21885-141">Handling CDC State Persistency</span></span>  
 <span data-ttu-id="21885-142">Der CDC-Steuerungstask behält zwischen Aktivierungen einen persistenten Status bei.</span><span class="sxs-lookup"><span data-stu-id="21885-142">The CDC Control task maintains a persistent state between activations.</span></span> <span data-ttu-id="21885-143">Die im CDC-Status gespeicherten Informationen werden verwendet, um den Verarbeitungsbereich für das CDC-Paket zu bestimmen und zu verwalten und Fehlerzustände zu erkennen.</span><span class="sxs-lookup"><span data-stu-id="21885-143">The information stored in the CDC state is used to determine and maintain the processing range for the CDC package and for detecting error conditions.</span></span> <span data-ttu-id="21885-144">Der persistente Status wird als Zeichenfolge gespeichert.</span><span class="sxs-lookup"><span data-stu-id="21885-144">The persistent state is stored as a string.</span></span> <span data-ttu-id="21885-145">Weitere Informationen finden Sie unter [Definieren einer Statusvariablen](../data-flow/define-a-state-variable.md).</span><span class="sxs-lookup"><span data-stu-id="21885-145">For more information, see [Define a State Variable](../data-flow/define-a-state-variable.md).</span></span>  
  
 <span data-ttu-id="21885-146">Der CDC-Steuerungstask unterstützt zwei Typen der Statuspersistenz:</span><span class="sxs-lookup"><span data-stu-id="21885-146">The CDC Control task supports two types of state persistency</span></span>  
  
-   <span data-ttu-id="21885-147">Manuelle Statuspersistenz: In diesem Fall verwaltet der CDC-Steuerungstask den in einer Paketvariablen gespeicherten Status. Der Paketentwickler muss die Variable vor dem Aufrufen der CDC-Steuerung jedoch aus einem persistenten Speicher lesen und dann in diesen persistenten Speicher zurückschreiben, nachdem die CDC-Steuerung zuletzt aufgerufen und die CDC-Ausführung abgeschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="21885-147">Manual State Persistency: In this case, the CDC Control task manages the state stored in a package variable but the package developer must read the variable from a persistent store before calling the CDC Control and then write it back to that persistent store after the CDC Control is last called and the CDC run completes.</span></span>  
  
-   <span data-ttu-id="21885-148">Automatische Statuspersistenz: Der CDC-Status wird in einer Tabelle in einer Datenbank gespeichert.</span><span class="sxs-lookup"><span data-stu-id="21885-148">Automatic State Persistency: The CDC state is stored in a table in a database.</span></span> <span data-ttu-id="21885-149">Der Status wird unter einem in der **StateName** -Eigenschaft angegebenen Namen in einer Tabelle gespeichert, die in der **Tabelle für Speicherstatus** -Eigenschaft angegeben ist. Sie befindet sich in einem ausgewählten Verbindungs-Manager zum Speichern des Status.</span><span class="sxs-lookup"><span data-stu-id="21885-149">The state is stored under a name provided in the **StateName** property in a table named in the **Table to Use for Storing State** property, which is located in a selected connection manager for storing the state.</span></span> <span data-ttu-id="21885-150">Die Standardeinstellung ist der Quellverbindungs-Manager, aber häufig wird der Zielverbindungs-Manager verwendet.</span><span class="sxs-lookup"><span data-stu-id="21885-150">The default is the source connection manager but the common practice is for it to be the target connection manager.</span></span> <span data-ttu-id="21885-151">Der CDC-Steuerungstask aktualisiert den Statuswert in der Statustabelle, und dafür wird als Teil der Ambient-Transaktion ein Commit ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="21885-151">The CDC Control task updates the state value in the state table and this is committed as part of the ambient transaction.</span></span>  
  
## <a name="error-handling"></a><span data-ttu-id="21885-152">Fehlerbehandlung</span><span class="sxs-lookup"><span data-stu-id="21885-152">Error Handling</span></span>  
 <span data-ttu-id="21885-153">Der CDC-Steuerungstask meldet möglicherweise in folgenden Fällen einen Fehler:</span><span class="sxs-lookup"><span data-stu-id="21885-153">The CDC Control task may report an error when:</span></span>  
  
-   <span data-ttu-id="21885-154">Beim Lesen des persistenten CDC-Status oder beim Aktualisieren des persistenten Status tritt ein Fehler auf.</span><span class="sxs-lookup"><span data-stu-id="21885-154">It fails to read the persistent CDC state or when updating the persistent state fails.</span></span>  
  
-   <span data-ttu-id="21885-155">Beim Lesen der aktuellen LSN-Informationen aus der Quelldatenbank tritt ein Fehler auf.</span><span class="sxs-lookup"><span data-stu-id="21885-155">It fails to read the current LSN information from the source database.</span></span>  
  
-   <span data-ttu-id="21885-156">Der gelesene CDC-Status ist nicht konsistent.</span><span class="sxs-lookup"><span data-stu-id="21885-156">The CDC state read is not consistent.</span></span>  
  
 <span data-ttu-id="21885-157">In all diesen Fällen meldet der CDC-Steuerungstask einen Fehler, der mithilfe der Standardmethode behandelt werden kann, die SSIS auch für Befehlsflussfehler verwendet.</span><span class="sxs-lookup"><span data-stu-id="21885-157">In all of these cases, the CDC Control task reports an error that can be handled in the standard way SSIS handles control-flow errors.</span></span>  
  
 <span data-ttu-id="21885-158">Der CDC-Steuerungstask zeigt möglicherweise auch eine Warnung an, wenn der Get Processing Range-Vorgang direkt nach einem anderen Get Processing Range-Vorgang aufgerufen wird, ohne dass Mark Processed Range aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="21885-158">The CDC Control task may also report a warning when the Get Processing Range operation is invoked directly after another Get Processing Range operation without Mark Processed Range being called.</span></span> <span data-ttu-id="21885-159">Dies ist ein Anzeichen dafür, dass bei der vorherigen Ausführung ein Fehler aufgetreten ist oder dass möglicherweise ein anderes CDC-Paket ausgeführt wird und den gleichen CDC-Statusnamen verwendet.</span><span class="sxs-lookup"><span data-stu-id="21885-159">This is an indication that the previous run failed or that another CDC package may be running using the same CDC state name.</span></span>  
  
## <a name="configuring-the-cdc-control-task"></a><span data-ttu-id="21885-160">Konfigurieren des CDC-Steuerungstasks</span><span class="sxs-lookup"><span data-stu-id="21885-160">Configuring the CDC Control Task</span></span>  
 <span data-ttu-id="21885-161">Sie können Eigenschaften programmgesteuert oder mit dem SSIS-Designer festlegen.</span><span class="sxs-lookup"><span data-stu-id="21885-161">You can set properties through SSIS Designer or programmatically.</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="21885-162">In diesem Abschnitt</span><span class="sxs-lookup"><span data-stu-id="21885-162">In This Section</span></span>  
  
-   [<span data-ttu-id="21885-163">CDC Control Task Editor</span><span class="sxs-lookup"><span data-stu-id="21885-163">CDC Control Task Editor</span></span>](../cdc-control-task-editor.md)  
  
-   [<span data-ttu-id="21885-164">Benutzerdefinierte Eigenschaften des CDC-Steuerungstasks</span><span class="sxs-lookup"><span data-stu-id="21885-164">CDC Control Task Custom Properties</span></span>](cdc-control-task-custom-properties.md)  
  
## <a name="related-tasks"></a><span data-ttu-id="21885-165">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="21885-165">Related Tasks</span></span>  
 [<span data-ttu-id="21885-166">Definieren einer Statusvariablen</span><span class="sxs-lookup"><span data-stu-id="21885-166">Define a State Variable</span></span>](../data-flow/define-a-state-variable.md)  
  
## <a name="related-content"></a><span data-ttu-id="21885-167">Verwandte Inhalte</span><span class="sxs-lookup"><span data-stu-id="21885-167">Related Content</span></span>  
  
-   <span data-ttu-id="21885-168">Technischer Artikel [Installieren von Microsoft SQL Server 2012 Change Data Capture für Oracle von Attunity](https://go.microsoft.com/fwlink/?LinkId=252958)auf social.technet.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="21885-168">Technical article, [Installing Microsoft SQL Server 2012 Change Data Capture for Oracle by Attunity](https://go.microsoft.com/fwlink/?LinkId=252958), on social.technet.microsoft.com.</span></span>  
  
-   <span data-ttu-id="21885-169">Technischer Artikel [Troubleshoot Configuration Issues in Microsoft Change Data Capture for Oracle by Attunity](https://go.microsoft.com/fwlink/?LinkId=252960)(Behandeln von Konfigurationsproblemen in Microsoft Change Data Capture für Oracle von Attunity) auf social.technet.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="21885-169">Technical article, [Troubleshoot Configuration Issues in Microsoft Change Data Capture for Oracle by Attunity](https://go.microsoft.com/fwlink/?LinkId=252960), on social.technet.microsoft.com.</span></span>  
  
-   <span data-ttu-id="21885-170">Technischer Artikel [Behandeln von Fehlern bei CDC-Instanzen in Microsoft Change Data Capture für Oracle von Attunity](https://go.microsoft.com/fwlink/?LinkId=252961)auf social.technet.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="21885-170">Technical article, [Troubleshoot CDC Instance Errors in Microsoft Change Data Capture for Oracle by Attunity](https://go.microsoft.com/fwlink/?LinkId=252961), on social.technet.microsoft.com.</span></span>  
  
  

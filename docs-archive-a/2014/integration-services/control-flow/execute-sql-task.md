---
title: Task „SQL ausführen“ | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.executesqltask.f1
helpviewer_keywords:
- Transact-SQL statements, SSIS
- statements [Integration Services]
- batches [Integration Services]
- Execute SQL task [Integration Services]
ms.assetid: bebb2e8c-0410-43b2-ac2f-6fc80c8f2e9e
author: chugugrace
ms.author: chugu
ms.openlocfilehash: e77b9f442ae8478c57d5b0e68955b541eda38aff
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87697069"
---
# <a name="execute-sql-task"></a><span data-ttu-id="8953e-102">SQL ausführen (Task)</span><span class="sxs-lookup"><span data-stu-id="8953e-102">Execute SQL Task</span></span>
  <span data-ttu-id="8953e-103">Mit dem Task SQL ausführen werden SQL-Anweisungen oder gespeicherte Prozeduren aus einem Paket ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="8953e-103">The Execute SQL task runs SQL statements or stored procedures from a package.</span></span> <span data-ttu-id="8953e-104">Dieser Task kann eine oder mehrere SQL-Anweisungen enthalten, die sequenziell ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="8953e-104">The task can contain either a single SQL statement or multiple SQL statements that run sequentially.</span></span> <span data-ttu-id="8953e-105">Der Task SQL ausführen kann für folgende Zwecke verwendet werden:</span><span class="sxs-lookup"><span data-stu-id="8953e-105">You can use the Execute SQL task for the following purposes:</span></span>  
  
-   <span data-ttu-id="8953e-106">Abschneiden einer Tabelle oder Sicht, um das Einfügen von Daten vorzubereiten.</span><span class="sxs-lookup"><span data-stu-id="8953e-106">Truncate a table or view in preparation for inserting data.</span></span>  
  
-   <span data-ttu-id="8953e-107">Erstellen, Ändern und Löschen von Datenbankobjekten, wie z. B. Tabellen und Sichten.</span><span class="sxs-lookup"><span data-stu-id="8953e-107">Create, alter, and drop database objects such as tables and views.</span></span>  
  
-   <span data-ttu-id="8953e-108">Neuerstellen von Fakten- und Dimensionstabellen vor dem Laden von Daten.</span><span class="sxs-lookup"><span data-stu-id="8953e-108">Re-create fact and dimension tables before loading data into them.</span></span>  
  
-   <span data-ttu-id="8953e-109">Ausführen gespeicherter Prozeduren.</span><span class="sxs-lookup"><span data-stu-id="8953e-109">Run stored procedures.</span></span> <span data-ttu-id="8953e-110">Wenn Sie mithilfe einer SQL-Anweisung eine gespeicherte Prozedur aufrufen, die Ergebnisse von einer temporären Tabelle zurückgibt, verwenden Sie die WITH RESULT SETS-Option, um Metadaten für das Resultset zu definieren.</span><span class="sxs-lookup"><span data-stu-id="8953e-110">If the SQL statement invokes a stored procedure that returns results from a temporary table, use the WITH RESULT SETS option to define metadata for the result set.</span></span>  
  
-   <span data-ttu-id="8953e-111">Speichern des Rowsets, das von einer Abfrage zurückgegeben wird, in einer Variablen.</span><span class="sxs-lookup"><span data-stu-id="8953e-111">Save the rowset returned from a query into a variable.</span></span>  
  
 <span data-ttu-id="8953e-112">Der Task SQL ausführen kann in Kombination mit dem Foreach-Schleifencontainer und dem For-Schleifencontainer verwendet werden, um mehrere SQL-Anweisungen auszuführen.</span><span class="sxs-lookup"><span data-stu-id="8953e-112">The Execute SQL task can be used in combination with the Foreach Loop and For Loop containers to run multiple SQL statements.</span></span> <span data-ttu-id="8953e-113">Diese Container implementieren das Wiederholen von Ablaufsteuerungen in einem Paket und können den Task SQL ausführen wiederholt ausführen.</span><span class="sxs-lookup"><span data-stu-id="8953e-113">These containers implement repeating control flows in a package and they can run the Execute SQL task repeatedly.</span></span> <span data-ttu-id="8953e-114">Beispielsweise kann ein Paket mithilfe des Foreach-Schleifencontainers Dateien in einem Ordner aufzählen und einen Task SQL ausführen wiederholt ausführen, um die in jeder Datei gespeicherte SQL-Anweisung auszuführen.</span><span class="sxs-lookup"><span data-stu-id="8953e-114">For example, using the Foreach Loop container, a package can enumerate files in a folder and run an Execute SQL task repeatedly to execute the SQL statement stored in each file.</span></span>  
  
## <a name="connecting-to-a-data-source"></a><span data-ttu-id="8953e-115">Aufbauen der Verbindung zu einer Datenquelle</span><span class="sxs-lookup"><span data-stu-id="8953e-115">Connecting to a Data Source</span></span>  
 <span data-ttu-id="8953e-116">Der Task SQL ausführen kann verschiedene Arten von Verbindungs-Managern für die Verbindung mit der Datenquelle verwenden, in der die SQL-Anweisung oder die gespeicherte Prozedur ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="8953e-116">The Execute SQL task can use different types of connection managers to connect to the data source where it runs the SQL statement or stored procedure.</span></span> <span data-ttu-id="8953e-117">Der Task kann die in der folgenden Tabelle aufgeführten Verbindungstypen verwenden.</span><span class="sxs-lookup"><span data-stu-id="8953e-117">The task can use the connection types listed in the following table.</span></span>  
  
|<span data-ttu-id="8953e-118">Verbindungstyp</span><span class="sxs-lookup"><span data-stu-id="8953e-118">Connection type</span></span>|<span data-ttu-id="8953e-119">Ziel-Editor für Dimensionsverarbeitung</span><span class="sxs-lookup"><span data-stu-id="8953e-119">Connection manager</span></span>|  
|---------------------|------------------------|  
|<span data-ttu-id="8953e-120">EXCEL</span><span class="sxs-lookup"><span data-stu-id="8953e-120">EXCEL</span></span>|[<span data-ttu-id="8953e-121">Excel-Verbindungs-Manager</span><span class="sxs-lookup"><span data-stu-id="8953e-121">Excel Connection Manager</span></span>](../connection-manager/excel-connection-manager.md)|  
|<span data-ttu-id="8953e-122">OLE DB</span><span class="sxs-lookup"><span data-stu-id="8953e-122">OLE DB</span></span>|[<span data-ttu-id="8953e-123">OLE DB-Verbindungs-Manager</span><span class="sxs-lookup"><span data-stu-id="8953e-123">OLE DB Connection Manager</span></span>](../connection-manager/ole-db-connection-manager.md)|  
|<span data-ttu-id="8953e-124">ODBC</span><span class="sxs-lookup"><span data-stu-id="8953e-124">ODBC</span></span>|[<span data-ttu-id="8953e-125">ODBC-Verbindungs-Manager</span><span class="sxs-lookup"><span data-stu-id="8953e-125">ODBC Connection Manager</span></span>](../connection-manager/odbc-connection-manager.md)|  
|<span data-ttu-id="8953e-126">ADO</span><span class="sxs-lookup"><span data-stu-id="8953e-126">ADO</span></span>|[<span data-ttu-id="8953e-127">ADO-Verbindungs-Manager</span><span class="sxs-lookup"><span data-stu-id="8953e-127">ADO Connection Manager</span></span>](../connection-manager/ado-connection-manager.md)|  
|<span data-ttu-id="8953e-128">ADO.NET</span><span class="sxs-lookup"><span data-stu-id="8953e-128">ADO.NET</span></span>|[<span data-ttu-id="8953e-129">ADO.NET-Verbindungs-Manager</span><span class="sxs-lookup"><span data-stu-id="8953e-129">ADO.NET Connection Manager</span></span>](../connection-manager/ado-net-connection-manager.md)|  
|<span data-ttu-id="8953e-130">SQLMOBILE</span><span class="sxs-lookup"><span data-stu-id="8953e-130">SQLMOBILE</span></span>|[<span data-ttu-id="8953e-131">SQL Server Compact Edition-Verbindungs-Manager</span><span class="sxs-lookup"><span data-stu-id="8953e-131">SQL Server Compact Edition Connection Manager</span></span>](../connection-manager/sql-server-compact-edition-connection-manager.md)|  
  
## <a name="creating-sql-statements"></a><span data-ttu-id="8953e-132">Erstellen von SQL-Anweisungen</span><span class="sxs-lookup"><span data-stu-id="8953e-132">Creating SQL Statements</span></span>  
 <span data-ttu-id="8953e-133">Die Quelle für die SQL-Anweisungen, die von diesem Task verwendet werden, kann eine Taskeigenschaft mit einer Anweisung, eine Verbindung mit einer Datei mit mindestens einer Anweisung oder der Name einer Variablen sein, die eine Anweisung enthält.</span><span class="sxs-lookup"><span data-stu-id="8953e-133">The source of the SQL statements used by this task can be a task property that contains a statement, a connection to a file that contains one or multiple statements, or the name of a variable that contains a statement.</span></span> <span data-ttu-id="8953e-134">Die SQL-Anweisungen müssen in dem Dialekt des Quelldatenbank-Managementsystems (DBMS, Database Management System) erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="8953e-134">The SQL statements must be written in the dialect of the source database management system (DBMS).</span></span> <span data-ttu-id="8953e-135">Weitere Informationen finden Sie unter [Integration Services-Abfragen &#40;SSIS&#41;](../integration-services-ssis-queries.md).</span><span class="sxs-lookup"><span data-stu-id="8953e-135">For more information, see [Integration Services &#40;SSIS&#41; Queries](../integration-services-ssis-queries.md).</span></span>  
  
 <span data-ttu-id="8953e-136">Wenn die SQL-Anweisungen in einer Datei gespeichert sind, stellt der Task mithilfe eines Verbindungs-Managers eine Verbindung mit der Datei her.</span><span class="sxs-lookup"><span data-stu-id="8953e-136">If the SQL statements are stored in a file, the task uses a File connection manager to connect to the file.</span></span> <span data-ttu-id="8953e-137">Weitere Informationen finden Sie unter [File Connection Manager](../connection-manager/file-connection-manager.md).</span><span class="sxs-lookup"><span data-stu-id="8953e-137">For more information, see [File Connection Manager](../connection-manager/file-connection-manager.md).</span></span>  
  
 <span data-ttu-id="8953e-138">Im [!INCLUDE[ssIS](../../includes/ssis-md.md)] -Designer können Sie zum Eingeben von SQL-Anweisungen das Dialogfeld **Editor für den Task SQL ausführen** oder den **Abfrage-Generator**verwenden. Dabei handelt es sich um eine grafische Benutzeroberfläche zum Erstellen von SQL-Abfragen.</span><span class="sxs-lookup"><span data-stu-id="8953e-138">In [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, you can use the **Execute SQL Task Editor** dialog box to type SQL statements, or use **Query Builder**, a graphical user interface for creating SQL queries.</span></span> <span data-ttu-id="8953e-139">Weitere Informationen finden Sie unter [Execute SQL Task Editor &#40;General Page&#41;](../execute-sql-task-editor-general-page.md) und [Abfrage-Generator](../query-builder.md).</span><span class="sxs-lookup"><span data-stu-id="8953e-139">For more information, see [Execute SQL Task Editor &#40;General Page&#41;](../execute-sql-task-editor-general-page.md) and [Query Builder](../query-builder.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8953e-140">Gültige SQL-Anweisungen, die außerhalb des Tasks "SQL ausführen" erstellt wurden, werden vom Task "SQL ausführen" möglicherweise nicht erfolgreich analysiert.</span><span class="sxs-lookup"><span data-stu-id="8953e-140">Valid SQL statements written outside the Execute SQL task may not be parsed successfully by the Execute SQL task.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8953e-141">Der Task "SQL ausführen" verwendet den `RecognizeAll` ParseMode-Enumerationswert.</span><span class="sxs-lookup"><span data-stu-id="8953e-141">The Execute SQL Task uses the `RecognizeAll` ParseMode enumeration value.</span></span> <span data-ttu-id="8953e-142">Weitere Informationen finden Sie unter [ManagedBatchParser-Namespace](https://go.microsoft.com/fwlink/?LinkId=223617).</span><span class="sxs-lookup"><span data-stu-id="8953e-142">For more information, see [ManagedBatchParser Namespace](https://go.microsoft.com/fwlink/?LinkId=223617).</span></span>  
  
## <a name="sending-multiple-statements-in-a-batch"></a><span data-ttu-id="8953e-143">Senden mehrerer Anweisungen in einem Batch</span><span class="sxs-lookup"><span data-stu-id="8953e-143">Sending Multiple Statements in a Batch</span></span>  
 <span data-ttu-id="8953e-144">Wenn Sie für den Task "SQL ausführen" mehrere Anweisungen einschließen, können Sie diese gruppieren und als Batch ausführen.</span><span class="sxs-lookup"><span data-stu-id="8953e-144">If you include multiple statements in an Execute SQL task, you can group them and run them as a batch.</span></span> <span data-ttu-id="8953e-145">Verwenden Sie den GO-Befehl, um das Ende eines Batches zu signalisieren.</span><span class="sxs-lookup"><span data-stu-id="8953e-145">To signal the end of a batch, use the GO command.</span></span> <span data-ttu-id="8953e-146">Alle SQL-Anweisungen zwischen zwei GO-Befehlen werden als Batch an den OLE DB-Anbieter zum Ausführen gesendet.</span><span class="sxs-lookup"><span data-stu-id="8953e-146">All the SQL statements between two GO commands are sent in a batch to the OLE DB provider to be run.</span></span> <span data-ttu-id="8953e-147">Der SQL-Befehl kann mehrere durch GO-Befehle getrennte Batches einschließen.</span><span class="sxs-lookup"><span data-stu-id="8953e-147">The SQL command can include multiple batches separated by GO commands.</span></span>  
  
 <span data-ttu-id="8953e-148">Bezüglich der SQL-Anweisungen, die als Batch gruppiert werden können, sind Einschränkungen vorhanden.</span><span class="sxs-lookup"><span data-stu-id="8953e-148">There are restrictions on the kinds of SQL statements that you can group in a batch.</span></span> <span data-ttu-id="8953e-149">Weitere Informationen finden Sie unter [Batches of Statements](../../relational-databases/native-client-odbc-queries/executing-statements/batches-of-statements.md).</span><span class="sxs-lookup"><span data-stu-id="8953e-149">For more information, see [Batches of Statements](../../relational-databases/native-client-odbc-queries/executing-statements/batches-of-statements.md).</span></span>  
  
 <span data-ttu-id="8953e-150">Falls der Task SQL ausführen einen Batch mit SQL-Anweisungen ausführt, gelten für den Batch die folgenden Regeln:</span><span class="sxs-lookup"><span data-stu-id="8953e-150">If the Execute SQL task runs a batch of SQL statements, the following rules apply to the batch:</span></span>  
  
-   <span data-ttu-id="8953e-151">Nur eine Anweisung kann ein Resultset zurückgeben. Sie muss außerdem die erste Anweisung im Batch sein.</span><span class="sxs-lookup"><span data-stu-id="8953e-151">Only one statement can return a result set and it must be the first statement in the batch.</span></span>  
  
-   <span data-ttu-id="8953e-152">Falls das Resultset Ergebnisbindungen verwendet, müssen die Abfragen die gleiche Anzahl von Spalten zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="8953e-152">If the result set uses result bindings, the queries must return the same number of columns.</span></span> <span data-ttu-id="8953e-153">Falls die Abfragen eine andere Anzahl von Spalten zurückgeben, wird für den Task ein Fehler gemeldet.</span><span class="sxs-lookup"><span data-stu-id="8953e-153">If the queries return a different number of columns, the task fails.</span></span> <span data-ttu-id="8953e-154">Bei einem Fehler des Tasks werden jedoch die von dem Task ausgeführten Abfragen, wie z. B. DELETE- oder INSERT-Abfragen, möglicherweise erfolgreich ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="8953e-154">However, even if the task fails, the queries that it runs, such as DELETE or INSERT queries, may succeed.</span></span>  
  
-   <span data-ttu-id="8953e-155">Falls für die Ergebnisbindungen Spaltennamen verwendet werden, muss die Abfrage Spalten zurückgeben, die die gleichen Namen wie die vom Task verwendeten Resultsetnamen besitzen.</span><span class="sxs-lookup"><span data-stu-id="8953e-155">If the result bindings use column names, the query must return columns that have the same names as the result set names that are used in the task.</span></span> <span data-ttu-id="8953e-156">Wenn die Spalten fehlen, wird für den Task ein Fehler gemeldet.</span><span class="sxs-lookup"><span data-stu-id="8953e-156">If the columns are missing, the task fails.</span></span>  
  
-   <span data-ttu-id="8953e-157">Falls für den Task die Parameterbindung verwendet wird, müssen alle Abfragen im Batch die gleiche Anzahl und Art von Parametern aufweisen.</span><span class="sxs-lookup"><span data-stu-id="8953e-157">If the task uses parameter binding, all the queries in the batch must have the same number and types of parameters.</span></span>  
  
## <a name="running-parameterized-sql-commands"></a><span data-ttu-id="8953e-158">Ausführen parametrisierter SQL-Befehle</span><span class="sxs-lookup"><span data-stu-id="8953e-158">Running Parameterized SQL Commands</span></span>  
 <span data-ttu-id="8953e-159">SQL-Anweisungen und gespeicherte Prozeduren verwenden häufig Eingabeparameter, Ausgabeparameter und Rückgabecodes.</span><span class="sxs-lookup"><span data-stu-id="8953e-159">SQL statements and stored procedures frequently use input parameters, output parameters, and return codes.</span></span> <span data-ttu-id="8953e-160">Der Task SQL ausführen unterstützt die `Input`-, `Output`- und `ReturnValue`-Parametertypen.</span><span class="sxs-lookup"><span data-stu-id="8953e-160">The Execute SQL task supports the `Input`, `Output`, and `ReturnValue` parameter types.</span></span> <span data-ttu-id="8953e-161">Sie können den `Input`-Typ für Eingabeparameter, den `Output`-Typ für Ausgabeparameter und den `ReturnValue`-Typ für Rückgabecodes verwenden.</span><span class="sxs-lookup"><span data-stu-id="8953e-161">You use the `Input` type for input parameters, `Output` for output parameters, and `ReturnValue` for return codes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8953e-162">Parameter können in einem Task SQL ausführen nur verwendet werden, wenn dies vom Datenanbieter unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="8953e-162">You can use parameters in an Execute SQL task only if the data provider supports them.</span></span>  
  
 <span data-ttu-id="8953e-163">Informationen über die Verwendung von Parametern und Rückgabecodes im Task „SQL ausführen“ finden Sie unter [Parameter und Rückgabecodes im Task „SQL ausführen“](execute-sql-task.md).</span><span class="sxs-lookup"><span data-stu-id="8953e-163">For information on using parameters and return codes in the Execute SQL task, see [Parameters and Return Codes in the Execute SQL Task](execute-sql-task.md).</span></span>  
  
## <a name="specifying-a-result-set-type"></a><span data-ttu-id="8953e-164">Angeben eines Resultsettyps</span><span class="sxs-lookup"><span data-stu-id="8953e-164">Specifying a Result Set Type</span></span>  
 <span data-ttu-id="8953e-165">Der Typ des SQL-Befehls bestimmt, ob für den Task SQL ausführen ein Resultset zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="8953e-165">Depending on the type of SQL command, a result set may or may not be returned to the Execute SQL task.</span></span> <span data-ttu-id="8953e-166">Beispielsweise gibt eine SELECT-Anweisung in der Regel ein Resultset zurück, eine INSERT-Anweisung jedoch nicht.</span><span class="sxs-lookup"><span data-stu-id="8953e-166">For example, a SELECT statement typically returns a result set, but an INSERT statement does not.</span></span> <span data-ttu-id="8953e-167">Das Resultset einer SELECT-Anweisung kann keine Zeilen, eine Zeile oder viele Zeilen enthalten.</span><span class="sxs-lookup"><span data-stu-id="8953e-167">The result set from a SELECT statement can contain zero rows, one row, or many rows.</span></span> <span data-ttu-id="8953e-168">Gespeicherte Prozeduren können außerdem einen ganzzahligen Wert, der als Rückgabecode bezeichnet wird, zurückgeben, um den Ausführungsstatus der Prozedur anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="8953e-168">Stored procedures can also return an integer value, called a return code, that indicates the execution status of the procedure.</span></span> <span data-ttu-id="8953e-169">In diesem Fall besteht das Resultset aus einer einzelnen Zeile.</span><span class="sxs-lookup"><span data-stu-id="8953e-169">In that case, the result set consists of a single row.</span></span>  
  
 <span data-ttu-id="8953e-170">Informationen über das Abrufen von Resultsets aus SQL-Befehlen im Task „SQL ausführen“ finden Sie unter [Resultsets im Task „SQL ausführen“](../result-sets-in-the-execute-sql-task.md).</span><span class="sxs-lookup"><span data-stu-id="8953e-170">For information on retrieving result sets from SQL commands in the Execute SQL task, see [Result Sets in the Execute SQL Task](../result-sets-in-the-execute-sql-task.md).</span></span>  
  
## <a name="troubleshooting-the-execute-sql-task"></a><span data-ttu-id="8953e-171">Problembehandlung des Tasks SQL ausführen</span><span class="sxs-lookup"><span data-stu-id="8953e-171">Troubleshooting the Execute SQL Task</span></span>  
 <span data-ttu-id="8953e-172">Sie können die vom Task SQL ausführen an externe Datenanbieter gerichteten Aufrufe protokollieren.</span><span class="sxs-lookup"><span data-stu-id="8953e-172">You can log the calls that the Execute SQL task makes to external data providers.</span></span> <span data-ttu-id="8953e-173">Mithilfe dieser Protokollierungsfunktionen können Sie Probleme bei SQL-Befehlen behandeln, die vom Task SQL ausführen ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="8953e-173">You can use this logging capability to troubleshoot the SQL commands that the Execute SQL task runs.</span></span> <span data-ttu-id="8953e-174">Aktivieren Sie zum Protokollieren der vom Task SQL ausführen an externe Datenanbieter gerichteten Aufrufe die Paketprotokollierung, und wählen Sie das **Diagnostic** -Ereignis auf Paketebene aus.</span><span class="sxs-lookup"><span data-stu-id="8953e-174">To log the calls that the Execute SQL task makes to external data providers, enable package logging and select the **Diagnostic** event at the package level.</span></span> <span data-ttu-id="8953e-175">Weitere Informationen finden Sie unter [Behandeln von Problemen mit Paketausführungstools](../troubleshooting/troubleshooting-tools-for-package-execution.md).</span><span class="sxs-lookup"><span data-stu-id="8953e-175">For more information, see [Troubleshooting Tools for Package Execution](../troubleshooting/troubleshooting-tools-for-package-execution.md).</span></span>  
  
 <span data-ttu-id="8953e-176">Gelegentlich gibt ein SQL-Befehl oder eine gespeicherte Prozedur mehrere Resultsets zurück.</span><span class="sxs-lookup"><span data-stu-id="8953e-176">Sometimes a SQL command or stored procedure returns multiple result sets.</span></span> <span data-ttu-id="8953e-177">Zu diesen Resultsets gehören nicht nur Rowsets, die das Ergebnis von `SELECT`-Abfragen sind, sondern auch einzelne Werte als Ergebnis von Fehlern in der `RAISERROR`-Anweisung oder `PRINT`-Anweisung.</span><span class="sxs-lookup"><span data-stu-id="8953e-177">These result sets include not only rowsets that are the result of `SELECT` queries, but single values that are the result of errors of `RAISERROR` or `PRINT` statements.</span></span> <span data-ttu-id="8953e-178">Ob der Task Fehler in Resultsets nach dem ersten Resultset ignoriert, hängt vom verwendeten Typ des Verbindungs-Managers ab:</span><span class="sxs-lookup"><span data-stu-id="8953e-178">Whether the task ignores errors in result sets that occur after the first result set depends on the type of connection manager that is used:</span></span>  
  
-   <span data-ttu-id="8953e-179">Wenn Sie OLE DB- und ADO-Verbindungs-Manager verwenden, ignoriert der Task die Resultsets, die nach dem ersten Resultset auftreten.</span><span class="sxs-lookup"><span data-stu-id="8953e-179">When you use OLE DB and ADO connection managers, the task ignores the result sets that occur after the first result set.</span></span> <span data-ttu-id="8953e-180">Das bedeutet, dass der Task bei diesen Verbindungs-Managern einen von einem SQL-Befehl oder einer gespeicherten Prozedur zurückgegebenen Fehler ignoriert, wenn der Fehler nicht Teil des ersten Resultsets ist.</span><span class="sxs-lookup"><span data-stu-id="8953e-180">Therefore, with these connection managers, the task ignores an error returned by an SQL command or a stored procedure when the error is not part of the first result set.</span></span>  
  
-   <span data-ttu-id="8953e-181">Wenn Sie ODBC- und ADO.NET-Verbindungs-Manager verwenden, werden die Resultsets, die nach dem ersten Resultset auftreten, vom Task nicht ignoriert.</span><span class="sxs-lookup"><span data-stu-id="8953e-181">When you use ODBC and ADO.NET connection managers, the task does not ignore result sets that occur after the first result set.</span></span> <span data-ttu-id="8953e-182">Bei diesen Verbindungs-Managern erzeugt der Task einen Fehler, wenn ein anderes Resultset als das erste Resultset einen Fehler aufweist.</span><span class="sxs-lookup"><span data-stu-id="8953e-182">With these connection managers, the task will fail with an error when a result set other than the first result set contains an error.</span></span>  
  
### <a name="custom-log-entries"></a><span data-ttu-id="8953e-183">Benutzerdefinierte Protokolleinträge</span><span class="sxs-lookup"><span data-stu-id="8953e-183">Custom Log Entries</span></span>  
 <span data-ttu-id="8953e-184">In der folgenden Tabelle wird der benutzerdefinierte Protokolleintrag für den Task <legacyBold>SQL ausführen</legacyBold> beschrieben.</span><span class="sxs-lookup"><span data-stu-id="8953e-184">The following table describes the custom log entry for the Execute SQL task.</span></span> <span data-ttu-id="8953e-185">Weitere Informationen finden Sie unter [Integration Services-Protokollierung &#40;SSIS&#41;](../performance/integration-services-ssis-logging.md) und [Benutzerdefinierte Meldungen für die Protokollierung](../custom-messages-for-logging.md).</span><span class="sxs-lookup"><span data-stu-id="8953e-185">For more information, see [Integration Services &#40;SSIS&#41; Logging](../performance/integration-services-ssis-logging.md) and [Custom Messages for Logging](../custom-messages-for-logging.md).</span></span>  
  
|<span data-ttu-id="8953e-186">Protokolleintrag</span><span class="sxs-lookup"><span data-stu-id="8953e-186">Log entry</span></span>|<span data-ttu-id="8953e-187">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="8953e-187">Description</span></span>|  
|---------------|-----------------|  
|`ExecuteSQLExecutingQuery`|<span data-ttu-id="8953e-188">Enthält Informationen zu den Ausführungsphasen der SQL-Anweisung.</span><span class="sxs-lookup"><span data-stu-id="8953e-188">Provides information about the execution phases of the SQL statement.</span></span> <span data-ttu-id="8953e-189">Protokolleinträge werden geschrieben, wenn der Task eine Verbindung mit der Datenbank erhält, wenn der Task beginnt, die SQL-Anweisung vorzubereiten, und nachdem die Ausführung der SQL-Anweisung abgeschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="8953e-189">Log entries are written when the task acquires connection to the database, when the task starts to prepare the SQL statement, and after the execution of the SQL statement is completed.</span></span> <span data-ttu-id="8953e-190">Der Protokolleintrag für die Vorbereitungsphase schließt die vom Task verwendete SQL-Anweisung ein.</span><span class="sxs-lookup"><span data-stu-id="8953e-190">The log entry for the prepare phase includes the SQL statement that the task uses.</span></span>|  
  
## <a name="configuring-the-execute-sql-task"></a><span data-ttu-id="8953e-191">Konfigurieren des Tasks SQL ausführen</span><span class="sxs-lookup"><span data-stu-id="8953e-191">Configuring the Execute SQL Task</span></span>  
 <span data-ttu-id="8953e-192">Es gibt folgende Möglichkeiten, um den Task SQL ausführen zu konfigurieren:</span><span class="sxs-lookup"><span data-stu-id="8953e-192">You can configure the Execute SQL task in the following ways:</span></span>  
  
-   <span data-ttu-id="8953e-193">Geben Sie den Verbindungs-Manager an, der zum Verbinden mit einer Datenbank verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="8953e-193">Specify the type of connection manager to use to connect to a database.</span></span>  
  
-   <span data-ttu-id="8953e-194">Geben Sie den Resultsettyp an, der von der SQL-Anweisung zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="8953e-194">Specify the type of result set that the SQL statement returns.</span></span>  
  
-   <span data-ttu-id="8953e-195">Geben Sie ein Timeout für die SQL-Anweisungen an.</span><span class="sxs-lookup"><span data-stu-id="8953e-195">Specify a time-out for the SQL statements.</span></span>  
  
-   <span data-ttu-id="8953e-196">Geben Sie die Quelle der SQL-Anweisung an.</span><span class="sxs-lookup"><span data-stu-id="8953e-196">Specify the source of the SQL statement.</span></span>  
  
-   <span data-ttu-id="8953e-197">Geben Sie an, ob der Task die Vorbereitungsphase für die SQL-Anweisung auslässt.</span><span class="sxs-lookup"><span data-stu-id="8953e-197">Indicate whether the task skips the prepare phase for the SQL statement.</span></span>  
  
-   <span data-ttu-id="8953e-198">Wenn Sie den ADO-Verbindungstyp verwenden, müssen Sie angeben, ob es sich bei der SQL-Anweisung um eine gespeicherte Prozedur handelt.</span><span class="sxs-lookup"><span data-stu-id="8953e-198">If you use the ADO connection type, you must indicate whether the SQL statement is a stored procedure.</span></span> <span data-ttu-id="8953e-199">Für andere Verbindungstypen ist diese Eigenschaft schreibgeschützt und weist immer den Wert `false` auf.</span><span class="sxs-lookup"><span data-stu-id="8953e-199">For other connection types, this property is read-only and its value is always `false`.</span></span>  
  
 <span data-ttu-id="8953e-200">Eigenschaften können Sie programmgesteuert oder mit dem [!INCLUDE[ssIS](../../includes/ssis-md.md)] -Designer festlegen.</span><span class="sxs-lookup"><span data-stu-id="8953e-200">You can set properties programmatically or through [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer.</span></span>  
  
 <span data-ttu-id="8953e-201">Klicken Sie auf eines der folgenden Themen, um weitere Informationen zu den Eigenschaften zu erhalten, die Sie im [!INCLUDE[ssIS](../../includes/ssis-md.md)] -Designer festlegen können:</span><span class="sxs-lookup"><span data-stu-id="8953e-201">For more information about the properties that you can set in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="8953e-202">Editor für den Task ' SQL ausführen ' &#40;Seite Allgemein&#41;</span><span class="sxs-lookup"><span data-stu-id="8953e-202">Execute SQL Task Editor &#40;General Page&#41;</span></span>](../execute-sql-task-editor-general-page.md)  
  
-   [<span data-ttu-id="8953e-203">Editor für den Task ' SQL ausführen ' &#40;Seite Parameter Zuordnung&#41;</span><span class="sxs-lookup"><span data-stu-id="8953e-203">Execute SQL Task Editor &#40;Parameter Mapping Page&#41;</span></span>](../execute-sql-task-editor-parameter-mapping-page.md)  
  
-   [<span data-ttu-id="8953e-204">Editor für den Task "SQL ausführen" &#40;resultsetseite&#41;</span><span class="sxs-lookup"><span data-stu-id="8953e-204">Execute SQL Task Editor &#40;Result Set Page&#41;</span></span>](../execute-sql-task-editor-result-set-page.md)  
  
-   [<span data-ttu-id="8953e-205">Seite Ausdrücke</span><span class="sxs-lookup"><span data-stu-id="8953e-205">Expressions Page</span></span>](../expressions/expressions-page.md)  
  
 <span data-ttu-id="8953e-206">Klicken Sie auf das folgende Thema, um weitere Informationen zum Festlegen dieser Eigenschaften im [!INCLUDE[ssIS](../../includes/ssis-md.md)] -Designer zu erhalten:</span><span class="sxs-lookup"><span data-stu-id="8953e-206">For more information about how to set these properties in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, click the following topic:</span></span>  
  
-   [<span data-ttu-id="8953e-207">Festlegen der Eigenschaften eines Tasks oder Containers</span><span class="sxs-lookup"><span data-stu-id="8953e-207">Set the Properties of a Task or Container</span></span>](../set-the-properties-of-a-task-or-container.md)  
  
## <a name="configuring-the-execute-sql-task-programmatically"></a><span data-ttu-id="8953e-208">Programmgesteuertes Konfigurieren des Tasks SQL ausführen</span><span class="sxs-lookup"><span data-stu-id="8953e-208">Configuring the Execute SQL Task Programmatically</span></span>  
 <span data-ttu-id="8953e-209">Klicken Sie auf das folgende Thema, um weitere Informationen zum programmgesteuerten Festlegen dieser Eigenschaften anzuzeigen:</span><span class="sxs-lookup"><span data-stu-id="8953e-209">For more information about programmatically setting these properties, click the following topic:</span></span>  
  
-   <xref:Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask>  
  
## <a name="related-tasks"></a><span data-ttu-id="8953e-210">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="8953e-210">Related Tasks</span></span>  
  
-   [<span data-ttu-id="8953e-211">Zuordnen von Abfrageparametern zu Variablen in einem Task SQL ausführen</span><span class="sxs-lookup"><span data-stu-id="8953e-211">Map Query Parameters to Variables in an Execute SQL Task</span></span>](../map-query-parameters-to-variables-in-an-execute-sql-task.md)  
  
-   [<span data-ttu-id="8953e-212">Zuordnen von Resultsets zu Variablen in einem Task "SQL ausführen"</span><span class="sxs-lookup"><span data-stu-id="8953e-212">Map Result Sets to Variables in an Execute SQL Task</span></span>](../map-result-sets-to-variables-in-an-execute-sql-task.md)  
  
## <a name="related-content"></a><span data-ttu-id="8953e-213">Verwandte Inhalte</span><span class="sxs-lookup"><span data-stu-id="8953e-213">Related Content</span></span>  
  
-   [<span data-ttu-id="8953e-214">Parameter und Rückgabecodes im Task 'SQL ausführen'</span><span class="sxs-lookup"><span data-stu-id="8953e-214">Parameters and Return Codes in the Execute SQL Task</span></span>](execute-sql-task.md)  
  
-   [<span data-ttu-id="8953e-215">Resultsets im Task „SQL ausführen“</span><span class="sxs-lookup"><span data-stu-id="8953e-215">Result Sets in the Execute SQL Task</span></span>](../result-sets-in-the-execute-sql-task.md)  
  
-   [<span data-ttu-id="8953e-216">Transact-SQL-Referenz &#40;Datenbank-Engine&#41;</span><span class="sxs-lookup"><span data-stu-id="8953e-216">Transact-SQL Reference &#40;Database Engine&#41;</span></span>](/sql/t-sql/language-reference)  
  
-   <span data-ttu-id="8953e-217">Blogeintrag [Neue Datums- und Uhrzeitfunktionen in SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=239783)auf mssqltips.com.</span><span class="sxs-lookup"><span data-stu-id="8953e-217">Blog entry, [New Date and Time Functions in SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=239783), on mssqltips.com</span></span>  
  
  

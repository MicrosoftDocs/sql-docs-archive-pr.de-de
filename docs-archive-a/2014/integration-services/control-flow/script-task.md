---
title: Skripttask | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.scripttask.f1
helpviewer_keywords:
- scripts [Integration Services], tasks
- Script task [Integration Services], about Script task
- Script task [Integration Services]
ms.assetid: f6cce7df-4bd6-4b75-9f89-6c37b4bb5558
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 69c051994eb06cbab041db3db2683a487a6e1994
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87607933"
---
# <a name="script-task"></a><span data-ttu-id="9760c-102">Skripttask</span><span class="sxs-lookup"><span data-stu-id="9760c-102">Script Task</span></span>
  <span data-ttu-id="9760c-103">Der Skripttask stellt Code zum Ausführen von Funktionen bereit, die in den integrierten Tasks und Transformationen von [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] nicht verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="9760c-103">The Script task provides code to perform functions that are not available in the built-in tasks and transformations that [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] provides.</span></span> <span data-ttu-id="9760c-104">Der Skripttask kann auch Funktionen in einem einzigen Skript zusammenfassen, statt mehrere Tasks und Transformationen zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="9760c-104">The Script task can also combine functions in one script instead of using multiple tasks and transformations.</span></span> <span data-ttu-id="9760c-105">Sie verwenden den Skripttask für einmalige Aktionen in einem Paket (einmalig pro aufgezähltem Objekt), anstatt diese einmalig pro Datenzeile auszuführen.</span><span class="sxs-lookup"><span data-stu-id="9760c-105">You use the Script task for work that must be done once in a package (or once per enumerated object), instead than once per data row.</span></span>  
  
 <span data-ttu-id="9760c-106">Der Skripttask kann für folgende Zwecke verwendet werden:</span><span class="sxs-lookup"><span data-stu-id="9760c-106">You can use the Script task for the following purposes:</span></span>  
  
-   <span data-ttu-id="9760c-107">Zugreifen auf Daten mithilfe anderer Technologien, die nicht von integrierten Verbindungstypen unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="9760c-107">Access data by using other technologies that are not supported by built-in connection types.</span></span> <span data-ttu-id="9760c-108">Beispielsweise kann ein Skript mithilfe von Active Directory Service Interfaces (ADSI) auf Benutzernamen von Active Directory zugreifen und diese extrahieren.</span><span class="sxs-lookup"><span data-stu-id="9760c-108">For example, a script can use Active Directory Service Interfaces (ADSI) to access and extract user names from Active Directory.</span></span>  
  
-   <span data-ttu-id="9760c-109">Erstellen eines paketspezifischen Leistungsindikators.</span><span class="sxs-lookup"><span data-stu-id="9760c-109">Create a package-specific performance counter.</span></span> <span data-ttu-id="9760c-110">Beispielsweise kann ein Skript einen Leistungsindikator erstellen, der aktualisiert wird, während ein komplexer Task oder ein Task mit einem geringen Leistungsverhalten ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="9760c-110">For example, a script can create a performance counter that is updated while a complex or poorly performing task runs.</span></span>  
  
-   <span data-ttu-id="9760c-111">Identifizieren, ob angegebene Dateien leer sind bzw. wie viele Zeilen sie enthalten, und deren Auswirkungen auf die Ablaufsteuerung in einem Paket auf Basis dieser Informationen.</span><span class="sxs-lookup"><span data-stu-id="9760c-111">Identify whether specified files are empty or how many rows they contain, and then based on that information affect the control flow in a package.</span></span> <span data-ttu-id="9760c-112">Enthält eine Datei beispielsweise 0 Zeilen, wird der Wert einer Variablen auf 0 festgelegt, und eine Rangfolgeneinschränkung, die den Wert auswertet, verhindert das Kopieren der Datei mit einem Dateisystemtask.</span><span class="sxs-lookup"><span data-stu-id="9760c-112">For example, if a file contains zero rows, the value of a variable set to 0, and a precedence constraint that evaluates the value prevents a File System task from copying the file.</span></span>  
  
 <span data-ttu-id="9760c-113">Wenn Sie das Skript verwenden müssen, um die gleichen Aktionen für jede Datenzeile einer Gruppe auszuführen, verwenden Sie anstelle des Skripttasks die Skriptkomponente.</span><span class="sxs-lookup"><span data-stu-id="9760c-113">If you have to use the script to do the same work for each row of data in a set, you should use the Script component instead of the Script task.</span></span> <span data-ttu-id="9760c-114">Eine Skriptkomponente wird beispielsweise verwendet, wenn Sie auswerten möchten, ob eine Portogebühr und das Auslassen von Datenzeilen mit extrem hohen oder niedrigen Beträgen angemessen sind.</span><span class="sxs-lookup"><span data-stu-id="9760c-114">For example, if you want to assess the reasonableness of a postage amount and skip data rows that have very high or low amounts, you would use a Script component.</span></span> <span data-ttu-id="9760c-115">Weitere Informationen finden Sie unter [Script Component](../data-flow/transformations/script-component.md).</span><span class="sxs-lookup"><span data-stu-id="9760c-115">For more information, see [Script Component](../data-flow/transformations/script-component.md).</span></span>  
  
 <span data-ttu-id="9760c-116">Falls ein Skript von mehreren Paketen verwendet wird, sollten Sie einen benutzerdefinierten Task erstellen, statt den Skripttask zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="9760c-116">If more than one package uses a script, consider writing a custom task instead of using the Script task.</span></span> <span data-ttu-id="9760c-117">Weitere Informationen finden Sie unter [Entwickeln eines benutzerdefinierten Tasks](../extending-packages-custom-objects/task/developing-a-custom-task.md).</span><span class="sxs-lookup"><span data-stu-id="9760c-117">For more information, see [Developing a Custom Task](../extending-packages-custom-objects/task/developing-a-custom-task.md).</span></span>  
  
 <span data-ttu-id="9760c-118">Nachdem Sie entschieden haben, dass die Skriptkomponente für Ihr Paket geeignet ist, müssen Sie das Skript entwickeln, das vom Task verwendet wird, und den Task konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="9760c-118">After you decide that the Script task is the appropriate choice for your package, you have to both develop the script that the task uses and configure the task itself.</span></span>  
  
## <a name="writing-and-running-the-script-that-the-task-uses"></a><span data-ttu-id="9760c-119">Erstellen und Ausführen des Skripts, das vom Task verwendet wird</span><span class="sxs-lookup"><span data-stu-id="9760c-119">Writing and Running the Script that the Task Uses</span></span>  
 <span data-ttu-id="9760c-120">Der Skripttask verwendet [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)]-Tools für Anwendungen (VSTA) als Umgebung zum Erstellen der Skripts und der Engine, mit der die Skripts ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="9760c-120">The Script task uses [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications (VSTA) as the environment in which you write the scripts and the engine that runs those scripts.</span></span>  
  
 <span data-ttu-id="9760c-121">VSTA enthält alle Standardfunktionen der [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] -Umgebung, z.B. den [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] -Editor mit Farbcodierung, IntelliSense und den **Objekt-Explorer**.</span><span class="sxs-lookup"><span data-stu-id="9760c-121">VSTA provides all the standard features of the [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] environment, such as the color-coded [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] editor, IntelliSense, and **Object Explorer**.</span></span> <span data-ttu-id="9760c-122">VSTA verwendet zudem den Debugger, der auch von anderen [!INCLUDE[msCoName](../../includes/msconame-md.md)] -Entwicklungstools verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="9760c-122">VSTA also uses the same debugger that other [!INCLUDE[msCoName](../../includes/msconame-md.md)] development tools use.</span></span> <span data-ttu-id="9760c-123">Breakpoints im Skript sind vollständig mit Breakpoints in Tasks und Containern von [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] kompatibel.</span><span class="sxs-lookup"><span data-stu-id="9760c-123">Breakpoints in the script work seamlessly with breakpoints on [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] tasks and containers.</span></span> <span data-ttu-id="9760c-124">VSTA unterstützt die Programmiersprachen [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic und [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C#.</span><span class="sxs-lookup"><span data-stu-id="9760c-124">VSTA supports both the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic and [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C# programming languages.</span></span>  
  
 <span data-ttu-id="9760c-125">Zum Ausführen eines Skripts muss VSTA auf dem Computer installiert sein, auf dem das Paket ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="9760c-125">To run a script, you must have VSTA installed on the computer where the package runs.</span></span> <span data-ttu-id="9760c-126">Wenn das Paket ausgeführt wird, lädt der Task die Skript-Engine und führt das Skript aus.</span><span class="sxs-lookup"><span data-stu-id="9760c-126">When the package runs, the task loads the script engine and runs the script.</span></span> <span data-ttu-id="9760c-127">Sie können auf externe .NET-Assemblys zugreifen, indem Sie Verweise auf die Assemblys im Projekt hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="9760c-127">You can access external .NET assemblies in scripts by adding references to the assemblies in the project.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9760c-128">Anders als in früheren Versionen, in denen Sie angeben konnten, ob die Skripts vorkompiliert sind, werden in [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] und nachfolgenden Versionen alle Skripts vorkompiliert.</span><span class="sxs-lookup"><span data-stu-id="9760c-128">Unlike earlier versions where you could indicate whether the scripts were precompiled, all scripts are precompiled in [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] and later versions.</span></span> <span data-ttu-id="9760c-129">Wenn ein Skript vorkompiliert ist, wird die Sprach-Engine zur Laufzeit nicht geladen, und das Paket wird schneller ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="9760c-129">When a script is precompiled, the language engine is not loaded at run time and the package runs more quickly.</span></span> <span data-ttu-id="9760c-130">Kompilierte binäre Dateien belegen jedoch erheblich mehr Speicherplatz.</span><span class="sxs-lookup"><span data-stu-id="9760c-130">However, precompiled binary files consume significant disk space.</span></span>  
  
## <a name="configuring-the-script-task"></a><span data-ttu-id="9760c-131">Konfigurieren des Skripttasks</span><span class="sxs-lookup"><span data-stu-id="9760c-131">Configuring the Script Task</span></span>  
 <span data-ttu-id="9760c-132">Es gibt folgende Möglichkeiten, um den Skripttask zu konfigurieren:</span><span class="sxs-lookup"><span data-stu-id="9760c-132">You can configure the Script task in the following ways:</span></span>  
  
-   <span data-ttu-id="9760c-133">Stellen Sie das benutzerdefinierte Skript bereit, das von dem Task ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="9760c-133">Provide the custom script that the task runs.</span></span>  
  
-   <span data-ttu-id="9760c-134">Geben Sie die Methode im VSTA-Projekt an, die die [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] -Laufzeit als Einstiegspunkt in den Code des Skripttasks aufruft.</span><span class="sxs-lookup"><span data-stu-id="9760c-134">Specify the method in the VSTA project that the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] runtime calls as the entry point into the Script task code.</span></span>  
  
-   <span data-ttu-id="9760c-135">Geben Sie die Skriptsprache an.</span><span class="sxs-lookup"><span data-stu-id="9760c-135">Specify the script language.</span></span>  
  
-   <span data-ttu-id="9760c-136">Geben Sie optional Listen mit schreibgeschützten und Lese-/Schreibvariablen für die Verwendung im Skript an.</span><span class="sxs-lookup"><span data-stu-id="9760c-136">Optionally, provide lists of read-only and read/write variables for use in the script.</span></span>  
  
 <span data-ttu-id="9760c-137">Diese Eigenschaften können Sie mit dem [!INCLUDE[ssIS](../../includes/ssis-md.md)] -Designer oder programmgesteuert festlegen.</span><span class="sxs-lookup"><span data-stu-id="9760c-137">You can set these properties through [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer or programmatically.</span></span>  
  
### <a name="configuring-the-script-task-in-the-designer"></a><span data-ttu-id="9760c-138">Konfigurieren des Skripttasks im Designer</span><span class="sxs-lookup"><span data-stu-id="9760c-138">Configuring the Script Task in the Designer</span></span>  
 <span data-ttu-id="9760c-139">In der folgenden Tabelle wird das `ScriptTaskLogEntry`-Ereignis beschrieben, das für den Skripttask protokolliert werden kann.</span><span class="sxs-lookup"><span data-stu-id="9760c-139">The following table describes the `ScriptTaskLogEntry` event that can be logged for Script task.</span></span> <span data-ttu-id="9760c-140">Das `ScriptTaskLogEntry` Ereignis wird für die Protokollierung auf der Registerkarte **Details** des Dialog Felds **SSIS-Protokolle konfigurieren** ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="9760c-140">The `ScriptTaskLogEntry` event is selected for logging on the **Details** tab of the **Configure SSIS Logs** dialog box.</span></span> <span data-ttu-id="9760c-141">Weitere Informationen finden Sie unter [Integration Services-Protokollierung &#40;SSIS&#41;](../performance/integration-services-ssis-logging.md) und [Benutzerdefinierte Meldungen für die Protokollierung](../custom-messages-for-logging.md).</span><span class="sxs-lookup"><span data-stu-id="9760c-141">For more information, see [Integration Services &#40;SSIS&#41; Logging](../performance/integration-services-ssis-logging.md) and [Custom Messages for Logging](../custom-messages-for-logging.md).</span></span>  
  
|<span data-ttu-id="9760c-142">Protokolleintrag</span><span class="sxs-lookup"><span data-stu-id="9760c-142">Log entry</span></span>|<span data-ttu-id="9760c-143">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="9760c-143">Description</span></span>|  
|---------------|-----------------|  
|`ScriptTaskLogEntry`|<span data-ttu-id="9760c-144">Gibt die Ergebnisse des Implementierens der Protokollierung innerhalb des Skripts an.</span><span class="sxs-lookup"><span data-stu-id="9760c-144">Reports the results of implementing logging in the script.</span></span> <span data-ttu-id="9760c-145">Der Task schreibt für jeden Aufruf der `Log`-Methode des `Dts`-Objekts einen Protokolleintrag.</span><span class="sxs-lookup"><span data-stu-id="9760c-145">The task writes a log entry for each call to the `Log` method of the `Dts` object.</span></span> <span data-ttu-id="9760c-146">Der Task schreibt diese Einträge, wenn der Code ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="9760c-146">The task writes these entries when the code is run.</span></span> <span data-ttu-id="9760c-147">Weitere Informationen finden Sie unter [Logging in the Script Task](../extending-packages-scripting/task/logging-in-the-script-task.md).</span><span class="sxs-lookup"><span data-stu-id="9760c-147">For more information, see [Logging in the Script Task](../extending-packages-scripting/task/logging-in-the-script-task.md).</span></span>|  
  
 <span data-ttu-id="9760c-148">Klicken Sie auf die folgenden Themen, um weitere Informationen zu den Eigenschaften zu erhalten, die Sie im [!INCLUDE[ssIS](../../includes/ssis-md.md)] -Designer festlegen können:</span><span class="sxs-lookup"><span data-stu-id="9760c-148">For more information about the properties that you can set in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, see the following topics:</span></span>  
  
-   [<span data-ttu-id="9760c-149">Skripttask-Editor &#40;Seite „Allgemein“&#41;</span><span class="sxs-lookup"><span data-stu-id="9760c-149">Script Task Editor &#40;General Page&#41;</span></span>](../general-page-of-integration-services-designers-options.md)  
  
-   [<span data-ttu-id="9760c-150">Skripttask-Editor &#40;Seite Skript&#41;</span><span class="sxs-lookup"><span data-stu-id="9760c-150">Script Task Editor &#40;Script Page&#41;</span></span>](../script-task-editor-script-page.md)  
  
-   [<span data-ttu-id="9760c-151">Seite Ausdrücke</span><span class="sxs-lookup"><span data-stu-id="9760c-151">Expressions Page</span></span>](../expressions/expressions-page.md)  
  
 <span data-ttu-id="9760c-152">Weitere Informationen zum Festlegen dieser Eigenschaften im [!INCLUDE[ssIS](../../includes/ssis-md.md)] -Designer finden Sie im folgenden Thema:</span><span class="sxs-lookup"><span data-stu-id="9760c-152">For more information about how to set these properties in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, see the following topic:</span></span>  
  
-   [<span data-ttu-id="9760c-153">Festlegen der Eigenschaften eines Tasks oder Containers</span><span class="sxs-lookup"><span data-stu-id="9760c-153">Set the Properties of a Task or Container</span></span>](../set-the-properties-of-a-task-or-container.md)  
  
### <a name="configuring-the-script-task-programmatically"></a><span data-ttu-id="9760c-154">Programmgesteuertes Konfigurieren des Skripttasks</span><span class="sxs-lookup"><span data-stu-id="9760c-154">Configuring the Script Task Programmatically</span></span>  
 <span data-ttu-id="9760c-155">Weitere Informationen zum programmgesteuerten Festlegen dieser Eigenschaften finden Sie im folgenden Thema:</span><span class="sxs-lookup"><span data-stu-id="9760c-155">For more information about programmatically setting these properties, see the following topic:</span></span>  
  
-   <xref:Microsoft.SqlServer.Dts.Tasks.ScriptTask.ScriptTask>  
  
## <a name="related-content"></a><span data-ttu-id="9760c-156">Verwandte Inhalte</span><span class="sxs-lookup"><span data-stu-id="9760c-156">Related Content</span></span>  
  
-   <span data-ttu-id="9760c-157">Technischer Artikel [Vorgehensweise: Senden von E-Mails mit Zustellungsbenachrichtigung in C#](https://go.microsoft.com/fwlink/?LinkId=237625)(Gewusst wie: Senden von E-Mails mit Zustellungsbenachrichtigung in C#) auf shareourideas.com</span><span class="sxs-lookup"><span data-stu-id="9760c-157">Technical article, [How to send email with delivery notification in C#](https://go.microsoft.com/fwlink/?LinkId=237625), on shareourideas.com</span></span>  
  
  

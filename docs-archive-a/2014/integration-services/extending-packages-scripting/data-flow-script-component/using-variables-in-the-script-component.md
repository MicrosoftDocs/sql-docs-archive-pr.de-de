---
title: Verwenden von Variablen in der Skriptkomponente | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
helpviewer_keywords:
- Script component [Integration Services], using variables
ms.assetid: 92d1881a-1ef1-43ae-b1ca-48d0536bdbc2
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 4328a938c56ad8383c12cdae1d6511604ec65582
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87720260"
---
# <a name="using-variables-in-the-script-component"></a><span data-ttu-id="38dc6-102">Verwenden von Variablen in der Skriptkomponente</span><span class="sxs-lookup"><span data-stu-id="38dc6-102">Using Variables in the Script Component</span></span>
  <span data-ttu-id="38dc6-103">Variablen speichern Werte, die von einem Paket und dessen Containern, Tasks und Ereignishandlern zur Laufzeit verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="38dc6-103">Variables store values that a package and its containers, tasks, and event handlers can use at run time.</span></span> <span data-ttu-id="38dc6-104">Weitere Informationen finden Sie unter [Integration Services-Variablen &#40;SSIS&#41;](../../integration-services-ssis-variables.md).</span><span class="sxs-lookup"><span data-stu-id="38dc6-104">For more information, see [Integration Services &#40;SSIS&#41; Variables](../../integration-services-ssis-variables.md).</span></span>  
  
 <span data-ttu-id="38dc6-105">Sie können vorhandene Variablen für schreibgeschützten oder Lese-/Schreibzugriff für Ihr benutzerdefiniertes Skript verfügbar machen, indem Sie durch Trennzeichen getrennte Listen von Variablen in den `ReadOnlyVariables` `ReadWriteVariables` Feldern und auf der Seite **Skript** des **Transformations-Editors für Skript**Erstellung eingeben.</span><span class="sxs-lookup"><span data-stu-id="38dc6-105">You can make existing variables available for read-only or read/write access by your custom script by entering comma-delimited lists of variables in the `ReadOnlyVariables` and `ReadWriteVariables` fields on the **Script** page of the **Script Transformation Editor**.</span></span> <span data-ttu-id="38dc6-106">Beachten Sie, dass bei Variablennamen nach Groß-/Kleinschreibung unterschieden wird.</span><span class="sxs-lookup"><span data-stu-id="38dc6-106">Keep in mind that variable names are case-sensitive.</span></span> <span data-ttu-id="38dc6-107">Mithilfe der `Value`-Eigenschaft erhalten Sie Lese- und Schreibzugriff auf einzelne Variablen.</span><span class="sxs-lookup"><span data-stu-id="38dc6-107">Use the `Value` property to read from and write to individual variables.</span></span> <span data-ttu-id="38dc6-108">Die Skriptkomponente führt erforderliche Sperrungen im Hintergrund aus, da das Skript die Variablen zur Laufzeit verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="38dc6-108">The Script component handles any required locking behind the scenes as your script manipulates the variables at run time.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="38dc6-109">Die Auflistung von `ReadWriteVariables` ist nur in der `PostExecute`-Methode verfügbar, um das Risiko von Sperrkonflikten zu vermindern und die Leistung zu maximieren.</span><span class="sxs-lookup"><span data-stu-id="38dc6-109">The collection of `ReadWriteVariables` is only available in the `PostExecute` method to maximize performance and minimize the risk of locking conflicts.</span></span> <span data-ttu-id="38dc6-110">Sie können daher den Wert einer Paketvariablen nicht direkt inkrementieren, während Sie jede Datenzeile verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="38dc6-110">Therefore you cannot directly increment the value of a package variable as you process each row of data.</span></span> <span data-ttu-id="38dc6-111">Inkrementieren Sie stattdessen den Wert einer lokalen Variablen, und legen Sie den Wert der Paketvariablen auf den Wert der lokalen Variablen in der `PostExecute`-Methode fest, nachdem alle Daten verarbeitet wurden.</span><span class="sxs-lookup"><span data-stu-id="38dc6-111">Increment the value of a local variable instead, and set the value of the package variable to the value of the local variable in the `PostExecute` method after all data has been processed.</span></span> <span data-ttu-id="38dc6-112">Sie können auch die Eigenschaft <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> verwenden, um diese Einschränkung zu umgehen, wie später in diesem Thema beschrieben ist.</span><span class="sxs-lookup"><span data-stu-id="38dc6-112">You can also use the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> property to work around this limitation, as described later in this topic.</span></span> <span data-ttu-id="38dc6-113">Wenn Sie jedoch direkt in eine Paketvariable schreiben, während jede Zeile verarbeitet wird, wird die Leistung beeinträchtigt und das Risiko von Sperrkonflikten erhöht.</span><span class="sxs-lookup"><span data-stu-id="38dc6-113">However, writing directly to a package variable as each row is processed will negatively impact performance and increase the risk of locking conflicts.</span></span>  
  
 <span data-ttu-id="38dc6-114">Weitere Informationen über die Seite **Skript** im **Transformations-Editor für Skripterstellung** finden Sie unter [Konfigurieren der Skriptkomponente im Skriptkomponenten-Editor](configuring-the-script-component-in-the-script-component-editor.md) und [Transformations-Editor für Skripterstellung &#40;Script Page&#41;](../../script-transformation-editor-script-page.md).</span><span class="sxs-lookup"><span data-stu-id="38dc6-114">For more information about the **Script** page of the **Script Transformation Editor**, see [Configuring the Script Component in the Script Component Editor](configuring-the-script-component-in-the-script-component-editor.md) and [Script Transformation Editor &#40;Script Page&#41;](../../script-transformation-editor-script-page.md).</span></span>  
  
 <span data-ttu-id="38dc6-115">Die Skriptkomponente erstellt eine `Variables`-Auflistungsklasse im `ComponentWrapper`-Projektelement mit einer Accessoreigenschaft mit starker Typbindung für den Wert jeder vorkonfigurierten Variable, wobei die Eigenschaft denselben Namen wie die Variable selbst hat.</span><span class="sxs-lookup"><span data-stu-id="38dc6-115">The Script component creates a `Variables` collection class in the `ComponentWrapper` project item with a strongly-typed accessor property for the value of each preconfigured variable where the property has the same name as the variable itself.</span></span> <span data-ttu-id="38dc6-116">Diese Auflistung wird von der `Variables`-Eigenschaft der `ScriptMain`-Klasse verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="38dc6-116">This collection is exposed through the `Variables` property of the `ScriptMain` class.</span></span> <span data-ttu-id="38dc6-117">Die Accessoreigenschaft bietet entsprechend Lese- oder Lese-/Schreibberechtigung für den Wert der Variable.</span><span class="sxs-lookup"><span data-stu-id="38dc6-117">The accessor property provides read-only or read/write permission to the value of the variable as appropriate.</span></span> <span data-ttu-id="38dc6-118">Wenn Sie beispielsweise eine Ganzzahlvariable namens `MyIntegerVariable` zur Liste `ReadOnlyVariables` hinzugefügt haben, können Sie ihren Wert mit dem folgenden Code in das Skript abrufen:</span><span class="sxs-lookup"><span data-stu-id="38dc6-118">For example, if you have added an integer variable named `MyIntegerVariable` to the `ReadOnlyVariables` list, you can retrieve its value in your script by using the following code:</span></span>  
  
 `Dim myIntegerVariableValue As Integer = Me.Variables.MyIntegerVariable`  
  
 <span data-ttu-id="38dc6-119">Für die Arbeit mit Variablen in der Skriptkomponente können Sie auch die <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A>-Eigenschaft (Aufruf mit `Me.VariableDispenser`) verwenden.</span><span class="sxs-lookup"><span data-stu-id="38dc6-119">You can also use the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> property, accessed by calling `Me.VariableDispenser`, to work with variables in the Script component.</span></span> <span data-ttu-id="38dc6-120">In diesem Fall verwenden Sie nicht die benannten, typisierten Accessoreigenschaften für Variablen, sondern greifen direkt auf die Variablen zu.</span><span class="sxs-lookup"><span data-stu-id="38dc6-120">In this case you are not using the typed and named accessor properties for variables, but accessing the variables directly.</span></span> <span data-ttu-id="38dc6-121">Bei der Verwendung von <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> müssen Sie die Sperrsemantik und die Umwandlung von Datentypen für variable Werte in Ihrem Code berücksichtigen.</span><span class="sxs-lookup"><span data-stu-id="38dc6-121">When using the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A>, you must handle both the locking semantics and the casting of data types for variable values in your own code.</span></span> <span data-ttu-id="38dc6-122">Wenn Sie mit Variablen arbeiten möchten, die zur Entwurfszeit nicht zur Verfügung stehen, sondern programmgesteuert zur Laufzeit erstellt werden, müssen Sie die <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A>-Eigenschaft statt der benannten, typisierten Accessoreigenschaften verwenden.</span><span class="sxs-lookup"><span data-stu-id="38dc6-122">You have to use the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> property instead of the named and typed accessor properties if you want to work with a variable that is not available at design time but is created programmatically at run time.</span></span>  
  
<span data-ttu-id="38dc6-123">![Integration Services Symbol (klein)](../../media/dts-16.gif "Integration Services (kleines Symbol)")immer auf**dem neuesten Stand bleiben mit Integration Services**  </span><span class="sxs-lookup"><span data-stu-id="38dc6-123">![Integration Services icon (small)](../../media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="38dc6-124">Die neuesten Downloads, Artikel, Beispiele und Videos von Microsoft sowie ausgewählte Lösungen aus der Community finden Sie auf MSDN auf der [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] -Seite:</span><span class="sxs-lookup"><span data-stu-id="38dc6-124">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="38dc6-125">Besuchen Sie die Integration Services-Seite auf MSDN</span><span class="sxs-lookup"><span data-stu-id="38dc6-125">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="38dc6-126">Abonnieren Sie die auf der Seite verfügbaren RSS-Feeds, um automatische Benachrichtigungen zu diesen Updates zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="38dc6-126">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="38dc6-127">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="38dc6-127">See Also</span></span>  
 <span data-ttu-id="38dc6-128">[Integration Services-Variablen &#40;SSIS&#41;](../../integration-services-ssis-variables.md) </span><span class="sxs-lookup"><span data-stu-id="38dc6-128">[Integration Services &#40;SSIS&#41; Variables](../../integration-services-ssis-variables.md) </span></span>  
 [<span data-ttu-id="38dc6-129">Verwenden von Variablen in Paketen</span><span class="sxs-lookup"><span data-stu-id="38dc6-129">Use Variables in Packages</span></span>](../../use-variables-in-packages.md)  
  
  

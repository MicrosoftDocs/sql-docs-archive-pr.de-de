---
title: Transformation für OLE DB-Befehl | Microsoft-Dokumentation
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.oledbcommandtrans.f1
helpviewer_keywords:
- statements [Integration Services]
- OLE DB Command transformation
ms.assetid: baa6735c-5acf-4759-b077-1216aca16c6c
author: chugugrace
ms.author: chugu
ms.openlocfilehash: a6b0498d0ae5fa61a00cc7f6fc89e4dc506cd25a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/04/2020
ms.locfileid: "87727109"
---
# <a name="ole-db-command-transformation"></a><span data-ttu-id="211ea-102">Transformation für OLE DB-Befehl</span><span class="sxs-lookup"><span data-stu-id="211ea-102">OLE DB Command Transformation</span></span>
  <span data-ttu-id="211ea-103">Die Transformation für OLE DB-Befehl führt eine SQL-Anweisung für jede Zeile in einem Datenfluss aus.</span><span class="sxs-lookup"><span data-stu-id="211ea-103">The OLE DB Command transformation runs an SQL statement for each row in a data flow.</span></span> <span data-ttu-id="211ea-104">Beispielsweise können Sie eine SQL-Anweisung ausführen, die Zeilen in einer Datenbanktabelle einfügt, aktualisiert oder löscht.</span><span class="sxs-lookup"><span data-stu-id="211ea-104">For example, you can run an SQL statement that inserts, updates, or deletes rows in a database table.</span></span>  
  
 <span data-ttu-id="211ea-105">Es gibt folgende Möglichkeiten, um die Transformation für OLE DB-Befehl zu konfigurieren:</span><span class="sxs-lookup"><span data-stu-id="211ea-105">You can configure the OLE DB Command Transformation in the following ways:</span></span>  
  
-   <span data-ttu-id="211ea-106">Stellen Sie die SQL-Anweisung bereit, die die Transformation für jede Zeile ausführt.</span><span class="sxs-lookup"><span data-stu-id="211ea-106">Provide the SQL statement that the transformation runs for each row.</span></span>  
  
-   <span data-ttu-id="211ea-107">Geben Sie an, nach wie vielen Sekunden ein Timeout bei der SQL-Anweisung eintritt.</span><span class="sxs-lookup"><span data-stu-id="211ea-107">Specify the number of seconds before the SQL statement times out.</span></span>  
  
-   <span data-ttu-id="211ea-108">Geben Sie die Standardcodepage an.</span><span class="sxs-lookup"><span data-stu-id="211ea-108">Specify the default code page.</span></span>  
  
 <span data-ttu-id="211ea-109">In der Regel enthält die SQL-Anweisung Parameter.</span><span class="sxs-lookup"><span data-stu-id="211ea-109">Typically, the SQL statement includes parameters.</span></span> <span data-ttu-id="211ea-110">Die Parameterwerte sind in externen Spalten in der Transformationseingabe gespeichert, und beim Zuordnen einer Eingabespalte zu einer externen Spalte wird eine Eingabespalte einem Parameter zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="211ea-110">The parameter values are stored in external columns in the transformation input, and mapping an input column to an external column maps an input column to a parameter.</span></span> <span data-ttu-id="211ea-111">Angenommen, Sie möchten Zeilen in der **DimProduct** -Tabelle anhand des Werts in der **ProductKey** -Spalte suchen und diese dann löschen. Hierzu können Sie die externe Spalte **Param_0** der **ProductKey** -Eingabespalte zuordnen und anschließend den SQL-Befehl `DELETE FROM DimProduct WHERE ProductKey = ?`ausführen.</span><span class="sxs-lookup"><span data-stu-id="211ea-111">For example, to locate rows in the **DimProduct** table by the value in their **ProductKey** column and then delete them, you can map the external column named **Param_0** to the input column named **ProductKey,** and then run the SQL statement `DELETE FROM DimProduct WHERE ProductKey = ?`..</span></span> <span data-ttu-id="211ea-112">Die Transformation für OLE DB-Befehl stellt die Parameternamen bereit, die nicht geändert werden können.</span><span class="sxs-lookup"><span data-stu-id="211ea-112">The OLE DB Command transformation provides the parameter names and you cannot modify them.</span></span> <span data-ttu-id="211ea-113">Die Parameternamen lauten **Param_0**, **Param_1**usw.</span><span class="sxs-lookup"><span data-stu-id="211ea-113">The parameter names are **Param_0**, **Param_1**, and so on.</span></span>  
  
 <span data-ttu-id="211ea-114">Wenn Sie die Transformation für OLE DB-Befehl mithilfe des Dialogfelds **Erweiterter Editor** konfigurieren, können die Parameter in der SQL-Anweisung automatisch externen Spalten in der Transformationseingabe zugeordnet und die Merkmale jedes Parameters definiert werden, indem Sie auf die Schaltfläche **Aktualisieren** klicken.</span><span class="sxs-lookup"><span data-stu-id="211ea-114">If you configure the OLE DB Command transformation by using the **Advanced Editor** dialog box, the parameters in the SQL statement may be mapped automatically to external columns in the transformation input, and the characteristics of each parameter defined, by clicking the **Refresh** button.</span></span> <span data-ttu-id="211ea-115">Wenn jedoch der von der Transformation für OLE DB-Befehl verwendete OLE DB-Anbieter das Ableiten von Parameterinformationen von dem Parameter nicht unterstützt, müssen Sie die externen Spalten manuell konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="211ea-115">However, if the OLE DB provider that the OLE DB Command transformation uses does not support deriving parameter information from the parameter, you must configure the external columns manually.</span></span> <span data-ttu-id="211ea-116">Das heißt, Sie müssen der Transformation für jeden Parameter zur externen Eingabe eine Spalte hinzufügen, die Spaltennamen aktualisieren, um Namen wie **Param_0**zu verwenden, den Wert der DBParamInfoFlags-Eigenschaft angeben sowie die Eingabespalten, die Parameterwerte enthalten, den externen Spalten zuordnen.</span><span class="sxs-lookup"><span data-stu-id="211ea-116">This means that you must add a column for each parameter to the external input to the transformation, update the column names to use names like **Param_0**, specify the value of the DBParamInfoFlags property, and map the input columns that contain parameter values to the external columns.</span></span>  
  
 <span data-ttu-id="211ea-117">Der Wert von DBParamInfoFlags stellt die Merkmale des Parameters dar.</span><span class="sxs-lookup"><span data-stu-id="211ea-117">The value of DBParamInfoFlags represents the characteristics of the parameter.</span></span> <span data-ttu-id="211ea-118">Beispielsweise gibt der Wert **1** an, dass der Parameter ein Eingabeparameter ist, und der Wert **65** gibt an, dass der Parameter ein Eingabeparameter ist und einen NULL-Wert enthalten kann.</span><span class="sxs-lookup"><span data-stu-id="211ea-118">For example, the value **1** specifies that the parameter is an input parameter, and the value **65** specifies that the parameter is an input parameter and may contain a null value.</span></span> <span data-ttu-id="211ea-119">Die Werte müssen mit den Werten in der OLE DB-Enumeration DBPARAMFLAGSENUM übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="211ea-119">The values must match the values in the OLE DB DBPARAMFLAGSENUM enumeration.</span></span> <span data-ttu-id="211ea-120">Weitere Informationen finden Sie in der OLE DB-Referenzdokumentation.</span><span class="sxs-lookup"><span data-stu-id="211ea-120">For more information, see the OLE DB reference documentation.</span></span>  
  
 <span data-ttu-id="211ea-121">Die Transformation für OLE DB-Befehl schließt die benutzerdefinierte Eigenschaft `SQLCommand` ein.</span><span class="sxs-lookup"><span data-stu-id="211ea-121">The OLE DB Command transformation includes the `SQLCommand` custom property.</span></span> <span data-ttu-id="211ea-122">Diese Eigenschaft kann beim Laden des Pakets mithilfe eines Eigenschaftsausdrucks aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="211ea-122">This property can be updated by a property expression when the package is loaded.</span></span> <span data-ttu-id="211ea-123">Weitere Informationen finden Sie unter [Integration Services-Ausdrücke &#40;SSIS&#41;](../../expressions/integration-services-ssis-expressions.md), [Verwenden von Eigenschaftsausdrücken in Paketen](../../expressions/use-property-expressions-in-packages.md) und [Benutzerdefinierte Eigenschaften von Transformationen](transformation-custom-properties.md).</span><span class="sxs-lookup"><span data-stu-id="211ea-123">For more information, see [Integration Services &#40;SSIS&#41; Expressions](../../expressions/integration-services-ssis-expressions.md), [Use Property Expressions in Packages](../../expressions/use-property-expressions-in-packages.md), and [Transformation Custom Properties](transformation-custom-properties.md).</span></span>  
  
 <span data-ttu-id="211ea-124">Diese Transformation weist eine Eingabe, eine reguläre Ausgabe und eine Fehlerausgabe auf.</span><span class="sxs-lookup"><span data-stu-id="211ea-124">This transformation has one input, one regular output, and one error output.</span></span>  
  
## <a name="logging"></a><span data-ttu-id="211ea-125">Protokollierung</span><span class="sxs-lookup"><span data-stu-id="211ea-125">Logging</span></span>  
 <span data-ttu-id="211ea-126">Sie können die von der Transformation für OLE DB-Befehl an externe Datenanbieter gerichteten Aufrufe protokollieren.</span><span class="sxs-lookup"><span data-stu-id="211ea-126">You can log the calls that the OLE DB Command transformation makes to external data providers.</span></span> <span data-ttu-id="211ea-127">Mithilfe dieser Protokollierungsfunktion können Sie Probleme bei Verbindungen mit externen Datenquellen und bei Befehlen an externe Datenquellen durch die Transformation für OLE DB-Befehl behandeln.</span><span class="sxs-lookup"><span data-stu-id="211ea-127">You can use this logging capability to troubleshoot the connections and commands to external data sources that the OLE DB Command transformation performs.</span></span> <span data-ttu-id="211ea-128">Aktivieren Sie zum Protokollieren der von der Transformation für OLE DB-Befehl an externe Datenanbieter gerichteten Aufrufe die Paketprotokollierung, und wählen Sie das **Diagnostic** -Ereignis auf Paketebene aus.</span><span class="sxs-lookup"><span data-stu-id="211ea-128">To log the calls that the OLE DB Command transformation makes to external data providers, enable package logging and select the **Diagnostic** event at the package level.</span></span> <span data-ttu-id="211ea-129">Weitere Informationen finden Sie unter [Behandeln von Problemen mit Paketausführungstools](../../troubleshooting/troubleshooting-tools-for-package-execution.md).</span><span class="sxs-lookup"><span data-stu-id="211ea-129">For more information, see [Troubleshooting Tools for Package Execution](../../troubleshooting/troubleshooting-tools-for-package-execution.md).</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="211ea-130">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="211ea-130">Related Tasks</span></span>  
 <span data-ttu-id="211ea-131">Sie können die Transformation konfigurieren, indem Sie entweder den [!INCLUDE[ssIS](../../../includes/ssis-md.md)] -Designer oder das Objektmodell verwenden.</span><span class="sxs-lookup"><span data-stu-id="211ea-131">You can configure the transformation by either using the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer or the object model.</span></span> <span data-ttu-id="211ea-132">Details zur Konfiguration der Transformation mithilfe des [!INCLUDE[ssIS](../../../includes/ssis-md.md)] -Designers finden Sie unter  [Konfigurieren der Transformation für OLE DB-Befehl](../../configure-the-ole-db-command-transformation.md).</span><span class="sxs-lookup"><span data-stu-id="211ea-132">For details about configuring the transformation using the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] designer, see  [Configure the OLE DB Command Transformation](../../configure-the-ole-db-command-transformation.md).</span></span> <span data-ttu-id="211ea-133">Details zum programmgesteuerten Konfigurieren dieser Transformation finden Sie im Entwicklerhandbuch.</span><span class="sxs-lookup"><span data-stu-id="211ea-133">See the Developer Guide for details about programmatically configuring this transformation.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="211ea-134">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="211ea-134">See Also</span></span>  
 <span data-ttu-id="211ea-135">[Datenfluss](../data-flow.md) </span><span class="sxs-lookup"><span data-stu-id="211ea-135">[Data Flow](../data-flow.md) </span></span>  
 [<span data-ttu-id="211ea-136">SQL Server Integration Services-Transformationen</span><span class="sxs-lookup"><span data-stu-id="211ea-136">Integration Services Transformations</span></span>](integration-services-transformations.md)  
  
  
